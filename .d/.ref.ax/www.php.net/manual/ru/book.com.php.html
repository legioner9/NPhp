<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: COM - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="book.com.php.html">
 <link rel="shorturl" href="https://www.php.net/com">
 <link rel="alternate" href="https://www.php.net/com" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="refs.utilspec.windows.php.html">
 <link rel="prev" href="refs.utilspec.windows.php.html">
 <link rel="next" href="intro.com.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/book.com.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/book.com.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/book.com.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/book.com.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/book.com.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/book.com.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/book.com.php" hreflang="pt_BR">
 <link rel="alternate" href="book.com.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/book.com.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/book.com.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="intro.com.php.html">
          Введение &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="refs.utilspec.windows.php.html">
          &laquo; Модули только для Windows        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.utilspec.windows.php.html'>Модули только для Windows</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/book.com.php'>English</option>
            <option value='de/book.com.php'>German</option>
            <option value='es/book.com.php'>Spanish</option>
            <option value='fr/book.com.php'>French</option>
            <option value='it/book.com.php'>Italian</option>
            <option value='ja/book.com.php'>Japanese</option>
            <option value='pt_BR/book.com.php'>Brazilian Portuguese</option>
            <option value='ru/book.com.php' selected="selected">Russian</option>
            <option value='tr/book.com.php'>Turkish</option>
            <option value='zh/book.com.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/com/book.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fbook.com%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="book.com" class="book">
 
 <h1 class="title">COM и .Net (Windows)</h1>
 

 
 
 

 





 





 





 





 





 





 





 





 





 





 







<ul class="chunklist chunklist_book"><li><a href="intro.com.php.html">Введение</a></li><li><a href="com.setup.php.html">Установка и настройка</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="com.requirements.php.html">Требования</a></li><li><a href="com.installation.php.html">Установка</a></li><li><a href="com.configuration.php.html">Настройка во время выполнения</a></li><li><a href="com.resources.php.html">Типы ресурсов</a></li></ul></li><li><a href="com.constants.php.html">Предопределённые константы</a></li><li><a href="com.error-handling.php.html">Ошибки и их обработка</a></li><li><a href="com.examples.php.html">Примеры</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="com.examples.foreach.php.html">For Each</a></li><li><a href="com.examples.arrays.php.html">Массивы и свойства COM в стиле массивов</a></li></ul></li><li><a href="class.com.php.html">com</a> — Класс com<ul class="chunklist chunklist_book chunklist_children"><li><a href="com.construct.php.html">com::__construct</a> — Конструктор класса com</li></ul></li><li><a href="class.dotnet.php.html">dotnet</a> — Класс dotnet<ul class="chunklist chunklist_book chunklist_children"><li><a href="dotnet.construct.php.html">dotnet::__construct</a> — Конструктор класса dotnet</li></ul></li><li><a href="class.variant.php.html">variant</a> — Класс variant<ul class="chunklist chunklist_book chunklist_children"><li><a href="variant.construct.php.html">variant::__construct</a> — Конструктор класса variant</li></ul></li><li><a href="class.compersisthelper.php.html">COMPersistHelper</a> — Класс COMPersistHelper<ul class="chunklist chunklist_book chunklist_children"><li><a href="compersisthelper.construct.php.html">COMPersistHelper::__construct</a> — Конструктор класса COMPersistHelper</li><li><a href="compersisthelper.getcurfilename.php.html">COMPersistHelper::GetCurFileName</a> — Получить имя файла</li><li><a href="compersisthelper.getmaxstreamsize.php.html">COMPersistHelper::GetMaxStreamSize</a> — Получить максимальный размер потока</li><li><a href="compersisthelper.initnew.php.html">COMPersistHelper::InitNew</a> — Инициализирует объект в состояние по умолчанию</li><li><a href="compersisthelper.loadfromfile.php.html">COMPersistHelper::LoadFromFile</a> — Загрузить объект из файла</li><li><a href="compersisthelper.loadfromstream.php.html">COMPersistHelper::LoadFromStream</a> — Загружает объект из потока</li><li><a href="compersisthelper.savetofile.php.html">COMPersistHelper::SaveToFile</a> — Сохранить объект в файл</li><li><a href="compersisthelper.savetostream.php.html">COMPersistHelper::SaveToStream</a> — Сохраняет объект в потоке</li></ul></li><li><a href="class.com-exception.php.html">com_exception</a> — Класс com_exception</li><li><a href="class.com-safearray-proxy.php.html">com_safearray_proxy</a> — Класс com_safearray_proxy</li><li><a href="ref.com.php.html">Функции COM</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.com-create-guid.php.html">com_create_guid</a> — Создание уникального глобального идентификатора (GUID)</li><li><a href="function.com-event-sink.php.html">com_event_sink</a> — Связать сообщения объекта COM с объектом PHP</li><li><a href="function.com-get-active-object.php.html">com_get_active_object</a> — Вернуть дескриптор на уже запущенный экземпляр объекта COM</li><li><a href="function.com-load-typelib.php.html">com_load_typelib</a> — Загрузка Typelib</li><li><a href="function.com-message-pump.php.html">com_message_pump</a> — Обработка сообщений COM, пришедших не позднее timeoutms миллисекунд после её запуска</li><li><a href="function.com-print-typeinfo.php.html">com_print_typeinfo</a> — Печатает определение класса PHP для интерфейса, наследующего IDispatch</li><li><a href="function.variant-abs.php.html">variant_abs</a> — Получить абсолютное значение варианта</li><li><a href="function.variant-add.php.html">variant_add</a> — Сложить значения двух вариантов</li><li><a href="function.variant-and.php.html">variant_and</a> — Побитовое И над двумя вариантами</li><li><a href="function.variant-cast.php.html">variant_cast</a> — Преобразовывает вариант в новый вариант другого типа</li><li><a href="function.variant-cat.php.html">variant_cat</a> — Объединение (конкатенация) значений двух вариантов</li><li><a href="function.variant-cmp.php.html">variant_cmp</a> — Сравнить два варианта</li><li><a href="function.variant-date-from-timestamp.php.html">variant_date_from_timestamp</a> — Получает представление даты для варианта из метки времени Unix</li><li><a href="function.variant-date-to-timestamp.php.html">variant_date_to_timestamp</a> — Преобразовывает вариант типа дата/время во временную метку Unix</li><li><a href="function.variant-div.php.html">variant_div</a> — Получить результат деления двух вариантов</li><li><a href="function.variant-eqv.php.html">variant_eqv</a> — Побитовая эквиваленция двух вариантов</li><li><a href="function.variant-fix.php.html">variant_fix</a> — Вернуть целую часть варианта</li><li><a href="function.variant-get-type.php.html">variant_get_type</a> — Получить тип варианта</li><li><a href="function.variant-idiv.php.html">variant_idiv</a> — Делит преобразованные в целые числа варианты</li><li><a href="function.variant-imp.php.html">variant_imp</a> — Побитовая импликация над двумя вариантами</li><li><a href="function.variant-int.php.html">variant_int</a> — Вернуть целочисленную часть варианта</li><li><a href="function.variant-mod.php.html">variant_mod</a> — Остаток от деления двух вариантов</li><li><a href="function.variant-mul.php.html">variant_mul</a> — Умножает значения двух вариантов</li><li><a href="function.variant-neg.php.html">variant_neg</a> — Логическое отрицание над вариантом</li><li><a href="function.variant-not.php.html">variant_not</a> — Побитовое отрицание над вариантом</li><li><a href="function.variant-or.php.html">variant_or</a> — Побитовое ИЛИ над двумя вариантами</li><li><a href="function.variant-pow.php.html">variant_pow</a> — Возводит один вариант в степень, заданную во втором</li><li><a href="function.variant-round.php.html">variant_round</a> — Округляет вариант с заданной точностью</li><li><a href="function.variant-set-type.php.html">variant_set_type</a> — Приводит вариант к другому типу &laquo;по месту&raquo;</li><li><a href="function.variant-set.php.html">variant_set</a> — Присвоение нового значения объекту варианта</li><li><a href="function.variant-sub.php.html">variant_sub</a> — Вычитает значение правого варианта из левого</li><li><a href="function.variant-xor.php.html">variant_xor</a> — Исключающее ИЛИ над двумя вариантами</li></ul></li></ul></div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=book.com&amp;redirect=https://www.php.net/manual/ru/book.com.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">6 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="90076">  <div class="votes">
    <div id="Vu90076">
    <a href="https://www.php.net/manual/vote-note.php?id=90076&amp;page=book.com&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd90076">
    <a href="https://www.php.net/manual/vote-note.php?id=90076&amp;page=book.com&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V90076" title="62% like this...">
    8
    </div>
  </div>
  <a href="book.com.php.html#90076" class="name">
  <strong class="user"><em>acsandeep at gmail dot com</em></strong></a><a class="genanchor" href="book.com.php.html#90076"> &para;</a><div class="date" title="2009-04-04 09:40"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom90076">
<div class="phpcode"><code><span class="html">If you are trying to get the properties of a Word document opened via COM object, you may need to define some constants in your script like so.<br /><br /><span class="default">&lt;?php<br />define</span><span class="keyword">(</span><span class="string">'wdPropertyTitle'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'wdPropertySubject'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'wdPropertyAuthor'</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'wdPropertyKeywords'</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'wdPropertyComments'</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'wdPropertyTemplate'</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'wdPropertyLastAuthor'</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">);<br /><br /></span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die (</span><span class="string">"Could not initialise MS Word object."</span><span class="keyword">);<br /></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="string">"Sample.doc"</span><span class="keyword">));<br /></span><span class="default">$Author </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">BuiltInDocumentProperties</span><span class="keyword">(</span><span class="default">wdPropertyAuthor</span><span class="keyword">);<br /><br />echo </span><span class="default">$Author</span><span class="keyword">;<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="109512">  <div class="votes">
    <div id="Vu109512">
    <a href="https://www.php.net/manual/vote-note.php?id=109512&amp;page=book.com&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd109512">
    <a href="https://www.php.net/manual/vote-note.php?id=109512&amp;page=book.com&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V109512" title="43% like this...">
    -8
    </div>
  </div>
  <a href="book.com.php.html#109512" class="name">
  <strong class="user"><em>robert dot johnson at icap dot com</em></strong></a><a class="genanchor" href="book.com.php.html#109512"> &para;</a><div class="date" title="2012-07-24 09:30"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom109512">
<div class="phpcode"><code><span class="html">(From?) PHP 5.4.5 for Windows:<br /><br />If you are seeing this in your error log:<br /><br />Fatal error:  Class 'COM' not found <br /><br />You require this in php.ini:<br /><br />[PHP_COM_DOTNET]<br />extension=php_com_dotnet.dll<br /><br />Previously it was compiled as built-in on the Windows build.  I assume this has happened because the com extension can now be built as a shared component.</span></code></div>
  </div>
 </div>
  <div class="note" id="89657">  <div class="votes">
    <div id="Vu89657">
    <a href="https://www.php.net/manual/vote-note.php?id=89657&amp;page=book.com&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd89657">
    <a href="https://www.php.net/manual/vote-note.php?id=89657&amp;page=book.com&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V89657" title="40% like this...">
    -7
    </div>
  </div>
  <a href="book.com.php.html#89657" class="name">
  <strong class="user"><em>long2hu3 ATT yahoo DOTT com</em></strong></a><a class="genanchor" href="book.com.php.html#89657"> &para;</a><div class="date" title="2009-03-18 04:38"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom89657">
<div class="phpcode"><code><span class="html">When you work with MS Excel, Word, ... and other applications, never forget that COM doesn’t know their predefined constants, thus if you want to do sth. that would look like this in VB:<br /><br />With myRange.Borders(xlEdgeBottom)<br />    .LineStyle = xlContinuous<br />    .Weight = xlThin<br />    .ColorIndex = xlAutomatic<br />End With<br /><br />you should either use numbers or define constants above, like this:<br /><br /><span class="default">&lt;?php<br /><br />define</span><span class="keyword">(</span><span class="string">'xlEdgeBottom'</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'xlContinuous'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'xlThin'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /></span><span class="default">define</span><span class="keyword">(</span><span class="string">'xlAutomatic'</span><span class="keyword">, -</span><span class="default">4105</span><span class="keyword">);<br /><br /></span><span class="default">$ex </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Excel.Application"</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">CP_UTF8</span><span class="keyword">) or Die (</span><span class="string">"Did not instantiate Excel"</span><span class="keyword">);<br /></span><span class="default">$wb </span><span class="keyword">= </span><span class="default">$ex</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();<br /></span><span class="default">$ws </span><span class="keyword">= </span><span class="default">$wb</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br /><br /></span><span class="default">$xra </span><span class="keyword">= </span><span class="default">$ws</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">(</span><span class="string">"A1:A6"</span><span class="keyword">);<br /><br /></span><span class="default">$bs </span><span class="keyword">= </span><span class="default">$xra</span><span class="keyword">-&gt;</span><span class="default">Borders</span><span class="keyword">(</span><span class="default">xlEdgeBottom</span><span class="keyword">);<br /></span><span class="default">$bs</span><span class="keyword">-&gt;</span><span class="default">LineStyle </span><span class="keyword">= </span><span class="default">xlContinuous</span><span class="keyword">;<br /></span><span class="default">$bs</span><span class="keyword">-&gt;</span><span class="default">Weight </span><span class="keyword">= </span><span class="default">xlThin</span><span class="keyword">;<br /></span><span class="default">$bs</span><span class="keyword">-&gt;</span><span class="default">ColorIndex </span><span class="keyword">= </span><span class="default">xlAutomatic</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;<br /></span><br />It is pointless to try to use text strings, i.e.<br /><br /><span class="default">&lt;?php<br /><br />$bs </span><span class="keyword">= </span><span class="default">$xra</span><span class="keyword">-&gt;</span><span class="default">Borders</span><span class="keyword">(</span><span class="string">'xlEdgeBottom'</span><span class="keyword">);<br /></span><span class="default">$bs</span><span class="keyword">-&gt;</span><span class="default">Weight </span><span class="keyword">= </span><span class="string">'xlThin'</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;<br /></span><br />this will cause an error: Unable to set property Weight of class Border ...</span></code></div>
  </div>
 </div>
  <div class="note" id="85328">  <div class="votes">
    <div id="Vu85328">
    <a href="https://www.php.net/manual/vote-note.php?id=85328&amp;page=book.com&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd85328">
    <a href="https://www.php.net/manual/vote-note.php?id=85328&amp;page=book.com&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V85328" title="38% like this...">
    -7
    </div>
  </div>
  <a href="book.com.php.html#85328" class="name">
  <strong class="user"><em>ilayansmano at gmail dot com</em></strong></a><a class="genanchor" href="book.com.php.html#85328"> &para;</a><div class="date" title="2008-08-26 01:39"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom85328">
<div class="phpcode"><code><span class="html">Extracting text from Word Documents via PHP and COM<br /><br /><span class="default">&lt;?php<br />$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die (</span><span class="string">"Could not initialise MS Word object."</span><span class="keyword">);<br /></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="string">"Sample.doc"</span><span class="keyword">));<br /><br /></span><span class="comment">// Extract content.<br /></span><span class="default">$content </span><span class="keyword">= (string) </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Content</span><span class="keyword">;<br /><br />echo </span><span class="default">$content</span><span class="keyword">;<br /><br /></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br /><br /></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br /></span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />unset(</span><span class="default">$word</span><span class="keyword">);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="93699">  <div class="votes">
    <div id="Vu93699">
    <a href="https://www.php.net/manual/vote-note.php?id=93699&amp;page=book.com&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd93699">
    <a href="https://www.php.net/manual/vote-note.php?id=93699&amp;page=book.com&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V93699" title="38% like this...">
    -9
    </div>
  </div>
  <a href="book.com.php.html#93699" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="book.com.php.html#93699"> &para;</a><div class="date" title="2009-09-23 05:00"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom93699">
<div class="phpcode"><code><span class="html">Add hyperlink at a Word Document's bookmark<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Create COM instance to word<br />       </span><span class="keyword">function </span><span class="default">clsMSWord</span><span class="keyword">(</span><span class="default">$Visible </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />       {<br />           </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate Word"</span><span class="keyword">);<br />           </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">$Visible</span><span class="keyword">;<br />       }<br /><br />function </span><span class="default">WriteHyperlink</span><span class="keyword">(</span><span class="default">$Bookmark</span><span class="keyword">,</span><span class="default">$Path</span><span class="keyword">,</span><span class="default">$Text</span><span class="keyword">)<br />       {<br />               </span><span class="default">$objBookmark </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Bookmarks</span><span class="keyword">(</span><span class="default">$Bookmark</span><span class="keyword">);<br />               </span><span class="default">$range </span><span class="keyword">= </span><span class="default">$objBookmark</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">;<br />               </span><span class="default">$objHyperlink </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Hyperlinks</span><span class="keyword">;<br />               </span><span class="default">$objHyperlink</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">(</span><span class="default">$range</span><span class="keyword">,</span><span class="default">$Path</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$Text</span><span class="keyword">);<br />           <br />       }<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="91161">  <div class="votes">
    <div id="Vu91161">
    <a href="https://www.php.net/manual/vote-note.php?id=91161&amp;page=book.com&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd91161">
    <a href="https://www.php.net/manual/vote-note.php?id=91161&amp;page=book.com&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V91161" title="25% like this...">
    -16
    </div>
  </div>
  <a href="book.com.php.html#91161" class="name">
  <strong class="user"><em>Dave Bachtel</em></strong></a><a class="genanchor" href="book.com.php.html#91161"> &para;</a><div class="date" title="2009-05-27 02:20"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom91161">
<div class="phpcode"><code><span class="html">Hello everybody!<br /><br />Here is some helpful advice for people attempting to use COM with Microsoft MapPoint 2006 or 2009 with PHP.<br /><br />If you are using apache, it MUST be running under the same credentials as a desktop user that has already installed/run mappoint or modifiy the service and select the "Allow Service to Interact with Desktop" option.  Otherwise, it won't work due to the EULA popup having to be accepted.  Mappoint 2004 works just fine, this only applies to 2006 and 2009.<br /><br />For troubleshooting, the error that appears in the System event viewer is:<br />The server {31851F82-AFE6-11D2-A3C9-00C04F72F340} did not register with DCOM within the required timeout.<br /><br />The error generated by PHP, if you happen to get lucky and let the COM() function timeout by cranking up set_time_limit() timeout is:<br /><span class="default">&lt;?php<br /><br />set_time_limit</span><span class="keyword">(</span><span class="default">1000</span><span class="keyword">) ;<br /><br /></span><span class="default">$mapoint </span><span class="keyword">=  new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MapPoint.Application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Mappoint COM object"</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;<br /></span>Generates:<br />Fatal error: Uncaught exception 'com_exception' with message 'Failed to create COM object `MapPoint.Application': Server execution failed ' in [somefile.php]:9 Stack trace: #0 [somefile.php](9): com-&gt;com('MapPoint.Applic...') #1 {main} thrown in [somefile.php] on line 9<br /><br />Also, if you have multiple versions of MapPoint installed, you will need to run:<br />c:\path\to\mappoint\MapPoint.exe /registerserver <br /><br />(using the correct folder path) to select the right version of the com object to use.  Gooood luck!</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=book.com&amp;redirect=https://www.php.net/manual/ru/book.com.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="refs.utilspec.windows.php.html">Модули только для Windows</a>

                                    <ul class='child-menu-list'>

                                                <li class="current">
                            <a href="book.com.php.html" title="COM">COM</a>
                        </li>
                                                <li class="">
                            <a href="book.win32service.php.html" title="win32service">win32service</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
