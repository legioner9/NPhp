<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: OpenSSL - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="book.openssl.php.html">
 <link rel="shorturl" href="https://www.php.net/openssl">
 <link rel="alternate" href="https://www.php.net/openssl" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="refs.crypto.php.html">
 <link rel="prev" href="function.mhash.php.html">
 <link rel="next" href="intro.openssl.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/book.openssl.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/book.openssl.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/book.openssl.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/book.openssl.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/book.openssl.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/book.openssl.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/book.openssl.php" hreflang="pt_BR">
 <link rel="alternate" href="book.openssl.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/book.openssl.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/book.openssl.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="intro.openssl.php.html">
          Введение &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.mhash.php.html">
          &laquo; mhash        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.crypto.php.html'>Криптографические модули</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/book.openssl.php'>English</option>
            <option value='de/book.openssl.php'>German</option>
            <option value='es/book.openssl.php'>Spanish</option>
            <option value='fr/book.openssl.php'>French</option>
            <option value='it/book.openssl.php'>Italian</option>
            <option value='ja/book.openssl.php'>Japanese</option>
            <option value='pt_BR/book.openssl.php'>Brazilian Portuguese</option>
            <option value='ru/book.openssl.php' selected="selected">Russian</option>
            <option value='tr/book.openssl.php'>Turkish</option>
            <option value='zh/book.openssl.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/openssl/book.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fbook.openssl%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="book.openssl" class="book">
 
 <h1 class="title">OpenSSL</h1>

 
 
 

 




 




 




 





 






 





 





 






<ul class="chunklist chunklist_book"><li><a href="intro.openssl.php.html">Введение</a></li><li><a href="openssl.setup.php.html">Установка и настройка</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="openssl.requirements.php.html">Требования</a></li><li><a href="openssl.installation.php.html">Установка</a></li><li><a href="openssl.configuration.php.html">Настройка во время выполнения</a></li><li><a href="openssl.resources.php.html">Типы ресурсов</a></li></ul></li><li><a href="openssl.constants.php.html">Предопределённые константы</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="openssl.purpose-check.php.html">Флаги проверки</a></li><li><a href="openssl.padding.php.html">Флаги заполнения для ассиметричного шифрования</a></li><li><a href="openssl.key-types.php.html">Типы ключей</a></li><li><a href="openssl.pkcs7.flags.php.html">Флаги/константы PKCS7</a></li><li><a href="openssl.cms.flags.php.html">Флаги/Константы CMS</a></li><li><a href="openssl.signature-algos.php.html">Алгоритмы подписи</a></li><li><a href="openssl.ciphers.php.html">Алгоритмы шифрования</a></li><li><a href="openssl.constversion.php.html">Константы версий</a></li><li><a href="openssl.constsni.php.html">Константа SNI (Server Name Indication)</a></li><li><a href="openssl.constants.other.php.html">Другие константы</a></li></ul></li><li><a href="openssl.certparams.php.html">Параметры ключа/сертификата</a></li><li><a href="openssl.cert.verification.php.html">Проверка сертификатов</a></li><li><a href="ref.openssl.php.html">Функции OpenSSL</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.openssl-cipher-iv-length.php.html">openssl_cipher_iv_length</a> — Получает длину инициализирующего вектора шифра</li><li><a href="function.openssl-cipher-key-length.php.html">openssl_cipher_key_length</a> — Получает длину ключа шифрования</li><li><a href="function.openssl-cms-decrypt.php.html">openssl_cms_decrypt</a> — Расшифровывает CMS-сообщение</li><li><a href="function.openssl-cms-encrypt.php.html">openssl_cms_encrypt</a> — Зашифровывает CMS-сообщение</li><li><a href="function.openssl-cms-read.php.html">openssl_cms_read</a> — Экспортирует файл CMS в массив сертификатов PEM</li><li><a href="function.openssl-cms-sign.php.html">openssl_cms_sign</a> — Подписывает файл</li><li><a href="function.openssl-cms-verify.php.html">openssl_cms_verify</a> — Проверяет подпись CMS</li><li><a href="function.openssl-csr-export-to-file.php.html">openssl_csr_export_to_file</a> — Экспортирует CSR в файл</li><li><a href="function.openssl-csr-export.php.html">openssl_csr_export</a> — Экспортирует CSR в виде строки</li><li><a href="function.openssl-csr-get-public-key.php.html">openssl_csr_get_public_key</a> — Возвращает открытый ключ CSR</li><li><a href="function.openssl-csr-get-subject.php.html">openssl_csr_get_subject</a> — Возвращает субъект CSR</li><li><a href="function.openssl-csr-new.php.html">openssl_csr_new</a> — Генерирует CSR</li><li><a href="function.openssl-csr-sign.php.html">openssl_csr_sign</a> — Подписать CSR с помощью другого сертификата (или им же) и создать сертификат</li><li><a href="function.openssl-decrypt.php.html">openssl_decrypt</a> — Расшифровывает данные</li><li><a href="function.openssl-dh-compute-key.php.html">openssl_dh_compute_key</a> — Вычисляет общий секретный ключ для значения удалённого открытого ключа DH и локального ключа DH</li><li><a href="function.openssl-digest.php.html">openssl_digest</a> — Вычисление дайджеста</li><li><a href="function.openssl-encrypt.php.html">openssl_encrypt</a> — Шифрует данные</li><li><a href="function.openssl-error-string.php.html">openssl_error_string</a> — Возвращает сообщение об ошибке openSSL</li><li><a href="function.openssl-free-key.php.html">openssl_free_key</a> — Высвобождение ресурса ключа</li><li><a href="function.openssl-get-cert-locations.php.html">openssl_get_cert_locations</a> — Получить доступные месторасположения сертификатов</li><li><a href="function.openssl-get-cipher-methods.php.html">openssl_get_cipher_methods</a> — Получить список доступных алгоритмов шифрования</li><li><a href="function.openssl-get-curve-names.php.html">openssl_get_curve_names</a> — Список доступных имён кривых для ECC</li><li><a href="function.openssl-get-md-methods.php.html">openssl_get_md_methods</a> — Получить список доступных методов хеширования</li><li><a href="function.openssl-get-privatekey.php.html">openssl_get_privatekey</a> — Псевдоним openssl_pkey_get_private</li><li><a href="function.openssl-get-publickey.php.html">openssl_get_publickey</a> — Псевдоним openssl_pkey_get_public</li><li><a href="function.openssl-open.php.html">openssl_open</a> — Открыть запечатанные данные</li><li><a href="function.openssl-pbkdf2.php.html">openssl_pbkdf2</a> — Генерирует строки PKCS5 v2 PBKDF2</li><li><a href="function.openssl-pkcs12-export-to-file.php.html">openssl_pkcs12_export_to_file</a> — Экспортирует в совместимый с PKCS#12 файл хранилища сертификатов</li><li><a href="function.openssl-pkcs12-export.php.html">openssl_pkcs12_export</a> — Экспортирует совместимый с PKCS#12 файл хранилища сертификатов в переменную</li><li><a href="function.openssl-pkcs12-read.php.html">openssl_pkcs12_read</a> — Разбирает хранилище сертификатов PKCS#12 в массив</li><li><a href="function.openssl-pkcs7-decrypt.php.html">openssl_pkcs7_decrypt</a> — Расшифровать сообщение, зашифрованное S/MIME</li><li><a href="function.openssl-pkcs7-encrypt.php.html">openssl_pkcs7_encrypt</a> — Шифрует сообщение S/MIME</li><li><a href="function.openssl-pkcs7-read.php.html">openssl_pkcs7_read</a> — Экспортировать файл PKCS7 в массив сертификатов PEM</li><li><a href="function.openssl-pkcs7-sign.php.html">openssl_pkcs7_sign</a> — Подписать сообщение S/MIME</li><li><a href="function.openssl-pkcs7-verify.php.html">openssl_pkcs7_verify</a> — Проверить подпись сообщения S/MIME</li><li><a href="function.openssl-pkey-derive.php.html">openssl_pkey_derive</a> — Вычисляет общий секрет для открытого значения удалённого и локального ключа DH или ECDH</li><li><a href="function.openssl-pkey-export-to-file.php.html">openssl_pkey_export_to_file</a> — Записывает в файл ключ в формате PEM</li><li><a href="function.openssl-pkey-export.php.html">openssl_pkey_export</a> — Получает строку с ключом в формате PEM</li><li><a href="function.openssl-pkey-free.php.html">openssl_pkey_free</a> — Освобождает ресурс закрытого ключа</li><li><a href="function.openssl-pkey-get-details.php.html">openssl_pkey_get_details</a> — Получает массив с детальной информацией о ключе</li><li><a href="function.openssl-pkey-get-private.php.html">openssl_pkey_get_private</a> — Получить закрытый ключ</li><li><a href="function.openssl-pkey-get-public.php.html">openssl_pkey_get_public</a> — Извлекает открытый ключ из сертификата и подготавливает его к использованию</li><li><a href="function.openssl-pkey-new.php.html">openssl_pkey_new</a> — Генерирует новый закрытый ключ</li><li><a href="function.openssl-private-decrypt.php.html">openssl_private_decrypt</a> — Расшифровывает данные с помощью закрытого ключа</li><li><a href="function.openssl-private-encrypt.php.html">openssl_private_encrypt</a> — Шифрует данные секретным ключом</li><li><a href="function.openssl-public-decrypt.php.html">openssl_public_decrypt</a> — Расшифровка данных с помощью открытого ключа</li><li><a href="function.openssl-public-encrypt.php.html">openssl_public_encrypt</a> — Шифрование данных открытым ключом</li><li><a href="function.openssl-random-pseudo-bytes.php.html">openssl_random_pseudo_bytes</a> — Генерирует псевдослучайную последовательность байт</li><li><a href="function.openssl-seal.php.html">openssl_seal</a> — Запечатать (зашифровать) данные</li><li><a href="function.openssl-sign.php.html">openssl_sign</a> — Генерация подписи</li><li><a href="function.openssl-spki-export-challenge.php.html">openssl_spki_export_challenge</a> — Экспорт вызова, связанного с подписанным ключом и вызовом</li><li><a href="function.openssl-spki-export.php.html">openssl_spki_export</a> — Экспорт открытого ключа в формате PEM из подписанного открытого ключа с вызовом</li><li><a href="function.openssl-spki-new.php.html">openssl_spki_new</a> — Создание нового подписанного открытого ключа с вызовом</li><li><a href="function.openssl-spki-verify.php.html">openssl_spki_verify</a> — Проверяет подписанный открытый ключ и вызов</li><li><a href="function.openssl-verify.php.html">openssl_verify</a> — Сверка сигнатуры</li><li><a href="function.openssl-x509-check-private-key.php.html">openssl_x509_check_private_key</a> — Проверить, относится ли секретный ключ к сертификату</li><li><a href="function.openssl-x509-checkpurpose.php.html">openssl_x509_checkpurpose</a> — Проверяет, можно ли использовать сертификат для конкретных задач</li><li><a href="function.openssl-x509-export-to-file.php.html">openssl_x509_export_to_file</a> — Экспортирует сертификат в файл</li><li><a href="function.openssl-x509-export.php.html">openssl_x509_export</a> — Экспортирует сертификат в строку</li><li><a href="function.openssl-x509-fingerprint.php.html">openssl_x509_fingerprint</a> — Вычисляет отпечаток или дайджест, заданный сертификатом X.509</li><li><a href="function.openssl-x509-free.php.html">openssl_x509_free</a> — Высвобождает ресурс сертификата</li><li><a href="function.openssl-x509-parse.php.html">openssl_x509_parse</a> — Разобрать сертификат X509 и получить массив с данными о нем</li><li><a href="function.openssl-x509-read.php.html">openssl_x509_read</a> — Разобрать сертификат X.509 и вернуть для него объект</li><li><a href="function.openssl-x509-verify.php.html">openssl_x509_verify</a> — Проверка цифровой подписи сертификата x509 с помощью публичного ключа</li></ul></li><li><a href="class.opensslcertificate.php.html">OpenSSLCertificate</a> — Класс OpenSSLCertificate</li><li><a href="class.opensslcertificatesigningrequest.php.html">OpenSSLCertificateSigningRequest</a> — Класс OpenSSLCertificateSigningRequest</li><li><a href="class.opensslasymmetrickey.php.html">OpenSSLAsymmetricKey</a> — Класс OpenSSLAsymmetricKey</li></ul></div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=book.openssl&amp;redirect=https://www.php.net/manual/ru/book.openssl.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">3 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="91210">  <div class="votes">
    <div id="Vu91210">
    <a href="https://www.php.net/manual/vote-note.php?id=91210&amp;page=book.openssl&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd91210">
    <a href="https://www.php.net/manual/vote-note.php?id=91210&amp;page=book.openssl&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V91210" title="66% like this...">
    52
    </div>
  </div>
  <a href="book.openssl.php.html#91210" class="name">
  <strong class="user"><em>bdh dot hall at gmail dot com</em></strong></a><a class="genanchor" href="book.openssl.php.html#91210"> &para;</a><div class="date" title="2009-05-29 03:18"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom91210">
<div class="phpcode"><code><span class="html">I was having a heck of a time finding help on making asynchronous encryption/decryption using private key/public key systems working, and I had to have it for creating a credit card module that uses recurring billing.<br /><br />You'd be a fool to use normal, 'synchronous' or two-way encryption for this, so the whole mcrypt library won't help.<br /><br />But, it turns out OpenSSL is extremely easy to use...yet it is so sparsely documented that it seems it would be incredibly hard.<br /><br />So I share my day of hacking with you - I hope you find it helpful!<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">if (isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTPS'</span><span class="keyword">]) )<br />{<br />    echo </span><span class="string">"SECURE: This page is being accessed through a secure connection.&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br />}<br />else<br />{<br />    echo </span><span class="string">"UNSECURE: This page is being access through an unsecure connection.&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br />}<br /><br /></span><span class="comment">// Create the keypair<br /></span><span class="default">$res</span><span class="keyword">=</span><span class="default">openssl_pkey_new</span><span class="keyword">();<br /><br /></span><span class="comment">// Get private key<br /></span><span class="default">openssl_pkey_export</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$privatekey</span><span class="keyword">);<br /><br /></span><span class="comment">// Get public key<br /></span><span class="default">$publickey</span><span class="keyword">=</span><span class="default">openssl_pkey_get_details</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">);<br /></span><span class="default">$publickey</span><span class="keyword">=</span><span class="default">$publickey</span><span class="keyword">[</span><span class="string">"key"</span><span class="keyword">];<br /><br />echo </span><span class="string">"Private Key:&lt;BR&gt;</span><span class="default">$privatekey</span><span class="string">&lt;br&gt;&lt;br&gt;Public Key:&lt;BR&gt;</span><span class="default">$publickey</span><span class="string">&lt;BR&gt;&lt;BR&gt;"</span><span class="keyword">;<br /><br /></span><span class="default">$cleartext </span><span class="keyword">= </span><span class="string">'1234 5678 9012 3456'</span><span class="keyword">;<br /><br />echo </span><span class="string">"Clear text:&lt;br&gt;</span><span class="default">$cleartext</span><span class="string">&lt;BR&gt;&lt;BR&gt;"</span><span class="keyword">;<br /><br /></span><span class="default">openssl_public_encrypt</span><span class="keyword">(</span><span class="default">$cleartext</span><span class="keyword">, </span><span class="default">$crypttext</span><span class="keyword">, </span><span class="default">$publickey</span><span class="keyword">);<br /><br />echo </span><span class="string">"Crypt text:&lt;br&gt;</span><span class="default">$crypttext</span><span class="string">&lt;BR&gt;&lt;BR&gt;"</span><span class="keyword">;<br /><br /></span><span class="default">openssl_private_decrypt</span><span class="keyword">(</span><span class="default">$crypttext</span><span class="keyword">, </span><span class="default">$decrypted</span><span class="keyword">, </span><span class="default">$privatekey</span><span class="keyword">);<br /><br />echo </span><span class="string">"Decrypted text:&lt;BR&gt;</span><span class="default">$decrypted</span><span class="string">&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span><br />Many thanks to other contributors in the docs for making this less painful.<br /><br />Note that you will want to use these sorts of functions to generate a key ONCE - save your privatekey offline for decryption, and put your public key in your scripts/configuration file. If your data is compromised you don't care about the encrypted stuff or the public key, it's only the private key and cleartext that really matter.<br /><br />Good luck!</span></code></div>
  </div>
 </div>
  <div class="note" id="85444">  <div class="votes">
    <div id="Vu85444">
    <a href="https://www.php.net/manual/vote-note.php?id=85444&amp;page=book.openssl&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd85444">
    <a href="https://www.php.net/manual/vote-note.php?id=85444&amp;page=book.openssl&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V85444" title="46% like this...">
    -5
    </div>
  </div>
  <a href="book.openssl.php.html#85444" class="name">
  <strong class="user"><em>koen dot thomeer at pubmed dot be</em></strong></a><a class="genanchor" href="book.openssl.php.html#85444"> &para;</a><div class="date" title="2008-08-31 10:27"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom85444">
<div class="phpcode"><code><span class="html">For checking the status of a client certificate using OCSP, you can use this script:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// User variables:<br /></span><span class="default">$dir </span><span class="keyword">= </span><span class="string">'/path/to/temp/'</span><span class="keyword">; </span><span class="comment">// Directory where apache has access to (chmod 777).<br /></span><span class="default">$RootCA </span><span class="keyword">= </span><span class="string">'/path/to/Root.cer'</span><span class="keyword">; </span><span class="comment">// Points to the Root CA in PEM format.<br /></span><span class="default">$OCSPUrl </span><span class="keyword">= </span><span class="string">'<a href="http://ocsp.url" rel="nofollow" target="_blank">http://ocsp.url</a>'</span><span class="keyword">; </span><span class="comment">//Points to the OCSP URL<br />// Script:<br /></span><span class="default">$a </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1000</span><span class="keyword">,</span><span class="default">99999</span><span class="keyword">); </span><span class="comment">// Needed if you expect more page clicks in one second!<br /></span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'cert_i.pem'</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SSL_CLIENT_CERT_CHAIN_0'</span><span class="keyword">]); </span><span class="comment">// Issuer certificate.<br /></span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'cert_c.pem'</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SSL_CLIENT_CERT'</span><span class="keyword">]); </span><span class="comment">// Client (authentication) certificate.<br /></span><span class="default">$output </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'openssl ocsp -CAfile '</span><span class="keyword">.</span><span class="default">$RootCA</span><span class="keyword">.</span><span class="string">' -issuer '</span><span class="keyword">.</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'cert_i.pem -cert '</span><span class="keyword">.</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'cert_c.pem -url '</span><span class="keyword">.</span><span class="default">$OCSPUrl</span><span class="keyword">);<br /></span><span class="default">$output2 </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">'/[\r\n]/'</span><span class="keyword">, </span><span class="default">$output</span><span class="keyword">);<br /></span><span class="default">$output3 </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">'/: /'</span><span class="keyword">, </span><span class="default">$output2</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /></span><span class="default">$ocsp </span><span class="keyword">= </span><span class="default">$output3</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />echo </span><span class="string">"OCSP status: "</span><span class="keyword">.</span><span class="default">$ocsp</span><span class="keyword">; </span><span class="comment">// will be "good", "revoked", or "unknown"<br /></span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'cert_i.pem'</span><span class="keyword">);<br /></span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'cert_c.pem'</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />It can be ameliorated, but it's just a beginning!<br /><br />Normally, you can extract the ocsp url from the client certificate. Also, an OCSP request contains only the hash of the issuer name, the hash of the issuer's key, and the serial number of the client certificate. All three can be extracted directly from the client certificate.</span></code></div>
  </div>
 </div>
  <div class="note" id="119594">  <div class="votes">
    <div id="Vu119594">
    <a href="https://www.php.net/manual/vote-note.php?id=119594&amp;page=book.openssl&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd119594">
    <a href="https://www.php.net/manual/vote-note.php?id=119594&amp;page=book.openssl&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V119594" title="40% like this...">
    -9
    </div>
  </div>
  <a href="book.openssl.php.html#119594" class="name">
  <strong class="user"><em>james at NOSPAM dot gmail dot com</em></strong></a><a class="genanchor" href="book.openssl.php.html#119594"> &para;</a><div class="date" title="2016-07-13 10:01"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom119594">
<div class="phpcode"><code><span class="html">In regards to the comment above:<br /><br />"After generating a key pair with OpenSSL, the public key can be stored in plain text format. I then encrypted the private key itself using regular mcrypt with the human-memorizable key of my choice and converted it to ACSII using base64_encode. Then to get the private key back, I just decrypted it with mcrypt. This way I could store the encrypted private key on the server without worrying about having things stored unencrypted. "<br /><br />To anyone reading this that might not be all that familiar with public key cryptography; I haven't the slightest idea what this person is talking about, but I can tell you its an absolutely horrible idea.  He might have ended up with something that "looked like a private key" insofar as it was a base64 encoded string, but he did not have a private key.  The parameters that make up a public/private key pair are EXTREMELY specific and in the case of RSA rely on very large co-primes plus an even larger moduli.  Its not just a base64 encoded string; and just for the record... base64 encoding is not encryption. <br /><br />One of two things happened; the more likely is the whatever program he needed the certificate for realized there was something wrong with the private key, and ignored it, reverting to either a default key, or null encryption or something.  The worse outcome would be if it interpreted whatever was there as legitimate; and encrypted data as if it were a a proper certificate; encrypting this way would likely provide close to zero security and I'm not even sure you could decrypt the data once encrypted.  Its not worth giving much thought.  <br /><br />Just please; don't do this.<br /><br />You can read about pki certificate structures and attribute frameworks by pasting "T-REC-X.509-201210-I" into your favorite interwebs search widget and following the result to the International Telecommunications Union webpage, or you can refer to the numerous RFCs; 6818, 5820 being good places to start. The Internet Engineering Task Force archives all RFCs, but there are other sources as well.  "IETF RFC" should be enough to get you there.<br /><br />...sorry, the "spam buster" was giving me all kinds of issues.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=book.openssl&amp;redirect=https://www.php.net/manual/ru/book.openssl.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="refs.crypto.php.html">Криптографические модули</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="book.hash.php.html" title="Hash">Hash</a>
                        </li>
                                                <li class="">
                            <a href="book.mcrypt.php.html" title="Mcrypt">Mcrypt</a>
                        </li>
                                                <li class="">
                            <a href="book.mhash.php.html" title="Mhash">Mhash</a>
                        </li>
                                                <li class="current">
                            <a href="book.openssl.php.html" title="OpenSSL">OpenSSL</a>
                        </li>
                                                <li class="">
                            <a href="book.password.php.html" title="Хеширование паролей">Хеширование паролей</a>
                        </li>
                                                <li class="">
                            <a href="book.rnp.php.html" title="Rnp">Rnp</a>
                        </li>
                                                <li class="">
                            <a href="book.sodium.php.html" title="Sodium">Sodium</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
