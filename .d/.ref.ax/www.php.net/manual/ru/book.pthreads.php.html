<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: pthreads - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="book.pthreads.php.html">
 <link rel="shorturl" href="https://www.php.net/pthreads">
 <link rel="alternate" href="https://www.php.net/pthreads" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="refs.fileprocess.process.php.html">
 <link rel="prev" href="parallel-sync.invoke.php.html">
 <link rel="next" href="intro.pthreads.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/book.pthreads.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/book.pthreads.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/book.pthreads.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/book.pthreads.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/book.pthreads.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/book.pthreads.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/book.pthreads.php" hreflang="pt_BR">
 <link rel="alternate" href="book.pthreads.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/book.pthreads.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/book.pthreads.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="intro.pthreads.php.html">
          Введение &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="parallel-sync.invoke.php.html">
          &laquo; parallel\Sync::__invoke        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.fileprocess.process.php.html'>Модули для управления процессами программ</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/book.pthreads.php'>English</option>
            <option value='de/book.pthreads.php'>German</option>
            <option value='es/book.pthreads.php'>Spanish</option>
            <option value='fr/book.pthreads.php'>French</option>
            <option value='it/book.pthreads.php'>Italian</option>
            <option value='ja/book.pthreads.php'>Japanese</option>
            <option value='pt_BR/book.pthreads.php'>Brazilian Portuguese</option>
            <option value='ru/book.pthreads.php' selected="selected">Russian</option>
            <option value='tr/book.pthreads.php'>Turkish</option>
            <option value='zh/book.pthreads.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/pthreads/book.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fbook.pthreads%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="book.pthreads" class="book">
 
 <h1 class="title">pthreads</h1>
 

 

 





 






 






 






 






 





 





 






<ul class="chunklist chunklist_book"><li><a href="intro.pthreads.php.html">Введение</a></li><li><a href="pthreads.setup.php.html">Установка и настройка</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="pthreads.requirements.php.html">Требования</a></li><li><a href="pthreads.installation.php.html">Установка</a></li><li><a href="pthreads.configuration.php.html">Настройка во время выполнения</a></li></ul></li><li><a href="pthreads.constants.php.html">Предопределённые константы</a></li><li><a href="class.threaded.php.html">Threaded</a> — Класс Threaded<ul class="chunklist chunklist_book chunklist_children"><li><a href="threaded.chunk.php.html">Threaded::chunk</a> — Обработка</li><li><a href="threaded.count.php.html">Threaded::count</a> — Обработка</li><li><a href="threaded.extend.php.html">Threaded::extend</a> — Обработка во время выполнения</li><li><a href="thread.isrunning.php.html">Threaded::isRunning</a> — Определение состояния</li><li><a href="threaded.isterminated.php.html">Threaded::isTerminated</a> — Определение состояния</li><li><a href="threaded.merge.php.html">Threaded::merge</a> — Обработка</li><li><a href="threaded.notify.php.html">Threaded::notify</a> — Синхронизация</li><li><a href="threaded.notifyone.php.html">Threaded::notifyOne</a> — Синхронизация</li><li><a href="threaded.pop.php.html">Threaded::pop</a> — Обработка</li><li><a href="threaded.run.php.html">Threaded::run</a> — Выполнение</li><li><a href="threaded.shift.php.html">Threaded::shift</a> — Обработка</li><li><a href="threaded.synchronized.php.html">Threaded::synchronized</a> — Синхронизация</li><li><a href="threaded.wait.php.html">Threaded::wait</a> — Синхронизация</li></ul></li><li><a href="class.thread.php.html">Thread</a> — Класс Thread<ul class="chunklist chunklist_book chunklist_children"><li><a href="thread.getcreatorid.php.html">Thread::getCreatorId</a> — Идентификация</li><li><a href="thread.getcurrentthread.php.html">Thread::getCurrentThread</a> — Идентификация</li><li><a href="thread.getcurrentthreadid.php.html">Thread::getCurrentThreadId</a> — Идентификация</li><li><a href="thread.getthreadid.php.html">Thread::getThreadId</a> — Идентификация</li><li><a href="thread.isjoined.php.html">Thread::isJoined</a> — Определение состояния</li><li><a href="thread.isstarted.php.html">Thread::isStarted</a> — Определение состояния</li><li><a href="thread.join.php.html">Thread::join</a> — Синхронизация</li><li><a href="thread.start.php.html">Thread::start</a> — Выполнение</li></ul></li><li><a href="class.worker.php.html">Worker</a> — Класс Worker<ul class="chunklist chunklist_book chunklist_children"><li><a href="worker.collect.php.html">Worker::collect</a> — Собрать ссылки на завершённые задачи</li><li><a href="worker.getstacked.php.html">Worker::getStacked</a> — Возвращает текущий размер стека</li><li><a href="worker.isshutdown.php.html">Worker::isShutdown</a> — Определение состояния</li><li><a href="worker.shutdown.php.html">Worker::shutdown</a> — Остановить Worker</li><li><a href="worker.stack.php.html">Worker::stack</a> — Положить задачу на стек</li><li><a href="worker.unstack.php.html">Worker::unstack</a> — Убрать задачу со стека</li></ul></li><li><a href="class.collectable.php.html">Collectable</a> — Интерфейс Collectable<ul class="chunklist chunklist_book chunklist_children"><li><a href="collectable.isgarbage.php.html">Collectable::isGarbage</a> — Определяет, помечен ли объект как мусор</li></ul></li><li><a href="class.pool.php.html">Pool</a> — Класс Pool<ul class="chunklist chunklist_book chunklist_children"><li><a href="pool.collect.php.html">Pool::collect</a> — Собирает ссылки на выполненные задания</li><li><a href="pool.construct.php.html">Pool::__construct</a> — Создаёт новый пул воркеров</li><li><a href="pool.resize.php.html">Pool::resize</a> — Изменяет размер пула</li><li><a href="pool.shutdown.php.html">Pool::shutdown</a> — Выключает все воркеры</li><li><a href="pool.submit.php.html">Pool::submit</a> — Отправляет объект на исполнение</li><li><a href="pool.submitTo.php.html">Pool::submitTo</a> — Отправляет задачу конкретному воркеру для выполнения</li></ul></li><li><a href="class.volatile.php.html">Volatile</a> — Класс Volatile</li></ul></div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=book.pthreads&amp;redirect=https://www.php.net/manual/ru/book.pthreads.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">6 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="121173">  <div class="votes">
    <div id="Vu121173">
    <a href="https://www.php.net/manual/vote-note.php?id=121173&amp;page=book.pthreads&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121173">
    <a href="https://www.php.net/manual/vote-note.php?id=121173&amp;page=book.pthreads&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121173" title="78% like this...">
    23
    </div>
  </div>
  <a href="book.pthreads.php.html#121173" class="name">
  <strong class="user"><em>anonymous at example dot com</em></strong></a><a class="genanchor" href="book.pthreads.php.html#121173"> &para;</a><div class="date" title="2017-06-02 03:19"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121173">
<div class="phpcode"><code><span class="html">Here are some notes regarding PHP pThreads v3 that I have gathered:<br />-namespace: It does not understand namespaces. <br />-globals: It won't serialize GLOBALS at all! And will not register new ones.<br />-classes: It registers new classes okay.<br />-functions: Will not register ANY functions - they must all be in static classes. It does understand PHP native functions. <br />-consts: previous constants will transfer over. Don't make any new ones thou!<br />-pThreads only work in CLI - of course!<br />-If a thread crashes it automatically gets recreated.<br />-In order to 'force kill' any thread the parent must be killed. Or wait until all other tasks queued are complete and then terminate.<br />-Anything registered in a pThread does not seem to join the main thread ... which is good!<br />-pThreads seem to be very powerful on multi-core environments, just need to be careful on system resources... it can and will lock up a system if mis-configured.<br />-Finally, finding help for PHP pThreads is slim to none... especially v3!<br /><br />Good luck!</span></code></div>
  </div>
 </div>
  <div class="note" id="125640">  <div class="votes">
    <div id="Vu125640">
    <a href="https://www.php.net/manual/vote-note.php?id=125640&amp;page=book.pthreads&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125640">
    <a href="https://www.php.net/manual/vote-note.php?id=125640&amp;page=book.pthreads&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125640" title="83% like this...">
    8
    </div>
  </div>
  <a href="book.pthreads.php.html#125640" class="name">
  <strong class="user"><em>meadowsjared at gmail dot com</em></strong></a><a class="genanchor" href="book.pthreads.php.html#125640"> &para;</a><div class="date" title="2020-12-29 04:49"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom125640">
<div class="phpcode"><code><span class="html">In this example, it shows how to use a threaded with a pool to get an array of results, using pThreads v3.2.1 and php 7.3.23<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">TestWork </span><span class="keyword">extends </span><span class="default">Threaded </span><span class="keyword">{<br /></span><span class="comment">//updated version that works with pThreads v3.2.1 and php 7.3.23<br />    </span><span class="keyword">protected </span><span class="default">$complete</span><span class="keyword">;<br />    </span><span class="comment">//$pData is the data sent to your worker thread to do it's job.<br />    </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$pData</span><span class="keyword">) {<br />        </span><span class="comment">//transfer all the variables to local variables<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">complete </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">testData </span><span class="keyword">= </span><span class="default">$pData</span><span class="keyword">;<br />    }<br />    </span><span class="comment">//This is where all of your work will be done.<br />    </span><span class="keyword">public function </span><span class="default">run</span><span class="keyword">() {<br />        </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">2000000</span><span class="keyword">); </span><span class="comment">//sleep 2 seconds to simulate a large job<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">complete </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />    }<br />    public function </span><span class="default">isDone</span><span class="keyword">() {<br />        return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">complete</span><span class="keyword">;<br />    }<br />}<br />class </span><span class="default">ExamplePool </span><span class="keyword">extends </span><span class="default">Pool </span><span class="keyword">{<br />    public </span><span class="default">$data </span><span class="keyword">= array(); </span><span class="comment">// used to return data after we're done<br />    </span><span class="keyword">private </span><span class="default">$numTasks </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// counter used to know when we're done<br />    /**<br />     * override the submit function from the parent<br />     * to keep track of our jobs<br />     */<br />    </span><span class="keyword">public function </span><span class="default">submit</span><span class="keyword">(</span><span class="default">Threaded $task</span><span class="keyword">) {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">numTasks</span><span class="keyword">++;<br />        </span><span class="default">parent</span><span class="keyword">::</span><span class="default">submit</span><span class="keyword">(</span><span class="default">$task</span><span class="keyword">);<br />    }<br />    </span><span class="comment">/**<br />     * used to wait until all workers are done<br />     */<br />    </span><span class="keyword">public function </span><span class="default">process</span><span class="keyword">() {<br />        </span><span class="comment">// Run this loop as long as we have<br />        // jobs in the pool<br />        </span><span class="keyword">while (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">) &lt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">numTasks</span><span class="keyword">) {<br />            </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">collect</span><span class="keyword">(function (</span><span class="default">TestWork $task</span><span class="keyword">) {<br />                </span><span class="comment">// If a task was marked as done<br />                // collect its results<br />                </span><span class="keyword">if (</span><span class="default">$task</span><span class="keyword">-&gt;</span><span class="default">isDone</span><span class="keyword">()) {<br />                    </span><span class="default">$tmpObj </span><span class="keyword">= new </span><span class="default">stdclass</span><span class="keyword">();<br />                    </span><span class="default">$tmpObj</span><span class="keyword">-&gt;</span><span class="default">complete </span><span class="keyword">= </span><span class="default">$task</span><span class="keyword">-&gt;</span><span class="default">complete</span><span class="keyword">;<br />                    </span><span class="comment">//this is how you get your completed data back out [accessed by $pool-&gt;process()]<br />                    </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[] = </span><span class="default">$tmpObj</span><span class="keyword">;<br />                }<br />                return </span><span class="default">$task</span><span class="keyword">-&gt;</span><span class="default">isDone</span><span class="keyword">();<br />            });<br />        }<br />        </span><span class="comment">// All jobs are done<br />        // we can shutdown the pool<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">shutdown</span><span class="keyword">();<br />        return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">;<br />    }<br />}<br /></span><span class="default">$pool </span><span class="keyword">= new </span><span class="default">ExamplePool</span><span class="keyword">(</span><span class="default">3</span><span class="keyword">);<br /></span><span class="default">$testData </span><span class="keyword">= </span><span class="string">'asdf'</span><span class="keyword">;<br />for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">5</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />    </span><span class="default">$pool</span><span class="keyword">-&gt;</span><span class="default">submit</span><span class="keyword">(new </span><span class="default">TestWork</span><span class="keyword">(</span><span class="default">$testData</span><span class="keyword">));<br />}<br /></span><span class="default">$retArr </span><span class="keyword">= </span><span class="default">$pool</span><span class="keyword">-&gt;</span><span class="default">process</span><span class="keyword">(); </span><span class="comment">//get all of the results<br /></span><span class="keyword">echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">;<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$retArr</span><span class="keyword">); </span><span class="comment">//return the array of results (and maybe errors)<br /></span><span class="keyword">echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="115576">  <div class="votes">
    <div id="Vu115576">
    <a href="https://www.php.net/manual/vote-note.php?id=115576&amp;page=book.pthreads&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115576">
    <a href="https://www.php.net/manual/vote-note.php?id=115576&amp;page=book.pthreads&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115576" title="58% like this...">
    6
    </div>
  </div>
  <a href="book.pthreads.php.html#115576" class="name">
  <strong class="user"><em>admin at deosnet dot com</em></strong></a><a class="genanchor" href="book.pthreads.php.html#115576"> &para;</a><div class="date" title="2014-08-19 10:01"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom115576">
<div class="phpcode"><code><span class="html">Hello,<br /><br />WARNING : When using Stackable objects in callable functions by your Threads, you must be very careful if you use it as an array. Indeed, if you do not copy your Stackable "array" in a local variable, the execution time can drop drastically !<br /><br />Also, if you want to modify an array() in a function, you will also store in a local variable in order that your array is in a thread-safe context.</span></code></div>
  </div>
 </div>
  <div class="note" id="114457">  <div class="votes">
    <div id="Vu114457">
    <a href="https://www.php.net/manual/vote-note.php?id=114457&amp;page=book.pthreads&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd114457">
    <a href="https://www.php.net/manual/vote-note.php?id=114457&amp;page=book.pthreads&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V114457" title="54% like this...">
    9
    </div>
  </div>
  <a href="book.pthreads.php.html#114457" class="name">
  <strong class="user"><em>jasonrlester at yahoo dot com</em></strong></a><a class="genanchor" href="book.pthreads.php.html#114457"> &para;</a><div class="date" title="2014-02-23 12:08"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom114457">
<div class="phpcode"><code><span class="html">Note that this extension *is* a high level implementation of POSIX threads, including on Windows (which is why pthreadsV*.dll is required)</span></code></div>
  </div>
 </div>
  <div class="note" id="118320">  <div class="votes">
    <div id="Vu118320">
    <a href="https://www.php.net/manual/vote-note.php?id=118320&amp;page=book.pthreads&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd118320">
    <a href="https://www.php.net/manual/vote-note.php?id=118320&amp;page=book.pthreads&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V118320" title="42% like this...">
    -7
    </div>
  </div>
  <a href="book.pthreads.php.html#118320" class="name">
  <strong class="user"><em>r3x at engelhardt-stefan dot de</em></strong></a><a class="genanchor" href="book.pthreads.php.html#118320"> &para;</a><div class="date" title="2015-11-17 06:17"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom118320">
<div class="phpcode"><code><span class="html">If you try to test threading, remember to let php think slow:<br /><br />Skript: -- C:\Webserver\htdocs&gt;php mttest.php<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">My </span><span class="keyword">extends </span><span class="default">Thread</span><span class="keyword">{<br />    function </span><span class="default">run</span><span class="keyword">(){<br />        for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">10</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />            echo </span><span class="default">Thread</span><span class="keyword">::</span><span class="default">getCurrentThreadId</span><span class="keyword">() .  </span><span class="string">"\n"</span><span class="keyword">;<br />            </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">);     </span><span class="comment">// &lt;------<br />        </span><span class="keyword">}<br />    }<br />}<br /><br />for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">2</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />    </span><span class="default">$pool</span><span class="keyword">[] = new </span><span class="default">My</span><span class="keyword">(); <br />}<br /><br />foreach(</span><span class="default">$pool </span><span class="keyword">as </span><span class="default">$worker</span><span class="keyword">){<br />    </span><span class="default">$worker</span><span class="keyword">-&gt;</span><span class="default">start</span><span class="keyword">();<br />}<br />foreach(</span><span class="default">$pool </span><span class="keyword">as </span><span class="default">$worker</span><span class="keyword">){<br />    </span><span class="default">$worker</span><span class="keyword">-&gt;</span><span class="default">join</span><span class="keyword">();<br />}<br /></span><span class="default">?&gt;<br /></span><br />Output: -- C:\Webserver\htdocs&gt;php mttest.php<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br />6300<br />5816<br /><br />If you leave sleep() out, the cpu-time for the threads is long enough to complete the script at once.</span></code></div>
  </div>
 </div>
  <div class="note" id="123162">  <div class="votes">
    <div id="Vu123162">
    <a href="https://www.php.net/manual/vote-note.php?id=123162&amp;page=book.pthreads&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd123162">
    <a href="https://www.php.net/manual/vote-note.php?id=123162&amp;page=book.pthreads&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V123162" title="17% like this...">
    -31
    </div>
  </div>
  <a href="book.pthreads.php.html#123162" class="name">
  <strong class="user"><em>mckaygerhard at gmail dot com</em></strong></a><a class="genanchor" href="book.pthreads.php.html#123162"> &para;</a><div class="date" title="2018-09-26 03:01"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom123162">
<div class="phpcode"><code><span class="html">mayority of that problems only happned for guindows, .. porr os</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=book.pthreads&amp;redirect=https://www.php.net/manual/ru/book.pthreads.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="refs.fileprocess.process.php.html">Модули для управления процессами программ</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="book.eio.php.html" title="Eio">Eio</a>
                        </li>
                                                <li class="">
                            <a href="book.ev.php.html" title="Ev">Ev</a>
                        </li>
                                                <li class="">
                            <a href="book.expect.php.html" title="Expect">Expect</a>
                        </li>
                                                <li class="">
                            <a href="book.pcntl.php.html" title="PCNTL">PCNTL</a>
                        </li>
                                                <li class="">
                            <a href="book.posix.php.html" title="POSIX">POSIX</a>
                        </li>
                                                <li class="">
                            <a href="book.exec.php.html" title="Запуск программы">Запуск программы</a>
                        </li>
                                                <li class="">
                            <a href="book.parallel.php.html" title="parallel">parallel</a>
                        </li>
                                                <li class="current">
                            <a href="book.pthreads.php.html" title="pthreads">pthreads</a>
                        </li>
                                                <li class="">
                            <a href="book.sem.php.html" title="Семафоры">Семафоры</a>
                        </li>
                                                <li class="">
                            <a href="book.shmop.php.html" title="Управление разделяемой памятью">Управление разделяемой памятью</a>
                        </li>
                                                <li class="">
                            <a href="book.sync.php.html" title="Sync">Sync</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
