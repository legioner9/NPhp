<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: SessionHandlerInterface - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="class.sessionhandlerinterface.php.html">
 <link rel="shorturl" href="https://www.php.net/sessionhandlerinterface">
 <link rel="alternate" href="https://www.php.net/sessionhandlerinterface" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="book.session.php.html">
 <link rel="prev" href="sessionhandler.write.php.html">
 <link rel="next" href="sessionhandlerinterface.close.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/class.sessionhandlerinterface.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/class.sessionhandlerinterface.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/class.sessionhandlerinterface.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/class.sessionhandlerinterface.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/class.sessionhandlerinterface.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/class.sessionhandlerinterface.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/class.sessionhandlerinterface.php" hreflang="pt_BR">
 <link rel="alternate" href="class.sessionhandlerinterface.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/class.sessionhandlerinterface.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/class.sessionhandlerinterface.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="sessionhandlerinterface.close.php.html">
          SessionHandlerInterface::close &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="sessionhandler.write.php.html">
          &laquo; SessionHandler::write        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.basic.session.php.html'>Модули для работы с сессиями</a></li>      <li><a href='book.session.php.html'>Сессии</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/class.sessionhandlerinterface.php'>English</option>
            <option value='de/class.sessionhandlerinterface.php'>German</option>
            <option value='es/class.sessionhandlerinterface.php'>Spanish</option>
            <option value='fr/class.sessionhandlerinterface.php'>French</option>
            <option value='it/class.sessionhandlerinterface.php'>Italian</option>
            <option value='ja/class.sessionhandlerinterface.php'>Japanese</option>
            <option value='pt_BR/class.sessionhandlerinterface.php'>Brazilian Portuguese</option>
            <option value='ru/class.sessionhandlerinterface.php' selected="selected">Russian</option>
            <option value='tr/class.sessionhandlerinterface.php'>Turkish</option>
            <option value='zh/class.sessionhandlerinterface.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/session/sessionhandlerinterface.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fclass.sessionhandlerinterface%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="class.sessionhandlerinterface" class="reference">

 <h1 class="title">Класс SessionHandlerInterface</h1>
 

 <div class="partintro"><p class="verinfo">(PHP 5 &gt;= 5.4.0, PHP 7, PHP 8)</p>

  
  <div class="section" id="sessionhandlerinterface.intro">
   <h2 class="title">Введение</h2>
   <p class="para">
    <span class="classname"><strong class="classname">SessionHandlerInterface</strong></span> - это интерфейс, который определяет минимальный прототип
    для создания пользовательского обработчика сессии. Для предоставления пользовательского
    обработчика сессии функции <span class="function"><a href="function.session-set-save-handler.php.html" class="function">session_set_save_handler()</a></span>, используя её
    <abbr class="abbrev">ООП</abbr> реализацию, класс должен реализовывать этот
    интерфейс.
   </p>
   <p class="para">
    Обратите внимание, что callback-методы этого класса созданы для внутренних
    вызовов PHP и не предназначены для вызовов из вашего кода.
   </p>
  </div>
  

  <div class="section" id="sessionhandlerinterface.synopsis">
   <h2 class="title">Обзор интерфейсов</h2>


   <div class="classsynopsis"><div class="classsynopsisinfo">
    
     <span class="modifier">interface</span> <strong class="interfacename"><strong class="interfacename">SessionHandlerInterface</strong></strong> {</div>

    <div class="classsynopsisinfo classsynopsisinfo_comment">/* Методы */</div>
    <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.close.php.html" class="methodname">close</a></span>(): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.destroy.php.html" class="methodname">destroy</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$id</code></span>): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.gc.php.html" class="methodname">gc</a></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter">$max_lifetime</code></span>): <span class="type"><span class="type">int</span>|<span class="type"><span class="type false">false</span></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.open.php.html" class="methodname">open</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$name</code></span>): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.read.php.html" class="methodname">read</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$id</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.write.php.html" class="methodname">write</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$id</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>): <span class="type">bool</span></div>

   }</div>


  </div>

  <div class="section" id="sessionhandlerinterface.examples">
   <div class="example" id="">
    <p><strong>Пример #1 
     Пример использования <span class="classname"><strong class="classname">SessionHandlerInterface</strong></span>
    </strong></p>
    <div class="example-contents"><p>
     Следующий пример реализует файловую сессию таким же образом, как это реализовано
     во внутреннем обработчике сессии PHP. Этот пример может быть легко расширен для
     обеспечения хранения сессий в предпочитаемой вами базе данных.
    </p></div>
    <div class="example-contents"><p>
     Обратите внимание, что мы используем объектно-ориентированные прототипы с функцией
     <span class="function"><a href="function.session-set-save-handler.php.html" class="function">session_set_save_handler()</a></span> и регистрируем функцию завершения
     (shutdown) используя один из параметров этой функции.  Это действие рекомендуется
     производить в большинстве случаев, когда объекты регистрируются в качестве
     обработчиков сессии.
    </p></div>
    <div class="caution"><strong class="caution">Предостережение</strong>
     <p class="para">
      Для краткости в этом примере не добавлена проверка входных данных.
      Обратите внимание, что параметр <code class="literal">$id</code> предоставляется
      пользователем и обязательно должен проверяться для исключения возможных
      атак, использующих, например, проблемы обхода пути.
      <em>Так что ни в коем случае не используйте этот код в промышленной
       эксплуатации, не добавив соответствующие проверки.</em>
     </p>
    </div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">MySessionHandler </span><span style="color: #007700">implements </span><span style="color: #0000BB">SessionHandlerInterface<br /></span><span style="color: #007700">{<br />    private </span><span style="color: #0000BB">$savePath</span><span style="color: #007700">;<br />    public function </span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #0000BB">$savePath</span><span style="color: #007700">, </span><span style="color: #0000BB">$sessionName</span><span style="color: #007700">): </span><span style="color: #0000BB">bool<br />    </span><span style="color: #007700">{<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath </span><span style="color: #007700">= </span><span style="color: #0000BB">$savePath</span><span style="color: #007700">;<br />        if (!</span><span style="color: #0000BB">is_dir</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #007700">)) {<br />            </span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #007700">, </span><span style="color: #0000BB">0777</span><span style="color: #007700">);<br />        }<br />        return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />    }<br />    public function </span><span style="color: #0000BB">close</span><span style="color: #007700">(): </span><span style="color: #0000BB">bool<br />    </span><span style="color: #007700">{<br />        return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />    }<br />    #[</span><span style="color: #0000BB">\ReturnTypeWillChange</span><span style="color: #007700">]<br />    public function </span><span style="color: #0000BB">read</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">)<br />    {<br />        return (string)@</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />    }<br />    public function </span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">, </span><span style="color: #0000BB">$data</span><span style="color: #007700">): </span><span style="color: #0000BB">bool<br />    </span><span style="color: #007700">{<br />        return </span><span style="color: #0000BB">file_put_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">"</span><span style="color: #007700">, </span><span style="color: #0000BB">$data</span><span style="color: #007700">) === </span><span style="color: #0000BB">false </span><span style="color: #007700">? </span><span style="color: #0000BB">false </span><span style="color: #007700">: </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />    }<br />    public function </span><span style="color: #0000BB">destroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">): </span><span style="color: #0000BB">bool<br />    </span><span style="color: #007700">{<br />        </span><span style="color: #0000BB">$file </span><span style="color: #007700">= </span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />        if (</span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">)) {<br />            </span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">);<br />        }<br />        return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />    }<br />    #[</span><span style="color: #0000BB">\ReturnTypeWillChange</span><span style="color: #007700">]<br />    public function </span><span style="color: #0000BB">gc</span><span style="color: #007700">(</span><span style="color: #0000BB">$maxlifetime</span><span style="color: #007700">)<br />    {<br />        foreach (</span><span style="color: #0000BB">glob</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_*"</span><span style="color: #007700">) as </span><span style="color: #0000BB">$file</span><span style="color: #007700">) {<br />            if (</span><span style="color: #0000BB">filemtime</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">) + </span><span style="color: #0000BB">$maxlifetime </span><span style="color: #007700">&lt; </span><span style="color: #0000BB">time</span><span style="color: #007700">() &amp;&amp; </span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">)) {<br />                </span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">);<br />            }<br />        }<br />        return </span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />    }<br />}<br /></span><span style="color: #0000BB">$handler </span><span style="color: #007700">= new </span><span style="color: #0000BB">MySessionHandler</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">session_set_save_handler</span><span style="color: #007700">(</span><span style="color: #0000BB">$handler</span><span style="color: #007700">, </span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// продолжаем работать с переменными сессии, устанавливая или читая их значение из $_SESSION</span></span></code></div>
    </div>

   </div>
  </div>

 </div>

 





































<h2>Содержание</h2><ul class="chunklist chunklist_reference"><li><a href="sessionhandlerinterface.close.php.html">SessionHandlerInterface::close</a> — Закрывает сессию</li><li><a href="sessionhandlerinterface.destroy.php.html">SessionHandlerInterface::destroy</a> — Уничтожает сессию</li><li><a href="sessionhandlerinterface.gc.php.html">SessionHandlerInterface::gc</a> — Очищает старые сессии</li><li><a href="sessionhandlerinterface.open.php.html">SessionHandlerInterface::open</a> — Инициализирует сессию</li><li><a href="sessionhandlerinterface.read.php.html">SessionHandlerInterface::read</a> — Читает данные сессии</li><li><a href="sessionhandlerinterface.write.php.html">SessionHandlerInterface::write</a> — Записать данные сессии</li></ul>
</div>
<section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=class.sessionhandlerinterface&amp;redirect=https://www.php.net/manual/ru/class.sessionhandlerinterface.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">8 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="122032">  <div class="votes">
    <div id="Vu122032">
    <a href="https://www.php.net/manual/vote-note.php?id=122032&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122032">
    <a href="https://www.php.net/manual/vote-note.php?id=122032&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122032" title="92% like this...">
    23
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#122032" class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#122032"> &para;</a><div class="date" title="2017-12-16 04:50"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom122032">
<div class="phpcode"><code><span class="html">As of PHP 7.0, you can implement SessionUpdateTimestampHandlerInterface to <br />define your own session id validating method like validate_sid and the timestamp updating method like update_timestamp in the non-OOP prototype of session_set_save_handler().<br /><br />SessionUpdateTimestampHandlerInterface is a new interface introduced in PHP 7.0, which has not been documented yet. It has two abstract methods: SessionUpdateTimestampHandlerInterface :: validateId($sessionId) and SessionUpdateTimestampHandlerInterface :: updateTimestamp($sessionId, $sessionData).<br /><br /><span class="default">&lt;?php<br />    </span><span class="comment">/*<br />       @author Wu Xiancheng<br />       Code structure for PHP 7.0+ only because SessionUpdateTimestampHandlerInterface is introduced in PHP 7.0<br />       With this class you can validate php session id and update the timestamp of php session data<br />       with the OOP prototype of session_set_save_handler() in PHP 7.0+<br />    */<br />    </span><span class="keyword">class </span><span class="default">PHPSessionXHandler </span><span class="keyword">implements </span><span class="default">SessionHandlerInterface</span><span class="keyword">, </span><span class="default">SessionUpdateTimestampHandlerInterface </span><span class="keyword">{<br />        public function </span><span class="default">close</span><span class="keyword">(){<br />            </span><span class="comment">// return value should be true for success or false for failure<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">destroy</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">){<br />            </span><span class="comment">// return value should be true for success or false for failure<br />            // ... <br />        </span><span class="keyword">}<br />        public function </span><span class="default">gc</span><span class="keyword">(</span><span class="default">$maximumLifetime</span><span class="keyword">){<br />            </span><span class="comment">// return value should be true for success or false for failure<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">open</span><span class="keyword">(</span><span class="default">$sessionSavePath</span><span class="keyword">, </span><span class="default">$sessionName</span><span class="keyword">){<br />            </span><span class="comment">// return value should be true for success or false for failure<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">read</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">){<br />            </span><span class="comment">// return value should be the session data or an empty string<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">write</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">, </span><span class="default">$sessionData</span><span class="keyword">){<br />            </span><span class="comment">// return value should be true for success or false for failure<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">create_sid</span><span class="keyword">(){<br />            </span><span class="comment">// available since PHP 5.5.1<br />            // invoked internally when a new session id is needed<br />            // no parameter is needed and return value should be the new session id created<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">validateId</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">){<br />            </span><span class="comment">// implements SessionUpdateTimestampHandlerInterface::validateId()<br />            // available since PHP 7.0<br />            // return value should be true if the session id is valid otherwise false<br />            // if false is returned a new session id will be generated by php internally<br />            // ...<br />        </span><span class="keyword">}<br />        public function </span><span class="default">updateTimestamp</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">, </span><span class="default">$sessionData</span><span class="keyword">){<br />            </span><span class="comment">// implements SessionUpdateTimestampHandlerInterface::validateId()<br />            // available since PHP 7.0<br />            // return value should be true for success or false for failure<br />            // ...<br />        </span><span class="keyword">}<br />    }<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="122030">  <div class="votes">
    <div id="Vu122030">
    <a href="https://www.php.net/manual/vote-note.php?id=122030&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122030">
    <a href="https://www.php.net/manual/vote-note.php?id=122030&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122030" title="100% like this...">
    5
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#122030" class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#122030"> &para;</a><div class="date" title="2017-12-16 08:06"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom122030">
<div class="phpcode"><code><span class="html">The non-OOP prototype of session_set_save_handler() supports validate_sid and update_timestamp as of PHP 7.0 while the OOP prototype doesn't even in PHP 7.2. However the OOP prototype does support create_sid since PHP 5.5.1.<br /><br />validate_sid($sessionId)<br />  This callback is to validate $sessionId. Its return value should be true for valid session id $sessionId or false for invalid session id $sessionId. If false is returned, a new session id is generated to replace the invalid session id $sessionId.<br /><br />update_timestamp($sessionId)<br />  This call back is to update timestamp, and its return value should be true for success or false for failure.</span></code></div>
  </div>
 </div>
  <div class="note" id="121970">  <div class="votes">
    <div id="Vu121970">
    <a href="https://www.php.net/manual/vote-note.php?id=121970&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121970">
    <a href="https://www.php.net/manual/vote-note.php?id=121970&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121970" title="66% like this...">
    1
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#121970" class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#121970"> &para;</a><div class="date" title="2017-12-03 10:40"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121970">
<div class="phpcode"><code><span class="html">As of PHP 5.5.1, another method create_sid() is supported. It will be called when session_regenerate_id() is invoked.<br /><br />SessionHandlerInterface {<br />    /* Methods */<br />    abstract public bool close ( void )<br />    abstract public bool create_sid ( void )    <br />    abstract public bool destroy ( string $session_id )<br />    abstract public bool gc ( int $maxlifetime )<br />    abstract public bool open ( string $save_path , string $session_name )<br />    abstract public string read ( string $session_id )<br />    abstract public bool write ( string $session_id , string $session_data )<br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="116288">  <div class="votes">
    <div id="Vu116288">
    <a href="https://www.php.net/manual/vote-note.php?id=116288&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd116288">
    <a href="https://www.php.net/manual/vote-note.php?id=116288&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V116288" title="56% like this...">
    3
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#116288" class="name">
  <strong class="user"><em>avenidagez at foro5 dot com</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#116288"> &para;</a><div class="date" title="2014-12-06 03:54"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom116288">
<div class="phpcode"><code><span class="html">Note that session_start( ) calls open then read and the class returns true for open and the value of session or empty for read.<br />Well, then there is no catch for errors, this is, session_start() must return false on failure, but that is not the case for the class implementation on method open, no matter if you return true or false or whatever from open, it is ignored by session_start() function and proceeds to read method<br />A bug?, if open returns false, session_start() should stop the next step (read) and return itself false<br /><br />if(session_start()) ...code<br />else exit( );<br /><br />So forget about session_start() return value, you need to implement an error catch routine and exit() in case of failure on open method</span></code></div>
  </div>
 </div>
  <div class="note" id="110125">  <div class="votes">
    <div id="Vu110125">
    <a href="https://www.php.net/manual/vote-note.php?id=110125&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd110125">
    <a href="https://www.php.net/manual/vote-note.php?id=110125&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V110125" title="53% like this...">
    5
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#110125" class="name">
  <strong class="user"><em>warxcell at gmail dot com</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#110125"> &para;</a><div class="date" title="2012-09-21 11:12"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom110125">
<div class="phpcode"><code><span class="html">You should prepend &lt;b&gt;\&lt;/b&gt; before class name, to tell php its from root namespace.</span></code></div>
  </div>
 </div>
  <div class="note" id="122817">  <div class="votes">
    <div id="Vu122817">
    <a href="https://www.php.net/manual/vote-note.php?id=122817&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122817">
    <a href="https://www.php.net/manual/vote-note.php?id=122817&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122817" title="100% like this...">
    2
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#122817" class="name">
  <strong class="user"><em>tony at marston-home dot demon dot co dot uk</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#122817"> &para;</a><div class="date" title="2018-06-10 03:45"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom122817">
<div class="phpcode"><code><span class="html">Your custom session handler should not contain calls to any of the session functions, such as session_name() or session_id(), as the relevant values are passed as arguments on various handler methods. Attempting to obtain values from alternative sources may not work as expected.</span></code></div>
  </div>
 </div>
  <div class="note" id="124839">  <div class="votes">
    <div id="Vu124839">
    <a href="https://www.php.net/manual/vote-note.php?id=124839&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124839">
    <a href="https://www.php.net/manual/vote-note.php?id=124839&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124839" title="50% like this...">
    0
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#124839" class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#124839"> &para;</a><div class="date" title="2020-03-22 01:50"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom124839">
<div class="phpcode"><code><span class="html">If you want to use type declarations in your own session handling class, don't "implements" the SessionHandlerInterface, SessionIdInterface, or SessinUpdateTimestampInterface, otherwise you will get a fatal error saying that declaration of the class method must be compatible with the interface method.<br /><br />a bad example<br /><span class="default">&lt;?php<br />    </span><span class="keyword">class </span><span class="default">SessionWuXianchengHandler </span><span class="keyword">implements </span><span class="default">SessionHandlerInterface </span><span class="keyword">{        <br />        public function </span><span class="default">open</span><span class="keyword">(</span><span class="default">string $sessionPath</span><span class="keyword">, </span><span class="default">string $sessionName</span><span class="keyword">) : </span><span class="default">bool </span><span class="keyword">{<br />        }<br />        ......<br />    }<br /></span><span class="default">?&gt;<br /></span><br />a good example<br /><span class="default">&lt;?php<br />    </span><span class="keyword">class </span><span class="default">SessionWuXianchengHandler </span><span class="keyword">{<br />        public function </span><span class="default">open</span><span class="keyword">(</span><span class="default">string $sessionPath</span><span class="keyword">, </span><span class="default">string $sessionName</span><span class="keyword">) : </span><span class="default">bool </span><span class="keyword">{<br />        }<br />        ......<br />    }<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="118246">  <div class="votes">
    <div id="Vu118246">
    <a href="https://www.php.net/manual/vote-note.php?id=118246&amp;page=class.sessionhandlerinterface&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd118246">
    <a href="https://www.php.net/manual/vote-note.php?id=118246&amp;page=class.sessionhandlerinterface&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V118246" title="38% like this...">
    -4
    </div>
  </div>
  <a href="class.sessionhandlerinterface.php.html#118246" class="name">
  <strong class="user"><em>StanE</em></strong></a><a class="genanchor" href="class.sessionhandlerinterface.php.html#118246"> &para;</a><div class="date" title="2015-11-02 07:46"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom118246">
<div class="phpcode"><code><span class="html">I think there is a small "error" in the example of the class MySessionHandler in method gc(). It uses the function filemtime() whose return value is cached by PHP. Add the following line inside the foreach block in the gc() method:<br /><br />clearstatcache(true, $file);</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=class.sessionhandlerinterface&amp;redirect=https://www.php.net/manual/ru/class.sessionhandlerinterface.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="book.session.php.html">Сессии</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="intro.session.php.html" title="Введение">Введение</a>
                        </li>
                                                <li class="">
                            <a href="session.setup.php.html" title="Установка и настройка">Установка и настройка</a>
                        </li>
                                                <li class="">
                            <a href="session.constants.php.html" title="Предопределённые константы">Предопределённые константы</a>
                        </li>
                                                <li class="">
                            <a href="session.examples.php.html" title="Примеры">Примеры</a>
                        </li>
                                                <li class="">
                            <a href="session.upload-progress.php.html" title="Отслеживание прогресса загрузки файлов с помощью сессий">Отслеживание прогресса загрузки файлов с помощью сессий</a>
                        </li>
                                                <li class="">
                            <a href="session.security.php.html" title="Безопасность сессий">Безопасность сессий</a>
                        </li>
                                                <li class="">
                            <a href="ref.session.php.html" title="Функции для работы с сессиями">Функции для работы с сессиями</a>
                        </li>
                                                <li class="">
                            <a href="class.sessionhandler.php.html" title="SessionHandler">SessionHandler</a>
                        </li>
                                                <li class="current">
                            <a href="class.sessionhandlerinterface.php.html" title="SessionHandlerInterface">SessionHandlerInterface</a>
                        </li>
                                                <li class="">
                            <a href="class.sessionidinterface.php.html" title="SessionIdInterface">SessionIdInterface</a>
                        </li>
                                                <li class="">
                            <a href="class.sessionupdatetimestamphandlerinterface.php.html" title="SessionUpdateTimestampHandlerInterface">SessionUpdateTimestampHandlerInterface</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
