<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Загрузка файлов методом POST - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="features.file-upload.post-method.php.html">
 <link rel="shorturl" href="https://www.php.net/file-upload.post-method">
 <link rel="alternate" href="https://www.php.net/file-upload.post-method" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="features.file-upload.php.html">
 <link rel="prev" href="features.file-upload.php.html">
 <link rel="next" href="features.file-upload.errors.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/features.file-upload.post-method.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/features.file-upload.post-method.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/features.file-upload.post-method.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/features.file-upload.post-method.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/features.file-upload.post-method.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/features.file-upload.post-method.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/features.file-upload.post-method.php" hreflang="pt_BR">
 <link rel="alternate" href="features.file-upload.post-method.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/features.file-upload.post-method.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/features.file-upload.post-method.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="features.file-upload.errors.php.html">
          Объяснение сообщений об ошибках &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="features.file-upload.php.html">
          &laquo; Загрузка файлов на сервер        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='features.php.html'>Особенности</a></li>      <li><a href='features.file-upload.php.html'>Загрузка файлов на сервер</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/features.file-upload.post-method.php'>English</option>
            <option value='de/features.file-upload.post-method.php'>German</option>
            <option value='es/features.file-upload.post-method.php'>Spanish</option>
            <option value='fr/features.file-upload.post-method.php'>French</option>
            <option value='it/features.file-upload.post-method.php'>Italian</option>
            <option value='ja/features.file-upload.post-method.php'>Japanese</option>
            <option value='pt_BR/features.file-upload.post-method.php'>Brazilian Portuguese</option>
            <option value='ru/features.file-upload.post-method.php' selected="selected">Russian</option>
            <option value='tr/features.file-upload.post-method.php'>Turkish</option>
            <option value='zh/features.file-upload.post-method.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/features/file-upload.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffeatures.file-upload.post-method%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="features.file-upload.post-method" class="sect1">
  <h2 class="title">Загрузка файлов методом POST</h2>
  <p class="simpara">
   Данная возможность позволяет загружать как текстовые, так и
   бинарные файлы. С помощью PHP-функций аутентификации и работы с
   файлами вы имеете полный контроль над тем, кому разрешено
   загружать файлы и что делать с файлом после его загрузки.
  </p>
  <p class="simpara">
   PHP способен получать загруженные файлы из любого браузера,
   совместимого со стандартом RFC-1867.
  </p>

  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <strong>Смежные замечания по конфигурации</strong><br />
   <p class="para">
    Также ознакомьтесь с описанием директив <a href="ini.core.php.html#ini.file-uploads" class="link">file_uploads</a>,
    <a href="ini.core.php.html#ini.upload-max-filesize" class="link">upload_max_filesize</a>,
    <a href="ini.core.php.html#ini.upload-tmp-dir" class="link">upload_tmp_dir</a>,
    <a href="ini.core.php.html#ini.post-max-size" class="link">post_max_size</a> и
    <a href="info.configuration.php.html#ini.max-input-time" class="link">max_input_time</a> конфигурационного
    файла <var class="filename">php.ini</var>
   </p>
  </p></blockquote>

  <p class="para">
   Также следует заметить, что PHP поддерживает загрузку файлов методом PUT,
   который используется в клиентах <span class="productname">Netscape Composer</span>
   и W3C <span class="productname">Amaya</span>. Для получения
   более детальной документации обратитесь к разделу
   <a href="features.file-upload.put-method.php.html" class="link">поддержка метода PUT</a>.
  </p>

  <p class="para">
   <div class="example" id="example-1366">
    <p><strong>Пример #1 Форма для загрузки файлов</strong></p>
    <div class="example-contents"><p>
     Страница для загрузки файлов может быть реализована при помощи
     специальной формы, которая выглядит примерно так:
    </p></div>
    <div class="example-contents">
<div class="htmlcode"><pre class="htmlcode">&lt;!-- Тип кодирования данных, enctype, ДОЛЖЕН БЫТЬ указан ИМЕННО так --&gt;
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;__URL__&quot; method=&quot;POST&quot;&gt;
    &lt;!-- Поле MAX_FILE_SIZE должно быть указано до поля загрузки файла --&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;MAX_FILE_SIZE&quot; value=&quot;30000&quot; /&gt;
    &lt;!-- Название элемента input определяет имя в массиве $_FILES --&gt;
    Отправить этот файл: &lt;input name=&quot;userfile&quot; type=&quot;file&quot; /&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Отправить файл&quot; /&gt;
&lt;/form&gt;</pre>
</div>
    </div>

    <div class="example-contents"><p>
     В приведённом выше примере <code class="literal">__URL__</code> необходимо заменить ссылкой
     на PHP-скрипт.
    </p></div>
    <div class="example-contents"><p>
     Скрытое поле <code class="literal">MAX_FILE_SIZE</code> (значение
     необходимо указывать в байтах) должно предшествовать полю
     для выбора файла, и его значение является максимально
     допустимым размером принимаемого файла в PHP.
     Рекомендуется всегда использовать эту переменную, так как она
     предотвращает тревожное ожидание пользователей при передаче
     огромных файлов, только для того, чтобы узнать, что файл
     слишком большой и передача фактически не состоялась.
     Имейте в виду, что обойти это ограничение на стороне браузера достаточно
     просто, следовательно, вы не должны полагаться на то, что
     все файлы большего размера будут блокированы при помощи этой
     возможности. Это по большей части удобная возможность для
     пользователей клиентской части вашего приложения.
     Однако настройки PHP (на сервере) касательно
     максимального размера обойти невозможно.
    </p></div>
   </div>
  </p>

  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Также следует убедиться, что форма загрузки имеет атрибут
    <code class="literal">enctype=&quot;multipart/form-data&quot;</code>, в противном случае
    загрузка файлов на сервер не произойдёт.
   </p>
  </p></blockquote>

  <p class="para">
   Глобальный массив <var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES</a></var> содержит всю информацию о загруженных файлах.
   Его содержимое для нашего примера приводится ниже. Обратите внимание, что здесь предполагается
   использование имени <em>userfile</em> для поля
   выбора файла, как и в приведённом выше примере. На самом деле
   имя поля может быть любым.
   <dl>
    
     <dt>
<var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['name']</a></var></dt>

     <dd>

      <p class="para">
       Оригинальное имя файла на компьютере клиента.
      </p>
     </dd>

    
    
     <dt>
<var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['type']</a></var></dt>

     <dd>

      <p class="para">
       Mime-тип файла, в случае, если браузер предоставил такую
       информацию. В качестве примера можно привести <code class="literal">&quot;image/gif&quot;</code>. Этот
       mime-тип не проверяется на стороне PHP, так что не полагайтесь
       на его значение без проверки.
      </p>
     </dd>

    
    
     <dt>
<var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['size']</a></var></dt>

     <dd>

      <p class="para">
       Размер в байтах принятого файла.
      </p>
     </dd>

    
    
     <dt>
<var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['tmp_name']</a></var></dt>

     <dd>

      <p class="para">
       Временное имя, с которым принятый файл был сохранён на сервере.
      </p>
     </dd>

    
    
     <dt>
<var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['error']</a></var></dt>

     <dd>

      <p class="para">
       <a href="features.file-upload.errors.php.html" class="link">Код ошибки</a>,
       которая может возникнуть при загрузке файла.
      </p>
     </dd>

    
    
     <dt>
<var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['full_path']</a></var></dt>

     <dd>

      <p class="para">
       Полный путь, представленный браузером. Это значение не всегда содержит реальную структуру каталогов и ему нельзя доверять.
       Доступно, начиная с PHP 8.1.0.
      </p>
     </dd>

    
   </dl>

  </p>

  <p class="para">
   По умолчанию принятые файлы сохраняются на сервере в стандартной
   временной папке до тех пор, пока не будет задана другая директория при
   помощи директивы <a href="ini.core.php.html#ini.upload-tmp-dir" class="link">upload_tmp_dir</a>
   конфигурационного файла <var class="filename">php.ini</var>. Директорию сервера по умолчанию
   можно сменить, установив переменную <var class="envar">TMPDIR</var> для
   окружения, в котором выполняется PHP. Установка этой переменной при помощи
   функции <span class="function"><a href="function.putenv.php.html" class="function">putenv()</a></span> внутри PHP-скрипта работать
   не будет. Эта переменная окружения также может использоваться для того,
   чтобы удостовериться, что другие операции также работают с принятыми файлами.
   <div class="example" id="example-1369">
    <p><strong>Пример #2 Проверка загружаемых на сервер файлов</strong></p>
    <div class="example-contents"><p>
     Для получения более детальной информации вы можете ознакомиться
     с описанием функций <span class="function"><a href="function.is-uploaded-file.php.html" class="function">is_uploaded_file()</a></span>
     и <span class="function"><a href="function.move-uploaded-file.php.html" class="function">move_uploaded_file()</a></span>. Следующий пример
     принимает и обрабатывает загруженный при помощи формы файл.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$uploaddir </span><span style="color: #007700">= </span><span style="color: #DD0000">'/var/www/uploads/'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$uploadfile </span><span style="color: #007700">= </span><span style="color: #0000BB">$uploaddir </span><span style="color: #007700">. </span><span style="color: #0000BB">basename</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'userfile'</span><span style="color: #007700">][</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]);<br /><br />echo </span><span style="color: #DD0000">'&lt;pre&gt;'</span><span style="color: #007700">;<br />if (</span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'userfile'</span><span style="color: #007700">][</span><span style="color: #DD0000">'tmp_name'</span><span style="color: #007700">], </span><span style="color: #0000BB">$uploadfile</span><span style="color: #007700">)) {<br />    echo </span><span style="color: #DD0000">"Файл корректен и был успешно загружен.\n"</span><span style="color: #007700">;<br />} else {<br />    echo </span><span style="color: #DD0000">"Возможная атака с помощью файловой загрузки!\n"</span><span style="color: #007700">;<br />}<br /><br />echo </span><span style="color: #DD0000">'Некоторая отладочная информация:'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">);<br /><br />print </span><span style="color: #DD0000">"&lt;/pre&gt;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
     </div>

    </div>
   </p>
   <p class="simpara">
    PHP-скрипт, принимающий загруженный файл, должен реализовывать логику,
    необходимую для определения дальнейших действий над принятым файлом.
    Например, вы можете проверить переменную <var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['size']</a></var>,
    чтобы отсечь слишком большие или слишком маленькие файлы. Также вы
    можете использовать переменную <var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['type']</a></var>
    для исключения файлов, которые не удовлетворяют критерию касательно
    типа файла, однако, принимайте во внимание, что это поле полностью
    контролируется клиентом, используйте его только в качестве первой
    из серии проверок. Также вы можете использовать
    <var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['error']</a></var> и
    <a href="features.file-upload.errors.php.html" class="link">коды ошибок</a>
    при реализации вашей логики. Независимо от того, какую модель поведения
    вы выбрали, вы должны удалить файл из временной папки или переместить его в
    другую директорию.
   </p>
   <p class="simpara">
    В случае, если при отправке формы файл выбран не был, PHP установит
    переменную <var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['size']</a></var> значением 0, а переменную
    <var class="varname"><a href="reserved.variables.files.php.html" class="classname">$_FILES['userfile']['tmp_name']</a></var> - none.
   </p>
   <p class="simpara">
    По окончанию работы скрипта, если загруженный файл не был
    переименован или перемещён, он будет автоматически удалён из временной папки.
   </p>
   <div class="example" id="example-1372">
    <p><strong>Пример #3 Загрузка массива файлов</strong></p>
    <div class="example-contents"><p>
     PHP поддерживает <a href="faq.html.php.html#faq.html.arrays" class="link">возможность передачи массива из HTML</a>
     в том числе и с файлами.
    </p></div>
    <div class="example-contents">
<div class="htmlcode"><pre class="htmlcode">&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
&lt;p&gt;Изображения:
&lt;input type=&quot;file&quot; name=&quot;pictures[]&quot; /&gt;
&lt;input type=&quot;file&quot; name=&quot;pictures[]&quot; /&gt;
&lt;input type=&quot;file&quot; name=&quot;pictures[]&quot; /&gt;
&lt;input type=&quot;submit&quot; value=&quot;Отправить&quot; /&gt;
&lt;/p&gt;
&lt;/form&gt;</pre>
</div>
    </div>

    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">foreach (</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">"pictures"</span><span style="color: #007700">][</span><span style="color: #DD0000">"error"</span><span style="color: #007700">] as </span><span style="color: #0000BB">$key </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$error</span><span style="color: #007700">) {<br />    if (</span><span style="color: #0000BB">$error </span><span style="color: #007700">== </span><span style="color: #0000BB">UPLOAD_ERR_OK</span><span style="color: #007700">) {<br />        </span><span style="color: #0000BB">$tmp_name </span><span style="color: #007700">= </span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">"pictures"</span><span style="color: #007700">][</span><span style="color: #DD0000">"tmp_name"</span><span style="color: #007700">][</span><span style="color: #0000BB">$key</span><span style="color: #007700">];<br />        </span><span style="color: #FF8000">// basename() может спасти от атак на файловую систему;<br />        // может понадобиться дополнительная проверка/очистка имени файла<br />        </span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #0000BB">basename</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">"pictures"</span><span style="color: #007700">][</span><span style="color: #DD0000">"name"</span><span style="color: #007700">][</span><span style="color: #0000BB">$key</span><span style="color: #007700">]);<br />        </span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$tmp_name</span><span style="color: #007700">, </span><span style="color: #DD0000">"data/</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />    }<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
     </div>

   </div>
   <p class="para">
    Полоса прогресса загрузки файлов может быть реализована с помощью
    &quot;<a href="session.upload-progress.php.html" class="link">отслеживания прогресса загрузки файлов с помощью сессий</a>&quot;.
   </p>
  </div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=features.file-upload.post-method&amp;redirect=https://www.php.net/manual/ru/features.file-upload.post-method.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">12 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="91479">  <div class="votes">
    <div id="Vu91479">
    <a href="https://www.php.net/manual/vote-note.php?id=91479&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd91479">
    <a href="https://www.php.net/manual/vote-note.php?id=91479&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V91479" title="56% like this...">
    76
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#91479" class="name">
  <strong class="user"><em>daevid at daevid dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#91479"> &para;</a><div class="date" title="2009-06-11 02:35"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom91479">
<div class="phpcode"><code><span class="html">I think the way an array of attachments works is kind of cumbersome. Usually the PHP guys are right on the money, but this is just counter-intuitive. It should have been more like:<br /><br />Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [name] =&gt; facepalm.jpg<br />            [type] =&gt; image/jpeg<br />            [tmp_name] =&gt; /tmp/phpn3FmFr<br />            [error] =&gt; 0<br />            [size] =&gt; 15476<br />        )<br /><br />    [1] =&gt; Array<br />        (<br />            [name] =&gt; <br />            [type] =&gt; <br />            [tmp_name] =&gt; <br />            [error] =&gt; 4<br />            [size] =&gt; <br />        )<br />)<br /><br />and not this<br />Array<br />(<br />    [name] =&gt; Array<br />        (<br />            [0] =&gt; facepalm.jpg<br />            [1] =&gt; <br />        )<br /><br />    [type] =&gt; Array<br />        (<br />            [0] =&gt; image/jpeg<br />            [1] =&gt; <br />        )<br /><br />    [tmp_name] =&gt; Array<br />        (<br />            [0] =&gt; /tmp/phpn3FmFr<br />            [1] =&gt; <br />        )<br /><br />    [error] =&gt; Array<br />        (<br />            [0] =&gt; 0<br />            [1] =&gt; 4<br />        )<br /><br />    [size] =&gt; Array<br />        (<br />            [0] =&gt; 15476<br />            [1] =&gt; 0<br />        )<br />)<br /><br />Anyways, here is a fuller example than the sparce one in the documentation above:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">foreach (</span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">"attachment"</span><span class="keyword">][</span><span class="string">"error"</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$error</span><span class="keyword">)<br />{<br />       </span><span class="default">$tmp_name </span><span class="keyword">= </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">"attachment"</span><span class="keyword">][</span><span class="string">"tmp_name"</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">];<br />       if (!</span><span class="default">$tmp_name</span><span class="keyword">) continue;<br /><br />       </span><span class="default">$name </span><span class="keyword">= </span><span class="default">basename</span><span class="keyword">(</span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">"attachment"</span><span class="keyword">][</span><span class="string">"name"</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br /><br />    if (</span><span class="default">$error </span><span class="keyword">== </span><span class="default">UPLOAD_ERR_OK</span><span class="keyword">)<br />    {<br />        if ( </span><span class="default">move_uploaded_file</span><span class="keyword">(</span><span class="default">$tmp_name</span><span class="keyword">, </span><span class="string">"/tmp/"</span><span class="keyword">.</span><span class="default">$name</span><span class="keyword">) )<br />            </span><span class="default">$uploaded_array</span><span class="keyword">[] .= </span><span class="string">"Uploaded file '"</span><span class="keyword">.</span><span class="default">$name</span><span class="keyword">.</span><span class="string">"'.&lt;br/&gt;\n"</span><span class="keyword">;<br />        else<br />            </span><span class="default">$errormsg </span><span class="keyword">.= </span><span class="string">"Could not move uploaded file '"</span><span class="keyword">.</span><span class="default">$tmp_name</span><span class="keyword">.</span><span class="string">"' to '"</span><span class="keyword">.</span><span class="default">$name</span><span class="keyword">.</span><span class="string">"'&lt;br/&gt;\n"</span><span class="keyword">;<br />    }<br />    else </span><span class="default">$errormsg </span><span class="keyword">.= </span><span class="string">"Upload error. ["</span><span class="keyword">.</span><span class="default">$error</span><span class="keyword">.</span><span class="string">"] on file '"</span><span class="keyword">.</span><span class="default">$name</span><span class="keyword">.</span><span class="string">"'&lt;br/&gt;\n"</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="119643">  <div class="votes">
    <div id="Vu119643">
    <a href="https://www.php.net/manual/vote-note.php?id=119643&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd119643">
    <a href="https://www.php.net/manual/vote-note.php?id=119643&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V119643" title="59% like this...">
    46
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#119643" class="name">
  <strong class="user"><em>mpyw</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#119643"> &para;</a><div class="date" title="2016-07-24 06:44"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom119643">
<div class="phpcode"><code><span class="html">Do not use Coreywelch or Daevid's way, because their methods can handle only within two-dimensional structure. $_FILES can consist of any hierarchy, such as 3d or 4d structure.<br /><br />The following example form breaks their codes:<br /><br />&lt;form action="" method="post" enctype="multipart/form-data"&gt;<br />    &lt;input type="file" name="files[x][y][z]"&gt;<br />    &lt;input type="submit"&gt;<br />&lt;/form&gt;<br /><br />As the solution, you should use PSR-7 based zendframework/zend-diactoros.<br /><br />GitHub:<br /><br /><a href="https://github.com/zendframework/zend-diactoros" rel="nofollow" target="_blank">https://github.com/zendframework/zend-diactoros</a><br /><br />Example:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">use </span><span class="default">Psr\Http\Message\UploadedFileInterface</span><span class="keyword">;<br />use </span><span class="default">Zend\Diactoros\ServerRequestFactory</span><span class="keyword">;<br /><br /></span><span class="default">$request </span><span class="keyword">= </span><span class="default">ServerRequestFactory</span><span class="keyword">::</span><span class="default">fromGlobals</span><span class="keyword">();<br /><br />if (</span><span class="default">$request</span><span class="keyword">-&gt;</span><span class="default">getMethod</span><span class="keyword">() !== </span><span class="string">'POST'</span><span class="keyword">) {<br />    </span><span class="default">http_response_code</span><span class="keyword">(</span><span class="default">405</span><span class="keyword">);<br />    exit(</span><span class="string">'Use POST method.'</span><span class="keyword">);<br />}<br /><br /></span><span class="default">$uploaded_files </span><span class="keyword">= </span><span class="default">$request</span><span class="keyword">-&gt;</span><span class="default">getUploadedFiles</span><span class="keyword">();<br /><br />if (<br />    !isset(</span><span class="default">$uploaded_files</span><span class="keyword">[</span><span class="string">'files'</span><span class="keyword">][</span><span class="string">'x'</span><span class="keyword">][</span><span class="string">'y'</span><span class="keyword">][</span><span class="string">'z'</span><span class="keyword">]) ||<br />    !</span><span class="default">$uploaded_files</span><span class="keyword">[</span><span class="string">'files'</span><span class="keyword">][</span><span class="string">'x'</span><span class="keyword">][</span><span class="string">'y'</span><span class="keyword">][</span><span class="string">'z'</span><span class="keyword">] instanceof </span><span class="default">UploadedFileInterface<br /></span><span class="keyword">) {<br />    </span><span class="default">http_response_code</span><span class="keyword">(</span><span class="default">400</span><span class="keyword">);<br />    exit(</span><span class="string">'Invalid request body.'</span><span class="keyword">);<br />}<br /><br /></span><span class="default">$file </span><span class="keyword">= </span><span class="default">$uploaded_files</span><span class="keyword">[</span><span class="string">'files'</span><span class="keyword">][</span><span class="string">'x'</span><span class="keyword">][</span><span class="string">'y'</span><span class="keyword">][</span><span class="string">'z'</span><span class="keyword">];<br /><br />if (</span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getError</span><span class="keyword">() !== </span><span class="default">UPLOAD_ERR_OK</span><span class="keyword">) {<br />    </span><span class="default">http_response_code</span><span class="keyword">(</span><span class="default">400</span><span class="keyword">);<br />    exit(</span><span class="string">'File uploading failed.'</span><span class="keyword">);<br />}<br /><br /></span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">moveTo</span><span class="keyword">(</span><span class="string">'/path/to/new/file'</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="118858">  <div class="votes">
    <div id="Vu118858">
    <a href="https://www.php.net/manual/vote-note.php?id=118858&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd118858">
    <a href="https://www.php.net/manual/vote-note.php?id=118858&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V118858" title="56% like this...">
    22
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#118858" class="name">
  <strong class="user"><em>coreywelch+phpnet at gmail dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#118858"> &para;</a><div class="date" title="2016-02-17 10:29"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom118858">
<div class="phpcode"><code><span class="html">The documentation doesn't have any details about how the HTML array feature formats the $_FILES array. <br /><br />Example $_FILES array:<br /><br />For single file -<br /><br />Array<br />(<br />    [document] =&gt; Array<br />        (<br />            [name] =&gt; sample-file.doc<br />            [type] =&gt; application/msword<br />            [tmp_name] =&gt; /tmp/path/phpVGCDAJ<br />            [error] =&gt; 0<br />            [size] =&gt; 0<br />        )<br />)<br /><br />Multi-files with HTML array feature -<br /><br />Array<br />(<br />    [documents] =&gt; Array<br />        (<br />            [name] =&gt; Array<br />                (<br />                    [0] =&gt; sample-file.doc<br />                    [1] =&gt; sample-file.doc<br />                )<br /><br />            [type] =&gt; Array<br />                (<br />                    [0] =&gt; application/msword<br />                    [1] =&gt; application/msword<br />                )<br /><br />            [tmp_name] =&gt; Array<br />                (<br />                    [0] =&gt; /tmp/path/phpVGCDAJ<br />                    [1] =&gt; /tmp/path/phpVGCDAJ<br />                )<br /><br />            [error] =&gt; Array<br />                (<br />                    [0] =&gt; 0<br />                    [1] =&gt; 0<br />                )<br /><br />            [size] =&gt; Array<br />                (<br />                    [0] =&gt; 0<br />                    [1] =&gt; 0<br />                )<br /><br />        )<br /><br />)<br /><br />The problem occurs when you have a form that uses both single file and HTML array feature. The array isn't normalized and tends to make coding for it really sloppy. I have included a nice method to normalize the $_FILES array.<br /><br /><span class="default">&lt;?php<br /><br />    </span><span class="keyword">function </span><span class="default">normalize_files_array</span><span class="keyword">(</span><span class="default">$files </span><span class="keyword">= []) {<br /><br />        </span><span class="default">$normalized_array </span><span class="keyword">= [];<br /><br />        foreach(</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">) {<br /><br />            if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">])) {<br />                </span><span class="default">$normalized_array</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">][] = </span><span class="default">$file</span><span class="keyword">;<br />                continue;<br />            }<br /><br />            foreach(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] as </span><span class="default">$idx </span><span class="keyword">=&gt; </span><span class="default">$name</span><span class="keyword">) {<br />                </span><span class="default">$normalized_array</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">][</span><span class="default">$idx</span><span class="keyword">] = [<br />                    </span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="default">$name</span><span class="keyword">,<br />                    </span><span class="string">'type' </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">][</span><span class="default">$idx</span><span class="keyword">],<br />                    </span><span class="string">'tmp_name' </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">[</span><span class="string">'tmp_name'</span><span class="keyword">][</span><span class="default">$idx</span><span class="keyword">],<br />                    </span><span class="string">'error' </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">[</span><span class="string">'error'</span><span class="keyword">][</span><span class="default">$idx</span><span class="keyword">],<br />                    </span><span class="string">'size' </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">][</span><span class="default">$idx</span><span class="keyword">]<br />                ];<br />            }<br /><br />        }<br /><br />        return </span><span class="default">$normalized_array</span><span class="keyword">;<br /><br />    }<br /><br /></span><span class="default">?&gt;<br /></span><br />The following is the output from the above method.<br /><br />Array<br />(<br />    [document] =&gt; Array<br />        (<br />            [0] =&gt; Array<br />                (<br />                [name] =&gt; sample-file.doc<br />                    [type] =&gt; application/msword<br />                    [tmp_name] =&gt; /tmp/path/phpVGCDAJ<br />                    [error] =&gt; 0<br />                    [size] =&gt; 0<br />                )<br /><br />        )<br /><br />    [documents] =&gt; Array<br />        (<br />            [0] =&gt; Array<br />                (<br />                    [name] =&gt; sample-file.doc<br />                    [type] =&gt; application/msword<br />                    [tmp_name] =&gt; /tmp/path/phpVGCDAJ<br />                    [error] =&gt; 0<br />                    [size] =&gt; 0<br />                )<br /><br />            [1] =&gt; Array<br />                (<br />                    [name] =&gt; sample-file.doc<br />                    [type] =&gt; application/msword<br />                    [tmp_name] =&gt; /tmp/path/phpVGCDAJ<br />                    [error] =&gt; 0<br />                    [size] =&gt; 0<br />                )<br /><br />        )<br /><br />)</span></code></div>
  </div>
 </div>
  <div class="note" id="117613">  <div class="votes">
    <div id="Vu117613">
    <a href="https://www.php.net/manual/vote-note.php?id=117613&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd117613">
    <a href="https://www.php.net/manual/vote-note.php?id=117613&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V117613" title="57% like this...">
    16
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#117613" class="name">
  <strong class="user"><em>anon</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#117613"> &para;</a><div class="date" title="2015-07-08 10:19"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom117613">
<div class="phpcode"><code><span class="html">For clarity; the reason you would NOT want to replace the example script with<br />$uploaddir = './';<br />is because if you have no coded file constraints a nerd could upload a php script with the same name of one of your scripts in the scripts directory.<br /><br />Given the right settings and permissions php-cgi is capable of replacing even php files.<br /><br />Imagine if it replaced the upload post processor file itself. The next "upload" could lead to some easy exploits.<br /><br />Even when replacements are not possible; uploading an .htaccess file could cause some problems, especially if it is sent after the nerd throws in a devious script to use htaccess to redirect to his upload.<br /><br />There are probably more ways of exploiting it. Don't let the nerds get you.<br /><br />More sensible to use a fresh directory for uploads with some form of unique naming algorithm; maybe even a cron job for sanitizing the directory so older files do not linger for too long.</span></code></div>
  </div>
 </div>
  <div class="note" id="124901">  <div class="votes">
    <div id="Vu124901">
    <a href="https://www.php.net/manual/vote-note.php?id=124901&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124901">
    <a href="https://www.php.net/manual/vote-note.php?id=124901&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124901" title="58% like this...">
    6
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#124901" class="name">
  <strong class="user"><em>fravadona at gmail dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#124901"> &para;</a><div class="date" title="2020-04-11 11:13"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom124901">
<div class="phpcode"><code><span class="html">mpyw is right, PSR-7 is awesome but a little overkill for simple projects (in my opinion).<br /><br />Here's an example of function that returns the file upload metadata in a (PSR-7 *like*) normalized tree. This function deals with whatever dimension of upload metadata.<br /><br />I kept the code extremely simple, it doesn't validate anything in $_FILES, etc... AND MOST IMPORTANTLY, it calls array_walk_recursive in an *undefined behaviour* way!!!<br /><br />You can test it against the examples of the PSR-7 spec ( <a href="https://www.php-fig.org/psr/psr-7/#16-uploaded-files" rel="nofollow" target="_blank">https://www.php-fig.org/psr/psr-7/#16-uploaded-files</a> ) and try to add your own checks that will detect the error in the last example ^^<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">/**<br /> *  THIS CODE IS ABSOLUTELY NOT MEANT FOR PRODUCTION !!! MAY ITS INSIGHTS HELP YOU !!!<br /> */<br /></span><span class="keyword">function </span><span class="default">getNormalizedFiles</span><span class="keyword">()<br />{<br />  </span><span class="default">$normalized </span><span class="keyword">= array();<br /><br />  if ( isset(</span><span class="default">$_FILES</span><span class="keyword">) ) { <br />    <br />    foreach ( </span><span class="default">$_FILES </span><span class="keyword">as </span><span class="default">$field </span><span class="keyword">=&gt; </span><span class="default">$metadata </span><span class="keyword">) {<br />      <br />      </span><span class="default">$normalized</span><span class="keyword">[</span><span class="default">$field</span><span class="keyword">] = array(); </span><span class="comment">// needs initialization for array_replace_recursive<br />      <br />      </span><span class="keyword">foreach ( </span><span class="default">$metadata </span><span class="keyword">as </span><span class="default">$meta </span><span class="keyword">=&gt; </span><span class="default">$data </span><span class="keyword">) { </span><span class="comment">// $meta is 'tmp_name', 'error', etc...<br />        <br />        </span><span class="keyword">if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) ) {<br />          <br />          </span><span class="comment">// insert the current meta just before each leaf !!! WRONG USE OF ARRAY_WALK_RECURSIVE !!!<br />          </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, function (&amp;</span><span class="default">$v</span><span class="keyword">,</span><span class="default">$k</span><span class="keyword">) use (</span><span class="default">$meta</span><span class="keyword">) { </span><span class="default">$v </span><span class="keyword">= array( </span><span class="default">$meta </span><span class="keyword">=&gt; </span><span class="default">$v </span><span class="keyword">); });<br />          <br />          </span><span class="comment">// fuse the current metadata with the previous ones<br />          </span><span class="default">$normalized</span><span class="keyword">[</span><span class="default">$field</span><span class="keyword">] = </span><span class="default">array_replace_recursive</span><span class="keyword">(</span><span class="default">$normalized</span><span class="keyword">[</span><span class="default">$field</span><span class="keyword">], </span><span class="default">$data</span><span class="keyword">);<br />        <br />        } else {<br />          </span><span class="default">$normalized</span><span class="keyword">[</span><span class="default">$field</span><span class="keyword">][</span><span class="default">$meta</span><span class="keyword">] = </span><span class="default">$data</span><span class="keyword">;<br />        }<br />      } <br />    }<br />  } <br />  return </span><span class="default">$normalized</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="89938">  <div class="votes">
    <div id="Vu89938">
    <a href="https://www.php.net/manual/vote-note.php?id=89938&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd89938">
    <a href="https://www.php.net/manual/vote-note.php?id=89938&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V89938" title="55% like this...">
    13
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#89938" class="name">
  <strong class="user"><em>eslindsey at gmail dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#89938"> &para;</a><div class="date" title="2009-03-29 11:09"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom89938">
<div class="phpcode"><code><span class="html">Also note that since MAX_FILE_SIZE hidden field is supplied by the browser doing the submitting, it is easily overridden from the clients' side.  You should always perform your own examination and error checking of the file after it reaches you, instead of relying on information submitted by the client.  This includes checks for file size (always check the length of the actual data versus the reported file size) as well as file type (the MIME type submitted by the browser can be inaccurate at best, and intentionally set to an incorrect value at worst).</span></code></div>
  </div>
 </div>
  <div class="note" id="100187">  <div class="votes">
    <div id="Vu100187">
    <a href="https://www.php.net/manual/vote-note.php?id=100187&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd100187">
    <a href="https://www.php.net/manual/vote-note.php?id=100187&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V100187" title="51% like this...">
    4
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#100187" class="name">
  <strong class="user"><em>Mark</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#100187"> &para;</a><div class="date" title="2010-09-29 04:12"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom100187">
<div class="phpcode"><code><span class="html">$_FILES will be empty if a user attempts to upload a file greater than post_max_size in your php.ini<br /><br />post_max_size should be &gt;= upload_max_filesize in your php.ini.</span></code></div>
  </div>
 </div>
  <div class="note" id="89697">  <div class="votes">
    <div id="Vu89697">
    <a href="https://www.php.net/manual/vote-note.php?id=89697&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd89697">
    <a href="https://www.php.net/manual/vote-note.php?id=89697&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V89697" title="51% like this...">
    4
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#89697" class="name">
  <strong class="user"><em>claude dot pache at gmail dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#89697"> &para;</a><div class="date" title="2009-03-19 09:26"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom89697">
<div class="phpcode"><code><span class="html">Note that the MAX_FILE_SIZE hidden field is only used by the PHP script which receives the request, as an instruction to reject files larger than the given bound. This field has no significance for the browser, it does not provide a client-side check of the file-size, and it has nothing to do with web standards or browser features.</span></code></div>
  </div>
 </div>
  <div class="note" id="120686">  <div class="votes">
    <div id="Vu120686">
    <a href="https://www.php.net/manual/vote-note.php?id=120686&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd120686">
    <a href="https://www.php.net/manual/vote-note.php?id=120686&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V120686" title="48% like this...">
    -2
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#120686" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#120686"> &para;</a><div class="date" title="2017-02-21 10:56"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom120686">
<div class="phpcode"><code><span class="html">I have found it useful to re-order the multidimensional $_FILES array into a more intuitive format, as proposed by many other developers already. <br /><br />Unfortunately, most of the proposed functions are not able to re-order the $_FILES array when it has more than 1 additional dimension.<br /><br />Therefore, I would like to contribute the function below, which is capable of meeting the aforementioned requirement:<br /><br /><span class="default">&lt;?php<br />    </span><span class="keyword">function </span><span class="default">get_fixed_files</span><span class="keyword">() {<br />        </span><span class="default">$function </span><span class="keyword">= function(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">$fixed_files </span><span class="keyword">= array(), </span><span class="default">$path </span><span class="keyword">= array()) use (&amp;</span><span class="default">$function</span><span class="keyword">) {<br />            foreach (</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />                </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">$path</span><span class="keyword">;<br />                </span><span class="default">$temp</span><span class="keyword">[] = </span><span class="default">$key</span><span class="keyword">;<br />            <br />                if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br />                    </span><span class="default">$fixed_files </span><span class="keyword">= </span><span class="default">$function</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$fixed_files</span><span class="keyword">, </span><span class="default">$temp</span><span class="keyword">);<br />                } else {<br />                    </span><span class="default">$next </span><span class="keyword">= </span><span class="default">array_splice</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />                    </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">, </span><span class="default">$next</span><span class="keyword">);<br />                    <br />                    </span><span class="default">$new </span><span class="keyword">= &amp;</span><span class="default">$fixed_files</span><span class="keyword">;<br />                    <br />                    foreach (</span><span class="default">$temp </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">) {<br />                        </span><span class="default">$new </span><span class="keyword">= &amp;</span><span class="default">$new</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />                    }<br />                    <br />                    </span><span class="default">$new </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />                }<br />            }<br />            <br />            return </span><span class="default">$fixed_files</span><span class="keyword">;<br />        };<br />        <br />        return </span><span class="default">$function</span><span class="keyword">(</span><span class="default">$_FILES</span><span class="keyword">);<br />    }<br /></span><span class="default">?&gt;<br /></span><br />Side note: the unnamed function within the function is used to avoid confusion regarding the arguments necessary for the recursion within the function, for example when viewing the function in an IDE.</span></code></div>
  </div>
 </div>
  <div class="note" id="104349">  <div class="votes">
    <div id="Vu104349">
    <a href="https://www.php.net/manual/vote-note.php?id=104349&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd104349">
    <a href="https://www.php.net/manual/vote-note.php?id=104349&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V104349" title="47% like this...">
    -5
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#104349" class="name">
  <strong class="user"><em>Age Bosma</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#104349"> &para;</a><div class="date" title="2011-06-10 02:49"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom104349">
<div class="phpcode"><code><span class="html">"If no file is selected for upload in your form, PHP will return $_FILES['userfile']['size'] as 0, and $_FILES['userfile']['tmp_name'] as none."<br /><br />Note that the situation above is the same when a file exceeding the MAX_FILE_SIZE hidden field is being uploaded. In this case $_FILES['userfile']['size'] is also set to 0, and $_FILES['userfile']['tmp_name'] is also empty. The difference would only be the error code.<br />Simply checking for these two conditions and assuming no file upload has been attempted is incorrect.<br /><br />Instead, check if $_FILES['userfile']['name'] is set or not. If it is, a file upload has at least been attempted (a failed attempt or not). If it is not set, no attempt has been made.</span></code></div>
  </div>
 </div>
  <div class="note" id="116393">  <div class="votes">
    <div id="Vu116393">
    <a href="https://www.php.net/manual/vote-note.php?id=116393&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd116393">
    <a href="https://www.php.net/manual/vote-note.php?id=116393&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V116393" title="42% like this...">
    -14
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#116393" class="name">
  <strong class="user"><em>bimal at sanjaal dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#116393"> &para;</a><div class="date" title="2014-12-26 11:44"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom116393">
<div class="phpcode"><code><span class="html">Some suggestions here:<br /><br />1. It is always better to check for your error status. If MAX_FILE_SIZE is active and the uploaded file crossed the limit, it will set the error. So, only when error is zero (0), move the file.<br /><br />2. If possible, never allow your script to upload in the path where file can be downloaded. Point your upload path to outside of public_html area or prevent direct browsing (using .htaccess restrictions). Think, if someone uploads malicious code, specially php codes, they will be executed on the server.<br /><br />3. Do not use the file name sent by the client. Regenerate a new name for newly uploaded file. This prevents overwriting your old files.<br /><br />4. Regularly track the disk space consumed, if you are running out of storage.</span></code></div>
  </div>
 </div>
  <div class="note" id="121833">  <div class="votes">
    <div id="Vu121833">
    <a href="https://www.php.net/manual/vote-note.php?id=121833&amp;page=features.file-upload.post-method&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121833">
    <a href="https://www.php.net/manual/vote-note.php?id=121833&amp;page=features.file-upload.post-method&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121833" title="32% like this...">
    -18
    </div>
  </div>
  <a href="features.file-upload.post-method.php.html#121833" class="name">
  <strong class="user"><em>katrinaelaine6 at gmail dot com</em></strong></a><a class="genanchor" href="features.file-upload.post-method.php.html#121833"> &para;</a><div class="date" title="2017-11-06 06:16"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121833">
<div class="phpcode"><code><span class="html">Here's a complete example of the $_FILES array with nested and non-nested names. Let's say we have this html form:<br /><br />&lt;form action="test.php" method="post"&gt;<br /><br />    &lt;input type="file" name="single" id="single"&gt;<br /><br />    &lt;input type="file" name="nested[]"          id="nested_one"&gt;<br />    &lt;input type="file" name="nested[root]"      id="nested_root"&gt;         <br />    &lt;input type="file" name="nested[][]"        id="nested_two"&gt; <br />    &lt;input type="file" name="nested[][parent]"  id="nested_parent"&gt;<br />    &lt;input type="file" name="nested[][][]"      id="nested_three"&gt;<br />    &lt;input type="file" name="nested[][][child]" id="nested_child"&gt;<br /><br />    &lt;input type="submit" value="Submit"&gt;<br /><br />&lt;/form&gt;<br /><br />In the test.php file:<br /><br /><span class="default">&lt;?php<br /><br />    print_r</span><span class="keyword">(</span><span class="default">$_FILES</span><span class="keyword">);<br />    exit;<br /><br /></span><span class="default">?&gt;<br /></span><br />If we upload a text file with the same name as the input id for each input and click submit, test.php will output this:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">Array<br />(<br /><br />    [</span><span class="default">single</span><span class="keyword">] =&gt; Array<br />        (<br />            [</span><span class="default">name</span><span class="keyword">] =&gt; </span><span class="default">single</span><span class="keyword">.</span><span class="default">txt<br />            </span><span class="keyword">[</span><span class="default">type</span><span class="keyword">] =&gt; </span><span class="default">text</span><span class="keyword">/</span><span class="default">plain<br />            </span><span class="keyword">[</span><span class="default">tmp_name</span><span class="keyword">] =&gt; /</span><span class="default">tmp</span><span class="keyword">/</span><span class="default">phpApO28i<br />            </span><span class="keyword">[</span><span class="default">error</span><span class="keyword">] =&gt; </span><span class="default">0<br />            </span><span class="keyword">[</span><span class="default">size</span><span class="keyword">] =&gt; </span><span class="default">3441<br />        </span><span class="keyword">)<br /><br />    [</span><span class="default">nested</span><span class="keyword">] =&gt; Array<br />        (<br />            [</span><span class="default">name</span><span class="keyword">] =&gt; Array<br />                (<br />                    [</span><span class="default">0</span><span class="keyword">] =&gt; </span><span class="default">nested_one</span><span class="keyword">.</span><span class="default">txt<br />                    </span><span class="keyword">[</span><span class="default">root</span><span class="keyword">] =&gt; </span><span class="default">nested_root</span><span class="keyword">.</span><span class="default">txt<br />                    </span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] =&gt; Array<br />                        (<br />                            [</span><span class="default">0</span><span class="keyword">] =&gt; </span><span class="default">nested_two</span><span class="keyword">.</span><span class="default">txt<br />                        </span><span class="keyword">)<br /><br />                    [</span><span class="default">2</span><span class="keyword">] =&gt; Array<br />                        (<br />                            [</span><span class="default">parent</span><span class="keyword">] =&gt; </span><span class="default">nested_parent</span><span class="keyword">.</span><span class="default">txt<br />                        </span><span class="keyword">)<br /><br />                    [</span><span class="default">3</span><span class="keyword">] =&gt; Array<br />                        (<br />                            [</span><span class="default">0</span><span class="keyword">] =&gt; Array<br />                                (<br />                                    [</span><span class="default">0</span><span class="keyword">] =&gt; </span><span class="default">nested_three</span><span class="keyword">.</span><span class="default">txt<br />                                </span><span class="keyword">)<br /><br />                        )<br /><br />                    [</span><span class="default">4</span><span class="keyword">] =&gt; Array<br />                        (<br />                            [</span><span class="default">0</span><span class="keyword">] =&gt; Array<br />                                (<br />                                    [</span><span class="default">child</span><span class="keyword">] =&gt; </span><span class="default">nested_child</span><span class="keyword">.</span><span class="default">txt<br />                                </span><span class="keyword">)<br /><br />                        )<br /><br />                )<br /><br />            </span><span class="comment">// type, tmp_name, size, and error will have the same structure.<br />        </span><span class="keyword">)<br /><br />)<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=features.file-upload.post-method&amp;redirect=https://www.php.net/manual/ru/features.file-upload.post-method.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="features.file-upload.php.html">Загрузка файлов на сервер</a>

                                    <ul class='child-menu-list'>

                                                <li class="current">
                            <a href="features.file-upload.post-method.php.html" title="Загрузка файлов методом POST">Загрузка файлов методом POST</a>
                        </li>
                                                <li class="">
                            <a href="features.file-upload.errors.php.html" title="Объяснение сообщений об ошибках">Объяснение сообщений об ошибках</a>
                        </li>
                                                <li class="">
                            <a href="features.file-upload.common-pitfalls.php.html" title="Наиболее распространённые ошибки">Наиболее распространённые ошибки</a>
                        </li>
                                                <li class="">
                            <a href="features.file-upload.multiple.php.html" title="Загрузка нескольких файлов">Загрузка нескольких файлов</a>
                        </li>
                                                <li class="">
                            <a href="features.file-upload.put-method.php.html" title="Поддержка метода PUT">Поддержка метода PUT</a>
                        </li>
                                                <li class="">
                            <a href="features.file-upload.errors.seealso.php.html" title="Смотрите также">Смотрите также</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
