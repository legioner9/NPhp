<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Компрессионные фильтры - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="filters.compression.php.html">
 <link rel="shorturl" href="filters.compression.php.html">
 <link rel="alternate" href="filters.compression.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="filters.php.html">
 <link rel="prev" href="filters.convert.php.html">
 <link rel="next" href="filters.encryption.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/filters.compression.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/filters.compression.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/filters.compression.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/filters.compression.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/filters.compression.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/filters.compression.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/filters.compression.php" hreflang="pt_BR">
 <link rel="alternate" href="filters.compression.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/filters.compression.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/filters.compression.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="filters.encryption.php.html">
          Шифрующие фильтры &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="filters.convert.php.html">
          &laquo; Преобразовывающие фильтры        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='appendices.php.html'>Приложения</a></li>      <li><a href='filters.php.html'>Список доступных фильтров</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/filters.compression.php'>English</option>
            <option value='de/filters.compression.php'>German</option>
            <option value='es/filters.compression.php'>Spanish</option>
            <option value='fr/filters.compression.php'>French</option>
            <option value='it/filters.compression.php'>Italian</option>
            <option value='ja/filters.compression.php'>Japanese</option>
            <option value='pt_BR/filters.compression.php'>Brazilian Portuguese</option>
            <option value='ru/filters.compression.php' selected="selected">Russian</option>
            <option value='tr/filters.compression.php'>Turkish</option>
            <option value='zh/filters.compression.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/appendices/filters.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffilters.compression%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="filters.compression" class="section">
  <h2 class="title">Компрессионные фильтры</h2>

  <p class="simpara">
   В то время, как <a href="wrappers.compression.php.html" class="link">Компрессионные
   обёртки</a> обеспечивают способ создания gzip- и bz2-совместимых
   файлов в локальной файловой системе, они не предоставляют общих средств
   для компрессии в сетевых потоках, как и не предоставляют средств
   для создания потока без компрессии с последующим превращением в
   компрессируемый. Для этих целей к любым потоковым ресурсам в любое время
   могут применяться компрессионные фильтры.
  </p>

  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <span class="simpara">
    Компрессионные фильтры <em>не</em> генерируют заголовков и
    окончаний, которые используют утилиты командной строки, такие как
    <code class="literal">gzip</code>. Они просто компрессируют (сжимают) и
    декомпрессируют (разжимают) порции данных в компрессируемом потоке
    данных.
   </span>
  </p></blockquote>

  <div class="section" id="filters.compression.zlib">
   <h2 class="title">zlib.deflate и zlib.inflate</h2>
   <p class="simpara">
    <code class="literal">zlib.deflate</code> (компрессия) и
    <code class="literal">zlib.inflate</code> (декомпрессия) являются реализациями
    методов сжатия, описанных в
    <a href="http://www.faqs.org/rfcs/rfc1951" class="link external">&raquo;&nbsp;RFC 1951</a>.
    Фильтр <code class="literal">deflate</code> принимает три аргумента, переданных в
    виде ассоциативного массива.

    <code class="parameter">level</code> определяет, какой уровень компрессии
    использовать (1-9). Повышение этого значения приведёт к уменьшению
    объёмов данных за счёт увеличения времени обработки. Существуют также два
    специальных уровня компрессии:
    0 (для отключения компрессии) и -1 (внутреннее значение по умолчанию
    библиотеки zlib -- на текущий момент равно 6).

    <code class="parameter">window</code> - это логарифм с основанием 2 от размера окна диапазона сжатия.
    Высокие значения (вплоть до 15 -- 32768 байт) приводят к улучшению
    компрессии за счёт роста необходимой памяти, в то время как низкие значения
    (вплоть до 9 -- 512 байт) приводят к ухудшению компрессии за счёт
    уменьшения необходимой памяти.
    Значением аргумента <code class="parameter">window</code> по умолчанию на текущий
    момент является <strong><code>15</code></strong>.

    <code class="parameter">memory</code> определяет масштаб резервируемой памяти.
    Допустимые значения находятся в диапазоне от 1 (минимальное резервирование)
    до 9 (максимальное резервирование). Такое резервирование памяти влияет
    только на скорость и не влияет на размер генерируемых данных.
   </p>
   <blockquote class="note"><p><strong class="note">Замечание</strong>: 
    <span class="simpara">
     Так как уровень компрессии является наиболее часто используемым
     аргументом, вы можете передать только его в качестве обычного целого
     числа (integer), вместо того чтобы передавать массив из одного элемента.
    </span>
   </p></blockquote>
   <p class="simpara">
    Компрессионные фильтры zlib.* доступны, если включена поддержка
    <a href="ref.zlib.php.html" class="link">zlib</a>.
   </p>
   <div class="example" id="">
    <p><strong>Пример #1 
     <code class="literal">zlib.deflate</code> и
     <code class="literal">zlib.inflate</code>
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$params </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'level' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">6</span><span style="color: #007700">, </span><span style="color: #DD0000">'window' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">15</span><span style="color: #007700">, </span><span style="color: #DD0000">'memory' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">9</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$original_text </span><span style="color: #007700">= </span><span style="color: #DD0000">"This is a test.\nThis is only a test.\nThis is not an important string.\n"</span><span style="color: #007700">;<br />echo </span><span style="color: #DD0000">"Оригинальный текст длиной " </span><span style="color: #007700">. </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$original_text</span><span style="color: #007700">) . </span><span style="color: #DD0000">" символов.\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$fp </span><span style="color: #007700">= </span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.deflated'</span><span style="color: #007700">, </span><span style="color: #DD0000">'w'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #DD0000">'zlib.deflate'</span><span style="color: #007700">, </span><span style="color: #0000BB">STREAM_FILTER_WRITE</span><span style="color: #007700">, </span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #0000BB">$original_text</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Сжатый файл размером " </span><span style="color: #007700">. </span><span style="color: #0000BB">filesize</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.deflated'</span><span style="color: #007700">) . </span><span style="color: #DD0000">" байт.\n"</span><span style="color: #007700">;<br />echo </span><span style="color: #DD0000">"Оригинальный текст:\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">/* Использование readfile и zlib.inflate для декомпресии на лету */<br /></span><span style="color: #0000BB">readfile</span><span style="color: #007700">(</span><span style="color: #DD0000">'php://filter/zlib.inflate/resource=test.deflated'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Генерирует вывод:<br /><br />Оригинальный текст длиной 70 символов.<br />Сжатый файл размером 56 байт.<br />Оригинальный текст:<br />This is a test.<br />This is only a test.<br />This is not an important string.<br /><br /> */<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>

   <div class="example" id="">
    <p><strong>Пример #2 
     Упрощённое использование <code class="literal">zlib.deflate</code>
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$original_text </span><span style="color: #007700">= </span><span style="color: #DD0000">"This is a test.\nThis is only a test.\nThis is not an important string.\n"</span><span style="color: #007700">;<br />echo </span><span style="color: #DD0000">"Оригинальный текст длиной " </span><span style="color: #007700">. </span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$original_text</span><span style="color: #007700">) . </span><span style="color: #DD0000">" символов.\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$fp </span><span style="color: #007700">= </span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.deflated'</span><span style="color: #007700">, </span><span style="color: #DD0000">'w'</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">/* Здесь "6" указывает уровень компрессии 6 */<br /></span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #DD0000">'zlib.deflate'</span><span style="color: #007700">, </span><span style="color: #0000BB">STREAM_FILTER_WRITE</span><span style="color: #007700">, </span><span style="color: #0000BB">6</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #0000BB">$original_text</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Сжатый файл размером " </span><span style="color: #007700">. </span><span style="color: #0000BB">filesize</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.deflated'</span><span style="color: #007700">) . </span><span style="color: #DD0000">" байт.\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/* Генерирует вывод:<br /><br />Оригинальный текст длиной 70 символов.<br />Сжатый файл размером 56 байт.<br /><br /> */<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </div>

  <div class="section" id="filters.compression.bzip2">
   <h2 class="title">bzip2.compress и bzip2.decompress</h2>
   <p class="simpara">
    <code class="literal">bzip2.compress</code> и
    <code class="literal">bzip2.decompress</code>
    работают точно так же, как и фильтры zlib, описанные выше.

    Фильтр <code class="literal">bzip2.compress</code> принимает два аргумента в виде
    элементов ассоциативного массива:

    <code class="parameter">blocks</code> является целочисленным (integer) значением
    в диапазоне от 1 до 9 и указывает на количество 100-килобайтовых блоков
    памяти для резервирования в качестве рабочего пространства.

    <code class="parameter">work</code> - это так же целочисленное (integer) значение
    в диапазоне от 0 до 250, определяющее сколько усилий нужно потратить на
    обычный метод компрессии перед переключением на медленный, но более
    надёжный метод. Изменение этого параметра влияет только на скорость
    компрессии. Ни размер сжатого результата, ни используемый объем памяти не
    изменяются при помощи этой настройки. Значение 0 указывает библиотеке bzip
    использовать собственное внутреннее значение по умолчанию.

    Фильтр <code class="literal">bzip2.decompress</code> принимает всего один аргумент,
    который может быть передан либо как обычное boolean-значение, либо как
    элемент <code class="parameter">small</code> ассоциативного массива.

    Когда <code class="parameter">small</code> установлен в <strong><code>true</code></strong>, библиотека bzip
    совершит декомпрессию с минимальным расходом памяти за счёт понижения
    скорости.
   </p>

   <p class="simpara">
    Компрессионные фильтры bzip2.* доступны, если включена поддержка
    <a href="ref.bzip2.php.html" class="link">bz2</a>.
   </p>

   <div class="example" id="">
    <p><strong>Пример #3 
     <code class="literal">bzip2.compress</code> и
     <code class="literal">bzip2.decompress</code>
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$param </span><span style="color: #007700">= array(</span><span style="color: #DD0000">'blocks' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">9</span><span style="color: #007700">, </span><span style="color: #DD0000">'work' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Оригинальный файл размером " </span><span style="color: #007700">. </span><span style="color: #0000BB">filesize</span><span style="color: #007700">(</span><span style="color: #DD0000">'LICENSE'</span><span style="color: #007700">) . </span><span style="color: #DD0000">" байт.\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$fp </span><span style="color: #007700">= </span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'LICENSE.compressed'</span><span style="color: #007700">, </span><span style="color: #DD0000">'w'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #DD0000">'bzip2.compress'</span><span style="color: #007700">, </span><span style="color: #0000BB">STREAM_FILTER_WRITE</span><span style="color: #007700">, </span><span style="color: #0000BB">$param</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'LICENSE'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Сжатый файл размером " </span><span style="color: #007700">. </span><span style="color: #0000BB">filesize</span><span style="color: #007700">(</span><span style="color: #DD0000">'LICENSE.compressed'</span><span style="color: #007700">) . </span><span style="color: #DD0000">" байт.\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/* Генерирует вывод:<br /><br />Оригинальный файл размером 3288 байт.<br />Сжатый файл размером 1488 байт.<br /><br /> */<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </div>
 </div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=filters.compression&amp;redirect=https://www.php.net/manual/ru/filters.compression.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">4 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="117859">  <div class="votes">
    <div id="Vu117859">
    <a href="https://www.php.net/manual/vote-note.php?id=117859&amp;page=filters.compression&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd117859">
    <a href="https://www.php.net/manual/vote-note.php?id=117859&amp;page=filters.compression&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V117859" title="90% like this...">
    9
    </div>
  </div>
  <a href="filters.compression.php.html#117859" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="filters.compression.php.html#117859"> &para;</a><div class="date" title="2015-08-21 06:12"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom117859">
<div class="phpcode"><code><span class="html">To read a gzip encoded stream from http<br /><span class="default">&lt;?php<br />$opts </span><span class="keyword">= [<br />    </span><span class="string">"http" </span><span class="keyword">=&gt; [<br />        </span><span class="string">"method" </span><span class="keyword">=&gt; </span><span class="string">"GET"</span><span class="keyword">,<br />        </span><span class="string">"header" </span><span class="keyword">=&gt; [ </span><span class="string">"Accept-Encoding: gzip" </span><span class="keyword">],<br />    ]<br />];<br /></span><span class="default">$ctx </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br /></span><span class="default">$f </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"<a href="http://php.net" rel="nofollow" target="_blank">http://php.net</a>"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$ctx</span><span class="keyword">);<br /></span><span class="comment">// check  stream_get_meta_data($f)["wrapper_data"] has "Content-Encoding: gzip"<br /></span><span class="default">stream_filter_append</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="string">"zlib.inflate"</span><span class="keyword">, </span><span class="default">STREAM_FILTER_READ</span><span class="keyword">, [</span><span class="string">"window" </span><span class="keyword">=&gt; </span><span class="default">30</span><span class="keyword">]);<br />echo </span><span class="default">stream_get_contents</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">); </span><span class="comment">// any stream processing<br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);</span></span></code></div>
  </div>
 </div>
  <div class="note" id="125804">  <div class="votes">
    <div id="Vu125804">
    <a href="https://www.php.net/manual/vote-note.php?id=125804&amp;page=filters.compression&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125804">
    <a href="https://www.php.net/manual/vote-note.php?id=125804&amp;page=filters.compression&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125804" title="66% like this...">
    1
    </div>
  </div>
  <a href="filters.compression.php.html#125804" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="filters.compression.php.html#125804"> &para;</a><div class="date" title="2021-02-10 06:37"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom125804">
<div class="phpcode"><code><span class="html">To use the zlib.inflate filter with data originally written using gzcompress() or zlib.deflate, set the window option to 15 as outlined here: <a href="https://bugs.php.net/bug.php?id=68556" rel="nofollow" target="_blank">https://bugs.php.net/bug.php?id=68556</a><br /><br /><span class="default">&lt;?php<br />$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">file_name</span><span class="keyword">, </span><span class="string">'rb'</span><span class="keyword">);<br /></span><span class="default">stream_filter_append</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">, </span><span class="string">'zlib.inflate'</span><span class="keyword">, </span><span class="default">STREAM_FILTER_READ</span><span class="keyword">, [</span><span class="string">'window' </span><span class="keyword">=&gt; </span><span class="default">15</span><span class="keyword">]);<br /></span><span class="default">$contents </span><span class="keyword">= </span><span class="default">stream_get_contents</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);</span></span></code></div>
  </div>
 </div>
  <div class="note" id="122919">  <div class="votes">
    <div id="Vu122919">
    <a href="https://www.php.net/manual/vote-note.php?id=122919&amp;page=filters.compression&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122919">
    <a href="https://www.php.net/manual/vote-note.php?id=122919&amp;page=filters.compression&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122919" title="62% like this...">
    2
    </div>
  </div>
  <a href="filters.compression.php.html#122919" class="name">
  <strong class="user"><em>bohwaz</em></strong></a><a class="genanchor" href="filters.compression.php.html#122919"> &para;</a><div class="date" title="2018-07-08 01:39"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom122919">
<div class="phpcode"><code><span class="html">Please note that there is currently a bug in this feature. ftell(), fseek() and fstat() functions cannot be used. Writing to a stream after using this function will not change the stream position as it should.<br /><br />See bug: <a href="https://bugs.php.net/bug.php?id=49874" rel="nofollow" target="_blank">https://bugs.php.net/bug.php?id=49874</a><br /><br />Also the zlib filters don't work with php://temp, php://memory and php://input streams, nothing is outputted to those streams.</span></code></div>
  </div>
 </div>
  <div class="note" id="128233">  <div class="votes">
    <div id="Vu128233">
    <a href="https://www.php.net/manual/vote-note.php?id=128233&amp;page=filters.compression&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd128233">
    <a href="https://www.php.net/manual/vote-note.php?id=128233&amp;page=filters.compression&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V128233" title="33% like this...">
    -1
    </div>
  </div>
  <a href="filters.compression.php.html#128233" class="name">
  <strong class="user"><em>TingSong</em></strong></a><a class="genanchor" href="filters.compression.php.html#128233"> &para;</a><div class="date" title="2023-02-20 03:43"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom128233">
<div class="phpcode"><code><span class="html">To decompress a gzipped stream:<br /><br /><span class="default">&lt;?php<br />$stream </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'<a href="https://example.com/some/file.txt.gz" rel="nofollow" target="_blank">https://example.com/some/file.txt.gz</a>'</span><span class="keyword">, </span><span class="string">'rb'</span><span class="keyword">);<br /></span><span class="default">stream_filter_append</span><span class="keyword">(</span><span class="default">$stream</span><span class="keyword">, </span><span class="string">'zlib.inflate'</span><span class="keyword">, </span><span class="default">STREAM_FILTER_READ</span><span class="keyword">, [</span><span class="string">'window' </span><span class="keyword">=&gt; </span><span class="default">15</span><span class="keyword">+</span><span class="default">16</span><span class="keyword">]);<br /><br /></span><span class="comment">// read the decompressed line directly<br /></span><span class="default">$line </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$stream</span><span class="keyword">);<br /><br /></span><span class="comment">// process the lines<br /></span><span class="default">?&gt;<br /></span><br />As the doc of zlib <a href="https://www.zlib.net/manual.html#Advanced" rel="nofollow" target="_blank">https://www.zlib.net/manual.html#Advanced</a><br /><br />The 'window' parameter between 8 and 15 specified the window size from 2⁸ to 2¹⁵ bytes. It can be added by 16 for wrapping with gzip header and trailer instead of zlib wrapper.<br /><br />And, window could be -8..-15 for unwrapping RAW deflate data.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=filters.compression&amp;redirect=https://www.php.net/manual/ru/filters.compression.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="filters.php.html">Список доступных фильтров</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="filters.string.php.html" title="Строковые фильтры">Строковые фильтры</a>
                        </li>
                                                <li class="">
                            <a href="filters.convert.php.html" title="Преобразовывающие фильтры">Преобразовывающие фильтры</a>
                        </li>
                                                <li class="current">
                            <a href="filters.compression.php.html" title="Компрессионные фильтры">Компрессионные фильтры</a>
                        </li>
                                                <li class="">
                            <a href="filters.encryption.php.html" title="Шифрующие фильтры">Шифрующие фильтры</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
