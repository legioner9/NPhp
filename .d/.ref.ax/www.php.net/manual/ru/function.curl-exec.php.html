<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: curl_exec - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.curl-exec.php.html">
 <link rel="shorturl" href="https://www.php.net/curl-exec">
 <link rel="alternate" href="https://www.php.net/curl-exec" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.curl.php.html">
 <link rel="prev" href="function.curl-escape.php.html">
 <link rel="next" href="function.curl-getinfo.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.curl-exec.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.curl-exec.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.curl-exec.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.curl-exec.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.curl-exec.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.curl-exec.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.curl-exec.php" hreflang="pt_BR">
 <link rel="alternate" href="function.curl-exec.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.curl-exec.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.curl-exec.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.curl-getinfo.php.html">
          curl_getinfo &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.curl-escape.php.html">
          &laquo; curl_escape        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.remote.other.php.html'>Другие службы</a></li>      <li><a href='book.curl.php.html'>cURL</a></li>      <li><a href='ref.curl.php.html'>Функции cURL</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.curl-exec.php'>English</option>
            <option value='de/function.curl-exec.php'>German</option>
            <option value='es/function.curl-exec.php'>Spanish</option>
            <option value='fr/function.curl-exec.php'>French</option>
            <option value='it/function.curl-exec.php'>Italian</option>
            <option value='ja/function.curl-exec.php'>Japanese</option>
            <option value='pt_BR/function.curl-exec.php'>Brazilian Portuguese</option>
            <option value='ru/function.curl-exec.php' selected="selected">Russian</option>
            <option value='tr/function.curl-exec.php'>Turkish</option>
            <option value='zh/function.curl-exec.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/curl/functions/curl-exec.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.curl-exec%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.curl-exec" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">curl_exec</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">curl_exec</span> &mdash; <span class="dc-title">Выполняет запрос cURL</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.curl-exec-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>curl_exec</strong></span>(<span class="methodparam"><span class="type"><a href="class.curlhandle.php.html" class="type CurlHandle">CurlHandle</a></span> <code class="parameter">$handle</code></span>): <span class="type"><span class="type">string</span>|<span class="type">bool</span></span></div>

  <p class="para rdfs-comment">
   Выполняет запрос cURL.
  </p>
  <p class="para">
   Эта функция должна вызываться после инициализации сеанса и установки всех
   необходимых параметров.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.curl-exec-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    <dt>
<code class="parameter">handle</code>
</dt>
<dd>
<p class="para">Дескриптор cURL, полученный из <span class="function"><a href="function.curl-init.php.html" class="function">curl_init()</a></span>.</p></dd>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.curl-exec-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки. Однако, если
   <a href="function.curl-setopt.php.html" class="link">установлена</a> опция
   <strong><code>CURLOPT_RETURNTRANSFER</code></strong>,
   при успешном завершении будет возвращён результат, а при
   неудаче - <strong><code>false</code></strong>.
  </p>
  <div class="warning"><strong class="warning">Внимание</strong><p class="simpara">Функция
возвращает как логическое значение <strong><code>false</code></strong>,
так и нелогическое значение, которое приводится к <strong><code>false</code></strong>.
Прочитайте раздел
«<a href="language.types.boolean.php.html" class="link">Логический тип</a>»,
чтобы получить дополнительную информацию.
Используйте <a href="language.operators.comparison.php.html" class="link">оператор ===</a>
для проверки значения, которое возвращает функция.</p></div>

  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Обратите внимание, что коды состояния ответа,
    указывающие на ошибки (например, <code class="literal">404 Not found</code>),
    не рассматриваются как неудача.
    Функция <span class="function"><a href="function.curl-getinfo.php.html" class="function">curl_getinfo()</a></span>
    может использоваться для проверки таких ошибок.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.curl-exec-changelog">
  <h3 class="title">Список изменений</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Версия</th>
      <th>Описание</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
 <td>8.0.0</td>
 <td>
  <code class="parameter">handle</code> теперь ожидает экземпляр <span class="classname"><a href="class.curlhandle.php.html" class="classname">CurlHandle</a></span>;
  раньше, ожидался ресурс (<span class="type">resource</span>).
 </td>
</tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.curl-exec-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Пример #1 Загрузка веб-страницы</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// создание нового cURL ресурса<br /></span><span style="color: #0000BB">$ch </span><span style="color: #007700">= </span><span style="color: #0000BB">curl_init</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// установка URL и других необходимых параметров<br /></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">, </span><span style="color: #0000BB">CURLOPT_URL</span><span style="color: #007700">, </span><span style="color: #DD0000">"http://www.example.com/"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">, </span><span style="color: #0000BB">CURLOPT_HEADER</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// загрузка страницы и выдача её браузеру<br /></span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// завершение сеанса и освобождение ресурсов<br /></span><span style="color: #0000BB">curl_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.curl-exec-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.curl-multi-exec.php.html" class="function" rel="rdfs-seeAlso">curl_multi_exec()</a> - Запускает подсоединения текущего дескриптора cURL</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.curl-exec&amp;redirect=https://www.php.net/manual/ru/function.curl-exec.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">23 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="98628">  <div class="votes">
    <div id="Vu98628">
    <a href="https://www.php.net/manual/vote-note.php?id=98628&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98628">
    <a href="https://www.php.net/manual/vote-note.php?id=98628&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98628" title="68% like this...">
    120
    </div>
  </div>
  <a href="function.curl-exec.php.html#98628" class="name">
  <strong class="user"><em>David from Code2Design.com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#98628"> &para;</a><div class="date" title="2010-06-27 07:44"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom98628">
<div class="phpcode"><code><span class="html">Just in case anyone is looking for a a couple of simple functions [to help automate cURL processes for POST and GET queries] I thought I'd post these.<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="comment">/**<br /> * Send a POST requst using cURL<br /> * @param string $url to request<br /> * @param array $post values to send<br /> * @param array $options for cURL<br /> * @return string<br /> */<br /></span><span class="keyword">function </span><span class="default">curl_post</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, array </span><span class="default">$post </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">, array </span><span class="default">$options </span><span class="keyword">= array())<br />{<br />    </span><span class="default">$defaults </span><span class="keyword">= array(<br />        </span><span class="default">CURLOPT_POST </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_HEADER </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_URL </span><span class="keyword">=&gt; </span><span class="default">$url</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_FRESH_CONNECT </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_RETURNTRANSFER </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_FORBID_REUSE </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_TIMEOUT </span><span class="keyword">=&gt; </span><span class="default">4</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_POSTFIELDS </span><span class="keyword">=&gt; </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$post</span><span class="keyword">)<br />    );<br /><br />    </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />    </span><span class="default">curl_setopt_array</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, (</span><span class="default">$options </span><span class="keyword">+ </span><span class="default">$defaults</span><span class="keyword">));<br />    if( ! </span><span class="default">$result </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">))<br />    {<br />        </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">));<br />    }<br />    </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />    return </span><span class="default">$result</span><span class="keyword">;<br />}<br /><br /></span><span class="comment">/**<br /> * Send a GET requst using cURL<br /> * @param string $url to request<br /> * @param array $get values to send<br /> * @param array $options for cURL<br /> * @return string<br /> */<br /></span><span class="keyword">function </span><span class="default">curl_get</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, array </span><span class="default">$get </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">, array </span><span class="default">$options </span><span class="keyword">= array())<br />{    <br />    </span><span class="default">$defaults </span><span class="keyword">= array(<br />        </span><span class="default">CURLOPT_URL </span><span class="keyword">=&gt; </span><span class="default">$url</span><span class="keyword">. (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">) === </span><span class="default">FALSE </span><span class="keyword">? </span><span class="string">'?' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">). </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$get</span><span class="keyword">),<br />        </span><span class="default">CURLOPT_HEADER </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_RETURNTRANSFER </span><span class="keyword">=&gt; </span><span class="default">TRUE</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_TIMEOUT </span><span class="keyword">=&gt; </span><span class="default">4<br />    </span><span class="keyword">);<br />    <br />    </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />    </span><span class="default">curl_setopt_array</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, (</span><span class="default">$options </span><span class="keyword">+ </span><span class="default">$defaults</span><span class="keyword">));<br />    if( ! </span><span class="default">$result </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">))<br />    {<br />        </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">));<br />    }<br />    </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />    return </span><span class="default">$result</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="125961">  <div class="votes">
    <div id="Vu125961">
    <a href="https://www.php.net/manual/vote-note.php?id=125961&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125961">
    <a href="https://www.php.net/manual/vote-note.php?id=125961&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125961" title="71% like this...">
    6
    </div>
  </div>
  <a href="function.curl-exec.php.html#125961" class="name">
  <strong class="user"><em>jpatta at digitalgamesystems dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#125961"> &para;</a><div class="date" title="2021-03-25 03:21"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom125961">
<div class="phpcode"><code><span class="html">If you are looking the debug curl_exec, you may wish to log its details, and analyze the various time points during its execution.<br /><br />before curl_exec:<br /><br /><span class="default">&lt;?php<br />    </span><span class="comment">// this will produce a curl log<br />    </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_VERBOSE</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />    </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_STDERR</span><span class="keyword">, </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/your/writable/app/logdir/curl.log'</span><span class="keyword">, </span><span class="string">'a+'</span><span class="keyword">)); </span><span class="comment">// a+ to append...<br /></span><span class="default">?&gt;<br /></span><br />after curl_exec, but before curl_close:<br /><br /><span class="default">&lt;?php<br />    </span><span class="comment">// this will extract the timing information<br />    </span><span class="default">extract</span><span class="keyword">(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">)); </span><span class="comment">// create metrics variables from getinfo<br />    </span><span class="default">$appconnect_time </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLINFO_APPCONNECT_TIME</span><span class="keyword">); </span><span class="comment">// request this time explicitly<br />    </span><span class="default">$downloadduration </span><span class="keyword">= </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$total_time </span><span class="keyword">- </span><span class="default">$starttransfer_time</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">); </span><span class="comment">// format, to get rid of scientific notation<br />    </span><span class="default">$namelookup_time </span><span class="keyword">= </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$namelookup_time</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);<br />    </span><span class="default">$metrics </span><span class="keyword">= </span><span class="string">"CURL...: </span><span class="default">$url</span><span class="string"> Time...: </span><span class="default">$total_time</span><span class="string"> DNS: </span><span class="default">$namelookup_time</span><span class="string"> Connect: </span><span class="default">$connect_time</span><span class="string"> SSL/SSH: </span><span class="default">$appconnect_time</span><span class="string"> PreTransfer: </span><span class="default">$pretransfer_time</span><span class="string"> StartTransfer: </span><span class="default">$starttransfer_time</span><span class="string"> Download: </span><span class="default">$downloadduration</span><span class="string">"</span><span class="keyword">;<br />    </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">$metrics</span><span class="keyword">);  </span><span class="comment">// write to php-fpm default www-error.log, or append it to same log as above with file_put_contents(&lt;filename&gt;, $metrics, FILE_APPEND)<br /></span><span class="default">?&gt;<br /></span><br />Happy debugging</span></code></div>
  </div>
 </div>
  <div class="note" id="121129">  <div class="votes">
    <div id="Vu121129">
    <a href="https://www.php.net/manual/vote-note.php?id=121129&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121129">
    <a href="https://www.php.net/manual/vote-note.php?id=121129&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121129" title="66% like this...">
    18
    </div>
  </div>
  <a href="function.curl-exec.php.html#121129" class="name">
  <strong class="user"><em>turiyag</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#121129"> &para;</a><div class="date" title="2017-05-25 05:07"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121129">
<div class="phpcode"><code><span class="html">Don't disable SSL verification! You don't need to, and it's super easy to stay secure! If you found that turning off "CURLOPT_SSL_VERIFYHOST" and "CURLOPT_SSL_VERIFYPEER" solved your problem, odds are you're just on a Windows box. Takes 2 min to solve the problem. Walkthrough here:<br /><br /><a href="https://snippets.webaware.com.au/howto/stop-turning-off-curlopt_ssl_verifypeer-and-fix-your-php-config/" rel="nofollow" target="_blank">https://snippets.webaware.com.au/howto/stop-turning-off-curlopt_ssl_verifypeer-and-fix-your-php-config/</a></span></code></div>
  </div>
 </div>
  <div class="note" id="70123">  <div class="votes">
    <div id="Vu70123">
    <a href="https://www.php.net/manual/vote-note.php?id=70123&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd70123">
    <a href="https://www.php.net/manual/vote-note.php?id=70123&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V70123" title="65% like this...">
    24
    </div>
  </div>
  <a href="function.curl-exec.php.html#70123" class="name"><strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#70123"> &para;</a><div class="date" title="2006-10-04 01:41"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom70123">
<div class="phpcode"><code><span class="html">Be careful when using curl_exec() and the CURLOPT_RETURNTRANSFER option. According to the manual and assorted documentation:<br />Set CURLOPT_RETURNTRANSFER to TRUE to return the transfer as a string of the return value of curl_exec() instead of outputting it out directly.<br /><br />When retrieving a document with no content (ie. 0 byte file), curl_exec() will return bool(true), not an empty string. I've not seen any mention of this in the manual.<br /><br />Example code to reproduce this:<br /><span class="default">&lt;?php<br /><br />    </span><span class="comment">// fictional URL to an existing file with no data in it (ie. 0 byte file)<br />    </span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a href="http://www.example.com/empty_file.txt" rel="nofollow" target="_blank">http://www.example.com/empty_file.txt</a>'</span><span class="keyword">;<br /><br />    </span><span class="default">$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />    <br />    </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br />    </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />    </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br /><br />    </span><span class="comment">// execute and return string (this should be an empty string '')<br />    </span><span class="default">$str </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br /><br />    </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br /><br />    </span><span class="comment">// the value of $str is actually bool(true), not empty string ''<br />    </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="80442">  <div class="votes">
    <div id="Vu80442">
    <a href="https://www.php.net/manual/vote-note.php?id=80442&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd80442">
    <a href="https://www.php.net/manual/vote-note.php?id=80442&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V80442" title="49% like this...">
    -1
    </div>
  </div>
  <a href="function.curl-exec.php.html#80442" class="name">
  <strong class="user"><em>roman dot ivasyuk at gmail dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#80442"> &para;</a><div class="date" title="2008-01-16 04:11"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom80442">
<div class="phpcode"><code><span class="html"><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">CurlRequest<br /></span><span class="keyword">{<br />    private </span><span class="default">$ch</span><span class="keyword">;<br />    </span><span class="comment">/**<br />     * Init curl session<br />     * <br />     * $params = array('url' =&gt; '',<br />     *                    'host' =&gt; '',<br />     *                   'header' =&gt; '',<br />     *                   'method' =&gt; '',<br />     *                   'referer' =&gt; '',<br />     *                   'cookie' =&gt; '',<br />     *                   'post_fields' =&gt; '',<br />     *                    ['login' =&gt; '',]<br />     *                    ['password' =&gt; '',]      <br />     *                   'timeout' =&gt; 0<br />     *                   );<br />     */                <br />    </span><span class="keyword">public function </span><span class="default">init</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">)<br />    {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />        </span><span class="default">$user_agent </span><span class="keyword">= </span><span class="string">'Mozilla/5.0 (Windows; U; <br />Windows NT 5.1; ru; rv:1.8.0.9) Gecko/20061206 Firefox/1.5.0.9'</span><span class="keyword">;<br />        </span><span class="default">$header </span><span class="keyword">= array(<br />        </span><span class="string">"Accept: text/xml,application/xml,application/xhtml+xml,<br />text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"</span><span class="keyword">,<br />        </span><span class="string">"Accept-Language: ru-ru,ru;q=0.7,en-us;q=0.5,en;q=0.3"</span><span class="keyword">,<br />        </span><span class="string">"Accept-Charset: windows-1251,utf-8;q=0.7,*;q=0.7"</span><span class="keyword">,<br />        </span><span class="string">"Keep-Alive: 300"</span><span class="keyword">);<br />        if (isset(</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">])      </span><span class="default">$header</span><span class="keyword">[]=</span><span class="string">"Host: "</span><span class="keyword">.</span><span class="default">$host</span><span class="keyword">;<br />        if (isset(</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'header'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'header'</span><span class="keyword">]) </span><span class="default">$header</span><span class="keyword">[]=</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'header'</span><span class="keyword">];<br />        <br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER </span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_VERBOSE </span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_HEADER </span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />        <br />        if (</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'method'</span><span class="keyword">] == </span><span class="string">"HEAD"</span><span class="keyword">) @</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">,</span><span class="default">CURLOPT_NOBODY</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$header </span><span class="keyword">);<br />        if (</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'referer'</span><span class="keyword">])    @</span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_REFERER</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'referer'</span><span class="keyword">] );<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="default">$user_agent</span><span class="keyword">);<br />        if (</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'cookie'</span><span class="keyword">])    @</span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_COOKIE</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'cookie'</span><span class="keyword">]);<br /><br />        if ( </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'method'</span><span class="keyword">] == </span><span class="string">"POST" </span><span class="keyword">)<br />        {<br />            </span><span class="default">curl_setopt</span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true </span><span class="keyword">);<br />            </span><span class="default">curl_setopt</span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'post_fields'</span><span class="keyword">] );<br />        }<br />        @</span><span class="default">curl_setopt</span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'url'</span><span class="keyword">]);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br />        if (isset(</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'login'</span><span class="keyword">]) &amp; isset(</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">]))<br />            @</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_USERPWD</span><span class="keyword">,</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'login'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">]);<br />        @</span><span class="default">curl_setopt </span><span class="keyword">( </span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch </span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'timeout'</span><span class="keyword">]);<br />    }<br />    <br />    </span><span class="comment">/**<br />     * Make curl request<br />     *<br />     * @return array  'header','body','curl_error','http_code','last_url'<br />     */<br />    </span><span class="keyword">public function </span><span class="default">exec</span><span class="keyword">()<br />    {<br />        </span><span class="default">$response </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ch</span><span class="keyword">);<br />        </span><span class="default">$error </span><span class="keyword">= </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ch</span><span class="keyword">);<br />        </span><span class="default">$result </span><span class="keyword">= array( </span><span class="string">'header' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">, <br />                         </span><span class="string">'body' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">, <br />                         </span><span class="string">'curl_error' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">, <br />                         </span><span class="string">'http_code' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />                         </span><span class="string">'last_url' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">);<br />        if ( </span><span class="default">$error </span><span class="keyword">!= </span><span class="string">"" </span><span class="keyword">)<br />        {<br />            </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'curl_error'</span><span class="keyword">] = </span><span class="default">$error</span><span class="keyword">;<br />            return </span><span class="default">$result</span><span class="keyword">;<br />        }<br />        <br />        </span><span class="default">$header_size </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ch</span><span class="keyword">,</span><span class="default">CURLINFO_HEADER_SIZE</span><span class="keyword">);<br />        </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'header'</span><span class="keyword">] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$header_size</span><span class="keyword">);<br />        </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'body'</span><span class="keyword">] = </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$response</span><span class="keyword">, </span><span class="default">$header_size </span><span class="keyword">);<br />        </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'http_code'</span><span class="keyword">] = </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">,</span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);<br />        </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'last_url'</span><span class="keyword">] = </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$this </span><span class="keyword">-&gt; </span><span class="default">ch</span><span class="keyword">,</span><span class="default">CURLINFO_EFFECTIVE_URL</span><span class="keyword">);<br />        return </span><span class="default">$result</span><span class="keyword">;<br />    }<br />}<br /></span><span class="default">?&gt;<br /></span><br />Example of use:<br /><span class="default">&lt;?php<br /></span><span class="keyword">..........<br />try<br />        {            <br />            </span><span class="default">$params </span><span class="keyword">= array(</span><span class="string">'url' </span><span class="keyword">=&gt; </span><span class="string">'<a href="http://www.google.com" rel="nofollow" target="_blank">http://www.google.com</a>'</span><span class="keyword">,<br />            </span><span class="string">'host' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />            </span><span class="string">'header' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />            </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'GET'</span><span class="keyword">, </span><span class="comment">// 'POST','HEAD'<br />            </span><span class="string">'referer' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />            </span><span class="string">'cookie' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />            </span><span class="string">'post_fields' </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">, </span><span class="comment">// 'var1=value&amp;var2=value<br />            </span><span class="string">'timeout' </span><span class="keyword">=&gt; </span><span class="default">20<br />            </span><span class="keyword">);<br />            <br />            </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">curl</span><span class="keyword">-&gt;</span><span class="default">init</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br />            </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">curl</span><span class="keyword">-&gt;</span><span class="default">exec</span><span class="keyword">();<br />            if (</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'curl_error'</span><span class="keyword">])    throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'curl_error'</span><span class="keyword">]);<br />            if (</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'http_code'</span><span class="keyword">]!=</span><span class="string">'200'</span><span class="keyword">)    throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"HTTP Code = "</span><span class="keyword">.</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'http_code'</span><span class="keyword">]);<br />            if (!</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'body'</span><span class="keyword">])        throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Body of file is empty"</span><span class="keyword">);<br />            ...............<br />        }<br />        catch (</span><span class="default">Exception $e</span><span class="keyword">)<br />        {<br />                    echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();<br />        }<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="115089">  <div class="votes">
    <div id="Vu115089">
    <a href="https://www.php.net/manual/vote-note.php?id=115089&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115089">
    <a href="https://www.php.net/manual/vote-note.php?id=115089&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115089" title="43% like this...">
    -3
    </div>
  </div>
  <a href="function.curl-exec.php.html#115089" class="name">
  <strong class="user"><em>hablutzel1 at gmail dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#115089"> &para;</a><div class="date" title="2014-05-24 05:04"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom115089">
<div class="phpcode"><code><span class="html">Be always aware that CURLOPT_SSL_VERIFYPEER set to FALSE or 0 should never be used for production as it makes the link inmediately vulnerable to man-in-the-middle attack, still you can use it during development, but I would suggest that only if you KNOW what are you doing, otherwise spend some more time making requests to HTTPS sites work without resorting to set that option to FALSE or 0.</span></code></div>
  </div>
 </div>
  <div class="note" id="31582">  <div class="votes">
    <div id="Vu31582">
    <a href="https://www.php.net/manual/vote-note.php?id=31582&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd31582">
    <a href="https://www.php.net/manual/vote-note.php?id=31582&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V31582" title="44% like this...">
    -3
    </div>
  </div>
  <a href="function.curl-exec.php.html#31582" class="name">
  <strong class="user"><em>nagyp at hunaxon dot hu</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#31582"> &para;</a><div class="date" title="2003-04-26 05:22"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom31582">
<div class="phpcode"><code><span class="html">fyi:<br />It returns false if there's an error while executing the curl session, no matter how CURLOPT_RETURNTRANSFER is set.</span></code></div>
  </div>
 </div>
  <div class="note" id="70198">  <div class="votes">
    <div id="Vu70198">
    <a href="https://www.php.net/manual/vote-note.php?id=70198&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd70198">
    <a href="https://www.php.net/manual/vote-note.php?id=70198&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V70198" title="40% like this...">
    -4
    </div>
  </div>
  <a href="function.curl-exec.php.html#70198" class="name">
  <strong class="user"><em>lukasl at ackleymedia dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#70198"> &para;</a><div class="date" title="2006-10-06 07:52"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom70198">
<div class="phpcode"><code><span class="html">Thank you for sharing this.  I was wondering why my result was 1.<br /><br />To get around this in a safe way, this is how I check if the result is valid.<br /><br />$ch = curl_init(); /// initialize a cURL session <br />curl_setopt ($ch, CURLOPT_RETURNTRANSFER, true);<br />$xmlResponse = curl_exec ($ch);<br />curl_close ($ch);<br /><br />if (!is_string($xmlResponse) || !strlen($xmlResponse)) {<br />    return $this-&gt;_set_error( "Failure Contacting Server" );<br />} else {<br />    return $xmlResponse;<br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="119059">  <div class="votes">
    <div id="Vu119059">
    <a href="https://www.php.net/manual/vote-note.php?id=119059&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd119059">
    <a href="https://www.php.net/manual/vote-note.php?id=119059&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V119059" title="39% like this...">
    -14
    </div>
  </div>
  <a href="function.curl-exec.php.html#119059" class="name">
  <strong class="user"><em>bimal at sanjaal dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#119059"> &para;</a><div class="date" title="2016-03-26 07:33"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom119059">
<div class="phpcode"><code><span class="html">If you are accessing HTTPS URLs and you do not receive any contents, try to disable verifying SSL.<br /><br /><span class="default">&lt;?php<br />curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br /></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="83676">  <div class="votes">
    <div id="Vu83676">
    <a href="https://www.php.net/manual/vote-note.php?id=83676&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83676">
    <a href="https://www.php.net/manual/vote-note.php?id=83676&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83676" title="37% like this...">
    -8
    </div>
  </div>
  <a href="function.curl-exec.php.html#83676" class="name">
  <strong class="user"><em>alan at forsyth dot cz</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#83676"> &para;</a><div class="date" title="2008-06-06 03:59"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83676">
<div class="phpcode"><code><span class="html">Great class Roman - just one fix:<br /><br />Replace the following line:<br /><span class="default">&lt;?php<br /></span><span class="keyword">if (isset(</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">])      </span><span class="default">$header</span><span class="keyword">[]=</span><span class="string">"Host: "</span><span class="keyword">.</span><span class="default">$host</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span><br />with this:<br /><span class="default">&lt;?php<br /></span><span class="keyword">if (isset(</span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">])      </span><span class="default">$header</span><span class="keyword">[]=</span><span class="string">"Host: " </span><span class="keyword">. </span><span class="default">$params</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">];<br /></span><span class="default">?&gt;<br /></span><br />CURL automatically creates the host parameter (since it is required for HTTP/1.1 requests), so you don't need to set it. But if you created a custom host parameter, the above bug would cause a '400 Bad Request' response due to invalid host specified.<br /><br />Also when copying and pasting the class code, make sure that no line breaks occur (for example in the $header and $user_agent definitions etc.). It will still be valid PHP, but the HTTP request will not be valid, and you may get a '400 Bad Request' response from the server.<br /><br />It took me a little playing around with an HTTP Sniffer before I finally got an HTTP POST request fully working!<br /><br />Thanks,<br />Alan</span></code></div>
  </div>
 </div>
  <div class="note" id="125517">  <div class="votes">
    <div id="Vu125517">
    <a href="https://www.php.net/manual/vote-note.php?id=125517&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125517">
    <a href="https://www.php.net/manual/vote-note.php?id=125517&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125517" title="33% like this...">
    -3
    </div>
  </div>
  <a href="function.curl-exec.php.html#125517" class="name">
  <strong class="user"><em>Roland</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#125517"> &para;</a><div class="date" title="2020-11-16 05:55"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom125517">
<div class="phpcode"><code><span class="html">To check for a timeout or error - <br /><br /> if (!$responsexml || !is_string($responsexml) || !strlen($responsexml) || strpos($responsexml, 'upstream request timeout') !== false) {<br />            return $this-&gt;sendRequest($request, $headers);<br />        }</span></code></div>
  </div>
 </div>
  <div class="note" id="19497">  <div class="votes">
    <div id="Vu19497">
    <a href="https://www.php.net/manual/vote-note.php?id=19497&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd19497">
    <a href="https://www.php.net/manual/vote-note.php?id=19497&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V19497" title="35% like this...">
    -9
    </div>
  </div>
  <a href="function.curl-exec.php.html#19497" class="name">
  <strong class="user"><em>ppruett at webengr dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#19497"> &para;</a><div class="date" title="2002-02-28 07:06"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom19497">
<div class="phpcode"><code><span class="html">fyi - if you are having problems getting a<br />webpage to display in your webpage with <br />curl_setopt(CURLOPT_RETURNTRANSFER, 1);<br />due to version bugginess perhaps, <br />you may can use output control functions<br />like this to show a web page<br />inside your webpage:<br /><br />&lt;html&gt;&lt;head&gt;&lt;title&gt;whatever&lt;/title&gt;&lt;/head&gt;<br />&lt;body&gt;<br />&lt;script language="php"&gt;<br />$ch = curl_init("<a href="http://www.cocoavillage.com/" rel="nofollow" target="_blank">http://www.cocoavillage.com/</a>");<br />// use output buffering instead of returntransfer -itmaybebuggy<br />ob_start();<br />curl_exec($ch); <br />curl_close($ch); <br />$retrievedhtml = ob_get_contents();<br />ob_end_clean();<br />// if you intend to print this page with meta tags, better clear out any expiration tag<br />//    $result = preg_replace('/(?s)&lt;meta http-equiv="Expires"[^&gt;]*&gt;/i', '', $retrievedhtml);<br />// for now I just want what is between the body tags so need<br />// somehow cut the header footer     <br />$bodyandend = stristr($retrievedhtml,"&lt;body");<br />// not needed- $positionstartbodystring = strlen($retrievedhtml)-strlen($bodyandend);<br />$positionendstartbodytag = strpos($bodyandend,"&gt;") + 1;<br />// got to change all to lowercase temporarily <br />// because end body may be upperlowercasemix<br />// to bad strirstr does not exist<br />$temptofindposition=strtolower($bodyandend);<br />$positionendendbodytag=strpos($temptofindposition,"&lt;/body");<br />//now to get the endbetween body tags<br />$grabbedbody=substr($bodyandend,<br />     $positionendstartbodytag,<br />           $positionendendbodytag); <br />//be sure to fix syntax broke by display on phpwebsite... like above line<br />print("$grabbedbody");<br />&lt;/script&gt;<br />&lt;/body&gt;&lt;/html&gt;<br /><br />tada</span></code></div>
  </div>
 </div>
  <div class="note" id="109653">  <div class="votes">
    <div id="Vu109653">
    <a href="https://www.php.net/manual/vote-note.php?id=109653&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd109653">
    <a href="https://www.php.net/manual/vote-note.php?id=109653&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V109653" title="32% like this...">
    -12
    </div>
  </div>
  <a href="function.curl-exec.php.html#109653" class="name">
  <strong class="user"><em>bertram dot pereira at gmail dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#109653"> &para;</a><div class="date" title="2012-08-05 11:48"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom109653">
<div class="phpcode"><code><span class="html">There will be times when you need to get the response from curl_exec and capture the transfer - this is not very well documented but you can do so with the CURLOPT_RETURNTRANSFER Option <br /><br />curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); <br /><br />Bert</span></code></div>
  </div>
 </div>
  <div class="note" id="50734">  <div class="votes">
    <div id="Vu50734">
    <a href="https://www.php.net/manual/vote-note.php?id=50734&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd50734">
    <a href="https://www.php.net/manual/vote-note.php?id=50734&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V50734" title="28% like this...">
    -6
    </div>
  </div>
  <a href="function.curl-exec.php.html#50734" class="name">
  <strong class="user"><em>J?rgen Tjern?</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#50734"> &para;</a><div class="date" title="2005-03-08 06:12"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom50734">
<div class="phpcode"><code><span class="html">If you've got problems with curl_exec not working, you should rather check curl_errno and curl_error than using commandline curl, like so:<br /><br />(since this is easier, and also allows you to check for errors runtime, which is a vital part of any well-design piece of code. ;)<br /><br /><span class="default">&lt;?php<br />$creq </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br /></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$creq</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"<a href="http://www.foo.internal" rel="nofollow" target="_blank">http://www.foo.internal</a>"</span><span class="keyword">);<br /></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$creq</span><span class="keyword">);<br /><br /></span><span class="comment">/* To quote curl_errno documentation:<br />     Returns the error number for the last cURL operation on the resource ch, or 0 (zero) if no error occurred. */<br /></span><span class="keyword">if (</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$creq</span><span class="keyword">)) {<br />    print </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$creq</span><span class="keyword">);<br />} else {<br />    </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$creq</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="77058">  <div class="votes">
    <div id="Vu77058">
    <a href="https://www.php.net/manual/vote-note.php?id=77058&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd77058">
    <a href="https://www.php.net/manual/vote-note.php?id=77058&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V77058" title="27% like this...">
    -8
    </div>
  </div>
  <a href="function.curl-exec.php.html#77058" class="name">
  <strong class="user"><em>test at test dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#77058"> &para;</a><div class="date" title="2007-08-13 06:43"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom77058">
<div class="phpcode"><code><span class="html">If you see a "0" at the end of the output, you might want to switch to HTTP/1.0:<br /><br />curl_setopt($ch, CURLOPT_HTTP_VERSION, 1.0);</span></code></div>
  </div>
 </div>
  <div class="note" id="13020">  <div class="votes">
    <div id="Vu13020">
    <a href="https://www.php.net/manual/vote-note.php?id=13020&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd13020">
    <a href="https://www.php.net/manual/vote-note.php?id=13020&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V13020" title="28% like this...">
    -9
    </div>
  </div>
  <a href="function.curl-exec.php.html#13020" class="name">
  <strong class="user"><em>csaba at alum dot mit dot edu</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#13020"> &para;</a><div class="date" title="2001-05-22 01:06"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom13020">
<div class="phpcode"><code><span class="html">If you retrieve a web page and print it (so you can see it in your browser), and the page has an expiration, this expiration now applies to MyProgram.php and next time your program/page is called, even if it's grabbing a different web page, it will show what it just displayed.  In Netscape you can get rid of this by going into Edit, Options, Advanced, Cache, and clear out the Disk Cache.  But this is really annoying after short order.  The following prevents the above scenario:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">GetCurlPage </span><span class="keyword">(</span><span class="default">$pageSpec</span><span class="keyword">) {<br />    </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$pageSpec</span><span class="keyword">);<br />    </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />    </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); <br />    </span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); <br /></span><span class="comment">// if you intend to print this page, better clear out expiration tag<br />    </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(?s)&lt;meta http-equiv="Expires"[^&gt;]*&gt;/i'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$tmp</span><span class="keyword">);<br />    return </span><span class="default">$tmp</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="92580">  <div class="votes">
    <div id="Vu92580">
    <a href="https://www.php.net/manual/vote-note.php?id=92580&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd92580">
    <a href="https://www.php.net/manual/vote-note.php?id=92580&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V92580" title="26% like this...">
    -9
    </div>
  </div>
  <a href="function.curl-exec.php.html#92580" class="name">
  <strong class="user"><em>petermiller1986[nospam] at gmail dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#92580"> &para;</a><div class="date" title="2009-07-30 01:57"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom92580">
<div class="phpcode"><code><span class="html">so far i have not come across any code or library file that will<br />extract cookie information from a http header, so i've written<br />one.<br /><br />there are two files:<br />file1.php - acts as server and sets the cookies<br />file2.php - acts as browser and retrieves the cookies set by file1<br /><br />/*****file1.php****/<br /><span class="default">&lt;?php<br /></span><span class="comment">/*set 3 cookies at the end of the execution of this script*/<br /><br /></span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"cookie1"</span><span class="keyword">,</span><span class="string">"cookie 1 data"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() - </span><span class="default">123123</span><span class="keyword">);<br /></span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"cookie2"</span><span class="keyword">,</span><span class="string">"cookie 2 data"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() + </span><span class="default">54326</span><span class="keyword">);<br /></span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">"cookie3"</span><span class="keyword">,</span><span class="string">"cookie 3 data"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">());<br /></span><span class="default">?&gt;<br /></span>/****end file1.php**/<br /><br />/*****file2.php****/<br /><span class="default">&lt;?php<br />$url </span><span class="keyword">= </span><span class="string">"<a href="http://[host][uri]/file1.php" rel="nofollow" target="_blank">http://[host][uri]/file1.php</a>"</span><span class="keyword">; </span><span class="comment">/*insert desired host and<br />uri*/<br /></span><span class="default">$browser_id </span><span class="keyword">= </span><span class="string">"some crazy browser"</span><span class="keyword">;<br /></span><span class="default">$curl_handle </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br /></span><span class="default">$options </span><span class="keyword">= array<br />(<br />    </span><span class="default">CURLOPT_URL</span><span class="keyword">=&gt;</span><span class="default">$url</span><span class="keyword">,<br />    </span><span class="default">CURLOPT_HEADER</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,<br />    </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,<br />    </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,<br />    </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">=&gt;</span><span class="default">$browser_id<br /></span><span class="keyword">);<br /></span><span class="default">curl_setopt_array</span><span class="keyword">(</span><span class="default">$curl_handle</span><span class="keyword">,</span><span class="default">$options</span><span class="keyword">);<br /></span><span class="default">$server_output </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl_handle</span><span class="keyword">);<br /></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl_handle</span><span class="keyword">);<br /><br /></span><span class="comment">/*construct the http search pattern for cookies*/<br /></span><span class="default">$pattern  </span><span class="keyword">= </span><span class="string">"/Set-Cookie:"</span><span class="keyword">;<br /></span><span class="default">$pattern </span><span class="keyword">.= </span><span class="string">"(?P&lt;name&gt;.*?)=(?P&lt;value&gt;.*?); "</span><span class="keyword">;<br /></span><span class="default">$pattern </span><span class="keyword">.= </span><span class="string">"expires=(?P&lt;expiry_dayname&gt;\w+), "</span><span class="keyword">;<br /></span><span class="default">$pattern </span><span class="keyword">.= </span><span class="string">"(?P&lt;expiry_day&gt;\d+)-<br />(?P&lt;expiry_month&gt;\w+)-(?P&lt;expiry_year&gt;\d+) "</span><span class="keyword">;<br /></span><span class="default">$pattern </span><span class="keyword">.= </span><span class="string">"(?P&lt;expiry_hour&gt;\d+):<br />(?P&lt;expiry_minute&gt;\d+):(?P&lt;expiry_second&gt;\d+) "</span><span class="keyword">;<br /></span><span class="default">$pattern </span><span class="keyword">.= </span><span class="string">"(?P&lt;expiry_zone&gt;\w+)/"</span><span class="keyword">;<br /></span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$server_output</span><span class="keyword">,</span><span class="default">$matches</span><span class="keyword">);<br /><br /></span><span class="default">$table_string </span><span class="keyword">= </span><span class="string">"<br />&lt;h1&gt;cookie information table&lt;/h1&gt;<br />&lt;table border='1'&gt;<br />    &lt;tr&gt;<br />        &lt;td&gt;cookie name&lt;/td&gt;<br />        &lt;td&gt;value&lt;/td&gt;<br />        &lt;td&gt;expiry day&lt;/td&gt;<br />        &lt;td&gt;expiry date&lt;/td&gt;<br />        &lt;td&gt;expiry time&lt;/td&gt;<br />        &lt;td&gt;expiry timezone&lt;/td&gt;<br />    &lt;/tr&gt;<br />"</span><span class="keyword">;<br /></span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />foreach(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">name</span><span class="keyword">] as </span><span class="default">$cookie_name</span><span class="keyword">)<br />{<br />    </span><span class="default">$table_string </span><span class="keyword">.= </span><span class="string">"<br />    &lt;tr&gt;<br />        &lt;td&gt;</span><span class="default">$cookie_name</span><span class="string">&lt;/td&gt;<br /><br />        &lt;td&gt;</span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">value</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br /><br />        &lt;td&gt;</span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_dayname</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br /><br />        &lt;td&gt;</span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_day</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">-<br />        </span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_month</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">-<br />        </span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_year</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br /><br />        &lt;td&gt;</span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_hour</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">:<br />        </span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_minute</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">:<br />        </span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_second</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br /><br />        &lt;td&gt;</span><span class="keyword">{</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">expiry_zone</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;<br />    &lt;/tr&gt;<br />    "</span><span class="keyword">;<br />    </span><span class="default">$i</span><span class="keyword">++;<br />}<br /></span><span class="default">$table_string </span><span class="keyword">.= </span><span class="string">"&lt;/table&gt;"</span><span class="keyword">;<br />echo </span><span class="default">$table_string</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span>/****end file2.php**/<br /><br />i based this code on the following http header:<br />(obtained by going: echo $server_output; in file2.php)<br /><br />HTTP/1.1 200 OK Date: Thu, 30 Jul 2009 07:10:07 GMT<br />Server: Apache/2.2.11 (Win32) DAV/2 mod_ssl/2.2.11<br />OpenSSL/0.9.8i PHP/5.2.9 X-Powered-By: PHP/5.2.9<br />Set-Cookie: cookie1=cookie+1+data; expires=Wed,<br />29-Jul-2009 03:23:27 GMT Set-Cookie<br />cookie2=cookie+2+data; expires=Wed, 29-Jul-2009 03:23:27<br />GMT Set-Cookie: cookie3=cookie+3+data; expires=Wed,<br />29-Jul-2009 03:23:27 GMT Content-Length: 196<br />Content-Type: text/html<br /><br />if your header differs from this one then $pattern in file2.php<br />will need to be modified accordingly. hopefully this code will save<br />you a lot of time though!</span></code></div>
  </div>
 </div>
  <div class="note" id="79572">  <div class="votes">
    <div id="Vu79572">
    <a href="https://www.php.net/manual/vote-note.php?id=79572&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd79572">
    <a href="https://www.php.net/manual/vote-note.php?id=79572&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V79572" title="23% like this...">
    -7
    </div>
  </div>
  <a href="function.curl-exec.php.html#79572" class="name">
  <strong class="user"><em>me at lawrencemok dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#79572"> &para;</a><div class="date" title="2007-12-03 11:52"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom79572">
<div class="phpcode"><code><span class="html">Note that when you use CURL to POST things....e.g:<br /><br />curl_setopt($ch, CURLOPT_POSTFIELDS, "string=This is a string"); <br /><br />The data part (e.g. "This is a string") inside the 3rd parameter should be applied with urlencode()<br /><br />Otherwise, if you intend to send a string like "%2F", you will end up with a "/" on the receiving end, which can cause troubles. (e.g. serialize() data cannot be unserialize() becase of the change in string length).</span></code></div>
  </div>
 </div>
  <div class="note" id="84774">  <div class="votes">
    <div id="Vu84774">
    <a href="https://www.php.net/manual/vote-note.php?id=84774&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd84774">
    <a href="https://www.php.net/manual/vote-note.php?id=84774&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V84774" title="23% like this...">
    -9
    </div>
  </div>
  <a href="function.curl-exec.php.html#84774" class="name">
  <strong class="user"><em>lmshad at wp dot pl dot foo dot bar</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#84774"> &para;</a><div class="date" title="2008-07-29 10:14"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom84774">
<div class="phpcode"><code><span class="html">example:<br />   echo CurlTool::fetchContent('www.onet.pl');<br />   CurlTool::downloadFile('<a href="http://download.gadu-gadu.pl/gg77.exe" rel="nofollow" target="_blank">http://download.gadu-gadu.pl/gg77.exe</a>', 'c:/');<br /><br /><span class="default">&lt;?php<br />error_reporting</span><span class="keyword">(</span><span class="default">E_STRICT </span><span class="keyword">| </span><span class="default">E_ALL</span><span class="keyword">);<br />class </span><span class="default">CurlTool </span><span class="keyword">{<br />    public static </span><span class="default">$userAgents </span><span class="keyword">= array(<br />        </span><span class="string">'FireFox3' </span><span class="keyword">=&gt; </span><span class="string">'Mozilla/5.0 (Windows; U; Windows NT 5.1; pl; rv:1.9) Gecko/2008052906 Firefox/3.0'</span><span class="keyword">,<br />        </span><span class="string">'GoogleBot' </span><span class="keyword">=&gt; </span><span class="string">'Mozilla/5.0 (compatible; Googlebot/2.1; +<a href="http://www.google.com/bot.html" rel="nofollow" target="_blank">http://www.google.com/bot.html</a>)'</span><span class="keyword">,<br />        </span><span class="string">'IE7' </span><span class="keyword">=&gt; </span><span class="string">'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'</span><span class="keyword">,<br />        </span><span class="string">'Netscape' </span><span class="keyword">=&gt; </span><span class="string">'Mozilla/4.8 [en] (Windows NT 6.0; U)'</span><span class="keyword">,<br />        </span><span class="string">'Opera' </span><span class="keyword">=&gt; </span><span class="string">'Opera/9.25 (Windows NT 6.0; U; en)'<br />        </span><span class="keyword">); <br />    public static </span><span class="default">$options </span><span class="keyword">= array(<br />        </span><span class="default">CURLOPT_USERAGENT </span><span class="keyword">=&gt; </span><span class="string">'Mozilla/5.0 (Windows; U; Windows NT 5.1; pl; rv:1.9) Gecko/2008052906 Firefox/3.0'</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_AUTOREFERER </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_COOKIEFILE </span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />        </span><span class="default">CURLOPT_FOLLOWLOCATION </span><span class="keyword">=&gt; </span><span class="default">true<br />        </span><span class="keyword">);<br />            <br />    private static </span><span class="default">$proxyServers </span><span class="keyword">= array();<br />    private static </span><span class="default">$proxyCount </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />    private static </span><span class="default">$currentProxyIndex </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />        <br />    public static function </span><span class="default">addProxyServer</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />        </span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyServers</span><span class="keyword">[] = </span><span class="default">$url</span><span class="keyword">;<br />        ++</span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyCount</span><span class="keyword">;    <br />    }<br />    <br />    public static function </span><span class="default">fetchContent</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$verbose </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />        if ((</span><span class="default">$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)) == </span><span class="default">false</span><span class="keyword">) {<br />            throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"curl_init error for url </span><span class="default">$url</span><span class="string">."</span><span class="keyword">);<br />        }<br />        <br />        if (</span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyCount </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />            </span><span class="default">$proxy </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyServers</span><span class="keyword">[</span><span class="default">self</span><span class="keyword">::</span><span class="default">$currentProxyIndex</span><span class="keyword">++ % </span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyCount</span><span class="keyword">];<br />            </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_PROXY</span><span class="keyword">, </span><span class="default">$proxy</span><span class="keyword">);<br />            if (</span><span class="default">$verbose </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />                echo </span><span class="string">"Reading </span><span class="default">$url</span><span class="string"> [Proxy: </span><span class="default">$proxy</span><span class="string">] ... "</span><span class="keyword">;<br />            }<br />        } else if (</span><span class="default">$verbose </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />            echo </span><span class="string">"Reading </span><span class="default">$url</span><span class="string"> ... "</span><span class="keyword">;    <br />        }<br />        <br />        </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />        </span><span class="default">curl_setopt_array</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">self</span><span class="keyword">::</span><span class="default">$options</span><span class="keyword">);<br />                <br />        </span><span class="default">$content </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br />        if (</span><span class="default">$content </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />            throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"curl_exec error for url </span><span class="default">$url</span><span class="string">."</span><span class="keyword">);<br />        }<br />        <br />        </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br />        if (</span><span class="default">$verbose </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />            echo </span><span class="string">"Done.\n"</span><span class="keyword">;<br />        }<br />        <br />        </span><span class="default">$content </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#\n+#'</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">);<br />        </span><span class="default">$content </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#\s+#'</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">);<br />        <br />        return </span><span class="default">$content</span><span class="keyword">;<br />    }<br />    <br />    public static function </span><span class="default">downloadFile</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">$verbose </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />        if ((</span><span class="default">$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)) == </span><span class="default">false</span><span class="keyword">) {<br />            throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"curl_init error for url </span><span class="default">$url</span><span class="string">."</span><span class="keyword">);<br />        }<br />        <br />        if (</span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyCount </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />            </span><span class="default">$proxy </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyServers</span><span class="keyword">[</span><span class="default">self</span><span class="keyword">::</span><span class="default">$currentProxyIndex</span><span class="keyword">++ % </span><span class="default">self</span><span class="keyword">::</span><span class="default">$proxyCount</span><span class="keyword">];<br />            </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_PROXY</span><span class="keyword">, </span><span class="default">$proxy</span><span class="keyword">);<br />            if (</span><span class="default">$verbose </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />                echo </span><span class="string">"Downloading </span><span class="default">$url</span><span class="string"> [Proxy: </span><span class="default">$proxy</span><span class="string">] ... "</span><span class="keyword">;<br />            }<br />        } else if (</span><span class="default">$verbose </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />            echo </span><span class="string">"Downloading </span><span class="default">$url</span><span class="string"> ... "</span><span class="keyword">;    <br />        }<br />        <br />        </span><span class="default">curl_setopt_array</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">self</span><span class="keyword">::</span><span class="default">$options</span><span class="keyword">);<br />        <br />        if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) == </span><span class="string">'/'</span><span class="keyword">) {<br />            </span><span class="default">$targetDir </span><span class="keyword">= </span><span class="default">$fileName</span><span class="keyword">;<br />            </span><span class="default">$fileName </span><span class="keyword">= </span><span class="default">tempnam</span><span class="keyword">(</span><span class="default">sys_get_temp_dir</span><span class="keyword">(), </span><span class="string">'c_'</span><span class="keyword">);<br />        }<br />        if ((</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">"wb"</span><span class="keyword">)) === </span><span class="default">false</span><span class="keyword">) {<br />            throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"fopen error for filename </span><span class="default">$fileName</span><span class="string">"</span><span class="keyword">);<br />        }<br />        </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fp</span><span class="keyword">);<br />        <br />        </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_BINARYTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />        if (</span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">) {<br />            </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />            </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">);<br />            throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"curl_exec error for url </span><span class="default">$url</span><span class="string">."</span><span class="keyword">);<br />        } elseif (isset(</span><span class="default">$targetDir</span><span class="keyword">)) {<br />            </span><span class="default">$eurl </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLINFO_EFFECTIVE_URL</span><span class="keyword">);<br />            </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'#^.*/(.+)$#'</span><span class="keyword">, </span><span class="default">$eurl</span><span class="keyword">, </span><span class="default">$match</span><span class="keyword">);<br />            </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />            </span><span class="default">rename</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">"</span><span class="default">$targetDir</span><span class="keyword">{</span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">);<br />            </span><span class="default">$fileName </span><span class="keyword">= </span><span class="string">"</span><span class="default">$targetDir</span><span class="keyword">{</span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">;<br />        } else {<br />            </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />        }<br />        <br />        </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br />        if (</span><span class="default">$verbose </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />            echo </span><span class="string">"Done.\n"</span><span class="keyword">;<br />        }<br />        return </span><span class="default">$fileName</span><span class="keyword">;<br />    }    <br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="96174">  <div class="votes">
    <div id="Vu96174">
    <a href="https://www.php.net/manual/vote-note.php?id=96174&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd96174">
    <a href="https://www.php.net/manual/vote-note.php?id=96174&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V96174" title="22% like this...">
    -10
    </div>
  </div>
  <a href="function.curl-exec.php.html#96174" class="name">
  <strong class="user"><em>ivanargulo at  NOSPAM gmail dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#96174"> &para;</a><div class="date" title="2010-02-12 03:41"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom96174">
<div class="phpcode"><code><span class="html">If having problems with special chars or entities (like á, ä, à, etc.), using the ISO encode, just decode the values given with the function utf8_decode().<br /><br />For example:<br /><br />The returned string is the following:<br /><br />&lt;xml&gt;&lt;name&gt;IvÃ¡n&lt;/name&gt;&lt;/xml&gt;<br /><br />Using utf8_decode, the result in ISO is<br /><br />&lt;xml&gt;&lt;name&gt;Iván&lt;/name&gt;&lt;/xml&gt;</span></code></div>
  </div>
 </div>
  <div class="note" id="20998">  <div class="votes">
    <div id="Vu20998">
    <a href="https://www.php.net/manual/vote-note.php?id=20998&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd20998">
    <a href="https://www.php.net/manual/vote-note.php?id=20998&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V20998" title="23% like this...">
    -11
    </div>
  </div>
  <a href="function.curl-exec.php.html#20998" class="name">
  <strong class="user"><em>colins at infofind dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#20998"> &para;</a><div class="date" title="2002-04-24 04:42"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom20998">
<div class="phpcode"><code><span class="html">Checking the source, curl_exec seems to return FALSE on failure, TRUE on success (unless CURLOPT_RETURNTRANSFER is set 1, and then it returns the returned data).</span></code></div>
  </div>
 </div>
  <div class="note" id="113876">  <div class="votes">
    <div id="Vu113876">
    <a href="https://www.php.net/manual/vote-note.php?id=113876&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113876">
    <a href="https://www.php.net/manual/vote-note.php?id=113876&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113876" title="18% like this...">
    -10
    </div>
  </div>
  <a href="function.curl-exec.php.html#113876" class="name">
  <strong class="user"><em>Manu Manjunath</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#113876"> &para;</a><div class="date" title="2013-12-12 01:24"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113876">
<div class="phpcode"><code><span class="html">If you want to get contents of a page through HTTP GET or POST,  you can write a small function like below.<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">/**<br /> * Read entire contents of a URL in a string<br /> * @param string $url URL to fetch data from<br /> * @param mixed $params Parameters to the URL, typically an array. In case of POST, can be a string<br /> * @param string $method HTTP method - can be 'GET' (default) or 'POST'<br /> * @return mixed Contents of the webpage. Returns &lt;i&gt;false&lt;/i&gt; in case of failure.<br /> */<br /></span><span class="keyword">function </span><span class="default">url_get_contents</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$params </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$method </span><span class="keyword">= </span><span class="string">'GET'</span><span class="keyword">) {<br />    </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />    if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, array(</span><span class="string">'GET'</span><span class="keyword">, </span><span class="string">'POST'</span><span class="keyword">))) {<br />        </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">": Unknown method '</span><span class="default">$method</span><span class="string">'"</span><span class="keyword">);<br />        return </span><span class="default">false</span><span class="keyword">;<br />    }<br />    if (</span><span class="default">$method </span><span class="keyword">== </span><span class="string">'GET'</span><span class="keyword">) {<br />        if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />            if (</span><span class="default">$params </span><span class="keyword">=== </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">)) {<br />                </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">": Numerical array recieved for argument '\$params' (assoc array expected)"</span><span class="keyword">);<br />                return </span><span class="default">false</span><span class="keyword">;<br />            }<br />            else {<br />                </span><span class="default">$url </span><span class="keyword">.= </span><span class="string">'?' </span><span class="keyword">. </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br />            }<br />        }<br />        elseif (!</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">)) {<br />            </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">": If you're making a GET request, argument \$params must be null or assoc array."</span><span class="keyword">);<br />            return </span><span class="default">false</span><span class="keyword">;<br />        }<br />    }<br />    </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />    if (</span><span class="default">$ch </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br />        </span><span class="default">curl_setopt_array</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, array(<br />            </span><span class="default">CURLOPT_HEADER </span><span class="keyword">=&gt; </span><span class="default">false</span><span class="keyword">,<br />            </span><span class="default">CURLOPT_RETURNTRANSFER </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,<br />        ));<br />        if (</span><span class="default">$method </span><span class="keyword">== </span><span class="string">'POST'</span><span class="keyword">) {<br />            </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />            if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) || </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">)) {<br />                </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">);<br />            }<br />            else {<br />                </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">__FUNCTION__ </span><span class="keyword">. </span><span class="string">": Argument \$params should be an array of parameters or (if you want to send raw data) a string"</span><span class="keyword">);<br />                return </span><span class="default">false</span><span class="keyword">;<br />            }<br />        }<br />        </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />        </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />    }<br />    return </span><span class="default">$contents</span><span class="keyword">;<br />}</span></span></code></div>
  </div>
 </div>
  <div class="note" id="102396">  <div class="votes">
    <div id="Vu102396">
    <a href="https://www.php.net/manual/vote-note.php?id=102396&amp;page=function.curl-exec&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd102396">
    <a href="https://www.php.net/manual/vote-note.php?id=102396&amp;page=function.curl-exec&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V102396" title="16% like this...">
    -8
    </div>
  </div>
  <a href="function.curl-exec.php.html#102396" class="name">
  <strong class="user"><em>tolas777 at gmail dot com</em></strong></a><a class="genanchor" href="function.curl-exec.php.html#102396"> &para;</a><div class="date" title="2011-02-11 08:27"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom102396">
<div class="phpcode"><code><span class="html">I was having a problem, for almost a week, of curl_exec() freezing/hanging when I made a request with it to a page that spends over an hour converting a large video file, and only afterwards sends control-data back to the calling script.<br /><br />I'm using windows 7, WampServer-2.1d-64.exe, PHP 5.3.4, libcurl-7.21.3.<br /><br />Here's the final solution;<br /><br />On Fri, Feb 11, 2011 at 1:32 PM, Daniel Stenberg &lt;daniel-of-haxx.se&gt; wrote:<br />&gt; On Fri, 11 Feb 2011, Tolas Anon wrote:<br />&gt;<br />&gt;&gt;&gt; It is also very easy for an application to enable the options as I've<br />&gt;&gt;&gt; shown.<br />&gt;&gt;<br />&gt;&gt; Just not for the platforms i use, apparently.. :(<br />&gt;<br />&gt; Why not? A quick search for "tcp keepalive windows" shows this:<br />&gt; <a href="http://msdn.microsoft.com/en-us/library/ms819735.aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/ms819735.aspx</a><br /><br />This fixed my problem in the simple test AND in my application!<br />No need to send keep-alive bytes on the text/html level either.<br /><br />I just added the "KeepAliveTime" setting with windows 7 regedit.exe in<br />HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/services/Tcpip, as a<br />REG_DWORD value, set it to decimal 25000 (so 25 seconds), rebooted,<br />and it all works as i want it now..<br /><br />Note that windows registry entries key names are case-sensitive, wrong<br />casing and they'll be deleted on restart.<br /><br />Lots of thanks, Daniel. I would've never solved this on my own..<br /><br />------------------------------------------------------<br />(now useless) details at:<br /><br /><a href="http://curl.haxx.se/mail/lib-2011-02/0101.html" rel="nofollow" target="_blank">http://curl.haxx.se/mail/lib-2011-02/0101.html</a><br /><br /><a href="http://readlist.com/lists/lists.php.net/php-general/16/81195.html" rel="nofollow" target="_blank">http://readlist.com/lists/lists.php.net/php-general/16/81195.html</a></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.curl-exec&amp;redirect=https://www.php.net/manual/ru/function.curl-exec.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.curl.php.html">Функции cURL</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.curl-close.php.html" title="curl_&#8203;close">curl_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-copy-handle.php.html" title="curl_&#8203;copy_&#8203;handle">curl_&#8203;copy_&#8203;handle</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-errno.php.html" title="curl_&#8203;errno">curl_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-error.php.html" title="curl_&#8203;error">curl_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-escape.php.html" title="curl_&#8203;escape">curl_&#8203;escape</a>
                        </li>
                                                <li class="current">
                            <a href="function.curl-exec.php.html" title="curl_&#8203;exec">curl_&#8203;exec</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-getinfo.php.html" title="curl_&#8203;getinfo">curl_&#8203;getinfo</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-init.php.html" title="curl_&#8203;init">curl_&#8203;init</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-add-handle.php.html" title="curl_&#8203;multi_&#8203;add_&#8203;handle">curl_&#8203;multi_&#8203;add_&#8203;handle</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-close.php.html" title="curl_&#8203;multi_&#8203;close">curl_&#8203;multi_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-errno.php.html" title="curl_&#8203;multi_&#8203;errno">curl_&#8203;multi_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-exec.php.html" title="curl_&#8203;multi_&#8203;exec">curl_&#8203;multi_&#8203;exec</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-getcontent.php.html" title="curl_&#8203;multi_&#8203;getcontent">curl_&#8203;multi_&#8203;getcontent</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-info-read.php.html" title="curl_&#8203;multi_&#8203;info_&#8203;read">curl_&#8203;multi_&#8203;info_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-init.php.html" title="curl_&#8203;multi_&#8203;init">curl_&#8203;multi_&#8203;init</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-remove-handle.php.html" title="curl_&#8203;multi_&#8203;remove_&#8203;handle">curl_&#8203;multi_&#8203;remove_&#8203;handle</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-select.php.html" title="curl_&#8203;multi_&#8203;select">curl_&#8203;multi_&#8203;select</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-setopt.php.html" title="curl_&#8203;multi_&#8203;setopt">curl_&#8203;multi_&#8203;setopt</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-multi-strerror.php.html" title="curl_&#8203;multi_&#8203;strerror">curl_&#8203;multi_&#8203;strerror</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-pause.php.html" title="curl_&#8203;pause">curl_&#8203;pause</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-reset.php.html" title="curl_&#8203;reset">curl_&#8203;reset</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-setopt-array.php.html" title="curl_&#8203;setopt_&#8203;array">curl_&#8203;setopt_&#8203;array</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-setopt.php.html" title="curl_&#8203;setopt">curl_&#8203;setopt</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-share-close.php.html" title="curl_&#8203;share_&#8203;close">curl_&#8203;share_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-share-errno.php.html" title="curl_&#8203;share_&#8203;errno">curl_&#8203;share_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-share-init.php.html" title="curl_&#8203;share_&#8203;init">curl_&#8203;share_&#8203;init</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-share-setopt.php.html" title="curl_&#8203;share_&#8203;setopt">curl_&#8203;share_&#8203;setopt</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-share-strerror.php.html" title="curl_&#8203;share_&#8203;strerror">curl_&#8203;share_&#8203;strerror</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-strerror.php.html" title="curl_&#8203;strerror">curl_&#8203;strerror</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-unescape.php.html" title="curl_&#8203;unescape">curl_&#8203;unescape</a>
                        </li>
                                                <li class="">
                            <a href="function.curl_upkeep.php.html" title="curl_&#8203;upkeep">curl_&#8203;upkeep</a>
                        </li>
                                                <li class="">
                            <a href="function.curl-version.php.html" title="curl_&#8203;version">curl_&#8203;version</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
