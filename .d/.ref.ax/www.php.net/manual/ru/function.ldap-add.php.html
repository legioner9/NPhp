<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: ldap_add - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.ldap-add.php.html">
 <link rel="shorturl" href="https://www.php.net/ldap-add">
 <link rel="alternate" href="https://www.php.net/ldap-add" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.ldap.php.html">
 <link rel="prev" href="function.ldap-add-ext.php.html">
 <link rel="next" href="function.ldap-bind-ext.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.ldap-add.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.ldap-add.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.ldap-add.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.ldap-add.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.ldap-add.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.ldap-add.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.ldap-add.php" hreflang="pt_BR">
 <link rel="alternate" href="function.ldap-add.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.ldap-add.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.ldap-add.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.ldap-bind-ext.php.html">
          ldap_bind_ext &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.ldap-add-ext.php.html">
          &laquo; ldap_add_ext        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.remote.other.php.html'>Другие службы</a></li>      <li><a href='book.ldap.php.html'>LDAP</a></li>      <li><a href='ref.ldap.php.html'>Функции LDAP</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.ldap-add.php'>English</option>
            <option value='de/function.ldap-add.php'>German</option>
            <option value='es/function.ldap-add.php'>Spanish</option>
            <option value='fr/function.ldap-add.php'>French</option>
            <option value='it/function.ldap-add.php'>Italian</option>
            <option value='ja/function.ldap-add.php'>Japanese</option>
            <option value='pt_BR/function.ldap-add.php'>Brazilian Portuguese</option>
            <option value='ru/function.ldap-add.php' selected="selected">Russian</option>
            <option value='tr/function.ldap-add.php'>Turkish</option>
            <option value='zh/function.ldap-add.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/ldap/functions/ldap-add.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.ldap-add%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.ldap-add" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ldap_add</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">ldap_add</span> &mdash; <span class="dc-title">Добавить запись в LDAP директорию</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.ldap-add-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>ldap_add</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="class.ldap-connection.php.html" class="type LDAP\Connection">LDAP\Connection</a></span> <code class="parameter">$ldap</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$dn</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">array</span> <code class="parameter">$entry</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">array</span><span class="type"></span></span> <code class="parameter">$controls</code><span class="initializer"> = <strong><code>null</code></strong></span></span><br>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   Добавляет запись в LDAP-директорию.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.ldap-add-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">ldap</code></dt>

     <dd>

      <p class="para">
       Экземпляр <span class="classname"><a href="class.ldap-connection.php.html" class="classname">LDAP\Connection</a></span>,
который возвращает функция <span class="function"><a href="function.ldap-connect.php.html" class="function">ldap_connect()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">dn</code></dt>

     <dd>

      <p class="para">
       Отличительное имя LDAP-объекта.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">entry</code></dt>

     <dd>

      <p class="para">
       Массив, который определяет информацию о записи. Значения в записи индексируются
       индивидуальными атрибутами.
       В случае множественных значений для атрибута, они индексируются с использованием
       целых чисел, начиная с 0.
       <div class="informalexample">
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$entry</span><span style="color: #007700">[</span><span style="color: #DD0000">"attribute1"</span><span style="color: #007700">] = </span><span style="color: #DD0000">"value"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$entry</span><span style="color: #007700">[</span><span style="color: #DD0000">"attribute2"</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">] = </span><span style="color: #DD0000">"value1"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$entry</span><span style="color: #007700">[</span><span style="color: #DD0000">"attribute2"</span><span style="color: #007700">][</span><span style="color: #0000BB">1</span><span style="color: #007700">] = </span><span style="color: #DD0000">"value2"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
        </div>

       </div>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">controls</code></dt>

     <dd>

      <p class="para">
       Массив <a href="ldap.controls.php.html" class="link">управляющих констант LDAP</a> для отправки в запросе.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.ldap-add-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.ldap-add-changelog">
  <h3 class="title">Список изменений</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Версия</th>
       <th>Описание</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
 <td>8.1.0</td>
 <td>
  Параметр <code class="parameter">ldap</code> теперь ожидает экземпляр <span class="classname"><a href="class.ldap-connection.php.html" class="classname">LDAP\Connection</a></span>;
  ранее ожидался ресурс (<a href="language.types.resource.php.html" class="link">resource</a>) <code class="literal">ldap link</code> .
 </td>
</tr>

      <tr>
 <td>8.0.0</td>
 <td>
  <code class="parameter">controls</code> теперь допускает значение null; ранее значение по умолчанию было <code class="literal">[]</code>.
 </td>
</tr>

      <tr>
       <td>7.3.0</td>
       <td>
        Добавлена поддержка параметра <code class="parameter">controls</code>
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.ldap-add-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Пример #1 Полный пример с проверкой подлинности привязки</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$ds </span><span style="color: #007700">= </span><span style="color: #0000BB">ldap_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">);  </span><span style="color: #FF8000">// предположим, что сервер LDAP находится тут<br /><br /></span><span style="color: #007700">if (</span><span style="color: #0000BB">$ds</span><span style="color: #007700">) {<br />    </span><span style="color: #FF8000">// привязка к соответствующему dn для возможности обновления<br />    </span><span style="color: #0000BB">$r </span><span style="color: #007700">= </span><span style="color: #0000BB">ldap_bind</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">, </span><span style="color: #DD0000">"cn=root, o=My Company, c=US"</span><span style="color: #007700">, </span><span style="color: #DD0000">"secret"</span><span style="color: #007700">);<br /><br />    </span><span style="color: #FF8000">// подготовить данные<br />    </span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"cn"</span><span style="color: #007700">] = </span><span style="color: #DD0000">"John Jones"</span><span style="color: #007700">;<br />    </span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"sn"</span><span style="color: #007700">] = </span><span style="color: #DD0000">"Jones"</span><span style="color: #007700">;<br />    </span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"objectclass"</span><span style="color: #007700">] = </span><span style="color: #DD0000">"person"</span><span style="color: #007700">;<br /><br />    </span><span style="color: #FF8000">// добавить данные<br />    </span><span style="color: #0000BB">$r </span><span style="color: #007700">= </span><span style="color: #0000BB">ldap_add</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">, </span><span style="color: #DD0000">"cn=John Jones, o=My Company, c=US"</span><span style="color: #007700">, </span><span style="color: #0000BB">$info</span><span style="color: #007700">);<br /><br />    </span><span style="color: #0000BB">ldap_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">);<br />} else {<br />    echo </span><span style="color: #DD0000">"Невозможно соединиться с сервером LDAP"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.ldap-add-notes">
  <h3 class="title">Примечания</h3>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: <span class="simpara">Эта функция
безопасна для обработки данных в двоичной форме.</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.ldap-add-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.ldap-add-ext.php.html" class="function" rel="rdfs-seeAlso">ldap_add_ext()</a> - Добавить записи в каталог LDAP</span></li>
    <li class="member"><span class="function"><a href="function.ldap-delete.php.html" class="function" rel="rdfs-seeAlso">ldap_delete()</a> - Удаляет запись из директории LDAP</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.ldap-add&amp;redirect=https://www.php.net/manual/ru/function.ldap-add.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">23 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="71857">  <div class="votes">
    <div id="Vu71857">
    <a href="https://www.php.net/manual/vote-note.php?id=71857&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd71857">
    <a href="https://www.php.net/manual/vote-note.php?id=71857&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V71857" title="80% like this...">
    6
    </div>
  </div>
  <a href="function.ldap-add.php.html#71857" class="name">
  <strong class="user"><em>damien at groovey dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#71857"> &para;</a><div class="date" title="2006-12-19 02:08"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom71857">
<div class="phpcode"><code><span class="html">Here is how to add a user with a hashed MD5 password to OpenLDAP.  I used this technique to migrate Drupal accounts into OpenLDAP for a single-sign-on solution.   <br /><br />The trick to it is to tell OpenLDAP the hash type (e.g. {MD5}) before the password, and also to base64 encode the BINARY hashed result.  You cannot just base64 encode what is returned by PHP's md5() or sha() hash functions, because they return a hexadecimal text string.  First you must use pack("H*", $hash_result) to make that a binary string, THEN you can base64 encode it.<br /><br />Here is complete code for connecting and adding a user with a hashed password.  You don't have to use {MD5}, you could pick a different hash if that is what you have.  The output from one of these hashed passwords will look like this:  {md5}bdwD04RS9xMDGVi1n/H36Q== <br /><br />Finally some caveats:  This technique will not work if you hashed the password using a salt value (but Drupal does not).  This technique will also certainly not work with active directory, where passwords can definitely only be set over SSL connections and hashing probably works differently.<br /><br />---- snip ----<br /><br />$ds = ldap_connect($serverAddress);<br />if ($ds) {<br />  ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);  // otherwise PHP defaults to ldap v2 and you will get a Syntax Error!<br />  $r = ldap_bind($ds, $managerDN, $managerPassword);<br />  $ldaprecord['cn'] = $newuser_username;<br />  $ldaprecord['givenName'] = $newuser_firstname;<br />  $ldaprecord['sn'] = $newuser_surname;<br />  // put user in objectClass inetOrgPerson so we can set the mail and phone number attributes<br />  $ldaprecord['objectclass'][0] = "person";<br />  $ldaprecord['objectclass'][1] = "organizationalPerson";<br />  $ldaprecord['objectclass'][2] = "inetOrgPerson";<br />  $ldaprecord['mail'] = $newuser_email_address;<br />  $ldaprecord['telephoneNumber'] = $newuser_phone_number;<br />  // and now the tricky part, base64 encode the binary hash result:<br />  $ldaprecord['userPassword'] = '{MD5}' . base64_encode(pack('H*',$newuser_md5hashed_password));<br />  // If you have the plain text password instead, you could use:<br />  // $ldaprecord['userPassword'] = '{MD5}' . base64_encode(pack('H*',md5($newuser_plaintext_password)));<br />  $r = ldap_add($ds, $base_user_dn, $ldaprecord);<br />} else { die "cannot connect to LDAP server at $serverAddress."; }</span></code></div>
  </div>
 </div>
  <div class="note" id="78902">  <div class="votes">
    <div id="Vu78902">
    <a href="https://www.php.net/manual/vote-note.php?id=78902&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd78902">
    <a href="https://www.php.net/manual/vote-note.php?id=78902&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V78902" title="69% like this...">
    5
    </div>
  </div>
  <a href="function.ldap-add.php.html#78902" class="name">
  <strong class="user"><em>stian</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#78902"> &para;</a><div class="date" title="2007-11-01 06:27"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom78902">
<div class="phpcode"><code><span class="html">This solution works for us. <br />In the form the CN and pwdtxt are randomly generated from strict rules. <br />This script creates 50-60 users i AD pr.day! and never even had a glitch!<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">## From form<br /></span><span class="default">$CN </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'CN'</span><span class="keyword">]; <br /></span><span class="default">$givenName </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'givenName'</span><span class="keyword">];<br /></span><span class="default">$SN </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'SN'</span><span class="keyword">];<br /></span><span class="default">$mail </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'mail'</span><span class="keyword">];<br /></span><span class="default">$Phone </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'Phone'</span><span class="keyword">];<br /></span><span class="default">$pwdtxt </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'pwdtxt'</span><span class="keyword">];<br /><br /></span><span class="default">$AD_server </span><span class="keyword">= </span><span class="string">"localhost:390"</span><span class="keyword">; </span><span class="comment">// Local Stunnel --&gt; <a href="http://www.stunnel.org/" rel="nofollow" target="_blank">http://www.stunnel.org/</a><br /></span><span class="default">$AD_Auth_User </span><span class="keyword">= </span><span class="string">"administrator@student.somwhere.com"</span><span class="keyword">; </span><span class="comment">//Administrative user<br /></span><span class="default">$AD_Auth_PWD </span><span class="keyword">= </span><span class="string">"duppiduppdupp"</span><span class="keyword">; </span><span class="comment">//The password <br /><br /></span><span class="default">$dn </span><span class="keyword">= </span><span class="string">'CN='</span><span class="keyword">.</span><span class="default">$CN</span><span class="keyword">.</span><span class="string">',OU=Brukere,DC=student,DC=somwhere,DC=com'</span><span class="keyword">;<br /><br /></span><span class="comment">## Create Unicode password<br /></span><span class="default">$newPassword </span><span class="keyword">= </span><span class="string">"\"" </span><span class="keyword">. </span><span class="default">$pwdtxt </span><span class="keyword">. </span><span class="string">"\""</span><span class="keyword">;<br /></span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$newPassword</span><span class="keyword">);<br /></span><span class="default">$newPassw </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br /><br />for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />    </span><span class="default">$newPassw </span><span class="keyword">.= </span><span class="string">"</span><span class="keyword">{</span><span class="default">$newPassword</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">}}</span><span class="string">\000"</span><span class="keyword">;<br />}<br /><br /></span><span class="comment">## CONNNECT TO AD<br /></span><span class="default">$ds </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="default">$AD_server</span><span class="keyword">);<br />if (</span><span class="default">$ds</span><span class="keyword">) {<br />    </span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">); </span><span class="comment">// IMPORTANT<br />    </span><span class="default">$r </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$AD_Auth_User</span><span class="keyword">, </span><span class="default">$AD_Auth_PWD</span><span class="keyword">); </span><span class="comment">//BIND<br /><br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'cn'</span><span class="keyword">] = </span><span class="default">$CN</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'givenName'</span><span class="keyword">] = </span><span class="default">$givenName</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'sn'</span><span class="keyword">] = </span><span class="default">$SN</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'objectclass'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"top"</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'objectclass'</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">] = </span><span class="string">"person"</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'objectclass'</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">] = </span><span class="string">"organizationalPerson"</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'objectclass'</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">] = </span><span class="string">"user"</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'mail'</span><span class="keyword">] = </span><span class="default">$mail</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">'telephoneNumber'</span><span class="keyword">] = </span><span class="default">$Phone</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">"unicodepwd"</span><span class="keyword">] = </span><span class="default">$newPassw</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">"sAMAccountName"</span><span class="keyword">] = </span><span class="default">$CN</span><span class="keyword">;<br />    </span><span class="default">$ldaprecord</span><span class="keyword">[</span><span class="string">"UserAccountControl"</span><span class="keyword">] = </span><span class="string">"512"</span><span class="keyword">; <br /></span><span class="comment">//This is to prevent the user from beeing disabled. --&gt;<br /></span><span class="default">http</span><span class="keyword">:</span><span class="comment">//support.microsoft.com/default.aspx?scid=kb;en-us;305144<br /><br />    </span><span class="default">$r </span><span class="keyword">= </span><span class="default">ldap_add</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$dn</span><span class="keyword">, </span><span class="default">$ldaprecord</span><span class="keyword">);<br />    <br />} else { <br />    echo </span><span class="string">"cannot connect to LDAP server at </span><span class="default">$AD_server</span><span class="string">."</span><span class="keyword">;<br />}<br /><br /></span><span class="default">?&gt;<br /></span><br />This is code example creates a user i AD.<br />We use this on an internal web page to create <br />temporary users that kan access the wireless network. <br />We have a .pl script that deletes the users after 24H.</span></code></div>
  </div>
 </div>
  <div class="note" id="30023">  <div class="votes">
    <div id="Vu30023">
    <a href="https://www.php.net/manual/vote-note.php?id=30023&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd30023">
    <a href="https://www.php.net/manual/vote-note.php?id=30023&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V30023" title="61% like this...">
    6
    </div>
  </div>
  <a href="function.ldap-add.php.html#30023" class="name">
  <strong class="user"><em>Axel D. (FRANCE)</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#30023"> &para;</a><div class="date" title="2003-03-04 08:26"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom30023">
<div class="phpcode"><code><span class="html">Try this script if you don't know how to add an user in the AD Win2K.<br />To have more informations about the attributes, open the adsiedit console in the Support Tools for Win2K.<br /><br />$adduserAD["cn"][0] = <br />$adduserAD["instancetype"][0] = <br />$adduserAD["samaccountname"][0] = <br />$adduserAD["objectclass"][0] = "top";<br />$adduserAD["objectclass"][1] = "person";<br />$adduserAD["objectclass"][2] = "organizationalPerson";<br />$adduserAD["objectclass"][3] = "user";<br />$adduserAD["displayname"][0] = <br />$adduserAD["name"][0] = <br />$adduserAD["givenname"][0] = <br />$adduserAD["sn"][0] = <br />$adduserAD["company"][0] =<br />$adduserAD["department"][0] = <br />$adduserAD["title"][0] = <br />$adduserAD["description"][0] = <br />$adduserAD["mail"][0] = <br />$adduserAD["initials"][0] = <br />$adduserAD["samaccountname"][0] = <br />$adduserAD["userprincipalname"][0] = <br />$adduserAD["profilepath"][0] =<br />$adduserAD["manager"][0] = ***Use DistinguishedName***<br /><br />if (!($ldap = ldap_connect("localhost"))) { <br />     die ("Could not connect to LDAP server"); <br />}<br />if (!($res = @ldap_bind($ldap, "user@pc.com", $password))) { <br />     die ("Could not bind to the LDAP account"); <br />}<br />if (!(ldap_add($ldap, "CN=New User,OU=OU Users,DC=pc,DC=com", $adduserAD))){<br />     echo "There is a problem to create the account<br />     echo "Please contact your administrator !";<br />     exit;<br />}<br />ldap_unbind($ldap);</span></code></div>
  </div>
 </div>
  <div class="note" id="54814">  <div class="votes">
    <div id="Vu54814">
    <a href="https://www.php.net/manual/vote-note.php?id=54814&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd54814">
    <a href="https://www.php.net/manual/vote-note.php?id=54814&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V54814" title="64% like this...">
    5
    </div>
  </div>
  <a href="function.ldap-add.php.html#54814" class="name">
  <strong class="user"><em>theiderich AT laweekly dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#54814"> &para;</a><div class="date" title="2005-07-15 10:19"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom54814">
<div class="phpcode"><code><span class="html">When adding/editing attributes for a user, keep in mind that the 'memberof' attribute is a special case.  The memberOf attribute is not an accessible attribute of the user schema. To add someone to a group, you have to add the user in the group, and not the group in the user. You can do this by accessing the group attribute 'member':<br /><br /><span class="default">&lt;?php<br /><br />$group_name </span><span class="keyword">= </span><span class="string">"CN=MyGroup,OU=Groups,DC=example,DC=com"</span><span class="keyword">;<br /></span><span class="default">$group_info</span><span class="keyword">[</span><span class="string">'member'</span><span class="keyword">] = </span><span class="default">$dn</span><span class="keyword">; </span><span class="comment">// User's DN is added to group's 'member' array<br /></span><span class="default">ldap_mod_add</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">,</span><span class="default">$group_name</span><span class="keyword">,</span><span class="default">$group_info</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="38990">  <div class="votes">
    <div id="Vu38990">
    <a href="https://www.php.net/manual/vote-note.php?id=38990&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd38990">
    <a href="https://www.php.net/manual/vote-note.php?id=38990&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V38990" title="75% like this...">
    2
    </div>
  </div>
  <a href="function.ldap-add.php.html#38990" class="name">
  <strong class="user"><em>ondrej dot duchon at t-systems dot cz</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#38990"> &para;</a><div class="date" title="2004-01-14 04:58"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom38990">
<div class="phpcode"><code><span class="html">jharnett at artschool dot com:<br />For active user in AD u must change "useraccountcontrol" to 512, 512 = enabled, 514 = disabled</span></code></div>
  </div>
 </div>
  <div class="note" id="81113">  <div class="votes">
    <div id="Vu81113">
    <a href="https://www.php.net/manual/vote-note.php?id=81113&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd81113">
    <a href="https://www.php.net/manual/vote-note.php?id=81113&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V81113" title="64% like this...">
    4
    </div>
  </div>
  <a href="function.ldap-add.php.html#81113" class="name">
  <strong class="user"><em>phil at networkalliance dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#81113"> &para;</a><div class="date" title="2008-02-14 09:24"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom81113">
<div class="phpcode"><code><span class="html">I created a simple function that can be called to create global distribution groups in Active Directory:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">ldap_createGroup</span><span class="keyword">(</span><span class="default">$object_name</span><span class="keyword">, </span><span class="default">$dn</span><span class="keyword">, </span><span class="default">$members</span><span class="keyword">, </span><span class="default">$ldap_conn</span><span class="keyword">)<br />{<br />    </span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">'cn'</span><span class="keyword">]=</span><span class="string">"</span><span class="default">$object_name</span><span class="string">"</span><span class="keyword">;<br />    </span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">'objectClass'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"top"</span><span class="keyword">;<br />    </span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">'objectClass'</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">] =</span><span class="string">"group"</span><span class="keyword">;<br />    </span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">'groupType'</span><span class="keyword">]=</span><span class="string">"2"</span><span class="keyword">;<br />    </span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">'member'</span><span class="keyword">]=</span><span class="default">$members</span><span class="keyword">;<br />    </span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">"sAMAccountName"</span><span class="keyword">] =</span><span class="default">$object_name</span><span class="keyword">;<br /><br />    </span><span class="default">ldap_add</span><span class="keyword">(</span><span class="default">$ldap_conn</span><span class="keyword">,</span><span class="default">$dn</span><span class="keyword">,</span><span class="default">$addgroup_ad</span><span class="keyword">);<br />    <br />    if(</span><span class="default">ldap_error</span><span class="keyword">(</span><span class="default">$ldap_conn</span><span class="keyword">) == </span><span class="string">"Success"</span><span class="keyword">)<br />      return </span><span class="default">true</span><span class="keyword">;<br />    else<br />      return </span><span class="default">false</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;<br /></span><br />You can call this function using the follow code:<br /><br /><span class="default">&lt;?php<br />$ldap_conn </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">();<br /></span><span class="default">$object_name</span><span class="keyword">=</span><span class="string">"Test Group"</span><span class="keyword">;<br /></span><span class="default">$dn</span><span class="keyword">=</span><span class="string">"CN="</span><span class="keyword">.</span><span class="default">$object_name</span><span class="keyword">.</span><span class="string">",OU=PathToAddGroupTo,OU=All Users,DC=YOURDOMAIN,DC=COM"</span><span class="keyword">;<br /></span><span class="default">$members</span><span class="keyword">[] =</span><span class="string">"CN=User1,OU=PathToAddGroupTo,OU=All Users,DC=YOURDOMAIN,DC=COM"</span><span class="keyword">;<br /></span><span class="default">$members</span><span class="keyword">[] =</span><span class="string">"CN=User2,OU=PathToAddGroupTo,OU=All Users,DC=YOURDOMAIN,DC=COM"</span><span class="keyword">;<br /><br /></span><span class="default">ldap_createGroup</span><span class="keyword">(</span><span class="default">$object_name</span><span class="keyword">, </span><span class="default">$dn</span><span class="keyword">, </span><span class="default">$members</span><span class="keyword">, </span><span class="default">$ldap_conn</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />The other function I created is ldap_bind(), and this can be used to bind to an LDAP server:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">ldap_bind</span><span class="keyword">()<br />{<br />  </span><span class="default">$ldap_addr </span><span class="keyword">= </span><span class="string">'192.168.1.1'</span><span class="keyword">;  </span><span class="comment">// Change this to the IP address of the LDAP server<br />  </span><span class="default">$ldap_conn </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="default">$ldap_addr</span><span class="keyword">) or die(</span><span class="string">"Couldn't connect!"</span><span class="keyword">);<br />  </span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$ldap_conn</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />  </span><span class="default">$ldap_rdn </span><span class="keyword">= </span><span class="string">"domain_name\\user_account"</span><span class="keyword">;<br />  </span><span class="default">$ldap_pass </span><span class="keyword">= </span><span class="string">"user_password"</span><span class="keyword">;<br /><br />  </span><span class="comment">// Authenticate the user against the domain controller<br />  </span><span class="default">$flag_ldap </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ldap_conn</span><span class="keyword">,</span><span class="default">$ldap_rdn</span><span class="keyword">,</span><span class="default">$ldap_pass</span><span class="keyword">);<br />  return </span><span class="default">$ldap_conn</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="82702">  <div class="votes">
    <div id="Vu82702">
    <a href="https://www.php.net/manual/vote-note.php?id=82702&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd82702">
    <a href="https://www.php.net/manual/vote-note.php?id=82702&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V82702" title="63% like this...">
    3
    </div>
  </div>
  <a href="function.ldap-add.php.html#82702" class="name">
  <strong class="user"><em>sergioshev</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#82702"> &para;</a><div class="date" title="2008-04-22 10:29"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom82702">
<div class="phpcode"><code><span class="html">once i'am having problmes to add attributes with boolean syntax (1.3.6.1.4.1.1466.115.121.1.7)<br /><br />$['boolean_attr']=true; //give me one warning, ldap_add(): Add: Invalid syntax<br /><br />solved this by setting the value on this:<br /> <br />$['boolean_attr']='TRUE';<br /><br />hope this can helps.</span></code></div>
  </div>
 </div>
  <div class="note" id="32187">  <div class="votes">
    <div id="Vu32187">
    <a href="https://www.php.net/manual/vote-note.php?id=32187&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd32187">
    <a href="https://www.php.net/manual/vote-note.php?id=32187&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V32187" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.ldap-add.php.html#32187" class="name">
  <strong class="user"><em>John Van Atta</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#32187"> &para;</a><div class="date" title="2003-05-19 06:52"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom32187">
<div class="phpcode"><code><span class="html">In response to jharnett's question about accounts disabled by default from ldap_add, we have found a solution. <br /><br />The attribute userAccountControl contains a value that includes whether the account is disabled or enabled. The default for us is 546; when we changed that to 544 the account became enabled. Changing whatever value is in userAccountControl by 2 seems to enable or disable the account.<br /><br />The following code worked for us to create a new user with an enabled account:<br /><br />$adduserAD["userAccountControl"] = "544";<br /><br />We just added this element to the above example's array.</span></code></div>
  </div>
 </div>
  <div class="note" id="46974">  <div class="votes">
    <div id="Vu46974">
    <a href="https://www.php.net/manual/vote-note.php?id=46974&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd46974">
    <a href="https://www.php.net/manual/vote-note.php?id=46974&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V46974" title="100% like this...">
    1
    </div>
  </div>
  <a href="function.ldap-add.php.html#46974" class="name">
  <strong class="user"><em>hp at syntomax dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#46974"> &para;</a><div class="date" title="2004-10-28 06:31"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom46974">
<div class="phpcode"><code><span class="html">Another fun thing: ldap_add() doesn't like arrays with empty members: so <br />array (<br />      [cn] = "name"<br />      [key] = ""<br />      [anotherkey] = "value"<br />)<br />will yield a syntax error!<br /><br />solve this with a simple peice of code:<br /><br />foreach ($originalobject as $key =&gt; $value){<br />        if ($value != ""){<br />                $object[$key] = $value;<br />        }<br />}<br /><br />where $originalobject is the uncecked array and $object is the one without empty members.</span></code></div>
  </div>
 </div>
  <div class="note" id="1606">  <div class="votes">
    <div id="Vu1606">
    <a href="https://www.php.net/manual/vote-note.php?id=1606&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd1606">
    <a href="https://www.php.net/manual/vote-note.php?id=1606&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V1606" title="100% like this...">
    1
    </div>
  </div>
  <a href="function.ldap-add.php.html#1606" class="name">
  <strong class="user"><em>akohlsmith at mixdown dot org</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#1606"> &para;</a><div class="date" title="1999-09-12 04:48"><strong>24 years ago</strong></div>
  <div class="text" id="Hcom1606">
<div class="phpcode"><code><span class="html">ldap_add() will only honour the $entry["attribute"][x]="value" *if there are multiple values for the attribute*.  If there is only one attribute value, it *MUST* be entered as $entry["attribute"]="value" or ldap_add() sets the value for the attribute to be "Array" instead of what you put into $entry["attribute"][0].<br /><br />Here is a little routine I wrote up to do this automatically.  when you're parsing the input, just use multi_add():<br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">multi_add</span><span class="keyword">(</span><span class="default">$attribute</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)<br />{<br /> global </span><span class="default">$entry</span><span class="keyword">;                                </span><span class="comment">// the LDAP entry you're gonna add<br /><br /> </span><span class="keyword">if(isset(</span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">]))<br />   if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">]))<br />     </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">][</span><span class="default">count</span><span class="keyword">(</span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">])] = </span><span class="default">$value</span><span class="keyword">;<br />   else<br />     {<br />     </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">];<br />     unset(</span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">]);<br />     </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$tmp</span><span class="keyword">;<br />     </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />     }<br /> else<br />   </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">$attribute</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;<br /></span>multi_add() checks to see if there is already a value for the attribute.  if not, it adds it as $entry[$attribute]=$value.  If there is already a value for the attribute, it converts the attribute to an array and adds the multiple values correctly.<br /><br />How to use it:<br /><span class="default">&lt;?php<br /></span><span class="keyword">switch(</span><span class="default">$form_data_name</span><span class="keyword">)<br />      {<br />      case </span><span class="string">'phone'</span><span class="keyword">: </span><span class="default">multi_add</span><span class="keyword">(</span><span class="string">"telephoneNumber"</span><span class="keyword">, </span><span class="default">$form_data_value</span><span class="keyword">); break;<br />      case </span><span class="string">'fax'</span><span class="keyword">: </span><span class="default">multi_add</span><span class="keyword">(</span><span class="string">"facsimileTelephoneNumber"</span><span class="keyword">, </span><span class="default">$form_data_value</span><span class="keyword">); break;<br />      case </span><span class="string">'email'</span><span class="keyword">: </span><span class="default">multi_add</span><span class="keyword">(</span><span class="string">"mail"</span><span class="keyword">, </span><span class="default">$form_data_value</span><span class="keyword">); break;<br />      ...<br />      }<br /></span><span class="default">?&gt;<br /></span>In the system I designed the form has pulldowns with names ctype1, ctype2, ctype3, etc. and the values are "fax, mail, phone...".  The actual contact data (phone number, fax, email, etc) is contact1, contact2, contact3, etc.  The user pulls down what the contact type is (phone, email) and then enters the data (number, address, etc.)<br /><br />I use variable variables to fill the entry and skip blanks.  Makes for a very clean form entry system.  email me if you're interested in it, as I think I'm outgrowing the size of note allowed here.  :-)</span></code></div>
  </div>
 </div>
  <div class="note" id="123356">  <div class="votes">
    <div id="Vu123356">
    <a href="https://www.php.net/manual/vote-note.php?id=123356&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd123356">
    <a href="https://www.php.net/manual/vote-note.php?id=123356&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V123356" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#123356" class="name">
  <strong class="user"><em>Baumkuchen.TH</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#123356"> &para;</a><div class="date" title="2018-11-19 06:40"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom123356">
<div class="phpcode"><code><span class="html">Create Group in Active Directory<br /><br /><span class="default">&lt;?php<br />$ds </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="string">"IP-server/localhost"</span><span class="keyword">); <br /></span><span class="default">$base_dn </span><span class="keyword">= </span><span class="string">"CN=Group name,OU=Organization Unit,DC=Domain-name,DC=com"</span><span class="keyword">;</span><span class="comment">//distinguishedName of group<br /><br /></span><span class="keyword">if (</span><span class="default">$ds</span><span class="keyword">) {<br /></span><span class="comment">// bind with appropriate dn to give update access<br /></span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="string">"CN=Administrator,OU=Organization Unit,DC=Domain-name,DC=com"</span><span class="keyword">, </span><span class="string">"some-password"</span><span class="keyword">);<br /><br /></span><span class="comment">//Add members in group<br /></span><span class="default">$member_array </span><span class="keyword">= array();<br /></span><span class="default">$member_array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"CN=Administrator,OU=Organization Unit,DC=Domain-name,DC=com"</span><span class="keyword">;<br /></span><span class="default">$member_array</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="string">"CN=User,OU=Organization Unit,DC=Domain-name,DC=com"</span><span class="keyword">;<br /><br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">"cn"</span><span class="keyword">] = </span><span class="string">"GroupTest"</span><span class="keyword">;<br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">"samaccountname"</span><span class="keyword">] = </span><span class="string">"GroupTest"</span><span class="keyword">;<br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">"objectClass"</span><span class="keyword">] = </span><span class="string">"Group"</span><span class="keyword">;<br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">"description"</span><span class="keyword">] = </span><span class="string">"Group Test!!"</span><span class="keyword">;<br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">"member"</span><span class="keyword">] = </span><span class="default">$member_array</span><span class="keyword">;<br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">"groupType"</span><span class="keyword">] = </span><span class="string">"2"</span><span class="keyword">;</span><span class="comment">//GroupType="2" is Distribution / GroupType="1" is Security<br /><br /></span><span class="default">ldap_add</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">,</span><span class="default">$base_dn</span><span class="keyword">,</span><span class="default">$entry</span><span class="keyword">);<br /><br /></span><span class="default">ldap_close</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">);<br />} else {<br />echo </span><span class="string">"Unable to connect to LDAP server"</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="111095">  <div class="votes">
    <div id="Vu111095">
    <a href="https://www.php.net/manual/vote-note.php?id=111095&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111095">
    <a href="https://www.php.net/manual/vote-note.php?id=111095&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111095" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#111095" class="name">
  <strong class="user"><em>paul90brown at gmail dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#111095"> &para;</a><div class="date" title="2013-01-14 07:04"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom111095">
<div class="phpcode"><code><span class="html">I kept getting "Object Class Violation" when I tried adding posixAccount and shadowAccount as an objectclass. It turned out that these object classes had a lot of required fields that I was not adding. You may need to export a working user (if you have phpLDAPadmin) and see exactly what fields they have, then try to copy it exactly in the script. It also doesn't hurt if you make everything an Array the first time around, you can fix those fields later.</span></code></div>
  </div>
 </div>
  <div class="note" id="57300">  <div class="votes">
    <div id="Vu57300">
    <a href="https://www.php.net/manual/vote-note.php?id=57300&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd57300">
    <a href="https://www.php.net/manual/vote-note.php?id=57300&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V57300" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#57300" class="name">
  <strong class="user"><em>chad dot smith at 50marketing dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#57300"> &para;</a><div class="date" title="2005-09-29 02:56"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom57300">
<div class="phpcode"><code><span class="html">I took spam2004 at turniton dot dk example and made it a bit better.  Maybe my setup was a bit different but either way here is how I added a group in Microsoft Windows Server 2003.<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Connect using ldap_connect<br />// Bind using ldap_bind<br />// Set LDAP_OPT_PROTOCOL_VERSION to 3<br /></span><span class="default">$member_array </span><span class="keyword">= array();<br /></span><span class="default">$member_array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"cn=user1,cn=Users,dc=yourdomain,dc=com"</span><span class="keyword">;<br /></span><span class="default">$member_array</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="string">"cn=administrator,cn=Users,dc=yourdomain,dc=com"</span><span class="keyword">;<br /><br /></span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">"cn"</span><span class="keyword">] = </span><span class="string">"testgroup"</span><span class="keyword">;<br /></span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">"samaccountname"</span><span class="keyword">] = </span><span class="string">"testgroup"</span><span class="keyword">;<br /></span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">"objectClass"</span><span class="keyword">] = </span><span class="string">"Group"</span><span class="keyword">;<br /></span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">"description"</span><span class="keyword">] = </span><span class="string">"Yep just a test."</span><span class="keyword">;<br /></span><span class="default">$addgroup_ad</span><span class="keyword">[</span><span class="string">"member"</span><span class="keyword">] = </span><span class="default">$member_array</span><span class="keyword">;<br /></span><span class="default">$base_dn </span><span class="keyword">= </span><span class="string">"cn=testgroup,cn=Users,DC=yourdomain,DC=com"</span><span class="keyword">;<br /></span><span class="default">ldap_add</span><span class="keyword">(</span><span class="default">$ldap_conn</span><span class="keyword">,</span><span class="default">$base_dn</span><span class="keyword">,</span><span class="default">$addgroup_ad</span><span class="keyword">);<br /></span><span class="comment">// This is it.<br /></span><span class="default">?&gt;<br /></span><br />Take care and good luck,<br />Chad R. Smith</span></code></div>
  </div>
 </div>
  <div class="note" id="46743">  <div class="votes">
    <div id="Vu46743">
    <a href="https://www.php.net/manual/vote-note.php?id=46743&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd46743">
    <a href="https://www.php.net/manual/vote-note.php?id=46743&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V46743" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#46743" class="name">
  <strong class="user"><em>amcnabb</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#46743"> &para;</a><div class="date" title="2004-10-21 02:37"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom46743">
<div class="phpcode"><code><span class="html">Be careful with types.  PHP switches automatically between strings and numbers, but LDAP doesn't, and PHP will send whatever is most convenient for PHP, not LDAP, unless you specify a type.<br /><br />If you inadvertently send a number as a string, you will get an error: "ldap_add(): Add: Invalid syntax in [filename] on line LINENUM."<br /><br />Observe this example which makes an array to send to LDAP to create a POSIX group.  Note that $new_groupid, which is technically a string, must be typecast with (int).<br /><br />         $new_ldap_group['cn'] = $groupname;<br />         $new_ldap_group['objectclass'][0] = 'posixgroup';<br />         $new_ldap_group['objectclass'][1] = 'top';<br />         $new_ldap_group['gidnumber'] = (int) $new_groupid;</span></code></div>
  </div>
 </div>
  <div class="note" id="46247">  <div class="votes">
    <div id="Vu46247">
    <a href="https://www.php.net/manual/vote-note.php?id=46247&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd46247">
    <a href="https://www.php.net/manual/vote-note.php?id=46247&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V46247" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#46247" class="name">
  <strong class="user"><em>spam2004 at turniton dot dk</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#46247"> &para;</a><div class="date" title="2004-10-04 04:06"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom46247">
<div class="phpcode"><code><span class="html">To add a group in Windows AD..<br />$object_name="testgroup2";<br />$members[]="CN=THU,ou=Users,dc=addomain,dc=domain,dc=dk";<br />$members[]="CN=testgroup2,ou=Groups,dc=addomain,dc=domain,dc=dk";<br />$addgroup_ad['cn']="$object_name";<br />$addgroup_ad['objectClass'][0] = "top";<br />$addgroup_ad['objectClass'][1] ="group";<br />$addgroup_ad['descripton']=$object_description;<br />$addgroup_ad['member']=$members;<br />$addgroup_ad["sAMAccountName"] =$object_name;<br /><br />// notice param 2 (dn) will probably be different<br />$dn="cn=".$object_name.",ou=Groups,dc=addomain,dc=domain,dc=dk";<br />ldap_add($ldapc,$dn,$addgroup_ad);</span></code></div>
  </div>
 </div>
  <div class="note" id="38999">  <div class="votes">
    <div id="Vu38999">
    <a href="https://www.php.net/manual/vote-note.php?id=38999&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd38999">
    <a href="https://www.php.net/manual/vote-note.php?id=38999&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V38999" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#38999" class="name">
  <strong class="user"><em>ondrej dot duchon at t-systems dot cz</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#38999"> &para;</a><div class="date" title="2004-01-14 06:49"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom38999">
<div class="phpcode"><code><span class="html">IF you need use national characters (iso 8859-2,8 etc.) it's good way to use  ldap_set_option.<br />It was hard job to find where is a bug ;-))). I hope that helps somebody.<br /><br /> ldap_set_option($ldap, LDAP_OPT_PROTOCOL_VERSION, 3);</span></code></div>
  </div>
 </div>
  <div class="note" id="26216">  <div class="votes">
    <div id="Vu26216">
    <a href="https://www.php.net/manual/vote-note.php?id=26216&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd26216">
    <a href="https://www.php.net/manual/vote-note.php?id=26216&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V26216" title="no votes...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#26216" class="name">
  <strong class="user"><em>jharnett at artschool dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#26216"> &para;</a><div class="date" title="2002-10-22 02:43"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom26216">
<div class="phpcode"><code><span class="html">For some wacky reason, when the new account is added using ldap_add(), the account is set to "inactive".<br />And from what I can see there is no modifiable attribute to "re-enable" that user. I suppose by default, if the specific flags are not set the default values are used. Anyone that has a fix for this, please post, I'm pulling out what little hair I have left.</span></code></div>
  </div>
 </div>
  <div class="note" id="22583">  <div class="votes">
    <div id="Vu22583">
    <a href="https://www.php.net/manual/vote-note.php?id=22583&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd22583">
    <a href="https://www.php.net/manual/vote-note.php?id=22583&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V22583" title="no votes...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#22583" class="name">
  <strong class="user"><em>del at babel dot com dot au</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#22583"> &para;</a><div class="date" title="2002-06-23 09:55"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom22583">
<div class="phpcode"><code><span class="html">If you need to add an attribute that is binary encoded (eg: userCertificate), then you need to add the ";binary" specification at the end of the field name.<br /><br />eg:<br /><br />$info["userCertificate;binary"] = $myBinaryCert;<br />$ldap_add ...<br /><br />Del</span></code></div>
  </div>
 </div>
  <div class="note" id="15167">  <div class="votes">
    <div id="Vu15167">
    <a href="https://www.php.net/manual/vote-note.php?id=15167&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd15167">
    <a href="https://www.php.net/manual/vote-note.php?id=15167&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V15167" title="no votes...">
    0
    </div>
  </div>
  <a href="function.ldap-add.php.html#15167" class="name">
  <strong class="user"><em>titus dot stahl at experts4 dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#15167"> &para;</a><div class="date" title="2001-08-30 06:53"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom15167">
<div class="phpcode"><code><span class="html">Note that you cannot use base64 encoding, you have to use utf-8 encoding for special chars instead.</span></code></div>
  </div>
 </div>
  <div class="note" id="77113">  <div class="votes">
    <div id="Vu77113">
    <a href="https://www.php.net/manual/vote-note.php?id=77113&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd77113">
    <a href="https://www.php.net/manual/vote-note.php?id=77113&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V77113" title="40% like this...">
    -1
    </div>
  </div>
  <a href="function.ldap-add.php.html#77113" class="name">
  <strong class="user"><em>Willie</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#77113"> &para;</a><div class="date" title="2007-08-15 02:16"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom77113">
<div class="phpcode"><code><span class="html">In response to:<br />Note that you cannot use base64 encoding, you have to use utf-8 encoding for special chars instead.<br />--<br /><br />I have found that if I have a special character (or a newline) that ldap_add and ldap_modify will automatically do the base64 encoding for you.  For example:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// assuming binding is done, etc.<br /></span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'postalAddress'</span><span class="keyword">] = </span><span class="string">"123 East 456 West\nSuite A103"</span><span class="keyword">;<br /></span><span class="default">ldap_modify</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$dn</span><span class="keyword">, </span><span class="default">$entry</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />The function or server will take the newline and convert it into base64 automatically (same goes for other special characters).<br /><br />You may be able to verify by using a command-line ldapsearch<br />ldapsearch -b "dc=example,dc=com" -x "(cn=Example Person)" postalAddress<br /><br />You'll see that the result comes up as<br />dn: cn=Example Person,dc=example,dc=com<br />postalAddress:: MTIzIEVhc3QgNDU2IFdlc3QKU3VpdGUgQTEwMw==<br /><br />See the double colons after postal address?  That's how LDAP states it's base64 encoded in this case.</span></code></div>
  </div>
 </div>
  <div class="note" id="52457">  <div class="votes">
    <div id="Vu52457">
    <a href="https://www.php.net/manual/vote-note.php?id=52457&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd52457">
    <a href="https://www.php.net/manual/vote-note.php?id=52457&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V52457" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.ldap-add.php.html#52457" class="name">
  <strong class="user"><em>micattack+phpnet at gmail dot com</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#52457"> &para;</a><div class="date" title="2005-05-02 06:32"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom52457">
<div class="phpcode"><code><span class="html">When getting the dreaded invalid syntax, it helps turning on debugging in ldap. Looking at /var/log/ldap, gets you things like<br /><br />May  2 13:51:21 tux slapd[12985]: conn=4934 op=1 RESULT tag=105 err=21 text=phpgwtz: value #0 invalid per syntax<br />May  2 13:52:02 tux slapd[12697]: No objectClass for entry (uid=1, ou=adressen, dc=...</span></code></div>
  </div>
 </div>
  <div class="note" id="36075">  <div class="votes">
    <div id="Vu36075">
    <a href="https://www.php.net/manual/vote-note.php?id=36075&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36075">
    <a href="https://www.php.net/manual/vote-note.php?id=36075&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36075" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.ldap-add.php.html#36075" class="name">
  <strong class="user"><em>Andrew (a.whyte at cqu.edu.au)</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#36075"> &para;</a><div class="date" title="2003-09-24 07:49"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36075">
<div class="phpcode"><code><span class="html">In reference to the questions about Account Enabling, you can use the table found at Microsoft's Support site to help with these attributes.<br /><br />You are correct that '2' is the Account Disabled flag, but there are others, which allow you to detect/set password force expiry and the like.<br /><br />Hope this URL is usefull for that:<br /><br /><a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;305144" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;en-us;305144</a><br /><br />Cheers.</span></code></div>
  </div>
 </div>
  <div class="note" id="113145">  <div class="votes">
    <div id="Vu113145">
    <a href="https://www.php.net/manual/vote-note.php?id=113145&amp;page=function.ldap-add&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113145">
    <a href="https://www.php.net/manual/vote-note.php?id=113145&amp;page=function.ldap-add&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113145" title="37% like this...">
    -4
    </div>
  </div>
  <a href="function.ldap-add.php.html#113145" class="name">
  <strong class="user"><em>Igor2i</em></strong></a><a class="genanchor" href="function.ldap-add.php.html#113145"> &para;</a><div class="date" title="2013-09-05 07:37"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113145">
<div class="phpcode"><code><span class="html">Решил добавить специально для русскоязычных пользователей.<br />У меня сервер на Gentoo с поддержкой кириллици в кодировке UTF-8.<br />И при вводе через форму кириллицы выдавал ошибку синтаксиса.<br />Решение проблемы: <br />1) код требуется перекодировать в UTF-8 без BOM<br />2) и в начале кода вставить строку <br /><span class="default">&lt;?php<br />header</span><span class="keyword">(</span><span class="string">'Content-Type: text/html; charset=utf-8'</span><span class="keyword">);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.ldap-add&amp;redirect=https://www.php.net/manual/ru/function.ldap-add.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.ldap.php.html">Функции LDAP</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.ldap-8859-to-t61.php.html" title="ldap_&#8203;8859_&#8203;to_&#8203;t61">ldap_&#8203;8859_&#8203;to_&#8203;t61</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-add-ext.php.html" title="ldap_&#8203;add_&#8203;ext">ldap_&#8203;add_&#8203;ext</a>
                        </li>
                                                <li class="current">
                            <a href="function.ldap-add.php.html" title="ldap_&#8203;add">ldap_&#8203;add</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-bind-ext.php.html" title="ldap_&#8203;bind_&#8203;ext">ldap_&#8203;bind_&#8203;ext</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-bind.php.html" title="ldap_&#8203;bind">ldap_&#8203;bind</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-close.php.html" title="ldap_&#8203;close">ldap_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-compare.php.html" title="ldap_&#8203;compare">ldap_&#8203;compare</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-connect-wallet.php.html" title="ldap_&#8203;connect_&#8203;wallet">ldap_&#8203;connect_&#8203;wallet</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-connect.php.html" title="ldap_&#8203;connect">ldap_&#8203;connect</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-count-entries.php.html" title="ldap_&#8203;count_&#8203;entries">ldap_&#8203;count_&#8203;entries</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-count-references.php.html" title="ldap_&#8203;count_&#8203;references">ldap_&#8203;count_&#8203;references</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-delete-ext.php.html" title="ldap_&#8203;delete_&#8203;ext">ldap_&#8203;delete_&#8203;ext</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-delete.php.html" title="ldap_&#8203;delete">ldap_&#8203;delete</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-dn2ufn.php.html" title="ldap_&#8203;dn2ufn">ldap_&#8203;dn2ufn</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-err2str.php.html" title="ldap_&#8203;err2str">ldap_&#8203;err2str</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-errno.php.html" title="ldap_&#8203;errno">ldap_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-error.php.html" title="ldap_&#8203;error">ldap_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-escape.php.html" title="ldap_&#8203;escape">ldap_&#8203;escape</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-exop-passwd.php.html" title="ldap_&#8203;exop_&#8203;passwd">ldap_&#8203;exop_&#8203;passwd</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-exop-refresh.php.html" title="ldap_&#8203;exop_&#8203;refresh">ldap_&#8203;exop_&#8203;refresh</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-exop-sync.php.html" title="ldap_&#8203;exop_&#8203;sync">ldap_&#8203;exop_&#8203;sync</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-exop-whoami.php.html" title="ldap_&#8203;exop_&#8203;whoami">ldap_&#8203;exop_&#8203;whoami</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-exop.php.html" title="ldap_&#8203;exop">ldap_&#8203;exop</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-explode-dn.php.html" title="ldap_&#8203;explode_&#8203;dn">ldap_&#8203;explode_&#8203;dn</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-first-attribute.php.html" title="ldap_&#8203;first_&#8203;attribute">ldap_&#8203;first_&#8203;attribute</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-first-entry.php.html" title="ldap_&#8203;first_&#8203;entry">ldap_&#8203;first_&#8203;entry</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-first-reference.php.html" title="ldap_&#8203;first_&#8203;reference">ldap_&#8203;first_&#8203;reference</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-free-result.php.html" title="ldap_&#8203;free_&#8203;result">ldap_&#8203;free_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-get-attributes.php.html" title="ldap_&#8203;get_&#8203;attributes">ldap_&#8203;get_&#8203;attributes</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-get-dn.php.html" title="ldap_&#8203;get_&#8203;dn">ldap_&#8203;get_&#8203;dn</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-get-entries.php.html" title="ldap_&#8203;get_&#8203;entries">ldap_&#8203;get_&#8203;entries</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-get-option.php.html" title="ldap_&#8203;get_&#8203;option">ldap_&#8203;get_&#8203;option</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-get-values-len.php.html" title="ldap_&#8203;get_&#8203;values_&#8203;len">ldap_&#8203;get_&#8203;values_&#8203;len</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-get-values.php.html" title="ldap_&#8203;get_&#8203;values">ldap_&#8203;get_&#8203;values</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-list.php.html" title="ldap_&#8203;list">ldap_&#8203;list</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-mod_add-ext.php.html" title="ldap_&#8203;mod_&#8203;add_&#8203;ext">ldap_&#8203;mod_&#8203;add_&#8203;ext</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-mod-add.php.html" title="ldap_&#8203;mod_&#8203;add">ldap_&#8203;mod_&#8203;add</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-mod_del-ext.php.html" title="ldap_&#8203;mod_&#8203;del_&#8203;ext">ldap_&#8203;mod_&#8203;del_&#8203;ext</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-mod-del.php.html" title="ldap_&#8203;mod_&#8203;del">ldap_&#8203;mod_&#8203;del</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-mod_replace-ext.php.html" title="ldap_&#8203;mod_&#8203;replace_&#8203;ext">ldap_&#8203;mod_&#8203;replace_&#8203;ext</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-mod-replace.php.html" title="ldap_&#8203;mod_&#8203;replace">ldap_&#8203;mod_&#8203;replace</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-modify-batch.php.html" title="ldap_&#8203;modify_&#8203;batch">ldap_&#8203;modify_&#8203;batch</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-modify.php.html" title="ldap_&#8203;modify">ldap_&#8203;modify</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-next-attribute.php.html" title="ldap_&#8203;next_&#8203;attribute">ldap_&#8203;next_&#8203;attribute</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-next-entry.php.html" title="ldap_&#8203;next_&#8203;entry">ldap_&#8203;next_&#8203;entry</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-next-reference.php.html" title="ldap_&#8203;next_&#8203;reference">ldap_&#8203;next_&#8203;reference</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-parse-exop.php.html" title="ldap_&#8203;parse_&#8203;exop">ldap_&#8203;parse_&#8203;exop</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-parse-reference.php.html" title="ldap_&#8203;parse_&#8203;reference">ldap_&#8203;parse_&#8203;reference</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-parse-result.php.html" title="ldap_&#8203;parse_&#8203;result">ldap_&#8203;parse_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-read.php.html" title="ldap_&#8203;read">ldap_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-rename-ext.php.html" title="ldap_&#8203;rename_&#8203;ext">ldap_&#8203;rename_&#8203;ext</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-rename.php.html" title="ldap_&#8203;rename">ldap_&#8203;rename</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-sasl-bind.php.html" title="ldap_&#8203;sasl_&#8203;bind">ldap_&#8203;sasl_&#8203;bind</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-search.php.html" title="ldap_&#8203;search">ldap_&#8203;search</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-set-option.php.html" title="ldap_&#8203;set_&#8203;option">ldap_&#8203;set_&#8203;option</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-set-rebind-proc.php.html" title="ldap_&#8203;set_&#8203;rebind_&#8203;proc">ldap_&#8203;set_&#8203;rebind_&#8203;proc</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-sort.php.html" title="ldap_&#8203;sort">ldap_&#8203;sort</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-start-tls.php.html" title="ldap_&#8203;start_&#8203;tls">ldap_&#8203;start_&#8203;tls</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-t61-to-8859.php.html" title="ldap_&#8203;t61_&#8203;to_&#8203;8859">ldap_&#8203;t61_&#8203;to_&#8203;8859</a>
                        </li>
                                                <li class="">
                            <a href="function.ldap-unbind.php.html" title="ldap_&#8203;unbind">ldap_&#8203;unbind</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                        <li>
                <span class="header">Deprecated</span>
                <ul class="child-menu-list">
                                    <li class="">
                        <a href="function.ldap-control-paged-result-response.php.html" title="ldap_&#8203;control_&#8203;paged_&#8203;result_&#8203;response">ldap_&#8203;control_&#8203;paged_&#8203;result_&#8203;response</a>
                    </li>
                                    <li class="">
                        <a href="function.ldap-control-paged-result.php.html" title="ldap_&#8203;control_&#8203;paged_&#8203;result">ldap_&#8203;control_&#8203;paged_&#8203;result</a>
                    </li>
                                </ul>
            </li>
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
