<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: mysql_query - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mysql-query.php.html">
 <link rel="shorturl" href="https://www.php.net/mysql-query">
 <link rel="alternate" href="https://www.php.net/mysql-query" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.mysql.php.html">
 <link rel="prev" href="function.mysql-ping.php.html">
 <link rel="next" href="function.mysql-real-escape-string.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.mysql-query.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.mysql-query.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.mysql-query.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.mysql-query.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.mysql-query.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.mysql-query.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.mysql-query.php" hreflang="pt_BR">
 <link rel="alternate" href="function.mysql-query.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.mysql-query.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.mysql-query.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.mysql-real-escape-string.php.html">
          mysql_real_escape_string &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.mysql-ping.php.html">
          &laquo; mysql_ping        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.vendors.php.html'>Модули для работы с базами данных отдельных производителей</a></li>      <li><a href='set.mysqlinfo.php.html'>MySQL</a></li>      <li><a href='book.mysql.php.html'>MySQL (Original)</a></li>      <li><a href='ref.mysql.php.html'>MySQL</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.mysql-query.php'>English</option>
            <option value='de/function.mysql-query.php'>German</option>
            <option value='es/function.mysql-query.php'>Spanish</option>
            <option value='fr/function.mysql-query.php'>French</option>
            <option value='it/function.mysql-query.php'>Italian</option>
            <option value='ja/function.mysql-query.php'>Japanese</option>
            <option value='pt_BR/function.mysql-query.php'>Brazilian Portuguese</option>
            <option value='ru/function.mysql-query.php' selected="selected">Russian</option>
            <option value='tr/function.mysql-query.php'>Turkish</option>
            <option value='zh/function.mysql-query.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/mysql/functions/mysql-query.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.mysql-query%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.mysql-query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_query</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_query</span> &mdash; <span class="dc-title">Посылает запрос MySQL</span></p>

 </div>

 <div id="function.mysql-query-refsynopsisdiv">
  <div class="warning"><strong class="warning">Внимание</strong>
   <p class="para">Данный модуль устарел начиная с версии PHP 5.5.0, и удалён в PHP 7.0.0.
Используйте вместо него <a href="book.mysqli.php.html" class="link">MySQLi</a> или <a href="ref.pdo-mysql.php.html" class="link">PDO_MySQL</a>.
Смотрите также инструкцию <a href="mysqlinfo.api.choosing.php.html" class="link">MySQL: выбор API</a>.
Альтернативы для этой функции:</p>
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli.query.php.html" class="function">mysqli_query()</a></span></li>
    <li class="member"><span class="methodname"><a href="pdo.query.php.html" class="methodname">PDO::query()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-query-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mysql_query</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$link_identifier</code><span class="initializer"> = NULL</span></span>): <span class="type"><a href="language.types.declarations.php.html#language.types.declarations.mixed" class="type mixed">mixed</a></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mysql_query()</strong></span> посылает один запрос
   (посылка нескольких запросов не поддерживается) активной базе
   данных сервера, на который ссылается переданный дескриптор
   <code class="parameter">link_identifier</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-query-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       SQL-запрос
      </p>
      <p class="para">
       Запрос не должен заканчиваться точкой с запятой.
       Данные в запросе должны быть <a href="function.mysql-real-escape-string.php.html" class="link">корректно проэкранированы</a>.
      </p>
     </dd>

    
    <dt>

<code class="parameter">link_identifier</code></dt>
<dd>
<p class="para">Соединение MySQL. Если идентификатор соединения не был указан,
будет использовано последнее соединение, открытое <span class="function"><a href="function.mysql-connect.php.html" class="function">mysql_connect()</a></span>. Если такое соединение не было найдено,
функция попытается создать таковое, как если бы <span class="function"><a href="function.mysql-connect.php.html" class="function">mysql_connect()</a></span> была вызвана без параметров.
Если соединение не было найдено и не смогло быть создано, генерируется ошибка уровня <strong><code>E_WARNING</code></strong>.</p></dd>


   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-query-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Для запросов SELECT, SHOW, DESCRIBE, EXPLAIN и других запросов,
   возвращающих результат из нескольких рядов,
   <span class="function"><strong>mysql_query()</strong></span> возвращает дескриптор результата
   запроса (<span class="type">resource</span>), или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
  <p class="para">
   Для других типов SQL-запросов, INSERT, UPDATE, DELETE, DROP и других,
   <span class="function"><strong>mysql_query()</strong></span> возвращает <strong><code>true</code></strong> в случае успешного выполнения
   и <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
  <p class="para">
   Полученный дескриптор результата нужно передать в функцию
   <span class="function"><a href="function.mysql-fetch-assoc.php.html" class="function">mysql_fetch_assoc()</a></span> или любую другую функцию,
   работающую с результатами запросов.
  </p>
  <p class="para">
   Используйте <span class="function"><a href="function.mysql-num-rows.php.html" class="function">mysql_num_rows()</a></span> для выяснения
   количества рядов в результате SELECT-запроса или
   <span class="function"><a href="function.mysql-affected-rows.php.html" class="function">mysql_affected_rows()</a></span> для выяснения количества
   обработанных рядов запросами DELETE, INSERT, REPLACE и UPDATE.
  </p>
  <p class="para">
   <span class="function"><strong>mysql_query()</strong></span> также завершится с ошибкой и
   вернёт <strong><code>false</code></strong>, если у пользователя нет доступа к какой-либо из
   таблиц, фигурирующих в запросе.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysql-query-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-5383">
    <p><strong>Пример #1 Неверный запрос</strong></p>
    <div class="example-contents"><p>
     Следующий запрос составлен неправильно и
     <span class="function"><strong>mysql_query()</strong></span> вернёт <strong><code>false</code></strong>.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$result </span><span style="color: #007700">= </span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT * WHERE 1 = 1'</span><span style="color: #007700">);<br />if (!</span><span style="color: #0000BB">$result</span><span style="color: #007700">) {<br />    die(</span><span style="color: #DD0000">'Неверный запрос: ' </span><span style="color: #007700">. </span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">());<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5386">
    <p><strong>Пример #2 Верный запрос</strong></p>
    <div class="example-contents"><p>
     Следующий запрос верен, поэтому <span class="function"><strong>mysql_query()</strong></span>
     вернёт <span class="type">resource</span>.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// Эти данные, к примеру, могли быть получены от пользователя<br /></span><span style="color: #0000BB">$firstname </span><span style="color: #007700">= </span><span style="color: #DD0000">'fred'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$lastname  </span><span style="color: #007700">= </span><span style="color: #DD0000">'fox'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">// Формируем запрос<br />// Это лучший способ выполнить SQL-запрос<br />// Ещё примеры можно найти в документации mysql_real_escape_string()<br /></span><span style="color: #0000BB">$query </span><span style="color: #007700">= </span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT firstname, lastname, address, age FROM friends<br />    WHERE firstname='%s' AND lastname='%s'"</span><span style="color: #007700">,<br />    </span><span style="color: #0000BB">mysql_real_escape_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$firstname</span><span style="color: #007700">),<br />    </span><span style="color: #0000BB">mysql_real_escape_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$lastname</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">// Выполняем запрос<br /></span><span style="color: #0000BB">$result </span><span style="color: #007700">= </span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// Проверяем результат<br />// Это показывает реальный запрос, посланный к MySQL, а также ошибку. Удобно при отладке.<br /></span><span style="color: #007700">if (!</span><span style="color: #0000BB">$result</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">$message  </span><span style="color: #007700">= </span><span style="color: #DD0000">'Неверный запрос: ' </span><span style="color: #007700">. </span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">() . </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />    </span><span style="color: #0000BB">$message </span><span style="color: #007700">.= </span><span style="color: #DD0000">'Запрос целиком: ' </span><span style="color: #007700">. </span><span style="color: #0000BB">$query</span><span style="color: #007700">;<br />    die(</span><span style="color: #0000BB">$message</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">// Используем результат<br />// Попытка напечатать $result не выведет информацию, которая в нем хранится<br />// Необходимо использовать какую-либо mysql-функцию, работающую с результатом запроса<br />// Смотрите также mysql_result(), mysql_fetch_array(), mysql_fetch_row() и т.п.<br /></span><span style="color: #007700">while (</span><span style="color: #0000BB">$row </span><span style="color: #007700">= </span><span style="color: #0000BB">mysql_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)) {<br />    echo </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'firstname'</span><span style="color: #007700">];<br />    echo </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'lastname'</span><span style="color: #007700">];<br />    echo </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'address'</span><span style="color: #007700">];<br />    echo </span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'age'</span><span style="color: #007700">];<br />}<br /><br /></span><span style="color: #FF8000">// Освобождаем ресурсы, ассоциированные с результатом<br />// Это делается автоматически в конце скрипта<br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-query-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-connect.php.html" class="function" rel="rdfs-seeAlso">mysql_connect()</a> - Открывает соединение с сервером MySQL</span></li>
    <li class="member"><span class="function"><a href="function.mysql-error.php.html" class="function" rel="rdfs-seeAlso">mysql_error()</a> - Возвращает текст ошибки последней операции с MySQL</span></li>
    <li class="member"><span class="function"><a href="function.mysql-real-escape-string.php.html" class="function" rel="rdfs-seeAlso">mysql_real_escape_string()</a> - Экранирует специальные символы в строках для использования в выражениях SQL</span></li>
    <li class="member"><span class="function"><a href="function.mysql-result.php.html" class="function" rel="rdfs-seeAlso">mysql_result()</a> - Возвращает данные результата запроса</span></li>
    <li class="member"><span class="function"><a href="function.mysql-fetch-assoc.php.html" class="function" rel="rdfs-seeAlso">mysql_fetch_assoc()</a> - Возвращает ряд результата запроса в качестве ассоциативного массива</span></li>
    <li class="member"><span class="function"><a href="function.mysql-unbuffered-query.php.html" class="function" rel="rdfs-seeAlso">mysql_unbuffered_query()</a> - Посылает запрос MySQL без авто-обработки результата и его буферизации</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.mysql-query&amp;redirect=https://www.php.net/manual/ru/function.mysql-query.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">26 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="76848">  <div class="votes">
    <div id="Vu76848">
    <a href="https://www.php.net/manual/vote-note.php?id=76848&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd76848">
    <a href="https://www.php.net/manual/vote-note.php?id=76848&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V76848" title="54% like this...">
    13
    </div>
  </div>
  <a href="function.mysql-query.php.html#76848" class="name">
  <strong class="user"><em>jack dot whoami at gmail dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#76848"> &para;</a><div class="date" title="2007-08-01 06:13"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom76848">
<div class="phpcode"><code><span class="html">Simulating an atomic operation for application locks using mysql.<br /><br />$link = mysql_connect('localhost', 'user', 'pass');<br />if (!$link) {<br />    die('Not connected : ' . mysql_error());<br />}<br /><br />// make foo the current db<br />$db_selected = mysql_select_db('foo', $link);<br />if (!$db_selected) {<br />    die ('Can\'t use foo : ' . mysql_error());<br />}<br /><br />$q = "update `table` set `LOCK`='F' where `ID`='1'";<br />$lock = mysql_affected_rows();<br /><br />If we assume<br />     NOT LOCKED = "" (empty string)<br />     LOCKED = 'F'<br /><br />then if the column LOCK had a value other than F (normally should be an empty string) the update statement sets it to F and set the affected rows to 1. Which mean than we got the lock.<br />If affected rows return 0 then the value of that column was already F and somebody else has the lock.<br /><br />The secret lies in the following statement taken from the mysql manual:<br />"If you set a column to the value it currently has, MySQL notices this and does not update it."<br /><br />Of course all this is possible if the all application processes agree on the locking algorithm.</span></code></div>
  </div>
 </div>
  <div class="note" id="76991">  <div class="votes">
    <div id="Vu76991">
    <a href="https://www.php.net/manual/vote-note.php?id=76991&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd76991">
    <a href="https://www.php.net/manual/vote-note.php?id=76991&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V76991" title="52% like this...">
    6
    </div>
  </div>
  <a href="function.mysql-query.php.html#76991" class="name">
  <strong class="user"><em>halion at gmail dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#76991"> &para;</a><div class="date" title="2007-08-09 02:53"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom76991">
<div class="phpcode"><code><span class="html">mysql_query doesnt support multiple queries, a way round this is to use innodb and transactions<br /><br />this db class/function will accept an array of arrays of querys, it will auto check every line for affected rows in db, if one is 0 it will rollback and return false, else it will commit and return true, the call to the function is simple and is easy to read etc<br />----------<br /><br />class MySQLDB<br />{<br />   private $connection;          // The MySQL database connection<br /><br />   /* Class constructor */<br />   function MySQLDB(){<br />      /* Make connection to database */<br />      $this-&gt;connection = mysql_connect(DB_SERVER, DB_USER, DB_PASS) or die(mysql_error());<br />      mysql_select_db(DB_NAME, $this-&gt;connection) or die(mysql_error());<br />   }<br /><br />   /* Transactions functions */<br /><br />   function begin(){<br />      $null = mysql_query("START TRANSACTION", $this-&gt;connection);<br />      return mysql_query("BEGIN", $this-&gt;connection);<br />   }<br /><br />   function commit(){<br />      return mysql_query("COMMIT", $this-&gt;connection);<br />   }<br />   <br />   function rollback(){<br />      return mysql_query("ROLLBACK", $this-&gt;connection);<br />   }<br /><br />   function transaction($q_array){<br />         $retval = 1;<br /><br />      $this-&gt;begin();<br /><br />         foreach($q_array as $qa){<br />            $result = mysql_query($qa['query'], $this-&gt;connection);<br />            if(mysql_affected_rows() == 0){ $retval = 0; }<br />         }<br /><br />      if($retval == 0){<br />         $this-&gt;rollback();<br />         return false;<br />      }else{<br />         $this-&gt;commit();<br />         return true;<br />      }<br />   }<br /><br />};<br /><br />/* Create database connection object */<br />$database = new MySQLDB;<br /><br />// then from anywhere else simply put the transaction queries in an array or arrays like this:<br /><br />   function function(){<br />      global $database;<br /><br />      $q = array ( <br />         array("query" =&gt; "UPDATE table WHERE something = 'something'"),<br />         array("query" =&gt; "UPDATE table WHERE something_else = 'something_else'"),<br />         array("query" =&gt; "DELETE FROM table WHERE something_else2 = 'something_else2'"),<br />      );<br /><br />      $database-&gt;transaction($q);<br /><br />   }</span></code></div>
  </div>
 </div>
  <div class="note" id="62247">  <div class="votes">
    <div id="Vu62247">
    <a href="https://www.php.net/manual/vote-note.php?id=62247&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd62247">
    <a href="https://www.php.net/manual/vote-note.php?id=62247&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V62247" title="52% like this...">
    3
    </div>
  </div>
  <a href="function.mysql-query.php.html#62247" class="name"><strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#62247"> &para;</a><div class="date" title="2006-02-22 11:11"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom62247">
<div class="phpcode"><code><span class="html">If, like me, you come from perl, you may not like having to use sprintf to 'simulate' placeholders that the DBI package from perl provides. I have created the following wrapper function for mysql_query() that allows you to use '?' characters to substitute values in your DB queries. Note that this is not how DBI in perl handles placeholders, but it's pretty similar.<br /><br /><span class="default">&lt;?php<br />    </span><span class="comment">// mysql_query() wrapper. takes two arguments. first<br />    // is the query with '?' placeholders in it. second argument<br />    // is an array containing the values to substitute in place<br />    // of the placeholders (in order, of course).<br />    </span><span class="keyword">function </span><span class="default">mysql_prepare </span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$phs </span><span class="keyword">= array()) {<br />        foreach (</span><span class="default">$phs </span><span class="keyword">as </span><span class="default">$ph</span><span class="keyword">) {<br />            </span><span class="default">$ph </span><span class="keyword">= </span><span class="string">"'" </span><span class="keyword">. </span><span class="default">mysql_real_escape_string</span><span class="keyword">(</span><span class="default">$ph</span><span class="keyword">) . </span><span class="string">"'"</span><span class="keyword">;<br />            </span><span class="default">$query </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(<br />                </span><span class="default">$query</span><span class="keyword">, </span><span class="default">$ph</span><span class="keyword">, </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">), </span><span class="default">1<br />            </span><span class="keyword">);<br />        }<br /><br />        return </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />    }<br /><br />    </span><span class="comment">// sample usage<br />    </span><span class="keyword">list(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$passwd</span><span class="keyword">) = array(</span><span class="string">'myuser'</span><span class="keyword">, </span><span class="string">'mypass'</span><span class="keyword">);<br /><br />    </span><span class="default">$sth </span><span class="keyword">= </span><span class="default">mysql_prepare</span><span class="keyword">(<br />        </span><span class="string">'select userid from users where userid=? and passwd=?'</span><span class="keyword">,<br />        array(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">sha1</span><span class="keyword">(</span><span class="default">$passwd</span><span class="keyword">))<br />    );<br />    </span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_row</span><span class="keyword">(</span><span class="default">$sth</span><span class="keyword">);<br /><br />    </span><span class="comment">// successfull username &amp; password authentication<br />    </span><span class="keyword">if (</span><span class="default">$row </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br />        echo </span><span class="string">"logging in as '</span><span class="keyword">{</span><span class="default">$row</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]}</span><span class="string">'!\n"</span><span class="keyword">;<br />    }<br /><br />    </span><span class="comment">// oops, wrong userid or passwd<br />    </span><span class="keyword">else {<br />        echo </span><span class="string">"Invalid username and password combination.\n"</span><span class="keyword">;<br />    }<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="122783">  <div class="votes">
    <div id="Vu122783">
    <a href="https://www.php.net/manual/vote-note.php?id=122783&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122783">
    <a href="https://www.php.net/manual/vote-note.php?id=122783&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122783" title="52% like this...">
    1
    </div>
  </div>
  <a href="function.mysql-query.php.html#122783" class="name">
  <strong class="user"><em>fbraz3 at gmail dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#122783"> &para;</a><div class="date" title="2018-05-30 07:36"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom122783">
<div class="phpcode"><code><span class="html">This project implements a wrapper to mysql functions in PHP7.0+<br /><br /><a href="https://github.com/OOPS-ORG-PHP/mysql-extension-wrapper" rel="nofollow" target="_blank">https://github.com/OOPS-ORG-PHP/mysql-extension-wrapper</a><br /><br />tested and working fine =)</span></code></div>
  </div>
 </div>
  <div class="note" id="2984">  <div class="votes">
    <div id="Vu2984">
    <a href="https://www.php.net/manual/vote-note.php?id=2984&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd2984">
    <a href="https://www.php.net/manual/vote-note.php?id=2984&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V2984" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.mysql-query.php.html#2984" class="name">
  <strong class="user"><em>nikhil-php at nols dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#2984"> &para;</a><div class="date" title="2000-01-02 12:38"><strong>24 years ago</strong></div>
  <div class="text" id="Hcom2984">
<div class="phpcode"><code><span class="html">When trying to INSERT or UPDATE and trying to put a large amount of text or data (blob) into a mysql table you might run into problems.<br /><br />In mysql.err you might see:<br />Packet too large (73904)<br /><br />To fix you just have to start up mysql with the option -O max_allowed_packet=maxsize <br /><br />You would just replace maxsize with the max size you want to insert, the default is 65536</span></code></div>
  </div>
 </div>
  <div class="note" id="85807">  <div class="votes">
    <div id="Vu85807">
    <a href="https://www.php.net/manual/vote-note.php?id=85807&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd85807">
    <a href="https://www.php.net/manual/vote-note.php?id=85807&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V85807" title="49% like this...">
    -1
    </div>
  </div>
  <a href="function.mysql-query.php.html#85807" class="name">
  <strong class="user"><em>Mr. Tim</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#85807"> &para;</a><div class="date" title="2008-09-18 11:42"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom85807">
<div class="phpcode"><code><span class="html">It should be noted that mysql_query can generate an E_WARNING (not documented).  The warning that I hit was when the db user did not have permission to execute a UDF. <br /><br />Expected behavior would be like an Invalid SQL statement, where there is no E_WARNING generated by mysql_query.<br /><br />Warning: mysql_query() [function.mysql-query]: Unable to save result set in filename.php<br /><br />The mysql_errno is 1370 and the mysql_error is:<br /><br />execute command denied to user 'username'@'%' for routine 'database_name.MyUDF'</span></code></div>
  </div>
 </div>
  <div class="note" id="31381">  <div class="votes">
    <div id="Vu31381">
    <a href="https://www.php.net/manual/vote-note.php?id=31381&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd31381">
    <a href="https://www.php.net/manual/vote-note.php?id=31381&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V31381" title="47% like this...">
    -2
    </div>
  </div>
  <a href="function.mysql-query.php.html#31381" class="name">
  <strong class="user"><em>davidc at edeca dot net</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#31381"> &para;</a><div class="date" title="2003-04-19 12:30"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom31381">
<div class="phpcode"><code><span class="html">Regarding the idea for returning all possible values of an enum field, the mySQL manual says that "SHOW COLUMNS FROM table LIKE column" should be used to do this.<br /><br />The function below (presumes db connection) will return an array of the possible values of an enum.<br /><br />function GetEnumValues($Table,$Column)<br />    {<br />    $dbSQL = "SHOW COLUMNS FROM ".$Table." LIKE '".$Column."'";<br />    $dbQuery = mysql_query($dbSQL);<br /><br />    $dbRow = mysql_fetch_assoc($dbQuery);<br />    $EnumValues = $dbRow["Type"];<br /><br />    $EnumValues = substr($EnumValues, 6, strlen($EnumValues)-8); <br />    $EnumValues = str_replace("','",",",$EnumValues);<br /><br />    return explode(",",$EnumValues);<br />    }<br /><br />Cavaets:<br /><br />1) If the LIKE matches more than one column you get the enum from the first, so be careful with the $Column argument<br />2) You can't have ',' as part of one of the enums (I guess mySQL would escape this, but I haven't tried)<br />3) If the field isn't an enum you'll get garbage back!<br /><br />This is just a quick example to show how to do it, some tidying up needs to be done (ie checking if the field is actually an enum) before it is perfect.</span></code></div>
  </div>
 </div>
  <div class="note" id="88602">  <div class="votes">
    <div id="Vu88602">
    <a href="https://www.php.net/manual/vote-note.php?id=88602&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd88602">
    <a href="https://www.php.net/manual/vote-note.php?id=88602&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V88602" title="48% like this...">
    -3
    </div>
  </div>
  <a href="function.mysql-query.php.html#88602" class="name">
  <strong class="user"><em>ialsoagree</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#88602"> &para;</a><div class="date" title="2009-01-30 08:24"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom88602">
<div class="phpcode"><code><span class="html">When you run a select statement and receive a response, the data types of your response will be a string regardless of the data type of the column.<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Query to select an int column<br /></span><span class="default">$query </span><span class="keyword">= </span><span class="string">'SELECT user_id FROM users WHERE user_id = 1'</span><span class="keyword">;<br /></span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br /></span><span class="default">$array </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br /><br /></span><span class="comment">// Echoes: string<br /></span><span class="keyword">echo </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">'user_id'</span><span class="keyword">]);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="79255">  <div class="votes">
    <div id="Vu79255">
    <a href="https://www.php.net/manual/vote-note.php?id=79255&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd79255">
    <a href="https://www.php.net/manual/vote-note.php?id=79255&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V79255" title="47% like this...">
    -3
    </div>
  </div>
  <a href="function.mysql-query.php.html#79255" class="name">
  <strong class="user"><em>masteracc0 at aol dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#79255"> &para;</a><div class="date" title="2007-11-17 10:00"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom79255">
<div class="phpcode"><code><span class="html">Keep in mind when dealing with PHP &amp; MySQL that sending a null-terminated string to a MySQL query can be misleading if you use echo($sql) in PHP because the null terminator may not be visible.<br /><br />For example (this assumes connection is already made),<br />$string1 = "mystring\0";<br />$string2 = "mystring";<br /><br />$query1 = "SELECT * FROM table WHERE mystring='".$string1."'"<br />$query2 = "SELECT * FROM table WHERE mystring='".$string2."'"<br /> <br />$result1 = mysql_query($query1);<br /><br />$result2 = mysql_query($query2);<br /><br />//$result1 IS NOT EQUAL TO $result2 but will not provide an error<br /><br />//but printing these queries to the screen will provide the same result<br />echo($result1);<br />echo($result2);<br /><br />Not knowing this could lead to some mind-numbing troubleshooting when dealing with any strings with a null terminator.  So now you know! :)</span></code></div>
  </div>
 </div>
  <div class="note" id="101488">  <div class="votes">
    <div id="Vu101488">
    <a href="https://www.php.net/manual/vote-note.php?id=101488&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd101488">
    <a href="https://www.php.net/manual/vote-note.php?id=101488&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V101488" title="48% like this...">
    -5
    </div>
  </div>
  <a href="function.mysql-query.php.html#101488" class="name">
  <strong class="user"><em>ddlshack [at] gmail.dot.com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#101488"> &para;</a><div class="date" title="2010-12-20 09:12"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom101488">
<div class="phpcode"><code><span class="html">Use this to neatly insert data into a mysql table:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">mysql_insert</span><span class="keyword">(</span><span class="default">$table</span><span class="keyword">, </span><span class="default">$inserts</span><span class="keyword">) {<br />    </span><span class="default">$values </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'mysql_real_escape_string'</span><span class="keyword">, </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$inserts</span><span class="keyword">));<br />    </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$inserts</span><span class="keyword">);<br />        <br />    return </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'INSERT INTO `'</span><span class="keyword">.</span><span class="default">$table</span><span class="keyword">.</span><span class="string">'` (`'</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">'`,`'</span><span class="keyword">, </span><span class="default">$keys</span><span class="keyword">).</span><span class="string">'`) VALUES (\''</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">'\',\''</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">).</span><span class="string">'\')'</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />For example:<br /><br /><span class="default">&lt;?php<br /><br />mysql_insert</span><span class="keyword">(</span><span class="string">'cars'</span><span class="keyword">, array(<br />    </span><span class="string">'make' </span><span class="keyword">=&gt; </span><span class="string">'Aston Martin'</span><span class="keyword">,<br />    </span><span class="string">'model' </span><span class="keyword">=&gt; </span><span class="string">'DB9'</span><span class="keyword">,<br />    </span><span class="string">'year' </span><span class="keyword">=&gt; </span><span class="string">'2009'</span><span class="keyword">,<br />));<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="67943">  <div class="votes">
    <div id="Vu67943">
    <a href="https://www.php.net/manual/vote-note.php?id=67943&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd67943">
    <a href="https://www.php.net/manual/vote-note.php?id=67943&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V67943" title="46% like this...">
    -3
    </div>
  </div>
  <a href="function.mysql-query.php.html#67943" class="name">
  <strong class="user"><em>rob desbois</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#67943"> &para;</a><div class="date" title="2006-07-07 02:38"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom67943">
<div class="phpcode"><code><span class="html">Note that the 'source' command used in the mysql client program is *not* a feature of the server but of the client.<br />This means that you cannot do<br />   mysql_query('source myfile.sql');<br />You will get a syntax error. Use LOAD DATA INFILE as an alternative.</span></code></div>
  </div>
 </div>
  <div class="note" id="70132">  <div class="votes">
    <div id="Vu70132">
    <a href="https://www.php.net/manual/vote-note.php?id=70132&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd70132">
    <a href="https://www.php.net/manual/vote-note.php?id=70132&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V70132" title="44% like this...">
    -4
    </div>
  </div>
  <a href="function.mysql-query.php.html#70132" class="name">
  <strong class="user"><em>veyita_angi at hotmail dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#70132"> &para;</a><div class="date" title="2006-10-04 09:35"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom70132">
<div class="phpcode"><code><span class="html">this could be a nice way to print values from 2 tables with a foreign key. i have not yet tested correctly but it should work fine.<br /><br />$buscar = mysql_query("SELECT k.*, e.Clasificacion FROM cat_plan_k k, cat_equipo e WHERE Tipo='$tipo' AND k.ID_Eq=a.ID_Eq"); <br />    while ($row=mysql_fetch_array($buscar))<br />        {<br />            $nombre = "e.Clasificacion"; <br />            $row[$nombre] = $Clasific; echo $row[$nombre].'convertido en '.$Clasific;<br />        }          <br />    mysql_free_result($buscar);</span></code></div>
  </div>
 </div>
  <div class="note" id="57377">  <div class="votes">
    <div id="Vu57377">
    <a href="https://www.php.net/manual/vote-note.php?id=57377&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd57377">
    <a href="https://www.php.net/manual/vote-note.php?id=57377&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V57377" title="43% like this...">
    -4
    </div>
  </div>
  <a href="function.mysql-query.php.html#57377" class="name">
  <strong class="user"><em>php at arcannon dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#57377"> &para;</a><div class="date" title="2005-10-01 03:30"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom57377">
<div class="phpcode"><code><span class="html">I believe there is a typo in celtic at raven-blue dot com version with:<br /><br />if (($sql != "") &amp;&amp; (substr($tsl, 0, 2) != "--") &amp;&amp; (substr($tsl, 0, 1) != "#")) {<br /><br />I think you really ment: <br /><br />if (($tsl != "") &amp;&amp; (substr($tsl, 0, 2) != "--") &amp;&amp; (substr($tsl, 0, 1) != "#")) {<br /><br />I changed the $sql to $tsl</span></code></div>
  </div>
 </div>
  <div class="note" id="31078">  <div class="votes">
    <div id="Vu31078">
    <a href="https://www.php.net/manual/vote-note.php?id=31078&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd31078">
    <a href="https://www.php.net/manual/vote-note.php?id=31078&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V31078" title="43% like this...">
    -5
    </div>
  </div>
  <a href="function.mysql-query.php.html#31078" class="name"><strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#31078"> &para;</a><div class="date" title="2003-04-09 12:43"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom31078">
<div class="phpcode"><code><span class="html">Until this function prohibits them, watch out for SQL comments (--) in your input.</span></code></div>
  </div>
 </div>
  <div class="note" id="82429">  <div class="votes">
    <div id="Vu82429">
    <a href="https://www.php.net/manual/vote-note.php?id=82429&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd82429">
    <a href="https://www.php.net/manual/vote-note.php?id=82429&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V82429" title="41% like this...">
    -6
    </div>
  </div>
  <a href="function.mysql-query.php.html#82429" class="name">
  <strong class="user"><em>rogier</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#82429"> &para;</a><div class="date" title="2008-04-10 06:55"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom82429">
<div class="phpcode"><code><span class="html">For all you programmers out there getting the 'Command out of synch' errors when executing a stored procedure call:<br /><br />There are known bugs related to this issue, and the best workaround for avoiding this error seems to be switching to mysqli.<br /><br />Still, I needed mysql to also handle these calls correctly.<br />The error is normally related to wrong function call sequences, though the bug report at  <a href="http://bugs.php.net/bug.php?id=39727" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=39727</a> shows otherwise.<br /><br />For me, after commenting out hundreds of lines and several introspection calls to parse the procedure information (using information_schema and 'SHOW' extensions), I still got the same error.<br />The first result is returned, because I initiated my connection using the MYSQL_MULTI_RESULTS value of 131072 (forget this and you will never get any output, but an error message stating mysql cannot return results in this context)<br /><br />After testing with this code (sproc2 simply calls 'SELECT * FROM sometable'), I found the error must be in the mysql library/extension. Somehow, mysql does not handle multiple resultsets correctly, or is at least missing some functionality related to handling multiple results.<br /><br /><span class="default">&lt;?php<br />    </span><span class="comment">//...<br />    </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'CALL sproc2(500)'</span><span class="keyword">);<br />    while ((</span><span class="default">$row</span><span class="keyword">=</span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">))!==</span><span class="default">false</span><span class="keyword">) {<br />        </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);<br />    }<br />    </span><span class="default">mysql_free_result</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">);<br /><br />    </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'CALL sproc2(500)'</span><span class="keyword">);<br />    print </span><span class="default">mysql_error</span><span class="keyword">(); </span><span class="comment">//the notorious 'command out of synch' message :(<br />    </span><span class="keyword">while ((</span><span class="default">$row</span><span class="keyword">=</span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">))!==</span><span class="default">false</span><span class="keyword">) {<br />        </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);<br />    }<br />    </span><span class="default">mysql_free_result</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />After spending hours debugging my code (the full library is already over the MB), the only solution seemed to be to CLOSE the connection after the first call, and reopening it before the second. <br /><br />So if you ever make a uniform database accessing interface and implement stored procedures/prepared statements (or classes for it), this could be a solution if you really wish to enable stored procedures.<br /><br />Still, be aware that this is really a serious flaw in your design (and IMHO, the mysql extension)<br /><br />Also see the documentation for mysqli on mysqli_query, which seems to be working fine.</span></code></div>
  </div>
 </div>
  <div class="note" id="83884">  <div class="votes">
    <div id="Vu83884">
    <a href="https://www.php.net/manual/vote-note.php?id=83884&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83884">
    <a href="https://www.php.net/manual/vote-note.php?id=83884&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83884" title="39% like this...">
    -6
    </div>
  </div>
  <a href="function.mysql-query.php.html#83884" class="name">
  <strong class="user"><em>fernandoleal at loytek dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#83884"> &para;</a><div class="date" title="2008-06-16 03:28"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83884">
<div class="phpcode"><code><span class="html">Dunno if is it a bug but when you are working with replications servers and work with multiple databases queries if you don't select the database it will only insert,update,delete into the master and bypass the slave, I think it its because it doesn't insert the sql on the binary log so the work around its to just call mysql_select_db <br />MYSQL : 5.0.51a-log<br />PHP: 5.2.6<br />Example:<br /><span class="default">&lt;?php<br /></span><span class="comment">#Inserts only to master<br /></span><span class="default">$link</span><span class="keyword">=</span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'host'</span><span class="keyword">,</span><span class="string">'user'</span><span class="keyword">,</span><span class="string">'pass'</span><span class="keyword">);<br /></span><span class="default">$sql </span><span class="keyword">=</span><span class="string">"INSERT INTO mysql.host (host) VALUES ('localhost');"<br /></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">,</span><span class="default">$link</span><span class="keyword">));<br /><br /></span><span class="comment">#The Working Way Master - Slave<br /></span><span class="default">$link2</span><span class="keyword">=</span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'host'</span><span class="keyword">,</span><span class="string">'user'</span><span class="keyword">,</span><span class="string">'pass'</span><span class="keyword">);<br /></span><span class="default">$select_db </span><span class="keyword">= </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">'mysql'</span><span class="keyword">, </span><span class="default">$link2</span><span class="keyword">);<br /></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">,</span><span class="default">$link2</span><span class="keyword">));   <br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="69365">  <div class="votes">
    <div id="Vu69365">
    <a href="https://www.php.net/manual/vote-note.php?id=69365&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd69365">
    <a href="https://www.php.net/manual/vote-note.php?id=69365&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V69365" title="36% like this...">
    -6
    </div>
  </div>
  <a href="function.mysql-query.php.html#69365" class="name">
  <strong class="user"><em>cc+php at c2se dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#69365"> &para;</a><div class="date" title="2006-09-02 05:39"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom69365">
<div class="phpcode"><code><span class="html">Here's a parameterised query function for MySQL similar to pg_query_params, I've been using something similar for a while now and while there is a slight drop in speed, it's far better than making a mistake escaping the parameters of your query and allowing an SQL injection attack on your server.<br /><br /><span class="default">&lt;?php   </span><span class="comment"># Parameterised query implementation for MySQL (similar PostgreSQL's PHP function pg_query_params)<br />        # Example: mysql_query_params( "SELECT * FROM my_table WHERE col1=$1 AND col2=$2", array( 42, "It's ok" ) );<br /><br />        </span><span class="keyword">if( !</span><span class="default">function_exists</span><span class="keyword">( </span><span class="string">'mysql_query_params' </span><span class="keyword">) ) {<br /><br />                function </span><span class="default">mysql_query_params__callback</span><span class="keyword">( </span><span class="default">$at </span><span class="keyword">) {<br />                        global </span><span class="default">$mysql_query_params__parameters</span><span class="keyword">;<br />                        return </span><span class="default">$mysql_query_params__parameters</span><span class="keyword">[ </span><span class="default">$at</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-</span><span class="default">1 </span><span class="keyword">];<br />                }<br /><br />                function </span><span class="default">mysql_query_params</span><span class="keyword">( </span><span class="default">$query</span><span class="keyword">, </span><span class="default">$parameters</span><span class="keyword">=array(), </span><span class="default">$database</span><span class="keyword">=</span><span class="default">false </span><span class="keyword">) {<br /><br />                        </span><span class="comment">// Escape parameters as required &amp; build parameters for callback function<br />                        </span><span class="keyword">global </span><span class="default">$mysql_query_params__parameters</span><span class="keyword">;<br />                        foreach( </span><span class="default">$parameters </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v </span><span class="keyword">)<br />                                </span><span class="default">$parameters</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = ( </span><span class="default">is_int</span><span class="keyword">( </span><span class="default">$v </span><span class="keyword">) ? </span><span class="default">$v </span><span class="keyword">: ( </span><span class="default">NULL</span><span class="keyword">===</span><span class="default">$v </span><span class="keyword">? </span><span class="string">'NULL' </span><span class="keyword">: </span><span class="string">"'"</span><span class="keyword">.</span><span class="default">mysql_real_escape_string</span><span class="keyword">( </span><span class="default">$v </span><span class="keyword">).</span><span class="string">"'" </span><span class="keyword">) );<br />                        </span><span class="default">$mysql_query_params__parameters </span><span class="keyword">= </span><span class="default">$parameters</span><span class="keyword">;<br /><br />                        </span><span class="comment">// Call using mysql_query<br />                        </span><span class="keyword">if( </span><span class="default">false</span><span class="keyword">===</span><span class="default">$database </span><span class="keyword">)<br />                                return </span><span class="default">mysql_query</span><span class="keyword">( </span><span class="default">preg_replace_callback</span><span class="keyword">( </span><span class="string">'/\$([0-9]+)/'</span><span class="keyword">, </span><span class="string">'mysql_query_params__callback'</span><span class="keyword">, </span><span class="default">$query </span><span class="keyword">) );<br />                        else    return </span><span class="default">mysql_query</span><span class="keyword">( </span><span class="default">preg_replace_callback</span><span class="keyword">( </span><span class="string">'/\$([0-9]+)/'</span><span class="keyword">, </span><span class="string">'mysql_query_params__callback'</span><span class="keyword">, </span><span class="default">$query </span><span class="keyword">), </span><span class="default">$database </span><span class="keyword">);<br /><br />                }<br />        }<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="108160">  <div class="votes">
    <div id="Vu108160">
    <a href="https://www.php.net/manual/vote-note.php?id=108160&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd108160">
    <a href="https://www.php.net/manual/vote-note.php?id=108160&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V108160" title="40% like this...">
    -11
    </div>
  </div>
  <a href="function.mysql-query.php.html#108160" class="name">
  <strong class="user"><em>mwwaygoo at hotmail dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#108160"> &para;</a><div class="date" title="2012-04-03 02:16"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom108160">
<div class="phpcode"><code><span class="html">I much prefer to use the same syntax for single INSERT, REPLACE and UPDATE queries as it is easier to read and keeps my code shorter (no seperate building of insert and update values)<br /><br />INSERT INTO table SET x='1', y=3<br />UPDATE table SET x='2' WHERE y=3<br /><br />So if your using a function to build your query, you will only ever need to code the "field=value, field2=value2" part for any query.</span></code></div>
  </div>
 </div>
  <div class="note" id="55811">  <div class="votes">
    <div id="Vu55811">
    <a href="https://www.php.net/manual/vote-note.php?id=55811&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd55811">
    <a href="https://www.php.net/manual/vote-note.php?id=55811&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V55811" title="39% like this...">
    -10
    </div>
  </div>
  <a href="function.mysql-query.php.html#55811" class="name">
  <strong class="user"><em>ix at nivelzero dot ro</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#55811"> &para;</a><div class="date" title="2005-08-14 03:07"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom55811">
<div class="phpcode"><code><span class="html">here's a script for parsing a *.sql file (tested only on dumps created with phpMyAdmin) which is short and simple (why do people say "here's a short and simple script" and it has a 100 lines?). the script skips comments and allows ; to be present within the querys<br /><br /><span class="default">&lt;?php<br />  </span><span class="keyword">function </span><span class="default">parse_mysql_dump</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">){<br />    </span><span class="default">$file_content </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />    </span><span class="default">$query </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />    foreach(</span><span class="default">$file_content </span><span class="keyword">as </span><span class="default">$sql_line</span><span class="keyword">){<br />      if(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$sql_line</span><span class="keyword">) != </span><span class="string">"" </span><span class="keyword">&amp;&amp; </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sql_line</span><span class="keyword">, </span><span class="string">"--"</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">){<br />        </span><span class="default">$query </span><span class="keyword">.= </span><span class="default">$sql_line</span><span class="keyword">;<br />        if(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/;[\040]*\$/"</span><span class="keyword">, </span><span class="default">$sql_line</span><span class="keyword">)){<br />          </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">)or die(</span><span class="default">mysql_error</span><span class="keyword">());<br />          </span><span class="default">$query </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />        }<br />      }<br />    }<br />  }<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="37870">  <div class="votes">
    <div id="Vu37870">
    <a href="https://www.php.net/manual/vote-note.php?id=37870&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd37870">
    <a href="https://www.php.net/manual/vote-note.php?id=37870&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V37870" title="35% like this...">
    -8
    </div>
  </div>
  <a href="function.mysql-query.php.html#37870" class="name">
  <strong class="user"><em>Predrag Supurovic</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#37870"> &para;</a><div class="date" title="2003-11-30 04:52"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom37870">
<div class="phpcode"><code><span class="html">If you need to execute sevaral SQL commands in a row (usually called batcg SQL) using PHP you canot use mysql_query() since it can execute single command only.<br /><br />Here is simple but effective function that can run batch SQL commands. Take cere, if string contains semicolon (;) anywhere except as command delimiter (within string expression for example) function will not work.<br /><br />function mysql_exec_batch ($p_query, $p_transaction_safe = true) {<br />  if ($p_transaction_safe) {<br />      $p_query = 'START TRANSACTION;' . $p_query . '; COMMIT;';<br />    };<br />  $query_split = preg_split ("/[;]+/", $p_query);<br />  foreach ($query_split as $command_line) {<br />    $command_line = trim($command_line);<br />    if ($command_line != '') {<br />      $query_result = mysql_query($command_line);<br />      if ($query_result == 0) {<br />        break;<br />      };<br />    };<br />  };<br />  return $query_result;<br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="49375">  <div class="votes">
    <div id="Vu49375">
    <a href="https://www.php.net/manual/vote-note.php?id=49375&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd49375">
    <a href="https://www.php.net/manual/vote-note.php?id=49375&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V49375" title="34% like this...">
    -8
    </div>
  </div>
  <a href="function.mysql-query.php.html#49375" class="name">
  <strong class="user"><em>jon at websandbox dot net</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#49375"> &para;</a><div class="date" title="2005-01-25 05:25"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom49375">
<div class="phpcode"><code><span class="html">I think it's important to note (for newbies, like me especially) that an empty result is not the same as an error:<br /><span class="default">&lt;?php<br /></span><span class="comment">/* 'bar' is an empty table in the db */<br /></span><span class="default">$rs </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"SELECT `foo` FROM `bar`"</span><span class="keyword">)<br />if(</span><span class="default">$rs</span><span class="keyword">) {<br />  echo </span><span class="default">mysql_num_rows</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">); </span><span class="comment">//outputs: 0<br /></span><span class="keyword">}<br /><br /></span><span class="comment">/* malformed query /*<br />$rs = mysql_query("SELECT `foo` FRO `bar`");<br />if($rs) {<br />  echo "This will never be echoed";<br />}<br />?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="30783">  <div class="votes">
    <div id="Vu30783">
    <a href="https://www.php.net/manual/vote-note.php?id=30783&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd30783">
    <a href="https://www.php.net/manual/vote-note.php?id=30783&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V30783" title="35% like this...">
    -9
    </div>
  </div>
  <a href="function.mysql-query.php.html#30783" class="name">
  <strong class="user"><em>allen a brooker gb net</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#30783"> &para;</a><div class="date" title="2003-03-28 05:35"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom30783">
<div class="phpcode"><code><span class="html">One way to reduce the dangers of queries like the dlete command above that dletes the whole DB is to use limits wherever possible. <br /><br />EG. If you have a routine that is only deisnged to delete 1 record, add 'LIMIT 1' to the end of the command. This way you'll only lose one record if someone does something stupid.<br /><br />You should also check all input, especially if it is sent using GET. ie. make sure that $_GET['id'] is not NULL or == "", is a number that is positive, not 0 (generally, I know this doesn't apply to some table types, but it applies to the default) and is within the valid range for that field.<br /><br />Just don't trust ANY data that is sent to your script.<br /><br />HTH<br />Allen</span></code></div>
  </div>
 </div>
  <div class="note" id="91791">  <div class="votes">
    <div id="Vu91791">
    <a href="https://www.php.net/manual/vote-note.php?id=91791&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd91791">
    <a href="https://www.php.net/manual/vote-note.php?id=91791&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V91791" title="38% like this...">
    -12
    </div>
  </div>
  <a href="function.mysql-query.php.html#91791" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#91791"> &para;</a><div class="date" title="2009-06-25 08:18"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom91791">
<div class="phpcode"><code><span class="html">When processing a RENAME TABLE query, PHP apparently always returns false, no matter if the query was successfully processed or not.</span></code></div>
  </div>
 </div>
  <div class="note" id="31707">  <div class="votes">
    <div id="Vu31707">
    <a href="https://www.php.net/manual/vote-note.php?id=31707&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd31707">
    <a href="https://www.php.net/manual/vote-note.php?id=31707&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V31707" title="35% like this...">
    -10
    </div>
  </div>
  <a href="function.mysql-query.php.html#31707" class="name">
  <strong class="user"><em>chris at hotmail dot com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#31707"> &para;</a><div class="date" title="2003-04-30 06:28"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom31707">
<div class="phpcode"><code><span class="html">Windows programmers, keep in mind that although table names in Windows queries are not case sensitive, many *NIX versions of Mysql require the correct table name case (perhaps others as well). So you're better off using the right case from the beginning, in case you ever decide to go with a *NIX server.</span></code></div>
  </div>
 </div>
  <div class="note" id="93774">  <div class="votes">
    <div id="Vu93774">
    <a href="https://www.php.net/manual/vote-note.php?id=93774&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd93774">
    <a href="https://www.php.net/manual/vote-note.php?id=93774&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V93774" title="38% like this...">
    -14
    </div>
  </div>
  <a href="function.mysql-query.php.html#93774" class="name">
  <strong class="user"><em>Richie (at) RichieBartlett.com</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#93774"> &para;</a><div class="date" title="2009-09-28 04:43"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom93774">
<div class="phpcode"><code><span class="html">For those of you whom spent hours bashing your brains against the keyboard wondering why your non-English characters are output as question marks... Try the following:<br /><br /><span class="default">&lt;?php<br /><br />$db </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'YOUR_DB_ADDRESS'</span><span class="keyword">,</span><span class="string">'YOUR_DB_USER'</span><span class="keyword">,</span><span class="string">'YOUR_DB_PASS'</span><span class="keyword">) or die(</span><span class="string">"Database error"</span><span class="keyword">);<br /></span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">'YOUR_DB'</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">);<br /><br /></span><span class="comment">//SOLUTION::  add this comment before your 1st query -- force multiLanuage support<br /></span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"set names 'utf8'"</span><span class="keyword">);<br /><br /></span><span class="default">$query </span><span class="keyword">= </span><span class="string">"select * from YOUR_DB_TABLE"</span><span class="keyword">;<br /></span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br /><br /></span><span class="comment">//-THE_REST_IS_UP_TO_YOU-<br /><br /></span><span class="default">?&gt;<br /></span><br />Simply run the query "set names 'utf8' " against the MySQL DB and your output should appear correct.</span></code></div>
  </div>
 </div>
  <div class="note" id="52427">  <div class="votes">
    <div id="Vu52427">
    <a href="https://www.php.net/manual/vote-note.php?id=52427&amp;page=function.mysql-query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd52427">
    <a href="https://www.php.net/manual/vote-note.php?id=52427&amp;page=function.mysql-query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V52427" title="28% like this...">
    -18
    </div>
  </div>
  <a href="function.mysql-query.php.html#52427" class="name">
  <strong class="user"><em>wjyong at sh163 dot net</em></strong></a><a class="genanchor" href="function.mysql-query.php.html#52427"> &para;</a><div class="date" title="2005-04-30 04:21"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom52427">
<div class="phpcode"><code><span class="html">The following query is not valid as expected:<br /><span class="default">&lt;?php<br />$username </span><span class="keyword">= </span><span class="string">'dicteworld'</span><span class="keyword">;<br /></span><span class="default">$username</span><span class="keyword">{</span><span class="default">4</span><span class="keyword">} = </span><span class="string">''</span><span class="keyword">;<br /></span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"SELECT * FROM `user` WHERE `User` = '</span><span class="default">$username</span><span class="string">'"</span><span class="keyword">;<br />print(</span><span class="default">$sql</span><span class="keyword">); </span><span class="comment">// Result: SELECT * FROM `user` WHERE `User` = 'dictworld'<br /></span><span class="default">$res </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br /></span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">);<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);</span><span class="comment">// Result: still return Array(), supposed that the user 'dictworld' exists.<br /></span><span class="default">?&gt;<br /></span>Pay more attention that null string '' is equivalent to '\0',therefore SQL statement above is equivalent to SELECT * FROM `user` WHERE `User` = 'dict\0world',though printing string is right.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.mysql-query&amp;redirect=https://www.php.net/manual/ru/function.mysql-query.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.mysql.php.html">MySQL</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.mysql-affected-rows.php.html" title="mysql_&#8203;affected_&#8203;rows">mysql_&#8203;affected_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-client-encoding.php.html" title="mysql_&#8203;client_&#8203;encoding">mysql_&#8203;client_&#8203;encoding</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-close.php.html" title="mysql_&#8203;close">mysql_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-connect.php.html" title="mysql_&#8203;connect">mysql_&#8203;connect</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-create-db.php.html" title="mysql_&#8203;create_&#8203;db">mysql_&#8203;create_&#8203;db</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-data-seek.php.html" title="mysql_&#8203;data_&#8203;seek">mysql_&#8203;data_&#8203;seek</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-db-name.php.html" title="mysql_&#8203;db_&#8203;name">mysql_&#8203;db_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-db-query.php.html" title="mysql_&#8203;db_&#8203;query">mysql_&#8203;db_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-drop-db.php.html" title="mysql_&#8203;drop_&#8203;db">mysql_&#8203;drop_&#8203;db</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-errno.php.html" title="mysql_&#8203;errno">mysql_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-error.php.html" title="mysql_&#8203;error">mysql_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-escape-string.php.html" title="mysql_&#8203;escape_&#8203;string">mysql_&#8203;escape_&#8203;string</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-fetch-array.php.html" title="mysql_&#8203;fetch_&#8203;array">mysql_&#8203;fetch_&#8203;array</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-fetch-assoc.php.html" title="mysql_&#8203;fetch_&#8203;assoc">mysql_&#8203;fetch_&#8203;assoc</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-fetch-field.php.html" title="mysql_&#8203;fetch_&#8203;field">mysql_&#8203;fetch_&#8203;field</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-fetch-lengths.php.html" title="mysql_&#8203;fetch_&#8203;lengths">mysql_&#8203;fetch_&#8203;lengths</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-fetch-object.php.html" title="mysql_&#8203;fetch_&#8203;object">mysql_&#8203;fetch_&#8203;object</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-fetch-row.php.html" title="mysql_&#8203;fetch_&#8203;row">mysql_&#8203;fetch_&#8203;row</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-field-flags.php.html" title="mysql_&#8203;field_&#8203;flags">mysql_&#8203;field_&#8203;flags</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-field-len.php.html" title="mysql_&#8203;field_&#8203;len">mysql_&#8203;field_&#8203;len</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-field-name.php.html" title="mysql_&#8203;field_&#8203;name">mysql_&#8203;field_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-field-seek.php.html" title="mysql_&#8203;field_&#8203;seek">mysql_&#8203;field_&#8203;seek</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-field-table.php.html" title="mysql_&#8203;field_&#8203;table">mysql_&#8203;field_&#8203;table</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-field-type.php.html" title="mysql_&#8203;field_&#8203;type">mysql_&#8203;field_&#8203;type</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-free-result.php.html" title="mysql_&#8203;free_&#8203;result">mysql_&#8203;free_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-get-client-info.php.html" title="mysql_&#8203;get_&#8203;client_&#8203;info">mysql_&#8203;get_&#8203;client_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-get-host-info.php.html" title="mysql_&#8203;get_&#8203;host_&#8203;info">mysql_&#8203;get_&#8203;host_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-get-proto-info.php.html" title="mysql_&#8203;get_&#8203;proto_&#8203;info">mysql_&#8203;get_&#8203;proto_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-get-server-info.php.html" title="mysql_&#8203;get_&#8203;server_&#8203;info">mysql_&#8203;get_&#8203;server_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-info.php.html" title="mysql_&#8203;info">mysql_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-insert-id.php.html" title="mysql_&#8203;insert_&#8203;id">mysql_&#8203;insert_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-list-dbs.php.html" title="mysql_&#8203;list_&#8203;dbs">mysql_&#8203;list_&#8203;dbs</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-list-fields.php.html" title="mysql_&#8203;list_&#8203;fields">mysql_&#8203;list_&#8203;fields</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-list-processes.php.html" title="mysql_&#8203;list_&#8203;processes">mysql_&#8203;list_&#8203;processes</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-list-tables.php.html" title="mysql_&#8203;list_&#8203;tables">mysql_&#8203;list_&#8203;tables</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-num-fields.php.html" title="mysql_&#8203;num_&#8203;fields">mysql_&#8203;num_&#8203;fields</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-num-rows.php.html" title="mysql_&#8203;num_&#8203;rows">mysql_&#8203;num_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-pconnect.php.html" title="mysql_&#8203;pconnect">mysql_&#8203;pconnect</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-ping.php.html" title="mysql_&#8203;ping">mysql_&#8203;ping</a>
                        </li>
                                                <li class="current">
                            <a href="function.mysql-query.php.html" title="mysql_&#8203;query">mysql_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-real-escape-string.php.html" title="mysql_&#8203;real_&#8203;escape_&#8203;string">mysql_&#8203;real_&#8203;escape_&#8203;string</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-result.php.html" title="mysql_&#8203;result">mysql_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-select-db.php.html" title="mysql_&#8203;select_&#8203;db">mysql_&#8203;select_&#8203;db</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-set-charset.php.html" title="mysql_&#8203;set_&#8203;charset">mysql_&#8203;set_&#8203;charset</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-stat.php.html" title="mysql_&#8203;stat">mysql_&#8203;stat</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-tablename.php.html" title="mysql_&#8203;tablename">mysql_&#8203;tablename</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-thread-id.php.html" title="mysql_&#8203;thread_&#8203;id">mysql_&#8203;thread_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="function.mysql-unbuffered-query.php.html" title="mysql_&#8203;unbuffered_&#8203;query">mysql_&#8203;unbuffered_&#8203;query</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
