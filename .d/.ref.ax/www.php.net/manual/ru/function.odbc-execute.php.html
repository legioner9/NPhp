<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: odbc_execute - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.odbc-execute.php.html">
 <link rel="shorturl" href="https://www.php.net/odbc-execute">
 <link rel="alternate" href="https://www.php.net/odbc-execute" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.uodbc.php.html">
 <link rel="prev" href="function.odbc-exec.php.html">
 <link rel="next" href="function.odbc-fetch-array.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.odbc-execute.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.odbc-execute.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.odbc-execute.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.odbc-execute.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.odbc-execute.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.odbc-execute.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.odbc-execute.php" hreflang="pt_BR">
 <link rel="alternate" href="function.odbc-execute.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.odbc-execute.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.odbc-execute.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.odbc-fetch-array.php.html">
          odbc_fetch_array &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.odbc-exec.php.html">
          &laquo; odbc_exec        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.abstract.php.html'>Уровни абстракции</a></li>      <li><a href='book.uodbc.php.html'>ODBC</a></li>      <li><a href='ref.uodbc.php.html'>Функции ODBC</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.odbc-execute.php'>English</option>
            <option value='de/function.odbc-execute.php'>German</option>
            <option value='es/function.odbc-execute.php'>Spanish</option>
            <option value='fr/function.odbc-execute.php'>French</option>
            <option value='it/function.odbc-execute.php'>Italian</option>
            <option value='ja/function.odbc-execute.php'>Japanese</option>
            <option value='pt_BR/function.odbc-execute.php'>Brazilian Portuguese</option>
            <option value='ru/function.odbc-execute.php' selected="selected">Russian</option>
            <option value='tr/function.odbc-execute.php'>Turkish</option>
            <option value='zh/function.odbc-execute.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/uodbc/functions/odbc-execute.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.odbc-execute%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.odbc-execute" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_execute</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">odbc_execute</span> &mdash; <span class="dc-title">Выполняет запрос</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.odbc-execute-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>odbc_execute</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$statement</code></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">$params</code><span class="initializer"> = []</span></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   Выполняет запрос, подготовленный <span class="function"><a href="function.odbc-prepare.php.html" class="function">odbc_prepare()</a></span>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.odbc-execute-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">statement</code></dt>

     <dd>

      <p class="para">
       Ресурс (<span class="type">resource</span>) с идентификатором результата из
       <span class="function"><a href="function.odbc-prepare.php.html" class="function">odbc_prepare()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">params</code></dt>

     <dd>

      <p class="para">
       Параметры в <code class="parameter">params</code> заменят псевдопеременные
       подготовленном запросе по порядку. Элементы этого массива будут
       преобразованы в строки при вызове этой функции.
      </p>
      <p class="para">
       Любые параметры в <code class="parameter">params</code>, заключённые в одинарные
       кавычки, будут восприниматься как имя файла для чтения и отправки на
       сервер базы данных в качестве данных для соответствующей псевдопеременной.
      </p>
      <span class="simpara">
       Если необходимо сохранить строку, которая на самом деле начинается и
       заканчивается одинарными кавычками, нужно добавить пробел или другой
       символ, не являющийся одинарной кавычкой, в начало или конец параметра, что
       предотвратит использование параметра в качестве имени файла. Если этот
       вариант не подходит, необходимо использовать другой механизм для хранения
       строки, например, выполнение запроса напрямую с помощью
       <span class="function"><a href="function.odbc-exec.php.html" class="function">odbc_exec()</a></span>.
      </span>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-execute-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.odbc-execute-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-3043">
    <p><strong>Пример #1 Пример использования <span class="function"><strong>odbc_execute()</strong></span> и <span class="function"><a href="function.odbc-prepare.php.html" class="function">odbc_prepare()</a></span></strong></p>
    <div class="example-contents"><p>
     В данном коде <var class="varname">$success</var> будет иметь значение <strong><code>true</code></strong>,
     только если все три параметра myproc присутствуют в массиве параметров:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$a </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$b </span><span style="color: #007700">= </span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$c </span><span style="color: #007700">= </span><span style="color: #0000BB">3</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt    </span><span style="color: #007700">= </span><span style="color: #0000BB">odbc_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #DD0000">'CALL myproc(?,?,?)'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$success </span><span style="color: #007700">= </span><span style="color: #0000BB">odbc_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, array(</span><span style="color: #0000BB">$a</span><span style="color: #007700">, </span><span style="color: #0000BB">$b</span><span style="color: #007700">, </span><span style="color: #0000BB">$c</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
  <p class="para">
   Если нужно вызвать хранимую процедуру с использованием параметров INOUT или
   OUT, рекомендуется использовать собственный модуль для вашей базы данных
   (например, <a href="ref.oci8.php.html" class="link">oci8</a> для Oracle).
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-execute-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-prepare.php.html" class="function" rel="rdfs-seeAlso">odbc_prepare()</a> - Подготавливает запрос к выполнению</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.odbc-execute&amp;redirect=https://www.php.net/manual/ru/function.odbc-execute.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">17 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="16694">  <div class="votes">
    <div id="Vu16694">
    <a href="https://www.php.net/manual/vote-note.php?id=16694&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd16694">
    <a href="https://www.php.net/manual/vote-note.php?id=16694&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V16694" title="78% like this...">
    8
    </div>
  </div>
  <a href="function.odbc-execute.php.html#16694" class="name">
  <strong class="user"><em>tcmleung at yahoo dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#16694"> &para;</a><div class="date" title="2001-11-09 01:22"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom16694">
<div class="phpcode"><code><span class="html">odbc has a maximum buffer size, that means it only stores and retrieves a limited size of data to/from database each time. The maximum buffer size is 4096 and set in php.ini (odbc.defaultlrl). You can set it to higher value for larger data access.</span></code></div>
  </div>
 </div>
  <div class="note" id="69134">  <div class="votes">
    <div id="Vu69134">
    <a href="https://www.php.net/manual/vote-note.php?id=69134&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd69134">
    <a href="https://www.php.net/manual/vote-note.php?id=69134&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V69134" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#69134" class="name">
  <strong class="user"><em>a dot brock at hhv-rheinklang dot de</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#69134"> &para;</a><div class="date" title="2006-08-24 04:38"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom69134">
<div class="phpcode"><code><span class="html">I have a solution for the problem with the strings beeing interpreted as filename because of the single quotes:<br /><br />Just add a blank to the end of the string:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">odbc_escape_params </span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) {<br /> if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) or empty(</span><span class="default">$params</span><span class="keyword">)) {<br />  return array();<br /> }<br /> foreach (</span><span class="default">$params </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">) {<br />  if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) &gt; </span><span class="default">1 </span><span class="keyword">and </span><span class="default">$val</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"'" </span><span class="keyword">and </span><span class="default">$val</span><span class="keyword">{</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">} == </span><span class="string">"'"</span><span class="keyword">) {<br />   </span><span class="default">$params</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] .= </span><span class="string">' '</span><span class="keyword">;<br />  }<br /> }<br /> return </span><span class="default">$params</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="115">  <div class="votes">
    <div id="Vu115">
    <a href="https://www.php.net/manual/vote-note.php?id=115&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115">
    <a href="https://www.php.net/manual/vote-note.php?id=115&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#115" class="name">
  <strong class="user"><em>wntrmute at tampabay dot rr dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#115"> &para;</a><div class="date" title="1998-08-15 09:22"><strong>25 years ago</strong></div>
  <div class="text" id="Hcom115">
<div class="phpcode"><code><span class="html">Solid Issue:<br />Solid defines CHAR, VARCHAR, LONG VARCHAR, BINARY, VARBINARY, and LONG VARBINARY to be a maximum of 2G in length.  However, when creating your tables for use with PHP one should choose LONG VARCHAR or LONG VARBINARY for these kinds of fields if you are planning on storing really large or lengthy data.  IE: Data exceeding 64k in length such as GIF/JPG, or really huge text areas.</span></code></div>
  </div>
 </div>
  <div class="note" id="106953">  <div class="votes">
    <div id="Vu106953">
    <a href="https://www.php.net/manual/vote-note.php?id=106953&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd106953">
    <a href="https://www.php.net/manual/vote-note.php?id=106953&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V106953" title="57% like this...">
    1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#106953" class="name">
  <strong class="user"><em>alvaro at demogracia dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#106953"> &para;</a><div class="date" title="2011-12-20 05:16"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom106953">
<div class="phpcode"><code><span class="html">When odbc_execute() fails it returns FALSE and triggers a warning but it will not necessarily feed odbc_error() and odbc_errormsg().</span></code></div>
  </div>
 </div>
  <div class="note" id="24979">  <div class="votes">
    <div id="Vu24979">
    <a href="https://www.php.net/manual/vote-note.php?id=24979&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd24979">
    <a href="https://www.php.net/manual/vote-note.php?id=24979&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V24979" title="100% like this...">
    1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#24979" class="name">
  <strong class="user"><em>svemir_AT_baltok.com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#24979"> &para;</a><div class="date" title="2002-09-06 10:45"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom24979">
<div class="phpcode"><code><span class="html">In reply to cpoirier's note from 04-Mar-2001 03:30:<br /><br />Currently, Access 2000 DOES support parametrized queries via ODBC. It still seems to have a problem with Memo and OLE fields, but "normal" types work just fine.</span></code></div>
  </div>
 </div>
  <div class="note" id="15058">  <div class="votes">
    <div id="Vu15058">
    <a href="https://www.php.net/manual/vote-note.php?id=15058&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd15058">
    <a href="https://www.php.net/manual/vote-note.php?id=15058&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V15058" title="100% like this...">
    1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#15058" class="name">
  <strong class="user"><em>sjericson at mindspring dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#15058"> &para;</a><div class="date" title="2001-08-25 10:43"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom15058">
<div class="phpcode"><code><span class="html">I don't think odbc_prepare and odbc_execute support output parameters for stored procedures on MSSQL.  An example of output parameters for MSSQL is at  <a href="http://support.microsoft.com/support/kb/articles/q174/2/23.asp" rel="nofollow" target="_blank">http://support.microsoft.com/support/kb/articles/q174/2/23.asp</a><br /><br />Also, my MSSQL driver seems happy only when I use the following incantation:<br /><br />...code removed...<br />$stmt=odbc_prepare($conn_id, "exec my_proc_name ?,?,?"); <br />$parms=array("fred","password",5);<br />if (!odbc_execute($stmt, &amp;$parms)) die("odbc_execute failed");</span></code></div>
  </div>
 </div>
  <div class="note" id="123505">  <div class="votes">
    <div id="Vu123505">
    <a href="https://www.php.net/manual/vote-note.php?id=123505&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd123505">
    <a href="https://www.php.net/manual/vote-note.php?id=123505&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V123505" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.odbc-execute.php.html#123505" class="name">
  <strong class="user"><em>dj at magma dot nz</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#123505"> &para;</a><div class="date" title="2019-01-09 07:07"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom123505">
<div class="phpcode"><code><span class="html">When using odbc_execute to an MS Access database use single quotes (not double quotes) for literal string definitions.   <br /><br />e.g. $sql = "Insert into [table] ([first], [last]) select 'Bob', 'Builder';"<br /><br />If you use double quotes you may end up with an error like: [Microsoft] [ODBC Text Driver] Too few parameters. Expected: 2</span></code></div>
  </div>
 </div>
  <div class="note" id="83645">  <div class="votes">
    <div id="Vu83645">
    <a href="https://www.php.net/manual/vote-note.php?id=83645&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83645">
    <a href="https://www.php.net/manual/vote-note.php?id=83645&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83645" title="no votes...">
    0
    </div>
  </div>
  <a href="function.odbc-execute.php.html#83645" class="name">
  <strong class="user"><em>jeroen at pyromanic dot nl</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#83645"> &para;</a><div class="date" title="2008-06-05 01:05"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83645">
<div class="phpcode"><code><span class="html">If you want to use stored procedures with MSSQL over ODBC, please read <br /><br /><a href="http://www.sitepoint.com/article/php-microsoft-sql-server/2" rel="nofollow" target="_blank">http://www.sitepoint.com/article/php-microsoft-sql-server/2</a><br /><br />It can you save lots of time ;)</span></code></div>
  </div>
 </div>
  <div class="note" id="63645">  <div class="votes">
    <div id="Vu63645">
    <a href="https://www.php.net/manual/vote-note.php?id=63645&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd63645">
    <a href="https://www.php.net/manual/vote-note.php?id=63645&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V63645" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.odbc-execute.php.html#63645" class="name">
  <strong class="user"><em>mjs at beebo dot org</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#63645"> &para;</a><div class="date" title="2006-03-27 01:57"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom63645">
<div class="phpcode"><code><span class="html">Don't miss the part where it says that if your string starts and ends with a single quote, the string is interpreted as a filename!<br /><br />This means that you can't do:<br /><br />$sth = odbc_prepare($dbh, "INSERT INTO people(name) VALUES(?)");<br />$res = odbc_execute($sth, array($name));<br /><br />without checking the value of $name--if $name is, say, '\\'c:\\passwords.txt\\'' the contents of c:\\passwords.txt get inserted into your database as a "name".<br /><br />Also, despite what the documentation suggests, there (incredibly) doesn't appear to be any way to escape your single quotes (via experimentation, and from reading the source): if your string starts and ends with a single quote you cannot use odbc_execute to insert it into the database.</span></code></div>
  </div>
 </div>
  <div class="note" id="14243">  <div class="votes">
    <div id="Vu14243">
    <a href="https://www.php.net/manual/vote-note.php?id=14243&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd14243">
    <a href="https://www.php.net/manual/vote-note.php?id=14243&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V14243" title="no votes...">
    0
    </div>
  </div>
  <a href="function.odbc-execute.php.html#14243" class="name">
  <strong class="user"><em>reaganpr at hotmail dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#14243"> &para;</a><div class="date" title="2001-07-23 04:50"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom14243">
<div class="phpcode"><code><span class="html">When running the CGI version of 4.0.6 under windows, I came across this error when trying to call a stored procedure in SQL Server using odbc_execute w/ the parameter array set:<br /><br />FATAL:  emalloc():  Unable to allocate 268675669 bytes<br /><br />Scary error, huh? In my case it just meant that SQL Server couldn't find the stored procedure.  Totally my fault, but a rather nondescript error message.<br /><br />p.</span></code></div>
  </div>
 </div>
  <div class="note" id="11722">  <div class="votes">
    <div id="Vu11722">
    <a href="https://www.php.net/manual/vote-note.php?id=11722&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd11722">
    <a href="https://www.php.net/manual/vote-note.php?id=11722&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V11722" title="no votes...">
    0
    </div>
  </div>
  <a href="function.odbc-execute.php.html#11722" class="name">
  <strong class="user"><em>cpoirier at shelluser dot net</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#11722"> &para;</a><div class="date" title="2001-03-04 02:30"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom11722">
<div class="phpcode"><code><span class="html">A quick note in hopes that my pain will save someone else:  Microsoft Access ODBC drivers do not support parameterized queries.</span></code></div>
  </div>
 </div>
  <div class="note" id="9110">  <div class="votes">
    <div id="Vu9110">
    <a href="https://www.php.net/manual/vote-note.php?id=9110&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd9110">
    <a href="https://www.php.net/manual/vote-note.php?id=9110&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V9110" title="no votes...">
    0
    </div>
  </div>
  <a href="function.odbc-execute.php.html#9110" class="name">
  <strong class="user"><em>edrenth at thematec dot nl</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#9110"> &para;</a><div class="date" title="2000-10-17 06:17"><strong>23 years ago</strong></div>
  <div class="text" id="Hcom9110">
<div class="phpcode"><code><span class="html">When used with parameters and the statement fails, you cannot use different arguments anymore, the same arguments as with the failed statement will be used.</span></code></div>
  </div>
 </div>
  <div class="note" id="119466">  <div class="votes">
    <div id="Vu119466">
    <a href="https://www.php.net/manual/vote-note.php?id=119466&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd119466">
    <a href="https://www.php.net/manual/vote-note.php?id=119466&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V119466" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#119466" class="name">
  <strong class="user"><em>vince at dinapoliwest dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#119466"> &para;</a><div class="date" title="2016-06-13 08:48"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom119466">
<div class="phpcode"><code><span class="html">I've been using odbc functions for quite a while and I was floored when I finally read the details about the how the parameters are handled when they start and end with single quotes! I assumed that the main reason for odbc_execute vs. odbc_exec was to prevent sql injection but apparently this added feature actually opens another security hole, perhaps worse. This was my fix:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">function </span><span class="default">odbc_execute_clean_parameters</span><span class="keyword">(</span><span class="default">$result_id</span><span class="keyword">, </span><span class="default">$parameters_array</span><span class="keyword">){<br />  for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$parameters_array</span><span class="keyword">); ++</span><span class="default">$i</span><span class="keyword">){<br />    if( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$parameters_array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], -</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"'" </span><span class="keyword">&amp;&amp; </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$parameters_array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">0 </span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"'" </span><span class="keyword">){<br />      </span><span class="default">$parameters_array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].= </span><span class="string">" "</span><span class="keyword">;<br />    }<br />  }<br />  return </span><span class="default">odbc_execute</span><span class="keyword">(</span><span class="default">$result_id</span><span class="keyword">, </span><span class="default">$parameters_array</span><span class="keyword">);<br />}<br /><br /></span><span class="comment">// then call<br /></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">odbc_prepare</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">" insert into mytable (col1, col2) values (?, ?) "</span><span class="keyword">);<br /></span><span class="default">$r </span><span class="keyword">= </span><span class="default">odbc_execute_clean_parameters</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, array( </span><span class="default">$val1</span><span class="keyword">, </span><span class="default">$val2 </span><span class="keyword">) );<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="79058">  <div class="votes">
    <div id="Vu79058">
    <a href="https://www.php.net/manual/vote-note.php?id=79058&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd79058">
    <a href="https://www.php.net/manual/vote-note.php?id=79058&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V79058" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#79058" class="name">
  <strong class="user"><em>traynor at uni hyphen hannover dot de</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#79058"> &para;</a><div class="date" title="2007-11-08 06:09"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom79058">
<div class="phpcode"><code><span class="html">Obdc_prepare and obdc_execute can only be used as an alternative to odbc_exec in limited circumstances:<br /><br />$con = obdc_connect ($dsn, $user, $pass);<br />$sql = "select * from TABLE";<br /><br />$result = obdc_exec ($con, $sql); //this line can be replaced as blow<br />//then to see results:<br /><br />odbc_result_all ($result);<br />odbc_free_result ($result);<br />odbc_close ($con);<br /><br />gives the same result with the middle line as:<br /><br />$result = odbc_prepare ($con, $sql);<br />odbc_execute ($result);<br /><br />as long as $sql contains a well formed and complete query.<br /><br />There is no point in trying to convert this into a parameter query with question marks as placeholders, since code like this will result only in error messages:<br /><br />$sql = "select * from TABLE where needle = ?";<br />$result = odbc_prepare ($con, $sql);<br />for ($i = 0; $i &lt; 4; $i++)<br />{<br />  odbc_execute ($result, array ($i));<br />  // and whatever you want to do with the result<br />  // but all you get is "parameter expected" or "count does not match"<br />}<br /><br />The lack of documentation for such functions should have been an alarm signal.</span></code></div>
  </div>
 </div>
  <div class="note" id="39749">  <div class="votes">
    <div id="Vu39749">
    <a href="https://www.php.net/manual/vote-note.php?id=39749&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd39749">
    <a href="https://www.php.net/manual/vote-note.php?id=39749&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V39749" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#39749" class="name">
  <strong class="user"><em>russell dot brown at removethis dot insignia dot com</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#39749"> &para;</a><div class="date" title="2004-02-09 12:55"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom39749">
<div class="phpcode"><code><span class="html">In reply to tcmleung at yahoo dot com (09-Nov-2001), I would add a caveat that I've found, which is that the odbc.defaultlrl/odbc_longreadlen() values may only apply to odbc-&gt;php conversion and not php-&gt;odbc (though this may be database-specific). Hence, if you want to post binary data the 4096 byte limit still stands. So you stand a better chance of being able to post binary data using the quoted filename upload procedure described above, rather than using the prepare... execute method with data held in a php variable.</span></code></div>
  </div>
 </div>
  <div class="note" id="110472">  <div class="votes">
    <div id="Vu110472">
    <a href="https://www.php.net/manual/vote-note.php?id=110472&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd110472">
    <a href="https://www.php.net/manual/vote-note.php?id=110472&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V110472" title="40% like this...">
    -2
    </div>
  </div>
  <a href="function.odbc-execute.php.html#110472" class="name">
  <strong class="user"><em>Marco Napetti</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#110472"> &para;</a><div class="date" title="2012-10-25 10:18"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom110472">
<div class="phpcode"><code><span class="html">To use prepared with select queries, the right way is:<br /><span class="default">&lt;?PHP<br /><br />$rConnection </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">'AS400'</span><span class="keyword">, </span><span class="string">'QSECOFR'</span><span class="keyword">, </span><span class="string">'QSECOFR'</span><span class="keyword">);<br />if(</span><span class="default">$rConnection </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />    throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">odbc_errormsg</span><span class="keyword">());<br />}<br /><br /></span><span class="default">$rResult </span><span class="keyword">= </span><span class="default">odbc_prepare</span><span class="keyword">(</span><span class="default">$rConnection</span><span class="keyword">, </span><span class="string">'SELECT * FROM KMNSH00F WHERE SHTMST &gt; ?'</span><span class="keyword">);<br />if(</span><span class="default">$rResult </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />    throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">odbc_errormsg</span><span class="keyword">());<br />}<br /><br />if(</span><span class="default">odbc_execute</span><span class="keyword">(</span><span class="default">$rResult</span><span class="keyword">, array(</span><span class="string">'0001-01-01 00:00:00.000000'</span><span class="keyword">)) === </span><span class="default">false</span><span class="keyword">) {<br />    throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">odbc_errormsg</span><span class="keyword">());<br />}<br /><br /></span><span class="default">odbc_result_all</span><span class="keyword">(</span><span class="default">$rResult</span><span class="keyword">);<br /><br /></span><span class="default">odbc_free_result</span><span class="keyword">(</span><span class="default">$rResult</span><span class="keyword">);<br /><br /></span><span class="default">odbc_close</span><span class="keyword">(</span><span class="default">$rConnection</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="90595">  <div class="votes">
    <div id="Vu90595">
    <a href="https://www.php.net/manual/vote-note.php?id=90595&amp;page=function.odbc-execute&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd90595">
    <a href="https://www.php.net/manual/vote-note.php?id=90595&amp;page=function.odbc-execute&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V90595" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.odbc-execute.php.html#90595" class="name">
  <strong class="user"><em>anonymous</em></strong></a><a class="genanchor" href="function.odbc-execute.php.html#90595"> &para;</a><div class="date" title="2009-04-29 11:32"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom90595">
<div class="phpcode"><code><span class="html">if you can't use php_mssql module in your environment (suse linux, apache2, php5, FreeTDS, unixODBC) an alternative is to use sql server functions instead of procedures. here is my sample code.<br /><br /><span class="default">&lt;?php<br />  $connect        </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$myDB</span><span class="keyword">, </span><span class="default">$myUser</span><span class="keyword">, </span><span class="default">$myPass</span><span class="keyword">);<br /><br />  </span><span class="default">$query </span><span class="keyword">= </span><span class="string">"SELECT dbo.&lt;function&gt;(&lt;column&gt;,&lt;text&gt;) alias"</span><span class="keyword">;<br /><br />  </span><span class="comment">// perform the query<br />  </span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">);<br /><br />  while(</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) {<br />    </span><span class="default">$Var1    </span><span class="keyword">= </span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, &lt;</span><span class="default">column alias</span><span class="keyword">&gt;);<br />    </span><span class="comment">//echo "Var1: " . $Var1 . "&lt;br&gt;";<br /><br />        // add additional logic<br /><br />  </span><span class="keyword">}<br /></span><span class="default">?&gt;<br /></span><br />Once I figured this out, my app worked perfectly.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.odbc-execute&amp;redirect=https://www.php.net/manual/ru/function.odbc-execute.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.uodbc.php.html">Функции ODBC</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.odbc-autocommit.php.html" title="odbc_&#8203;autocommit">odbc_&#8203;autocommit</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-binmode.php.html" title="odbc_&#8203;binmode">odbc_&#8203;binmode</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-close-all.php.html" title="odbc_&#8203;close_&#8203;all">odbc_&#8203;close_&#8203;all</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-close.php.html" title="odbc_&#8203;close">odbc_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-columnprivileges.php.html" title="odbc_&#8203;columnprivileges">odbc_&#8203;columnprivileges</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-columns.php.html" title="odbc_&#8203;columns">odbc_&#8203;columns</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-commit.php.html" title="odbc_&#8203;commit">odbc_&#8203;commit</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connect.php.html" title="odbc_&#8203;connect">odbc_&#8203;connect</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connection-string-is-quoted.php.html" title="odbc_&#8203;connection_&#8203;string_&#8203;is_&#8203;quoted">odbc_&#8203;connection_&#8203;string_&#8203;is_&#8203;quoted</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connection-string-quote.php.html" title="odbc_&#8203;connection_&#8203;string_&#8203;quote">odbc_&#8203;connection_&#8203;string_&#8203;quote</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connection-string-should-quote.php.html" title="odbc_&#8203;connection_&#8203;string_&#8203;should_&#8203;quote">odbc_&#8203;connection_&#8203;string_&#8203;should_&#8203;quote</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-cursor.php.html" title="odbc_&#8203;cursor">odbc_&#8203;cursor</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-data-source.php.html" title="odbc_&#8203;data_&#8203;source">odbc_&#8203;data_&#8203;source</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-do.php.html" title="odbc_&#8203;do">odbc_&#8203;do</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-error.php.html" title="odbc_&#8203;error">odbc_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-errormsg.php.html" title="odbc_&#8203;errormsg">odbc_&#8203;errormsg</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-exec.php.html" title="odbc_&#8203;exec">odbc_&#8203;exec</a>
                        </li>
                                                <li class="current">
                            <a href="function.odbc-execute.php.html" title="odbc_&#8203;execute">odbc_&#8203;execute</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-array.php.html" title="odbc_&#8203;fetch_&#8203;array">odbc_&#8203;fetch_&#8203;array</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-into.php.html" title="odbc_&#8203;fetch_&#8203;into">odbc_&#8203;fetch_&#8203;into</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-object.php.html" title="odbc_&#8203;fetch_&#8203;object">odbc_&#8203;fetch_&#8203;object</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-row.php.html" title="odbc_&#8203;fetch_&#8203;row">odbc_&#8203;fetch_&#8203;row</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-len.php.html" title="odbc_&#8203;field_&#8203;len">odbc_&#8203;field_&#8203;len</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-name.php.html" title="odbc_&#8203;field_&#8203;name">odbc_&#8203;field_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-num.php.html" title="odbc_&#8203;field_&#8203;num">odbc_&#8203;field_&#8203;num</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-precision.php.html" title="odbc_&#8203;field_&#8203;precision">odbc_&#8203;field_&#8203;precision</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-scale.php.html" title="odbc_&#8203;field_&#8203;scale">odbc_&#8203;field_&#8203;scale</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-type.php.html" title="odbc_&#8203;field_&#8203;type">odbc_&#8203;field_&#8203;type</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-foreignkeys.php.html" title="odbc_&#8203;foreignkeys">odbc_&#8203;foreignkeys</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-free-result.php.html" title="odbc_&#8203;free_&#8203;result">odbc_&#8203;free_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-gettypeinfo.php.html" title="odbc_&#8203;gettypeinfo">odbc_&#8203;gettypeinfo</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-longreadlen.php.html" title="odbc_&#8203;longreadlen">odbc_&#8203;longreadlen</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-next-result.php.html" title="odbc_&#8203;next_&#8203;result">odbc_&#8203;next_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-num-fields.php.html" title="odbc_&#8203;num_&#8203;fields">odbc_&#8203;num_&#8203;fields</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-num-rows.php.html" title="odbc_&#8203;num_&#8203;rows">odbc_&#8203;num_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-pconnect.php.html" title="odbc_&#8203;pconnect">odbc_&#8203;pconnect</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-prepare.php.html" title="odbc_&#8203;prepare">odbc_&#8203;prepare</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-primarykeys.php.html" title="odbc_&#8203;primarykeys">odbc_&#8203;primarykeys</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-procedurecolumns.php.html" title="odbc_&#8203;procedurecolumns">odbc_&#8203;procedurecolumns</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-procedures.php.html" title="odbc_&#8203;procedures">odbc_&#8203;procedures</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-result-all.php.html" title="odbc_&#8203;result_&#8203;all">odbc_&#8203;result_&#8203;all</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-result.php.html" title="odbc_&#8203;result">odbc_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-rollback.php.html" title="odbc_&#8203;rollback">odbc_&#8203;rollback</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-setoption.php.html" title="odbc_&#8203;setoption">odbc_&#8203;setoption</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-specialcolumns.php.html" title="odbc_&#8203;specialcolumns">odbc_&#8203;specialcolumns</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-statistics.php.html" title="odbc_&#8203;statistics">odbc_&#8203;statistics</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-tableprivileges.php.html" title="odbc_&#8203;tableprivileges">odbc_&#8203;tableprivileges</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-tables.php.html" title="odbc_&#8203;tables">odbc_&#8203;tables</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
