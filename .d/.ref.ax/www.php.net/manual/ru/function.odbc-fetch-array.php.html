<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: odbc_fetch_array - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.odbc-fetch-array.php.html">
 <link rel="shorturl" href="https://www.php.net/odbc-fetch-array">
 <link rel="alternate" href="https://www.php.net/odbc-fetch-array" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.uodbc.php.html">
 <link rel="prev" href="function.odbc-execute.php.html">
 <link rel="next" href="function.odbc-fetch-into.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.odbc-fetch-array.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.odbc-fetch-array.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.odbc-fetch-array.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.odbc-fetch-array.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.odbc-fetch-array.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.odbc-fetch-array.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.odbc-fetch-array.php" hreflang="pt_BR">
 <link rel="alternate" href="function.odbc-fetch-array.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.odbc-fetch-array.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.odbc-fetch-array.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.odbc-fetch-into.php.html">
          odbc_fetch_into &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.odbc-execute.php.html">
          &laquo; odbc_execute        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.abstract.php.html'>Уровни абстракции</a></li>      <li><a href='book.uodbc.php.html'>ODBC</a></li>      <li><a href='ref.uodbc.php.html'>Функции ODBC</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.odbc-fetch-array.php'>English</option>
            <option value='de/function.odbc-fetch-array.php'>German</option>
            <option value='es/function.odbc-fetch-array.php'>Spanish</option>
            <option value='fr/function.odbc-fetch-array.php'>French</option>
            <option value='it/function.odbc-fetch-array.php'>Italian</option>
            <option value='ja/function.odbc-fetch-array.php'>Japanese</option>
            <option value='pt_BR/function.odbc-fetch-array.php'>Brazilian Portuguese</option>
            <option value='ru/function.odbc-fetch-array.php' selected="selected">Russian</option>
            <option value='tr/function.odbc-fetch-array.php'>Turkish</option>
            <option value='zh/function.odbc-fetch-array.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/uodbc/functions/odbc-fetch-array.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.odbc-fetch-array%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.odbc-fetch-array" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_fetch_array</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">odbc_fetch_array</span> &mdash; <span class="dc-title">Возвращает строку результата в виде ассоциативного массива</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.odbc-fetch-array-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>odbc_fetch_array</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$statement</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$row</code><span class="initializer"> = -1</span></span>): <span class="type"><span class="type">array</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Возвращает ассоциативный массив (<span class="type">array</span>) из запроса ODBC.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.odbc-fetch-array-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">statement</code></dt>

     <dd>

      <p class="para">
       Ресурс результата из <span class="function"><a href="function.odbc-exec.php.html" class="function">odbc_exec()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">row</code></dt>

     <dd>

      <p class="para">
       Необязательный параметр, указывающий номер строки для возврата.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-fetch-array-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает массив, соответствующий возвращаемой строке, или <strong><code>false</code></strong> если
   строк больше нет.
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.odbc-fetch-array-notes">
  <h3 class="title">Примечания</h3>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <span class="simpara">
    Функция существует при компиляции с поддержкой DBMaker, IBM DB2 или UnixODBC.
   </span>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-fetch-array-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-fetch-row.php.html" class="function" rel="rdfs-seeAlso">odbc_fetch_row()</a> - Возвращает строку</span></li>
    <li class="member"><span class="function"><a href="function.odbc-fetch-object.php.html" class="function" rel="rdfs-seeAlso">odbc_fetch_object()</a> - Возвращает строку результата в виде объекта</span></li>
    <li class="member"><span class="function"><a href="function.odbc-num-rows.php.html" class="function" rel="rdfs-seeAlso">odbc_num_rows()</a> - Возвращает количество строк в результате</span></li>
   </ul>
  </p>
 </div>

</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.odbc-fetch-array&amp;redirect=https://www.php.net/manual/ru/function.odbc-fetch-array.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">16 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="47340">  <div class="votes">
    <div id="Vu47340">
    <a href="https://www.php.net/manual/vote-note.php?id=47340&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd47340">
    <a href="https://www.php.net/manual/vote-note.php?id=47340&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V47340" title="63% like this...">
    13
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#47340" class="name">
  <strong class="user"><em>russ at russprince dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#47340"> &para;</a><div class="date" title="2004-11-11 06:57"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom47340">
<div class="phpcode"><code><span class="html">I really liked Ryan's example so I took it another step and added a recordset class to work with the connection class.  I made slight alterations to the original code as well.  Also note the recordset class takes advantage of php5's __get property function...<br /><br />&lt;%<br />class odbcRecordset {<br />   var $recordcount;<br />   var $currentrow;<br />   var $eof;<br /><br />   var $recorddata;<br />   var $query;<br /><br />   function odbcConnection(){<br />      $this-&gt;recordcount = 0;<br />      $this-&gt;recorddata = 0;<br />   }<br /><br />   function SetData( $newdata, $num_records, $query ) {<br />      $this-&gt;recorddata = $newdata;<br />      $this-&gt;recordcount = $num_records;<br />      $this-&gt;query = $query;<br />      $this-&gt;currentrow = 0;<br />      $this-&gt;set_eof();<br />   }<br /><br />   function set_eof() {<br />      $this-&gt;eof = $this-&gt;currentrow &gt;= $this-&gt;recordcount;<br />   }<br /><br />   function movenext()  { if ($this-&gt;currentrow &lt; $this-&gt;recordcount) { $this-&gt;currentrow++; $this-&gt;set_eof(); } }<br />   function moveprev()  { if ($this-&gt;currentrow &gt; 0)                  { $this-&gt;currentrow--; $this-&gt;set_eof(); } }<br />   function movefirst() { $this-&gt;currentrow = 0; set_eof();                                               }<br />   function movelast()  { $this-&gt;currentrow = $this-&gt;recordcount - 1;  set_eof();                         }<br /><br />   function data($field_name) {<br />      if (isset($this-&gt;recorddata[$this-&gt;currentrow][$field_name])) {<br />         $thisVal = $this-&gt;recorddata[$this-&gt;currentrow][$field_name];<br />      } else if ($this-&gt;eof) {<br />         die("&lt;B&gt;Error!&lt;/B&gt; eof of recordset was reached");<br />      } else {<br />         die("&lt;B&gt;Error!&lt;/B&gt; Field &lt;B&gt;" . $field_name . "&lt;/B&gt; was not found in the current recordset from query:&lt;br&gt;&lt;br&gt;$this-&gt;query");<br />      }<br /><br />      return $thisVal;<br />   } <br /><br />   function __get($field_name) {<br />      return $this-&gt;data($field_name);<br />   } <br />}<br /><br />class odbcConnection {<br />   var $user;  //Username for the database<br />   var $pass; //Password<br /><br />   var $conn_handle; //Connection handle<br />   var $temp_fieldnames; //Tempory array used to store the fieldnames, makes parsing returned data easier.<br />   <br />   function odbcConnection(){<br />      $this-&gt;user = "";<br />      $this-&gt;pass = "";<br />   }<br />   <br />   function open($dsn,$user,$pass){<br />      $handle = @odbc_connect($dsn,$user,$pass,SQL_CUR_USE_ODBC) or<br />         die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Connect To Database. Error Code:  ".odbc_error());<br />      $this-&gt;conn_handle = $handle;<br />      return true;<br />   }<br />   <br />   function &amp;execute($query){<br />      //Create a temp recordset<br />      $newRS = new odbcRecordset;<br />      $thisData = "";<br /><br />      $res = @odbc_exec($this-&gt;conn_handle,$query) or<br />         die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Run Query:&lt;br&gt;&lt;br&gt;" . $query . "&lt;br&gt;&lt;br&gt;Error Code:  ".odbc_error());<br />      unset($this-&gt;temp_fieldnames);<br /><br />      $i = 0;<br />      $j = 0;<br />      $num_rows = 0;<br /><br />      // only populate select queries<br />      if (stripos($query, 'select ') !== false) {<br />         while(odbc_fetch_row($res)) {<br />            $num_rows++;<br />   <br />            //Build tempory<br />            for ($j = 1; $j &lt;= odbc_num_fields($res); $j++) {<br />               $field_name = odbc_field_name($res, $j);<br />               $this-&gt;temp_fieldnames[$j] = $field_name;<br />               $ar[$field_name] = odbc_result($res, $field_name) . "";<br />            }<br />   <br />            $thisData[$i] = $ar;<br />            $i++;<br />         }<br />      }<br />      <br />      //populate the recordset and return it<br />      $newRS-&gt;SetData( $thisData, $num_rows, $query );<br />      return $newRS;<br />   }<br />}<br />%&gt;<br /><br />usage is pretty simple:<br /><br />&lt;%<br />  $con = new odbcConnection<br />  $con-&gt;open("dsn","user","pass")<br /><br />  $sql = "select bar from foo";<br />  $rs = $con-&gt;execute($sql);<br /><br />  if (!$rs-&gt;eof) {<br />    print $rs-&gt;data("bar");<br />      // or //<br />    print $rs-&gt;bar;<br />  }<br /><br />  while (!$rs-&gt;eof) {<br />    // blah blah code<br />    $rs-&gt;movenext();<br />  }<br />%&gt;<br /><br />Works pretty well, but I haven't thoughly tested it yet.<br />Code can be dl'd here:<br /><br /><a href="http://www.russprince.com/odbc_functions.zip" rel="nofollow" target="_blank">http://www.russprince.com/odbc_functions.zip</a><br /><br />Cheers,<br />Russ</span></code></div>
  </div>
 </div>
  <div class="note" id="41437">  <div class="votes">
    <div id="Vu41437">
    <a href="https://www.php.net/manual/vote-note.php?id=41437&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd41437">
    <a href="https://www.php.net/manual/vote-note.php?id=41437&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V41437" title="70% like this...">
    7
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#41437" class="name">
  <strong class="user"><em>Ryan (rystar_x2000 at hotmail dot com)</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#41437"> &para;</a><div class="date" title="2004-04-09 06:39"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom41437">
<div class="phpcode"><code><span class="html">Heya,<br /><br />After much fiddling around with the odbc_num_rows() function, and trying to get odbc_fetch_array() to play nice with it, I decided to write this little function which will return a 2-dimensional array, in the format [rownumber][field].<br /><br />The 'rownumber' array index is obviously the number of the row stored in the array.<br />The 'field' index is keyed to the field name on that row. <br /><br />--Function--<br />&lt;?<br /><br />function fetch2DArray($res){    <br />    $i = 0;<br />    $j = 0;<br />    $toReturn = "";<br />    <br />    while(odbc_fetch_row($res))<br />    {<br />        for ($j = 1; $j &lt;= odbc_num_fields($res); $j++)<br />        {        <br />             $field_name = odbc_field_name($res, $j);<br />             $ar[$field_name] = odbc_result($res, $field_name);<br />        }<br />        <br />        $toReturn[$i] = $ar;<br />        $i++;<br />    }<br />    return $toReturn;    <br />}<br />?&gt;<br /><br />I then took this one stage further.. and wrote a whole class to deal with the odbc connection... it's a bit slap-happy, but it does work well enough.<br /><br />-- Class --<br />&lt;?<br />class odbcConnection{<br />   var $user;  //Username for the database<br />   var $pass; //Password<br />   var $conn_handle; //Connection handle<br />   var $temp_fieldnames; //Tempory array used to store the fieldnames, makes parsing returned data easier.<br /><br />   function odbcConnection(){<br />       $this-&gt;user = "";<br />       $this-&gt;pass = "";<br />   }<br />   <br />       function connectDatabase($dsn_link,$user,$pass){<br />        $handle = @odbc_connect($dsn_link,$user,$pass,SQL_CUR_USE_DRIVER) or die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Connect To Database. Error Code:  ".odbc_error());<br />        $this-&gt;conn_handle = $handle;<br />        return true;<br />    }<br />    <br />    function runStoredQuery($query, $returns_results){<br />    <br />    if($returns_results == false){<br />            return false;<br />        }<br />    <br />    $toReturn = "";<br />        $res = @odbc_exec($this-&gt;conn_handle, "exec ".$query."") or die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Run Stored Query. Error Code:  ".odbc_error());<br />        unset($this-&gt;temp_fieldnames);<br />            $i = 0;<br />            $j = 0;<br />            <br />            while(odbc_fetch_row($res))<br />            {<br />                  //Build tempory<br />                for ($j = 1; $j &lt;= odbc_num_fields($res); $j++)<br />                   {        <br />                     $field_name = odbc_field_name($res, $j);<br />                     $this-&gt;temp_fieldnames[$j] = $field_name;<br />                      $this-&gt;temp_fieldnames[$j];<br />                     $ar[$field_name] = odbc_result($res, $field_name);<br />                   }<br />                <br />                $toReturn[$i] = $ar;<br />                $i++;<br />             }<br />    <br />     return $toReturn;<br />    }<br />    <br />    function runSQL($query,$returns_results){<br />    $toReturn = "";<br />    <br />        $res = @odbc_exec($this-&gt;conn_handle,$query) or die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Run Query. Error Code:  ".odbc_error());<br />           unset($this-&gt;temp_fieldnames);<br />        if($returns_results == false){<br />            return false;<br />        }<br />        <br />            $i = 0;<br />            $j = 0;<br />            <br />            while(odbc_fetch_row($res))<br />            {<br />                //Build tempory<br />                for ($j = 1; $j &lt;= odbc_num_fields($res); $j++)<br />                   {        <br />                     $field_name = odbc_field_name($res, $j);<br />                     $this-&gt;temp_fieldnames[$j] = $field_name;<br />                     $ar[$field_name] = odbc_result($res, $field_name);<br />                   }<br />                <br />                $toReturn[$i] = $ar;<br />                $i++;<br />             }<br />            <br />     return $toReturn;<br />    }<br />    <br /><br />}<br /><br />//And an example of how to use the class:<br /><br />include("dbClass.inc");  //Where dbClass.inc is the name of the file holding the class<br /><br />//Declare a new instance of the class <br />$dbConnection = new odbcConnection;<br /><br />$dsn = "GroupWork";   //Your System DSN name to point to your database<br />$dbConnection-&gt;connectDatabase($dsn,"","");  //No username and password - read only access<br /><br />echo"&lt;BR&gt;&lt;HR&gt;&lt;B&gt;Testing SQL&lt;/b&gt;&lt;BR&gt;&lt;BR&gt;";<br />$query_result = $dbConnection-&gt;runSQL("SELECT * FROM Event WHERE Type = 'Sport' ORDER BY EDate ASC",true); <br /><br />    if(!$query_result)<br />    {<br />        //No Results - Your Error Code Here<br />    }else{<br />        //Get the results<br />        $key = $dbConnection-&gt;temp_fieldnames;<br />        $rows = count($query_result);<br />        $keys = count($key);<br />        $i = 0;<br />        <br />        <br />        while($i &lt; $rows){<br />            $j = 1;<br />            echo "Echoing Row $i:&lt;BR&gt;";<br />            <br />                while($j &lt; $keys - 1){<br />                    <br />                    //$query_result[row][field];<br />                    $result = $query_result[$i][$key[$j]];<br />                    $field = $key[$j];<br />                    echo("Field &lt;b&gt;'".$field."'&lt;/b&gt; : ".$result." &lt;BR&gt;");<br />                    <br />                    $j++;<br />                }<br />            echo "&lt;BR&gt;----&lt;BR&gt;&lt;BR&gt;";<br />            $i++;<br />        }<br />    }<br />?&gt;<br /><br />Hope this was of some help. If anyone has any improvments to the class, please drop them by me.</span></code></div>
  </div>
 </div>
  <div class="note" id="56802">  <div class="votes">
    <div id="Vu56802">
    <a href="https://www.php.net/manual/vote-note.php?id=56802&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd56802">
    <a href="https://www.php.net/manual/vote-note.php?id=56802&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V56802" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#56802" class="name">
  <strong class="user"><em>tim at tmcode dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#56802"> &para;</a><div class="date" title="2005-09-15 08:07"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom56802">
<div class="phpcode"><code><span class="html">Depending on the odbc driver/operating system you are using,  odbc_fetch_array might not be defined. (ie if you used --with-custom-odbc you may be out of luck).   The following can be safely added to define the odbc_fetch_array function if doesn't exist already.  Unlike some of the other examples contributed here, this one will create the numeric keys and the text keys.   This function is definitely not very optimal because it has to check the number of fields and field names each time a row is pulled.  Often you will be looping through a result set and there is no need to pull this information each time.  It could probably be improved by caching the result of these functions but I'll leave that as an exercise for someone else... :)<br /><br />if(!function_exists("odbc_fetch_array"))<br />{<br />    <br />    function odbc_fetch_array($res)<br />    {<br />        // make sure to pass back the false if we are out of rows<br />        if(!odbc_fetch_row($res)) return false;<br />        <br />        $row=array();<br /><br />        // populate the row array<br />        $numfields=odbc_num_fields($res);<br />        for($i=1; $i&lt;=$numfields; $i++)<br />        {<br />            //odbc starts its indice at 1 but since I am <br />            // trying to emulate the functionality of *_fetch_array<br />            // for other dbs (ie mysql)  I'm going to decrement my<br />            // my numeric indice by 1.  This might not be what <br />            // you are after in which case get rid of the -1  <br />            $row[odbc_field_name($res,$i)]=$row[$i-1]=odbc_result($res,$i);<br />            <br />        }<br />        return $row;<br />    }<br />    <br />    <br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="127471">  <div class="votes">
    <div id="Vu127471">
    <a href="https://www.php.net/manual/vote-note.php?id=127471&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd127471">
    <a href="https://www.php.net/manual/vote-note.php?id=127471&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V127471" title="no votes...">
    0
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#127471" class="name">
  <strong class="user"><em>eion at robbmob dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#127471"> &para;</a><div class="date" title="2022-08-09 09:56"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom127471">
<div class="phpcode"><code><span class="html">This function can also return 'false' if there was a row with corrupt data (eg bad binary data or invalid locale data) depending on what ODBC driver you're connecting to.  Subsequent calls to odbc_fetch_array() will still return results in those cases.<br /><br />Either compare the number of rows fetched using the odbc_num_rows() function (if the driver provides such data), or verify that there's not some extra data after the failing rowduring your while loops:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Allow for up to two sequential rows of bad/corrupt data<br /></span><span class="keyword">while((</span><span class="default">$row </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) || (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) || (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">))) {<br />    </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />Seen in the wild when using PHP's ODBC to talk to Informix and Foxpro databases.</span></code></div>
  </div>
 </div>
  <div class="note" id="89906">  <div class="votes">
    <div id="Vu89906">
    <a href="https://www.php.net/manual/vote-note.php?id=89906&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd89906">
    <a href="https://www.php.net/manual/vote-note.php?id=89906&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V89906" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#89906" class="name">
  <strong class="user"><em>James Auxier</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#89906"> &para;</a><div class="date" title="2009-03-27 10:30"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom89906">
<div class="phpcode"><code><span class="html">Some interesting behavior was discovered while attempting simultaneous queries to a MS SQL server through the ODBC/freeTDS layer on SUSE on a persistent connection with ODBC cursors enabled. Stepping through the first resource with odbc_fetch_array() in a while loop works as expected, but calls to subsequently created resources within that loop were failing to return data where MySQL equivalents to the script were working just fine.<br /><br />I found that adding a num_rows function call [custom function that simply steps through the result set... the misbehavior of odbc_num_rows() is another matter] immediately following each odbc_exec() then resetting the cursor seemed to cache the results for proper performance of the multiple active result sets.  It may be slightly slower than the MySQL equivalent, but at least it works.</span></code></div>
  </div>
 </div>
  <div class="note" id="76627">  <div class="votes">
    <div id="Vu76627">
    <a href="https://www.php.net/manual/vote-note.php?id=76627&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd76627">
    <a href="https://www.php.net/manual/vote-note.php?id=76627&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V76627" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#76627" class="name">
  <strong class="user"><em>luke at croslow dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#76627"> &para;</a><div class="date" title="2007-07-23 10:18"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom76627">
<div class="phpcode"><code><span class="html">On IBM DB2 for iSeries I have to specify a specific row number to retrieve. If I don't specify the row number, the behavior is erratic.<br /><br />This seems to work:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$row</span><span class="keyword">=</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++) {<br />  </span><span class="comment">//use $row<br /></span><span class="keyword">}<br /></span><span class="default">?&gt;<br /></span><br />The row count MUST start at 1 or else the behavior seems undefined; i.e., when I start from 0 some rows might be returned two or more times or not at all.</span></code></div>
  </div>
 </div>
  <div class="note" id="72247">  <div class="votes">
    <div id="Vu72247">
    <a href="https://www.php.net/manual/vote-note.php?id=72247&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd72247">
    <a href="https://www.php.net/manual/vote-note.php?id=72247&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V72247" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#72247" class="name">
  <strong class="user"><em>robincw at gnospammail dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#72247"> &para;</a><div class="date" title="2007-01-09 04:46"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom72247">
<div class="phpcode"><code><span class="html">I am using MS SQL Server 2005, and using odbc_connect with SQL_CUR_USE_ODBC.<br /><br />I had a problem with odbc_fetch_array when getting results from a stored procedure that returns a text column. The misleading error I got was:<br /><br />odbc_fetch_array() [function.odbc-fetch-array]: SQL error: [Microsoft][ODBC Cursor Library] Result set was not generated by a SELECT statement, SQL state SL004 in SQLGetData<br /><br />Eventually I found that by converting the text column in my database to varchar(8000), it worked fine. Perhaps using CONVERT or CAST might have worked too. I also found that varchar(max) columns were scrambled.</span></code></div>
  </div>
 </div>
  <div class="note" id="51152">  <div class="votes">
    <div id="Vu51152">
    <a href="https://www.php.net/manual/vote-note.php?id=51152&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd51152">
    <a href="https://www.php.net/manual/vote-note.php?id=51152&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V51152" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#51152" class="name">
  <strong class="user"><em>philip</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#51152"> &para;</a><div class="date" title="2005-03-21 08:03"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom51152">
<div class="phpcode"><code><span class="html">This function requires one of the following to exist: Windows, DB2, or UNIXODBC.</span></code></div>
  </div>
 </div>
  <div class="note" id="41017">  <div class="votes">
    <div id="Vu41017">
    <a href="https://www.php.net/manual/vote-note.php?id=41017&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd41017">
    <a href="https://www.php.net/manual/vote-note.php?id=41017&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V41017" title="no votes...">
    0
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#41017" class="name">
  <strong class="user"><em>powerstat at web dot de</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#41017"> &para;</a><div class="date" title="2004-03-26 04:48"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom41017">
<div class="phpcode"><code><span class="html">This function is badly implemented, because the fetch_array versions for all other databases are storing the values as associative AND numeric key.<br />This one only stores as associative key :(<br />Someone should really cleanup the complete database api design!</span></code></div>
  </div>
 </div>
  <div class="note" id="83054">  <div class="votes">
    <div id="Vu83054">
    <a href="https://www.php.net/manual/vote-note.php?id=83054&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83054">
    <a href="https://www.php.net/manual/vote-note.php?id=83054&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83054" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#83054" class="name">
  <strong class="user"><em>michael dot buergi at zhdk dot ch</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#83054"> &para;</a><div class="date" title="2008-05-08 02:30"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83054">
<div class="phpcode"><code><span class="html">I use an odbc connection to a mssql2000 db. As long as I had set ansi_warnings on, I occasionnally got the last record twice when retrieving them with odbc_fetch_array or odbc_fetch_row and odbc_result.</span></code></div>
  </div>
 </div>
  <div class="note" id="40951">  <div class="votes">
    <div id="Vu40951">
    <a href="https://www.php.net/manual/vote-note.php?id=40951&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd40951">
    <a href="https://www.php.net/manual/vote-note.php?id=40951&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V40951" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#40951" class="name">
  <strong class="user"><em>xhat at NOSPAM dot hotmail dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#40951"> &para;</a><div class="date" title="2004-03-24 10:46"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom40951">
<div class="phpcode"><code><span class="html">This is a quick and dirty way to accomplish the same thing:<br /><br />&lt;?<br />while(odbc_fetch_row($result)) {<br />$var1 = odbc_result($result, "NAMEOFFIELD1");<br />$var2 = odbc_result($result, "NAMEOFFIELD2");<br />..... //as many vars as you have fields with data to capture<br /><br />$array_of_results[] = compact('var1', 'var2','var3', etc, etc)<br />}<br />?&gt;<br /><br />Just turn each returned row's data into variables then use the compact().  Turns each variable name into a key and the vars value into the array value.  Makes a wonderful 2d array that you can walk easily and still use key values to get at data.</span></code></div>
  </div>
 </div>
  <div class="note" id="48228">  <div class="votes">
    <div id="Vu48228">
    <a href="https://www.php.net/manual/vote-note.php?id=48228&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd48228">
    <a href="https://www.php.net/manual/vote-note.php?id=48228&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V48228" title="41% like this...">
    -2
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#48228" class="name">
  <strong class="user"><em>miles at e-clipseconsulting dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#48228"> &para;</a><div class="date" title="2004-12-15 01:47"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom48228">
<div class="phpcode"><code><span class="html">In response to Sena's post, odbc_num_rows does not always return a row count.  When executing a query on MS Access it seems to return a row count of -1.<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">while(</span><span class="default">odbc_num_rows</span><span class="keyword">(</span><span class="default">$myodbcexec</span><span class="keyword">)){<br />       </span><span class="default">$myarray</span><span class="keyword">[] = </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$myodbcexec</span><span class="keyword">);<br />}<br /><br /></span><span class="default">?&gt;<br /></span><br />Just something to watch out for when attempting to execute this code.<br /><br />Miles Phillips<br />e-Clipse Consulting</span></code></div>
  </div>
 </div>
  <div class="note" id="81957">  <div class="votes">
    <div id="Vu81957">
    <a href="https://www.php.net/manual/vote-note.php?id=81957&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd81957">
    <a href="https://www.php.net/manual/vote-note.php?id=81957&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V81957" title="25% like this...">
    -2
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#81957" class="name">
  <strong class="user"><em>bryant at zionprogramming dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#81957"> &para;</a><div class="date" title="2008-03-20 03:04"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom81957">
<div class="phpcode"><code><span class="html">I found the function submitted by jezndiatyahoodotcodotuk to be very helpful.  I'm using PHP 5.2.5 and this function isn't defined, so it may depend on the ODBC driver being used.<br /><br />The only problem with the solution already posted is that the return values don't match the ones specified by the documentation.  I made the following modification so that the function will work the same whether it exists internally or not:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'odbc_fetch_array'</span><span class="keyword">)) {<br />    function </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$rownumber</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />        </span><span class="default">$array </span><span class="keyword">= array();<br />        if (!(</span><span class="default">$cols </span><span class="keyword">= </span><span class="default">odbc_fetch_into</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$result_array</span><span class="keyword">, </span><span class="default">$rownumber</span><span class="keyword">))) {<br />            return </span><span class="default">false</span><span class="keyword">;<br />        }<br />        for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$cols</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />            </span><span class="default">$array</span><span class="keyword">[</span><span class="default">odbc_field_name</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)] = </span><span class="default">$result_array</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];<br />        }<br />        return </span><span class="default">$array</span><span class="keyword">;<br />    }<br />}<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="116134">  <div class="votes">
    <div id="Vu116134">
    <a href="https://www.php.net/manual/vote-note.php?id=116134&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd116134">
    <a href="https://www.php.net/manual/vote-note.php?id=116134&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V116134" title="16% like this...">
    -4
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#116134" class="name">
  <strong class="user"><em>dinchu at gmail dot com</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#116134"> &para;</a><div class="date" title="2014-11-12 03:28"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom116134">
<div class="phpcode"><code><span class="html">I've found an issue while working with php ODBC functions. odbc_fetch_array and odbc_fetch_object fail when query has a join with a table that has the same column name, even when that certain field is excluded from the field selection (With SQL SERVER):<br /><br />THIS ONLY HAPPENS WHEN USING SQL_CUR_USE_ODBC<br /><br />for example<br /><br />$con = odbc_connect("Driver={SQL Server Native Client 11.0};Server=$serverName;Database=$db;", 'user', 'pass',SQL_CUR_USE_ODBC);<br /><br />$query="SELECT table1.field1, table1.field2 from table1 JOIN table2 ON  table1.field1=table2.field1";<br /><br />$result = odbc_exec($con,$query);<br /><br /> $a=odbc_fetch_array($result); <br />the code above generates a warning:<br /><br />Warning: odbc_fetch_array() [function.odbc-fetch-array]: SQL error: [Microsoft][SQL Server Native Client 10.0][SQL Server]the column name '' is ambiguous., SQL state 37000 in SQLGetData<br /><br />The error would be okay if i had selected field1 without specifying from which table, but even when it is explicit it doesn't work. the only "workaround" i've found so far is to remove the field from the selected fields or changinf the field name from the second table<br /><br />I tried with: both SQL Server Native Client 10.0 and SQL Server Native Client 11.0 SQL server 2008 Php 5.3.2 over Windows<br /><br />PD: If someone has any aideas without using sqlsrv or mssqL extension it will be great</span></code></div>
  </div>
 </div>
  <div class="note" id="100833">  <div class="votes">
    <div id="Vu100833">
    <a href="https://www.php.net/manual/vote-note.php?id=100833&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd100833">
    <a href="https://www.php.net/manual/vote-note.php?id=100833&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V100833" title="16% like this...">
    -8
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#100833" class="name">
  <strong class="user"><em>Vadim Istratov</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#100833"> &para;</a><div class="date" title="2010-11-10 04:21"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom100833">
<div class="phpcode"><code><span class="html">Be careful while using this function with MSSQL for fetching results of SQL queries like following: "SELECT * FROM table". In this case array will NOT contain named indexes!<br /><br />I.e.:<br />Table:<br />------------------------<br />| col1 | col2 | col3  |<br />------------------------<br />|   1   |   2   |   3   |<br />------------------------<br />|   4   |   5   |   6   |<br />------------------------<br /><br />Code:<br />---------------------<br /><span class="default">&lt;?php<br />$query </span><span class="keyword">= </span><span class="string">"SELECT * FROM table"</span><span class="keyword">;<br /></span><span class="default">$res </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br /><br />while( </span><span class="default">$row </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">) ) {<br />    </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span>---------------------<br /><br />Output will be:<br />---------------------<br />Array(<br /> [0] =&gt; 1,<br /> [1] =&gt; 2,<br /> [2] =&gt; 3<br />)<br />Array(<br /> [0] =&gt; 4,<br /> [1] =&gt; 5,<br /> [2] =&gt; 6<br />)<br />---------------------<br /><br />No field names here!</span></code></div>
  </div>
 </div>
  <div class="note" id="51826">  <div class="votes">
    <div id="Vu51826">
    <a href="https://www.php.net/manual/vote-note.php?id=51826&amp;page=function.odbc-fetch-array&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd51826">
    <a href="https://www.php.net/manual/vote-note.php?id=51826&amp;page=function.odbc-fetch-array&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V51826" title="0% like this...">
    -3
    </div>
  </div>
  <a href="function.odbc-fetch-array.php.html#51826" class="name">
  <strong class="user"><em>Remy</em></strong></a><a class="genanchor" href="function.odbc-fetch-array.php.html#51826"> &para;</a><div class="date" title="2005-04-12 05:35"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom51826">
<div class="phpcode"><code><span class="html">I use this function to get my recordset in an array, and it's very easy to use.<br /><br />function dbquery($sql) {<br />  $arr    = array();<br />  $conn = odbc_connect('dsn','user','pass');<br />  $rs     = odbc_exec($conn,$sql);<br />  $x      = 1;<br />  while (odbc_fetch_row($rs)) {<br />    for ($y = 1; $y &lt;= odbc_num_fields($rs); $y++) <br />      $arr[$x][$y] = odbc_result($rs,$y);<br />    $x++;<br />  }<br />  if ($x &gt; 1)<br />    return $arr;<br />}<br /><br />usage:<br /><br />$arr=dbquery("SELECT * FROM tblTable");<br />echo $arr[1][1] //echo's first column of the first row</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.odbc-fetch-array&amp;redirect=https://www.php.net/manual/ru/function.odbc-fetch-array.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.uodbc.php.html">Функции ODBC</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.odbc-autocommit.php.html" title="odbc_&#8203;autocommit">odbc_&#8203;autocommit</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-binmode.php.html" title="odbc_&#8203;binmode">odbc_&#8203;binmode</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-close-all.php.html" title="odbc_&#8203;close_&#8203;all">odbc_&#8203;close_&#8203;all</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-close.php.html" title="odbc_&#8203;close">odbc_&#8203;close</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-columnprivileges.php.html" title="odbc_&#8203;columnprivileges">odbc_&#8203;columnprivileges</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-columns.php.html" title="odbc_&#8203;columns">odbc_&#8203;columns</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-commit.php.html" title="odbc_&#8203;commit">odbc_&#8203;commit</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connect.php.html" title="odbc_&#8203;connect">odbc_&#8203;connect</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connection-string-is-quoted.php.html" title="odbc_&#8203;connection_&#8203;string_&#8203;is_&#8203;quoted">odbc_&#8203;connection_&#8203;string_&#8203;is_&#8203;quoted</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connection-string-quote.php.html" title="odbc_&#8203;connection_&#8203;string_&#8203;quote">odbc_&#8203;connection_&#8203;string_&#8203;quote</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-connection-string-should-quote.php.html" title="odbc_&#8203;connection_&#8203;string_&#8203;should_&#8203;quote">odbc_&#8203;connection_&#8203;string_&#8203;should_&#8203;quote</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-cursor.php.html" title="odbc_&#8203;cursor">odbc_&#8203;cursor</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-data-source.php.html" title="odbc_&#8203;data_&#8203;source">odbc_&#8203;data_&#8203;source</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-do.php.html" title="odbc_&#8203;do">odbc_&#8203;do</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-error.php.html" title="odbc_&#8203;error">odbc_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-errormsg.php.html" title="odbc_&#8203;errormsg">odbc_&#8203;errormsg</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-exec.php.html" title="odbc_&#8203;exec">odbc_&#8203;exec</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-execute.php.html" title="odbc_&#8203;execute">odbc_&#8203;execute</a>
                        </li>
                                                <li class="current">
                            <a href="function.odbc-fetch-array.php.html" title="odbc_&#8203;fetch_&#8203;array">odbc_&#8203;fetch_&#8203;array</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-into.php.html" title="odbc_&#8203;fetch_&#8203;into">odbc_&#8203;fetch_&#8203;into</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-object.php.html" title="odbc_&#8203;fetch_&#8203;object">odbc_&#8203;fetch_&#8203;object</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-fetch-row.php.html" title="odbc_&#8203;fetch_&#8203;row">odbc_&#8203;fetch_&#8203;row</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-len.php.html" title="odbc_&#8203;field_&#8203;len">odbc_&#8203;field_&#8203;len</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-name.php.html" title="odbc_&#8203;field_&#8203;name">odbc_&#8203;field_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-num.php.html" title="odbc_&#8203;field_&#8203;num">odbc_&#8203;field_&#8203;num</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-precision.php.html" title="odbc_&#8203;field_&#8203;precision">odbc_&#8203;field_&#8203;precision</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-scale.php.html" title="odbc_&#8203;field_&#8203;scale">odbc_&#8203;field_&#8203;scale</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-field-type.php.html" title="odbc_&#8203;field_&#8203;type">odbc_&#8203;field_&#8203;type</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-foreignkeys.php.html" title="odbc_&#8203;foreignkeys">odbc_&#8203;foreignkeys</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-free-result.php.html" title="odbc_&#8203;free_&#8203;result">odbc_&#8203;free_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-gettypeinfo.php.html" title="odbc_&#8203;gettypeinfo">odbc_&#8203;gettypeinfo</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-longreadlen.php.html" title="odbc_&#8203;longreadlen">odbc_&#8203;longreadlen</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-next-result.php.html" title="odbc_&#8203;next_&#8203;result">odbc_&#8203;next_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-num-fields.php.html" title="odbc_&#8203;num_&#8203;fields">odbc_&#8203;num_&#8203;fields</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-num-rows.php.html" title="odbc_&#8203;num_&#8203;rows">odbc_&#8203;num_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-pconnect.php.html" title="odbc_&#8203;pconnect">odbc_&#8203;pconnect</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-prepare.php.html" title="odbc_&#8203;prepare">odbc_&#8203;prepare</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-primarykeys.php.html" title="odbc_&#8203;primarykeys">odbc_&#8203;primarykeys</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-procedurecolumns.php.html" title="odbc_&#8203;procedurecolumns">odbc_&#8203;procedurecolumns</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-procedures.php.html" title="odbc_&#8203;procedures">odbc_&#8203;procedures</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-result-all.php.html" title="odbc_&#8203;result_&#8203;all">odbc_&#8203;result_&#8203;all</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-result.php.html" title="odbc_&#8203;result">odbc_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-rollback.php.html" title="odbc_&#8203;rollback">odbc_&#8203;rollback</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-setoption.php.html" title="odbc_&#8203;setoption">odbc_&#8203;setoption</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-specialcolumns.php.html" title="odbc_&#8203;specialcolumns">odbc_&#8203;specialcolumns</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-statistics.php.html" title="odbc_&#8203;statistics">odbc_&#8203;statistics</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-tableprivileges.php.html" title="odbc_&#8203;tableprivileges">odbc_&#8203;tableprivileges</a>
                        </li>
                                                <li class="">
                            <a href="function.odbc-tables.php.html" title="odbc_&#8203;tables">odbc_&#8203;tables</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
