<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: openssl_pkcs7_encrypt - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.openssl-pkcs7-encrypt.php.html">
 <link rel="shorturl" href="https://www.php.net/openssl-pkcs7-encrypt">
 <link rel="alternate" href="https://www.php.net/openssl-pkcs7-encrypt" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.openssl.php.html">
 <link rel="prev" href="function.openssl-pkcs7-decrypt.php.html">
 <link rel="next" href="function.openssl-pkcs7-read.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.openssl-pkcs7-encrypt.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.openssl-pkcs7-encrypt.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.openssl-pkcs7-encrypt.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.openssl-pkcs7-encrypt.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.openssl-pkcs7-encrypt.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.openssl-pkcs7-encrypt.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.openssl-pkcs7-encrypt.php" hreflang="pt_BR">
 <link rel="alternate" href="function.openssl-pkcs7-encrypt.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.openssl-pkcs7-encrypt.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.openssl-pkcs7-encrypt.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.openssl-pkcs7-read.php.html">
          openssl_pkcs7_read &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.openssl-pkcs7-decrypt.php.html">
          &laquo; openssl_pkcs7_decrypt        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.crypto.php.html'>Криптографические модули</a></li>      <li><a href='book.openssl.php.html'>OpenSSL</a></li>      <li><a href='ref.openssl.php.html'>Функции OpenSSL</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.openssl-pkcs7-encrypt.php'>English</option>
            <option value='de/function.openssl-pkcs7-encrypt.php'>German</option>
            <option value='es/function.openssl-pkcs7-encrypt.php'>Spanish</option>
            <option value='fr/function.openssl-pkcs7-encrypt.php'>French</option>
            <option value='it/function.openssl-pkcs7-encrypt.php'>Italian</option>
            <option value='ja/function.openssl-pkcs7-encrypt.php'>Japanese</option>
            <option value='pt_BR/function.openssl-pkcs7-encrypt.php'>Brazilian Portuguese</option>
            <option value='ru/function.openssl-pkcs7-encrypt.php' selected="selected">Russian</option>
            <option value='tr/function.openssl-pkcs7-encrypt.php'>Turkish</option>
            <option value='zh/function.openssl-pkcs7-encrypt.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/openssl/functions/openssl-pkcs7-encrypt.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.openssl-pkcs7-encrypt%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.openssl-pkcs7-encrypt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">openssl_pkcs7_encrypt</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">openssl_pkcs7_encrypt</span> &mdash; <span class="dc-title">Шифрует сообщение S/MIME</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.openssl-pkcs7-encrypt-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>openssl_pkcs7_encrypt</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$input_filename</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$output_filename</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type"><a href="class.opensslcertificate.php.html" class="type OpenSSLCertificate">OpenSSLCertificate</a></span>|<span class="type">array</span>|<span class="type">string</span></span> <code class="parameter">$certificate</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">array</span><span class="type"></span></span> <code class="parameter">$headers</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = 0</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$cipher_algo</code><span class="initializer"> = <strong><code>OPENSSL_CIPHER_AES_128_CBC</code></strong></span></span><br>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>openssl_pkcs7_encrypt()</strong></span> читает сообщение из файла
   <code class="parameter">input_filename</code>, шифрует его с помощью 40-битного RC2
   шифра таким образом, что расшифровать его могут только получатели,
   указанными в <code class="parameter">certificate</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.openssl-pkcs7-encrypt-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">input_filename</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">output_filename</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">certificate</code></dt>

     <dd>

      <p class="para">
       Массив, либо единичный сертификат X.509.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">headers</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">headers</code> задаётся массивом заголовков,
       которые будут добавлены в начало сообщения перед шифрованием.
      </p>
      <p class="para">
       <code class="parameter">headers</code> может быть как ассоциативным массивом,
       где в качестве ключей используются имена заголовков, либо индексированным
       массивом, содержащим полные строки заголовков.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">flags</code> используется для настройки процесса шифрования.
       Смотрите <a href="openssl.pkcs7.flags.php.html" class="link">Константы PKCS7</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">cipher_algo</code></dt>

     <dd>

      <p class="para">
       Одна из <a href="openssl.ciphers.php.html" class="link">констант шифров</a>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.openssl-pkcs7-encrypt-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.openssl-pkcs7-encrypt-changelog">
  <h3 class="title">Список изменений</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Версия</th>
      <th>Описание</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.1.0</td>
      <td>
       Алгоритм шифрования по умолчанию (<code class="parameter">cipher_algo</code>) теперь AES-128-CBC (<strong><code>OPENSSL_CIPHER_AES_128_CBC</code></strong>).
       Ранее использовался алгоритм PKCS7/CMS (<strong><code>OPENSSL_CIPHER_RC2_40</code></strong>).
      </td>
     </tr>

     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">certificate</code> теперь принимает экземпляр <span class="classname"><a href="class.opensslcertificate.php.html" class="classname">OpenSSLCertificate</a></span>;
       ранее принимался ресурс (<a href="language.types.resource.php.html" class="link">resource</a>) типа <code class="literal">OpenSSL X.509 CSR</code>.
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.openssl-pkcs7-encrypt-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-2860">
    <p><strong>Пример #1 Пример использования <span class="function"><strong>openssl_pkcs7_encrypt()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// Сообщение, которое вы хотите зашифровать и отправить своему секретному<br />// агенту с позывным Козодой. У вас есть его сертификат в файле nighthawk.pem<br /></span><span style="color: #0000BB">$data </span><span style="color: #007700">= &lt;&lt;&lt;EOD<br /></span><span style="color: #DD0000">Козодой,<br /><br />Совершенно секретно! После прочтения сжечь!<br /><br />Враги приближаются! Связной с новым поддельным паспортом<br />будет ждать тебя завтра в кафе в 8.30 утра.<br /><br />Пароль - "У вас ус отклеился!"<br />Отзыв - "Это не ус, а борода!"<br /><br /></span><span style="color: #007700">EOD;<br /><br /></span><span style="color: #FF8000">// загружаем ключ<br /></span><span style="color: #0000BB">$key </span><span style="color: #007700">= </span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">"nighthawk.pem"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// записываем сообщение в файл<br /></span><span style="color: #0000BB">$fp </span><span style="color: #007700">= </span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">"msg.txt"</span><span style="color: #007700">, </span><span style="color: #DD0000">"w"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #0000BB">$data</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// шифруем<br /></span><span style="color: #007700">if (</span><span style="color: #0000BB">openssl_pkcs7_encrypt</span><span style="color: #007700">(</span><span style="color: #DD0000">"msg.txt"</span><span style="color: #007700">, </span><span style="color: #DD0000">"enc.txt"</span><span style="color: #007700">, </span><span style="color: #0000BB">$key</span><span style="color: #007700">,<br />    array(</span><span style="color: #DD0000">"To" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"nighthawk@example.com"</span><span style="color: #007700">, </span><span style="color: #FF8000">// ассоциативный синтаксис<br />          </span><span style="color: #DD0000">"From: HQ &lt;hq@example.com&gt;"</span><span style="color: #007700">, </span><span style="color: #FF8000">// индексированный синтаксис<br />          </span><span style="color: #DD0000">"Subject" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"СРОЧНО!!! ВАЖНО!!!"</span><span style="color: #007700">))) {<br />    </span><span style="color: #FF8000">// сообщение зашифровано - отправляем!!<br />    </span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">"sendmail_path"</span><span style="color: #007700">) . </span><span style="color: #DD0000">" &lt; enc.txt"</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.openssl-pkcs7-encrypt&amp;redirect=https://www.php.net/manual/ru/function.openssl-pkcs7-encrypt.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">15 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="51006">  <div class="votes">
    <div id="Vu51006">
    <a href="https://www.php.net/manual/vote-note.php?id=51006&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd51006">
    <a href="https://www.php.net/manual/vote-note.php?id=51006&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V51006" title="70% like this...">
    4
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#51006" class="name">
  <strong class="user"><em>ungdi at hotmail dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#51006"> &para;</a><div class="date" title="2005-03-16 03:19"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom51006">
<div class="phpcode"><code><span class="html">Amongst the many discussions about signing or encrypting email by itself, none really discuss the pain of having an email BOTH signed AND encrypted.<br /><br />*** What do you do first? Sign then Encrypt? Or Encrypt then Sign?<br /><br />According to RFC 2311, you can encrypt then sign or sign then encrypt. However, it depends on the client in which you are programming for. In my experience, in Outlook 2000, it prefers it Encrypt then Sign. While in Outlook 2003, it is Sign then Encrypt. Generally, you want Sign then Encrypt, as it seems most logical from a snail-mail piece point of view. You first sign a letter than put it in an envelope. Certain clients complain if you do it in an order it does not like, so you may want to experiement with it.<br /><br />*** Example of doing both signing AND encrypting.<br /><br />When you perform the first function, do NOT put in any headers in the headers array parameters, you want to put it in the SECOND function you want to perform. If you put the headers in the first function, the second function will hide it from the mail servers. You do not want that. Here I will sign then encrypt.<br /><br />&lt;?<br />// Setup mail headers.<br />$headers = array("To" =&gt; "someone@nowhere.net",<br />     "From" =&gt; "noone@somewhere.net",<br />     "Subject" =&gt; "A signed and encrypted message.");<br /><br />// Sign the message first<br />openssl_pkcs7_sign("msg.txt","signed.txt",<br />     "signing_cert.pem",array("private_key.pem",<br />     "password"),array());<br /><br />// Get the public key certificate.<br />$pubkey = file_get_contents("cert.pem");<br /><br />//encrypt the message, now put in the headers.<br />openssl_pkcs7_encrypt("signed.txt", "enc.txt",<br />     $pubkey,$headers,0,1);<br /><br />$data = file_get_contents("enc.txt");<br /><br />// separate header and body, to use with mail function<br />//  unfortunate but required, else we have two sets of headers<br />//  and the email client doesn't decode the attachment<br />$parts = explode("\n\n", $data, 2);<br /><br />// send mail (headers in the Headers parameter will override those<br />//  generated for the To &amp; Subject parameters)<br />mail($mail, $subject, $parts[1], $parts[0]);<br />?&gt;<br /><br />Note that if you use a function that picks up the data from the disk to be used in another function in your program, remember that you may have used the explode("\n\n",$data,2) function which may have removed the spacing between the header and the message content. <br /><br />When you take the signed message and feed it in to the encryption part, you have to remember that the line spacing must also be fed AS PART OF THE MESSAGE BODY! If you plan to sign then encrypt, do not feed the header output from the signing into the encrypting as part of the headers array parameter! The output of the signing should stay as part of the message body being encrypted. (And the same is true if you are doing the reverse of encrypting then signing.) An example of both the signing and encryption function made in to a routine for reusability, and then called to sign and encrypt a message.<br /><br />*** Example of signing and encrypting executed from a routine function for code reusability through a program.<br /><br />THIS IS WRONG!:<br />&lt;?<br />// [0] of Array contains headers of message. [1] of Array contains signed body of message.<br />$signedOutputArray = signMessage($inputMessage,$headers);<br /><br />// [0] of Array contains headers of message and the signing.<br />// [1] of Array contains encrypted body of message without the signing header.<br />$signedAndEncryptedArray = encryptMessage($signedOutputArray[1],<br />     $signedOutputArray[0]);<br /><br />mail($emailAddr,$subject,$signedAndEncryptedArray[1],<br />      $signedAndEncryptedArray[0]);<br />?&gt;<br /><br />THIS IS CORRECT!<br />&lt;?<br />// [0] of Array contains headers of signing.<br />// [1] of Array contains signed body of message.<br />$signedOutputArray = signMessage($inputMessage,array());<br /><br />// [0] of Array contains headers of message.<br />// [1] of Array contains encrypted contents of both the signed message and its headers of the signing.<br />$signedAndEncryptedArray = <br />     encryptMessage($signedOutputArray[0] . "\n\n" . $signedOutputArray[1],$headers);<br /><br />mail($emailAddr,$subject,$signedAndEncryptedArray[1],<br />     $signedAndEncryptedArray[0]);<br />?&gt;</span></code></div>
  </div>
 </div>
  <div class="note" id="107892">  <div class="votes">
    <div id="Vu107892">
    <a href="https://www.php.net/manual/vote-note.php?id=107892&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd107892">
    <a href="https://www.php.net/manual/vote-note.php?id=107892&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V107892" title="60% like this...">
    1
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#107892" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#107892"> &para;</a><div class="date" title="2012-03-13 02:37"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom107892">
<div class="phpcode"><code><span class="html">To build on what people have already done, below is a function that takes a from address, an array of e-mails/public keys, a subject, and a message and sends out an encrypted message using the appropriate public key.<br /><br />Since we're sending an encrypted message, the assumption is that what we're sending is actually critical. As a result the files used for sending the message are immediately shredded.<br /><br />$recipients = Array("user@example.com"=&gt;file_get_contents("cert.pem"));<br />$body = 'secret text';<br />   sendSignedMail("me@examplel.com", $recipients, "Test Message", $body);<br /><br />  //Recepients is an array of e-mail address=&gt;Key<br />  function sendSignedMail($from, $recepients, $subject, $body){<br />    foreach($recepients AS $email=&gt;$key){<br />      $tfn_in = tempnam("/tmp", "b");<br />      $tfn_out = tempnam("/tmp", "e");<br /> <br />      $handle = fopen($tfn_in, "w");<br />      fwrite($handle, $body);<br />      fclose($handle);<br />    <br />      openssl_pkcs7_encrypt($tfn_in, $tfn_out, $key,<br />          array("To" =&gt; $email,<br />                "From" =&gt; $from,<br />                "Subject" =&gt; $subject), 0);<br />      $data = file_get_contents($tfn_out);<br />      <br />      //Shred the files since this is sensitive data.<br />      $handle = popen("/usr/bin/shred -n 3 -u $tfn_in", 'r');<br />      pclose($handle);<br />      $handle = popen("/usr/bin/shred -n 3 -u $tfn_out", 'r');<br />      pclose($handle);<br />      <br />      <br />      $parts = explode("\n\n", $data, 2);//Fixes headers in mail function<br /><br />      mail($email, $subject, $parts[1], $parts[0]);<br />  <br />    }<br />  <br />  }</span></code></div>
  </div>
 </div>
  <div class="note" id="96542">  <div class="votes">
    <div id="Vu96542">
    <a href="https://www.php.net/manual/vote-note.php?id=96542&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd96542">
    <a href="https://www.php.net/manual/vote-note.php?id=96542&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V96542" title="100% like this...">
    2
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#96542" class="name">
  <strong class="user"><em>1matqo1 at azet dot sk</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#96542"> &para;</a><div class="date" title="2010-03-04 02:30"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom96542">
<div class="phpcode"><code><span class="html">For everyone who spent lots of time trying to encrypt multipart/alternative emailwith no success:<br /><br />1.) put complete email (header together with body) into file to encrypt as in example from koen:<br /><span class="default">&lt;?php<br />$body </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"body.txt"</span><span class="keyword">);<br /></span><span class="default">$msg </span><span class="keyword">= </span><span class="default">$enc_header</span><span class="keyword">.</span><span class="default">$body</span><span class="keyword">;<br /></span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="default">$msg</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />2.) headers array sent to openssl_pkcs7_encrypt can`t contain some of headers, it conflicts/doubles and some clients have problems with it - i.e. Thunderbird don`t show you email body. For me worked headers: "Subject", "To", "From", "Reply-To", "Date","Return-Receipt","Message-ID","CC", "X-Priority", "X-Mailer"<br /><br />one more thing - if your public key for encryption is not working, check if you are sending certificate with key, not only pure key(must be certificate)<br /><br />Good luck to everyone, its a little bit hard because of small amount of documentation which is sometimes confusing...</span></code></div>
  </div>
 </div>
  <div class="note" id="84484">  <div class="votes">
    <div id="Vu84484">
    <a href="https://www.php.net/manual/vote-note.php?id=84484&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd84484">
    <a href="https://www.php.net/manual/vote-note.php?id=84484&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V84484" title="55% like this...">
    1
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#84484" class="name">
  <strong class="user"><em>koen dot thomeer at pubmed dot be</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#84484"> &para;</a><div class="date" title="2008-07-16 06:15"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom84484">
<div class="phpcode"><code><span class="html">In the previous example, the decrypted message couldn't be read by the 'popular' mail clients. Those mail clients needed also headers in the encrypted part.<br /><br />I also noticed that there were some double headers in the previous example ('To:' and 'Subject:' were not overriden by the Headers parameter in mail()). This is also corrected by unsetting 'To:' and 'Subject:' in $headers_msg.<br /><br />body.txt is the file with the mail body.<br />publickey.cer is the file with the public certificate.<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Setup mail headers.<br /></span><span class="default">$headers </span><span class="keyword">= array(</span><span class="string">"From" </span><span class="keyword">=&gt; </span><span class="string">"from@mail.com"</span><span class="keyword">, </span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"to@mail.com"</span><span class="keyword">, </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"Encrypted mail readable with most clients"</span><span class="keyword">, </span><span class="string">"X-Mailer" </span><span class="keyword">=&gt; </span><span class="string">"PHP/"</span><span class="keyword">.</span><span class="default">phpversion</span><span class="keyword">());<br /><br /></span><span class="comment">// Get the public key certificate.<br /></span><span class="default">$pubkey </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"publickey.cer"</span><span class="keyword">);<br /><br /></span><span class="comment">// Header for encrypted part<br /></span><span class="default">$eol </span><span class="keyword">= </span><span class="string">"\r\n"</span><span class="keyword">;<br /></span><span class="default">$enc_header </span><span class="keyword">.= </span><span class="string">"From: "</span><span class="keyword">.</span><span class="default">$headers</span><span class="keyword">[</span><span class="string">'From'</span><span class="keyword">].</span><span class="default">$eol</span><span class="keyword">;<br /></span><span class="default">$enc_header </span><span class="keyword">.= </span><span class="string">"To: "</span><span class="keyword">.</span><span class="default">$headers</span><span class="keyword">[</span><span class="string">'To'</span><span class="keyword">].</span><span class="default">$eol</span><span class="keyword">;<br /></span><span class="default">$enc_header </span><span class="keyword">.= </span><span class="string">"Subject: "</span><span class="keyword">.</span><span class="default">$headers</span><span class="keyword">[</span><span class="string">'Subject'</span><span class="keyword">].</span><span class="default">$eol</span><span class="keyword">;<br /></span><span class="default">$enc_header </span><span class="keyword">.= </span><span class="string">"Content-Type: text/plain; format=flowed; charset=\"iso-8859-1\"; reply-type=original"</span><span class="keyword">.</span><span class="default">$eol</span><span class="keyword">;<br /></span><span class="default">$enc_header </span><span class="keyword">.= </span><span class="string">"Content-Transfer-Encoding: 7bit"</span><span class="keyword">.</span><span class="default">$eol</span><span class="keyword">;<br /></span><span class="default">$enc_header </span><span class="keyword">.= </span><span class="string">"\n"</span><span class="keyword">;<br /><br /></span><span class="comment">// Prepend header for encrypted message<br /></span><span class="default">$body </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"body.txt"</span><span class="keyword">);<br /></span><span class="default">$msg </span><span class="keyword">= </span><span class="default">$enc_header</span><span class="keyword">.</span><span class="default">$body</span><span class="keyword">;<br /></span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="default">$msg</span><span class="keyword">);<br /><br /></span><span class="comment">// Remove some double headers for mail()<br /></span><span class="default">$headers_msg </span><span class="keyword">= </span><span class="default">$headers</span><span class="keyword">;<br />unset(</span><span class="default">$headers_msg</span><span class="keyword">[</span><span class="string">'To'</span><span class="keyword">], </span><span class="default">$headers_msg</span><span class="keyword">[</span><span class="string">'Subject'</span><span class="keyword">]);<br /><br /></span><span class="comment">// Encrypt message<br /></span><span class="default">openssl_pkcs7_encrypt</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"enc.txt"</span><span class="keyword">,</span><span class="default">$pubkey</span><span class="keyword">,</span><span class="default">$headers_msg</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br /><br /></span><span class="comment">// Seperate headers and body for mail()<br /></span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"enc.txt"</span><span class="keyword">);<br /></span><span class="default">$parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /><br /></span><span class="comment">// send mail <br /></span><span class="default">mail</span><span class="keyword">(</span><span class="default">$headers</span><span class="keyword">[</span><span class="string">'To'</span><span class="keyword">], </span><span class="default">$headers</span><span class="keyword">[</span><span class="string">'Subject'</span><span class="keyword">], </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="124938">  <div class="votes">
    <div id="Vu124938">
    <a href="https://www.php.net/manual/vote-note.php?id=124938&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124938">
    <a href="https://www.php.net/manual/vote-note.php?id=124938&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124938" title="no votes...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#124938" class="name">
  <strong class="user"><em>Matthias Barkhausen</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#124938"> &para;</a><div class="date" title="2020-04-23 12:34"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom124938">
<div class="phpcode"><code><span class="html">To successfully sign and encrypt an plain text E-Mail to send to and to be able to read by Outlook and iOS Mail you need to first sign w/o headers and use the PKCS7_TEXT constant, then encrypt with headers and cipherid 3DES, then send with sendmail/ssmtp with -t option.<br /><br />Reason for 3DES ist that iOS (or Apple in general) doesnt further accept the RC40 default encryption openssl-pkcs7-encrypt is using. Outlook would decrypt such encryption, but iOS Mail just said "this mail has no content" and "install a profile containing your identity...".<br /><br />$headers = array("To" =&gt; ...,<br />         "From" =&gt; ...,<br />         "Subject" =&gt; ...);<br /><br />openssl_pkcs7_sign("msg.txt","signed.txt", $mMyCertFileToIncludeForRecipient,array($mMyPrivKeyFileAsPEM, "passphrase"),array(),PKCS7_TEXT);<br /><br />openssl_pkcs7_encrypt("signed.txt","enc.txt",$pubkeyContents,$headers,0,OPENSSL_CIPHER_3DES);<br /><br />shell_exec("ssmtp -t &lt; enc.txt") #sendmail same syntax</span></code></div>
  </div>
 </div>
  <div class="note" id="107342">  <div class="votes">
    <div id="Vu107342">
    <a href="https://www.php.net/manual/vote-note.php?id=107342&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd107342">
    <a href="https://www.php.net/manual/vote-note.php?id=107342&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V107342" title="no votes...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#107342" class="name">
  <strong class="user"><em>Ryan Schaffner</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#107342"> &para;</a><div class="date" title="2012-02-01 08:16"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom107342">
<div class="phpcode"><code><span class="html">After tinkering around for about an hour, I found this that might help someone.  When you export your certificate, make sure it is a base-64 certificate, as the DER-encoded cannot be read by these functions.  Windows want's to default to DER.  IT MUST BE Base-64 cert for these to work.</span></code></div>
  </div>
 </div>
  <div class="note" id="44669">  <div class="votes">
    <div id="Vu44669">
    <a href="https://www.php.net/manual/vote-note.php?id=44669&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd44669">
    <a href="https://www.php.net/manual/vote-note.php?id=44669&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V44669" title="no votes...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#44669" class="name">
  <strong class="user"><em>ungdi AT hotmail DOT com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#44669"> &para;</a><div class="date" title="2004-08-12 11:07"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom44669">
<div class="phpcode"><code><span class="html">As of PHP 5.0.0, you have the ability to choose between 64 bit RC2 encryption OR 128 bit RC2 encryption.<br /><br />The new function description should now be:<br />bool openssl_pkcs7_encrypt ( string infile, string outfile, mixed recipcerts, array headers [, int flags] [,int cipher])<br /><br />Where the int value of cipher is 0 or 1. 0 = 64 bit and 1 = 128 bit.</span></code></div>
  </div>
 </div>
  <div class="note" id="36598">  <div class="votes">
    <div id="Vu36598">
    <a href="https://www.php.net/manual/vote-note.php?id=36598&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36598">
    <a href="https://www.php.net/manual/vote-note.php?id=36598&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36598" title="no votes...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#36598" class="name">
  <strong class="user"><em>richardaburton at hotmail dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#36598"> &para;</a><div class="date" title="2003-10-15 05:38"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36598">
<div class="phpcode"><code><span class="html">Using sendmail isn't very portable, and seems daft since PHP has the mail function which will do the job. Problem is how do you use the mail function to send this email, since it's already complete with headers?<br /><br />If you pull in the contents of the file produced by openssl_pkcs7_encrypt and pass this as the message data to the mail command, you end up with an email with two sets of headers (one set from the encrypt function, another added by the mail command). The result is that the second set of headers (which tell the mail client the email is encrypted) get ignored and the (base64 encoded) encrypted mail is shown as-is, rather than being decrypted.<br /><br />The solution is quite simple, but it took me a little while to think of it, so I'm sharing it here. Once you load the contents of the file, split the headers off the body. Then pass the headers as the additional_headers parameter to the mail function, and just the body of the email as the message parameter of the mail function.<br /><br />You will need to specify the to &amp; subject parameters, but these will be overriden in the final email (as delievered to the recipiant) by the ones from the real encrypted email.<br /><br /><span class="default">&lt;?php<br /><br />$pubkey </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"cert.pem"</span><span class="keyword">);<br /><br /></span><span class="default">openssl_pkcs7_encrypt</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"enc.txt"</span><span class="keyword">, </span><span class="default">$pubkey</span><span class="keyword">,<br />    array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"nighthawk@example.com"</span><span class="keyword">,<br />          </span><span class="string">"From" </span><span class="keyword">=&gt; </span><span class="string">"HQ &lt;hq@example.com&gt;"</span><span class="keyword">,<br />          </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"Eyes only"</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">)<br /><br /></span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"enc.txt"</span><span class="keyword">);<br /><br /></span><span class="comment">// separate header and body, to use with mail function<br />//  unfortunate but required, else we have two sets of headers<br />//  and the email client doesn't decode the attachment<br /></span><span class="default">$parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /><br /></span><span class="comment">// send mail (headers in the Headers parameter will override those<br />//  generated for the To &amp; Subject parameters)<br /></span><span class="default">mail</span><span class="keyword">(</span><span class="default">$mail</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">, </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /><br /></span><span class="default">?&gt;<br /></span><br />Richard.</span></code></div>
  </div>
 </div>
  <div class="note" id="36596">  <div class="votes">
    <div id="Vu36596">
    <a href="https://www.php.net/manual/vote-note.php?id=36596&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36596">
    <a href="https://www.php.net/manual/vote-note.php?id=36596&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36596" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#36596" class="name">
  <strong class="user"><em>richardaburton at hotmail dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#36596"> &para;</a><div class="date" title="2003-10-15 05:31"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36596">
<div class="phpcode"><code><span class="html">If you don't like the idea of only using RC2/40bit you can always recompile the php_openssl extension. Simply search through the extensions openssl.c source file for the EVP_rc2_40_cbc() call, which selects this cipher. Replace the call to select another better cipher such as EVP_rc2_cbc() (RC2/128bit) or EVP_des_ede3_cbc() (triple-DES).<br /><br />I patched the source to allow the selection of cipher as an extra parameter, but got the latest source from CVS to submit a patch and it appears the work has already been done, so looks like we will see this feature in pretty soon.<br /><br />Richard.</span></code></div>
  </div>
 </div>
  <div class="note" id="55497">  <div class="votes">
    <div id="Vu55497">
    <a href="https://www.php.net/manual/vote-note.php?id=55497&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd55497">
    <a href="https://www.php.net/manual/vote-note.php?id=55497&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V55497" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#55497" class="name">
  <strong class="user"><em>bob at bobscheffler dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#55497"> &para;</a><div class="date" title="2005-08-04 05:58"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom55497">
<div class="phpcode"><code><span class="html">It's not worth it.  Honestly, it would sound like a great idea, but it is such a pain in the arse.  I have done so using asp, but have not yet found a way (or really tried for that matter) to do this using PGP.  Using asp took me a full day to do (had to judo-kung foo chop a little for it to work correctly).  Peace--</span></code></div>
  </div>
 </div>
  <div class="note" id="31786">  <div class="votes">
    <div id="Vu31786">
    <a href="https://www.php.net/manual/vote-note.php?id=31786&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd31786">
    <a href="https://www.php.net/manual/vote-note.php?id=31786&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V31786" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#31786" class="name">
  <strong class="user"><em>glyn at tomkins dot net</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#31786"> &para;</a><div class="date" title="2003-05-03 01:50"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom31786">
<div class="phpcode"><code><span class="html">I have been struggling to get openssl_pkcs7_encrypt() to work just as I need it to do but through my perseverence I have prevailed.  The issues I came across were due to my very incomplete understanding of S/MIME, MIME and email headers.<br /><br />First, both the example in the manual and the correction offered by msisolak above are also slightly incorrect.  Let me explain in lay terms how the problem arises ... <br /><br />email messages are constructed as follows<br /><br />headers<br />blank line<br />content<br /><br />For S/MIME, the message is encrypted (including headers) and further headers are wrapped around the encrypted message, like so: <br /><br />S/MIME headers<br />blank line<br />encrypted MIME headers<br />encrypted blank line<br />encrypted content<br /><br />If you have no headers in what you are encrypting then anything before the 1st blank line is regarded as headers and doesn't appear in the content of your message.<br /><br />openssl_pkcs7_encrypt() creates the entire encrypted portion so if you do not include any headers in your infile then you will find that some of your message may be treated as headers unless you make the first line of your file a blank line.<br /><br />There is also an error in the way the "From" S/MIME header is coded on the call to openssl_pkcs7_encrypt(). <br /><br />So the example, to work 100% correctly needs to read as follows: <br /><br />// the message you want to encrypt and send to your secret agent<br />// in the field, known as nighthawk.  You have his certificate<br />// in the file nighthawk.pem<br />//<br />//Note the first line must be blank as i am providing no headers inside the secure portion of the mail.<br />$data = &lt;&lt;&lt;EOD<br /><br />Nighthawk,<br /><br />Top secret, for your eyes only!<br /><br />The enemy is closing in! Meet me at the cafe at 8.30am<br />to collect your forged passport!<br /><br />HQ<br />EOD;<br /><br />// load key<br />$key = implode("", file("my.pem"));<br /><br />// save message to file<br />$fp = fopen("msg.txt", "w");<br />fwrite($fp, $data);<br />fclose($fp);<br /><br />// encrypt it<br />if (openssl_pkcs7_encrypt("msg.txt", "enc.txt", $key,<br />  array("To" =&gt; "you@yourdomain.com", // keyed syntax<br />         "From" =&gt; "HQ &lt;hq@cia.com&gt;", // indexed syntax<br />         "Subject" =&gt; "Eyes only")))<br />{<br />   // message encrypted - send it!<br />  exec(ini_get("sendmail_path") . " &lt; enc.txt");<br />}<br /><br />Now,  I wanted to make a couple of other enhancements. My email contained html content and must be formatted when displayed in the email client and I also wanted to use temporary file names to allow multiple users to use the script at the same time. Finally, I wanted to remove these temporary files afterwards.   <br /><br />Here is how the example ends up with these additional enhancements:<br /><br />&lt;?<br /><br />// the message you want to encrypt and send to your secret agent<br />// in the field, known as nighthawk.  You have his certificate<br />// in the file my.pem<br />//<br />//Note the blank line  following the Content-type header<br />//<br />$data = &lt;&lt;&lt;EOD<br />MIME-Version: 1.0<br />Content-type: text/html; charset=iso-8859-1<br /><br />&lt;html&gt;<br />&lt;b&gt;Nighthawk&lt;/b&gt;,<br />&lt;h1&gt;Top secret, for your eyes only!&lt;/h1&gt;<br />&lt;p&gt;The enemy is closing in! Meet me at the cafe at 8.30am<br />to collect your forged passport!&lt;/p&gt;<br />&lt;p&gt;HQ&lt;/p&gt;<br />&lt;/html&gt;<br />EOD;<br /><br />// load key<br />$key = implode("", file("my.pem"));<br /><br />// generate a unique temporary file name.  Use .txt for the clear text version and .enc for the encrypted version.<br />$clearfile = tempnam("temp","email") . ".txt";<br />$encfile = $clearfile . ".enc";<br />$clearfile .= ".txt";<br /><br />$fp = fopen($clearfile, "w");<br />fwrite($fp, $data);<br />fclose($fp);<br /><br />// encrypt it<br />if (openssl_pkcs7_encrypt($clearfile,$encfile, $key,<br />  array("To" =&gt; "you@yourdomain.com", // keyed syntax<br />         "From" =&gt; "HQ &lt;hq@cia.com&gt;", // indexed syntax<br />         "Subject" =&gt; "Eyes only")))<br />{<br />   // message encrypted - send it!<br />  exec(ini_get("sendmail_path") . " &lt; $encfile");<br /><br />};<br />// now erase the temp files<br />unlink($clearfile);<br />unlink($encfile);<br /><br />?&gt;</span></code></div>
  </div>
 </div>
  <div class="note" id="21823">  <div class="votes">
    <div id="Vu21823">
    <a href="https://www.php.net/manual/vote-note.php?id=21823&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd21823">
    <a href="https://www.php.net/manual/vote-note.php?id=21823&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V21823" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#21823" class="name">
  <strong class="user"><em>msisolak at yahoo dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#21823"> &para;</a><div class="date" title="2002-05-28 12:14"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom21823">
<div class="phpcode"><code><span class="html">For those trying to use this function from Windows with a key in Outlook or Outlook Express it can be tricky to figure out how to get the key exported in the format that OpenSSL is looking for.  Since all (at least all Microsoft) products share a common key store, it's easier to export the key from IE than Outlook.<br /><br />In IE select Tools -&gt; Internet Options, then the "Content" tab, and click the Certificates button.  Select your certificate from the list and click the Export button.  To encrypt email you only want your public key exported in the "Base-64 encoded X.509 (.CER)" format.  The file this procedure creates can be directly used as a key file to S/MIME encrypt with openssl-pkcs7-encrypt.</span></code></div>
  </div>
 </div>
  <div class="note" id="119071">  <div class="votes">
    <div id="Vu119071">
    <a href="https://www.php.net/manual/vote-note.php?id=119071&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd119071">
    <a href="https://www.php.net/manual/vote-note.php?id=119071&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V119071" title="0% like this...">
    -2
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#119071" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#119071"> &para;</a><div class="date" title="2016-03-28 09:07"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom119071">
<div class="phpcode"><code><span class="html">The example code is wrong (at least as of 4.2.0).  The recipcerts parameter is either the actual text of the base64 encoded key file, or it must be a filename in "file://..." format.  A normal path will not work (OpenSSL tries to use the path as the actual certificate).  The above code works as: <br /><br /><span class="default">&lt;?php <br /></span><span class="comment">// the message you want to encrypt and send to your secret agent <br />// in the field, known as nighthawk.  You have his certificate <br />// in the file nighthawk.pem <br /></span><span class="default">$data </span><span class="keyword">= &lt;&lt;&lt;</span><span class="default">EOD <br />Nighthawk</span><span class="keyword">, <br /><br /></span><span class="default">Top secret</span><span class="keyword">, for </span><span class="default">your eyes only</span><span class="keyword">! <br /><br /></span><span class="default">The enemy is closing in</span><span class="keyword">! </span><span class="default">Meet me at the cafe at 8.30am <br />to collect your forged passport</span><span class="keyword">! <br /><br /></span><span class="default">HQ <br />EOD</span><span class="keyword">; <br /><br /></span><span class="comment">// load key <br /></span><span class="default">$key </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">file</span><span class="keyword">(</span><span class="string">"my.pem"</span><span class="keyword">)); <br /><br /></span><span class="comment">// save message to file <br /></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">); <br /></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">); <br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">); <br /><br /></span><span class="comment">// encrypt it <br /></span><span class="keyword">if (</span><span class="default">openssl_pkcs7_encrypt</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"enc.txt"</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, <br />    array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"example@example.com"</span><span class="keyword">, </span><span class="comment">// keyed syntax <br />          </span><span class="string">"From: HQ &lt;hq@cia.com&gt;"</span><span class="keyword">, </span><span class="comment">// indexed syntax <br />          </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"Eyes only"</span><span class="keyword">))) <br />{ <br />    </span><span class="comment">// message encrypted - send it! <br />    </span><span class="default">exec</span><span class="keyword">(</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">"sendmail_path"</span><span class="keyword">) . </span><span class="string">" &lt; enc.txt"</span><span class="keyword">); <br />} <br /></span><span class="default">?&gt;</span> <br /><br />[You can also pass an array of recipcerts values, but I haven't used that so I don't know what it's expecting.]</span></code></div>
  </div>
 </div>
  <div class="note" id="32206">  <div class="votes">
    <div id="Vu32206">
    <a href="https://www.php.net/manual/vote-note.php?id=32206&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd32206">
    <a href="https://www.php.net/manual/vote-note.php?id=32206&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V32206" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#32206" class="name"><strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#32206"> &para;</a><div class="date" title="2003-05-20 08:16"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom32206">
<div class="phpcode"><code><span class="html">It is a bit scary to use only RC2/40bit considering that has been already so exposed as vulnerable to brute-force cracking (see for example www.distributed.net)<br /><br />Here is an alternate method which allows stronger encryption (128bit.) This works on Solaris 8 but could be adapted for e.g. Linux by removing the "-rand" parameter and its randomfile name.<br /><br />-------------snippet-------------------<br /><br />$execstring=  "echo \"" . $yourbodytext . "\" | /usr/local/ssl/bin/openssl smime -encrypt -rc2-128 -rand /usr/local/apache/yoursecuredir/randomfile -text  -to " .  $recipient . " -from someuser@example.com -subject \"" . $subject . "\"  /usr/local/apache/yoursecuredir/usercerts/someuser.pem | /usr/lib/sendmail -t";<br /><br />exec($execstring,$returndata,$resultcode);<br /><br />-------------snippet-------------------<br /><br />It requires the .pem format for the user certificate.  Assuming you already got a certificate from a commercial CA such as www.thawte.com then it is fairly simple to export it from your browser WITHOUT --REPEAT-- WITHOUT its private key and copy it to the PHP/web server. The export process is browser-specific but assuming MS Internet Explorer you require the menu selection tools -&gt; internet options -&gt; content -&gt; certificates -&gt; (highlight your cert in the list) -&gt; export wizard.<br /><br />The exported file will probably be in DER-encoded binary<br />with a name like "whatever.CER" and you need to convert it to Privacy Enhanced message (PEM) format. Typically you would now transfer the file to the *nix machine and the command for doing this conversion is, for example:<br /><br />/usr/local/ssl/bin/openssl x509 -inform DER -outform PEM -in someuser.cer -out someuser.pem<br /><br />When adapting this code it is of course as always vital to ensure that the values ($recipient etc.) being passed into the system call are acquired in a clean way that avoids trusting user-supplied data.</span></code></div>
  </div>
 </div>
  <div class="note" id="21030">  <div class="votes">
    <div id="Vu21030">
    <a href="https://www.php.net/manual/vote-note.php?id=21030&amp;page=function.openssl-pkcs7-encrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd21030">
    <a href="https://www.php.net/manual/vote-note.php?id=21030&amp;page=function.openssl-pkcs7-encrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V21030" title="0% like this...">
    -4
    </div>
  </div>
  <a href="function.openssl-pkcs7-encrypt.php.html#21030" class="name">
  <strong class="user"><em>msisolak at yahoo dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-encrypt.php.html#21030"> &para;</a><div class="date" title="2002-04-25 03:24"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom21030">
<div class="phpcode"><code><span class="html">The example code is wrong (at least as of 4.2.0).  The recipcerts parameter is either the actual text of the base64 encoded key file, or it must be a filename in "file://..." format.  A normal path will not work (OpenSSL tries to use the path as the actual certificate).  The above code works as:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// the message you want to encrypt and send to your secret agent<br />// in the field, known as nighthawk.  You have his certificate<br />// in the file nighthawk.pem<br /></span><span class="default">$data </span><span class="keyword">= &lt;&lt;&lt;EOD<br /></span><span class="string">Nighthawk,<br /><br />Top secret, for your eyes only!<br /><br />The enemy is closing in! Meet me at the cafe at 8.30am<br />to collect your forged passport!<br /><br />HQ<br /></span><span class="keyword">EOD;<br /><br /></span><span class="comment">// load key<br /></span><span class="default">$key </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">file</span><span class="keyword">(</span><span class="string">"my.pem"</span><span class="keyword">));<br /><br /></span><span class="comment">// save message to file<br /></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br /></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br /><br /></span><span class="comment">// encrypt it<br /></span><span class="keyword">if (</span><span class="default">openssl_pkcs7_encrypt</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"enc.txt"</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">,<br />    array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"example@example.com"</span><span class="keyword">, </span><span class="comment">// keyed syntax<br />          </span><span class="string">"From: HQ &lt;hq@cia.com&gt;"</span><span class="keyword">, </span><span class="comment">// indexed syntax<br />          </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"Eyes only"</span><span class="keyword">)))<br />{<br />    </span><span class="comment">// message encrypted - send it!<br />    </span><span class="default">exec</span><span class="keyword">(</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">"sendmail_path"</span><span class="keyword">) . </span><span class="string">" &lt; enc.txt"</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />[You can also pass an array of recipcerts values, but I haven't used that so I don't know what it's expecting.]</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.openssl-pkcs7-encrypt&amp;redirect=https://www.php.net/manual/ru/function.openssl-pkcs7-encrypt.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.openssl.php.html">Функции OpenSSL</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.openssl-cipher-iv-length.php.html" title="openssl_&#8203;cipher_&#8203;iv_&#8203;length">openssl_&#8203;cipher_&#8203;iv_&#8203;length</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cipher-key-length.php.html" title="openssl_&#8203;cipher_&#8203;key_&#8203;length">openssl_&#8203;cipher_&#8203;key_&#8203;length</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-decrypt.php.html" title="openssl_&#8203;cms_&#8203;decrypt">openssl_&#8203;cms_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-encrypt.php.html" title="openssl_&#8203;cms_&#8203;encrypt">openssl_&#8203;cms_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-read.php.html" title="openssl_&#8203;cms_&#8203;read">openssl_&#8203;cms_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-sign.php.html" title="openssl_&#8203;cms_&#8203;sign">openssl_&#8203;cms_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-verify.php.html" title="openssl_&#8203;cms_&#8203;verify">openssl_&#8203;cms_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-export-to-file.php.html" title="openssl_&#8203;csr_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;csr_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-export.php.html" title="openssl_&#8203;csr_&#8203;export">openssl_&#8203;csr_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-get-public-key.php.html" title="openssl_&#8203;csr_&#8203;get_&#8203;public_&#8203;key">openssl_&#8203;csr_&#8203;get_&#8203;public_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-get-subject.php.html" title="openssl_&#8203;csr_&#8203;get_&#8203;subject">openssl_&#8203;csr_&#8203;get_&#8203;subject</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-new.php.html" title="openssl_&#8203;csr_&#8203;new">openssl_&#8203;csr_&#8203;new</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-sign.php.html" title="openssl_&#8203;csr_&#8203;sign">openssl_&#8203;csr_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-decrypt.php.html" title="openssl_&#8203;decrypt">openssl_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-dh-compute-key.php.html" title="openssl_&#8203;dh_&#8203;compute_&#8203;key">openssl_&#8203;dh_&#8203;compute_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-digest.php.html" title="openssl_&#8203;digest">openssl_&#8203;digest</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-encrypt.php.html" title="openssl_&#8203;encrypt">openssl_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-error-string.php.html" title="openssl_&#8203;error_&#8203;string">openssl_&#8203;error_&#8203;string</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-free-key.php.html" title="openssl_&#8203;free_&#8203;key">openssl_&#8203;free_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-cert-locations.php.html" title="openssl_&#8203;get_&#8203;cert_&#8203;locations">openssl_&#8203;get_&#8203;cert_&#8203;locations</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-cipher-methods.php.html" title="openssl_&#8203;get_&#8203;cipher_&#8203;methods">openssl_&#8203;get_&#8203;cipher_&#8203;methods</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-curve-names.php.html" title="openssl_&#8203;get_&#8203;curve_&#8203;names">openssl_&#8203;get_&#8203;curve_&#8203;names</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-md-methods.php.html" title="openssl_&#8203;get_&#8203;md_&#8203;methods">openssl_&#8203;get_&#8203;md_&#8203;methods</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-privatekey.php.html" title="openssl_&#8203;get_&#8203;privatekey">openssl_&#8203;get_&#8203;privatekey</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-publickey.php.html" title="openssl_&#8203;get_&#8203;publickey">openssl_&#8203;get_&#8203;publickey</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-open.php.html" title="openssl_&#8203;open">openssl_&#8203;open</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pbkdf2.php.html" title="openssl_&#8203;pbkdf2">openssl_&#8203;pbkdf2</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs12-export-to-file.php.html" title="openssl_&#8203;pkcs12_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;pkcs12_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs12-export.php.html" title="openssl_&#8203;pkcs12_&#8203;export">openssl_&#8203;pkcs12_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs12-read.php.html" title="openssl_&#8203;pkcs12_&#8203;read">openssl_&#8203;pkcs12_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-decrypt.php.html" title="openssl_&#8203;pkcs7_&#8203;decrypt">openssl_&#8203;pkcs7_&#8203;decrypt</a>
                        </li>
                                                <li class="current">
                            <a href="function.openssl-pkcs7-encrypt.php.html" title="openssl_&#8203;pkcs7_&#8203;encrypt">openssl_&#8203;pkcs7_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-read.php.html" title="openssl_&#8203;pkcs7_&#8203;read">openssl_&#8203;pkcs7_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-sign.php.html" title="openssl_&#8203;pkcs7_&#8203;sign">openssl_&#8203;pkcs7_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-verify.php.html" title="openssl_&#8203;pkcs7_&#8203;verify">openssl_&#8203;pkcs7_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-derive.php.html" title="openssl_&#8203;pkey_&#8203;derive">openssl_&#8203;pkey_&#8203;derive</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-export-to-file.php.html" title="openssl_&#8203;pkey_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;pkey_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-export.php.html" title="openssl_&#8203;pkey_&#8203;export">openssl_&#8203;pkey_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-free.php.html" title="openssl_&#8203;pkey_&#8203;free">openssl_&#8203;pkey_&#8203;free</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-get-details.php.html" title="openssl_&#8203;pkey_&#8203;get_&#8203;details">openssl_&#8203;pkey_&#8203;get_&#8203;details</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-get-private.php.html" title="openssl_&#8203;pkey_&#8203;get_&#8203;private">openssl_&#8203;pkey_&#8203;get_&#8203;private</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-get-public.php.html" title="openssl_&#8203;pkey_&#8203;get_&#8203;public">openssl_&#8203;pkey_&#8203;get_&#8203;public</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-new.php.html" title="openssl_&#8203;pkey_&#8203;new">openssl_&#8203;pkey_&#8203;new</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-private-decrypt.php.html" title="openssl_&#8203;private_&#8203;decrypt">openssl_&#8203;private_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-private-encrypt.php.html" title="openssl_&#8203;private_&#8203;encrypt">openssl_&#8203;private_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-public-decrypt.php.html" title="openssl_&#8203;public_&#8203;decrypt">openssl_&#8203;public_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-public-encrypt.php.html" title="openssl_&#8203;public_&#8203;encrypt">openssl_&#8203;public_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-random-pseudo-bytes.php.html" title="openssl_&#8203;random_&#8203;pseudo_&#8203;bytes">openssl_&#8203;random_&#8203;pseudo_&#8203;bytes</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-seal.php.html" title="openssl_&#8203;seal">openssl_&#8203;seal</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-sign.php.html" title="openssl_&#8203;sign">openssl_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-export-challenge.php.html" title="openssl_&#8203;spki_&#8203;export_&#8203;challenge">openssl_&#8203;spki_&#8203;export_&#8203;challenge</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-export.php.html" title="openssl_&#8203;spki_&#8203;export">openssl_&#8203;spki_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-new.php.html" title="openssl_&#8203;spki_&#8203;new">openssl_&#8203;spki_&#8203;new</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-verify.php.html" title="openssl_&#8203;spki_&#8203;verify">openssl_&#8203;spki_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-verify.php.html" title="openssl_&#8203;verify">openssl_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-check-private-key.php.html" title="openssl_&#8203;x509_&#8203;check_&#8203;private_&#8203;key">openssl_&#8203;x509_&#8203;check_&#8203;private_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-checkpurpose.php.html" title="openssl_&#8203;x509_&#8203;checkpurpose">openssl_&#8203;x509_&#8203;checkpurpose</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-export-to-file.php.html" title="openssl_&#8203;x509_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;x509_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-export.php.html" title="openssl_&#8203;x509_&#8203;export">openssl_&#8203;x509_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-fingerprint.php.html" title="openssl_&#8203;x509_&#8203;fingerprint">openssl_&#8203;x509_&#8203;fingerprint</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-free.php.html" title="openssl_&#8203;x509_&#8203;free">openssl_&#8203;x509_&#8203;free</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-parse.php.html" title="openssl_&#8203;x509_&#8203;parse">openssl_&#8203;x509_&#8203;parse</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-read.php.html" title="openssl_&#8203;x509_&#8203;read">openssl_&#8203;x509_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-verify.php.html" title="openssl_&#8203;x509_&#8203;verify">openssl_&#8203;x509_&#8203;verify</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
