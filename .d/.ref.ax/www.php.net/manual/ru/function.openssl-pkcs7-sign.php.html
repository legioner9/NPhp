<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: openssl_pkcs7_sign - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.openssl-pkcs7-sign.php.html">
 <link rel="shorturl" href="https://www.php.net/openssl-pkcs7-sign">
 <link rel="alternate" href="https://www.php.net/openssl-pkcs7-sign" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.openssl.php.html">
 <link rel="prev" href="function.openssl-pkcs7-read.php.html">
 <link rel="next" href="function.openssl-pkcs7-verify.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.openssl-pkcs7-sign.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.openssl-pkcs7-sign.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.openssl-pkcs7-sign.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.openssl-pkcs7-sign.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.openssl-pkcs7-sign.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.openssl-pkcs7-sign.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.openssl-pkcs7-sign.php" hreflang="pt_BR">
 <link rel="alternate" href="function.openssl-pkcs7-sign.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.openssl-pkcs7-sign.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.openssl-pkcs7-sign.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.openssl-pkcs7-verify.php.html">
          openssl_pkcs7_verify &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.openssl-pkcs7-read.php.html">
          &laquo; openssl_pkcs7_read        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.crypto.php.html'>Криптографические модули</a></li>      <li><a href='book.openssl.php.html'>OpenSSL</a></li>      <li><a href='ref.openssl.php.html'>Функции OpenSSL</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.openssl-pkcs7-sign.php'>English</option>
            <option value='de/function.openssl-pkcs7-sign.php'>German</option>
            <option value='es/function.openssl-pkcs7-sign.php'>Spanish</option>
            <option value='fr/function.openssl-pkcs7-sign.php'>French</option>
            <option value='it/function.openssl-pkcs7-sign.php'>Italian</option>
            <option value='ja/function.openssl-pkcs7-sign.php'>Japanese</option>
            <option value='pt_BR/function.openssl-pkcs7-sign.php'>Brazilian Portuguese</option>
            <option value='ru/function.openssl-pkcs7-sign.php' selected="selected">Russian</option>
            <option value='tr/function.openssl-pkcs7-sign.php'>Turkish</option>
            <option value='zh/function.openssl-pkcs7-sign.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/openssl/functions/openssl-pkcs7-sign.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.openssl-pkcs7-sign%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.openssl-pkcs7-sign" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">openssl_pkcs7_sign</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">openssl_pkcs7_sign</span> &mdash; <span class="dc-title">Подписать сообщение S/MIME</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.openssl-pkcs7-sign-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>openssl_pkcs7_sign</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$input_filename</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$output_filename</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type"><a href="class.opensslcertificate.php.html" class="type OpenSSLCertificate">OpenSSLCertificate</a></span>|<span class="type">string</span></span> <code class="parameter">$certificate</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type"><a href="class.opensslasymmetrickey.php.html" class="type OpenSSLAsymmetricKey">OpenSSLAsymmetricKey</a></span>|<span class="type"><a href="class.opensslcertificate.php.html" class="type OpenSSLCertificate">OpenSSLCertificate</a></span>|<span class="type">array</span>|<span class="type">string</span></span> <code class="parameter">$private_key</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">array</span><span class="type"></span></span> <code class="parameter">$headers</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = <strong><code>PKCS7_DETACHED</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$untrusted_certificates_filename</code><span class="initializer"> = <strong><code>null</code></strong></span></span><br>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>openssl_pkcs7_sign()</strong></span> берет содержимое файла
   <code class="parameter">input_filename</code> и подписывает его с использованием сертификата
   <code class="parameter">certificate</code> и закрытого ключа <code class="parameter">private_key</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.openssl-pkcs7-sign-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">input_filename</code></dt>

     <dd>

      <p class="para">
       Файл, который нужно подписать.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">output_filename</code></dt>

     <dd>

      <p class="para">
       Файл, в который будет записана цифровая подпись.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">certificate</code></dt>

     <dd>

      <p class="para">
       Сертификат X.509, который будет использован для подписи <code class="parameter">input_filename</code>.
       Смотрите <a href="openssl.certparams.php.html" class="link">параметры ключа/сертификата</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">private_key</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">private_key</code> задаётся секретным ключом, соответствующим сертификату (<code class="parameter">certificate</code>).
       Смотрите <a href="openssl.certparams.php.html" class="link">параметры открытого/секретного ключа</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">headers</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">headers</code> задаётся массивом заголовков,
       которые будут добавлены в начало данных после подписания. (смотрите <span class="function"><a href="function.openssl-pkcs7-encrypt.php.html" class="function">openssl_pkcs7_encrypt()</a></span>
       для получения дополнительной информации о формате этого параметра).
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">flags</code> используется для настройки вывода. Смотрите <a href="openssl.pkcs7.flags.php.html" class="link">константы PKCS7</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">untrusted_certificates_filename</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">untrusted_certificates_filename</code> может содержать имя файла,
       в котором хранятся дополнительные сертификаты для добавления их
       к подписи, например для облегчения верификации подписи разными пользователями.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.openssl-pkcs7-sign-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.openssl-pkcs7-sign-changelog">
  <h3 class="title">Список изменений</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Версия</th>
      <th>Описание</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">certificate</code> теперь принимает экземпляр <span class="classname"><a href="class.opensslcertificate.php.html" class="classname">OpenSSLCertificate</a></span>;
       ранее принимался ресурс (<a href="language.types.resource.php.html" class="link">resource</a>) типа <code class="literal">OpenSSL X.509 CSR</code>.
      </td>
     </tr>

     <tr>
      <td>8.0.0</td>
      <td>
       <code class="parameter">private_key</code> теперь принимает экземпляр <span class="classname"><a href="class.opensslasymmetrickey.php.html" class="classname">OpenSSLAsymmetricKey</a></span>
       или <span class="classname"><a href="class.opensslcertificate.php.html" class="classname">OpenSSLCertificate</a></span>;
       ранее принимался ресурс (<a href="language.types.resource.php.html" class="link">resource</a>) типа <code class="literal">OpenSSL key</code> or <code class="literal">OpenSSL X.509 CSR</code>.
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.openssl-pkcs7-sign-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-2866">
    <p><strong>Пример #1 Пример использования <span class="function"><strong>openssl_pkcs7_sign()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// сообщение, которое вы хотите подписать для того, чтобы получатели могли<br />// проверить, что его послали именно вы<br /></span><span style="color: #0000BB">$data </span><span style="color: #007700">= &lt;&lt;&lt;EOD<br /></span><span style="color: #DD0000"><br />Разрешаю потратить на обед с контрагентом не более 100,000 рублей.<br /><br />Ваш директор.<br /></span><span style="color: #007700">EOD;<br /></span><span style="color: #FF8000">// сохраняем сообщение в фалй<br /></span><span style="color: #0000BB">$fp </span><span style="color: #007700">= </span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">"msg.txt"</span><span style="color: #007700">, </span><span style="color: #DD0000">"w"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">, </span><span style="color: #0000BB">$data</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// шифруем<br /></span><span style="color: #007700">if (</span><span style="color: #0000BB">openssl_pkcs7_sign</span><span style="color: #007700">(</span><span style="color: #DD0000">"msg.txt"</span><span style="color: #007700">, </span><span style="color: #DD0000">"signed.txt"</span><span style="color: #007700">, </span><span style="color: #DD0000">"file://mycert.pem"</span><span style="color: #007700">,<br />    array(</span><span style="color: #DD0000">"file://mycert.pem"</span><span style="color: #007700">, </span><span style="color: #DD0000">"mypassphrase"</span><span style="color: #007700">),<br />    array(</span><span style="color: #DD0000">"To" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"joes@example.com"</span><span style="color: #007700">, </span><span style="color: #FF8000">// ассоциативный синтаксис<br />          </span><span style="color: #DD0000">"From: HQ &lt;ceo@example.com&gt;"</span><span style="color: #007700">, </span><span style="color: #FF8000">// индексированный синтаксис<br />          </span><span style="color: #DD0000">"Subject" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Представительские расходы"</span><span style="color: #007700">)<br />    )) {<br />    </span><span style="color: #FF8000">// сообщение подписано - отправляем!<br />    </span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">"sendmail_path"</span><span style="color: #007700">) . </span><span style="color: #DD0000">" &lt; signed.txt"</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.openssl-pkcs7-sign&amp;redirect=https://www.php.net/manual/ru/function.openssl-pkcs7-sign.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">12 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="121904">  <div class="votes">
    <div id="Vu121904">
    <a href="https://www.php.net/manual/vote-note.php?id=121904&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121904">
    <a href="https://www.php.net/manual/vote-note.php?id=121904&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121904" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#121904" class="name">
  <strong class="user"><em>jcmichot at usenet-fr dot net</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#121904"> &para;</a><div class="date" title="2017-11-22 07:12"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121904">
<div class="phpcode"><code><span class="html">Due to lack of example the following code may be useful to some.<br /><br /># Demo code for openssl_pkcs7_sign() and openssl_pkcs7_encrypt() to sign and encrypt for Paypal EWP.<br />#<br /># generate and self sign certificat<br /># % openssl genrsa -out my-private-key.pem 2048<br /># % openssl req -new -key my-private-key.pem -x509 -days 3650 -out my-public-key.pem<br />#<br /><br />function demo_paypal_encrypt( $webform_hash )<br />{<br />    $MY_PUBLIC_KEY = "file:///usr/local/etc/paypal/my-public-key.pem";<br />    $MY_PRIVATE_KEY = "file:///usr/local/etc/paypal/my-private-key.pem";<br />    $PAYPAL_PUBLIC_KEY = "file:///usr/local/etc/paypal/paypal_cert_pem.txt";<br /><br />    //Assign Build Notation for PayPal Support<br />    $webform_hash['bn']= 'MyWebRef.PHP_EWP2';<br /><br />    $data = "";<br />    foreach ($webform_hash as $key =&gt; $value)<br />        if ($value != "")<br />            $data .= "$key=$value\n";<br /><br />    $file_msg = sprintf( "/tmp/pp-msg-%d.txt", getmypid() );<br />    $file_sign = sprintf( "/tmp/pp-sign-%d.mpem", getmypid() );<br />    $file_bsign = sprintf( "/tmp/pp-sign-%d.der", getmypid() );<br />    $file_enc = sprintf( "/tmp/pp-enc-%d.txt", getmypid() );<br /><br />    if ( file_exists( $file_msg ) ) unlink( $file_msg );<br />    if ( file_exists( $file_sign ) ) unlink( $file_sign );<br />    if ( file_exists( $file_bsign ) ) unlink( $file_bsign );<br />    if ( file_exists( $file_enc ) ) unlink( $file_enc );<br /><br />    $fp = fopen( $file_msg, "w" );<br />    if ( $fp ) {<br />        fwrite($fp, $data );<br />        fclose($fp);<br />        }<br /><br />    // sign part of html form message<br />    openssl_pkcs7_sign(<br />        $file_msg,<br />        $file_sign,<br />        $MY_PUBLIC_KEY,<br />        array( $MY_PRIVATE_KEY, "" ), /// private key, password<br />        array(),<br />        PKCS7_BINARY<br />        );<br /><br />    // convert PEM to DER<br />    $pem_data = file_get_contents( $file_sign );<br />    $begin = "Content-Transfer-Encoding: base64";<br />    $pem_data = trim( substr($pem_data, strpos($pem_data, $begin)+strlen($begin)) );<br />    $der = base64_decode( $pem_data );<br /><br />    $fp = fopen( $file_bsign, "w" );<br />    if ( $fp ) {<br />        fwrite($fp, $der );<br />        fclose($fp);<br />        }<br /><br />    // you could verify correct DER signature by:<br />    // % openssl smime -verify -CAfile $MY_PUBLIC_KEY -inform DER -in $file_bsign<br /><br />    //encrypt the message, with Paypal public key<br />    openssl_pkcs7_encrypt(<br />        $file_bsign,<br />        $file_enc,<br />        $PAYPAL_PUBLIC_KEY,<br />        array(),<br />        PKCS7_BINARY,<br />        OPENSSL_CIPHER_3DES  );<br /><br />    $data = file_get_contents( $file_enc );<br />    $data = substr($data, strpos($data, $begin)+strlen($begin));<br />    $data = "-----BEGIN PKCS7-----\n".  trim( $data ) . "\n-----END PKCS7-----";<br /><br />    // cleanup<br />    if ( file_exists( $file_msg ) ) unlink( $file_msg );<br />    if ( file_exists( $file_sign ) ) unlink( $file_sign );<br />    if ( file_exists( $file_bsign ) ) unlink( $file_bsign );<br />    if ( file_exists( $file_enc ) ) unlink( $file_enc );<br /><br />    return( $data );<br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="111336">  <div class="votes">
    <div id="Vu111336">
    <a href="https://www.php.net/manual/vote-note.php?id=111336&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111336">
    <a href="https://www.php.net/manual/vote-note.php?id=111336&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111336" title="100% like this...">
    2
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#111336" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#111336"> &para;</a><div class="date" title="2013-02-08 04:35"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom111336">
<div class="phpcode"><code><span class="html">A note about the $flags parameter: PKCS7_BINARY has 2 effects:<br />* converts LF to CR+LF, as described in <a href="http://www.php.net/manual/en/openssl.pkcs7.flags.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/openssl.pkcs7.flags.php</a><br />* it creates an opaque pkcs7 signature (p7m)<br /><br />If you want to prevent the LF-&gt;CR+LF conversion *and* still have a detached signature (p7s), use PKCS7_BINARY | PKCS7_DETACHED (both flags are set).<br /><br />If the signed message is already MIME multi-part, using both flags as described above seems to be the right solution to assemble the message properly. Without any flags, apparently only some of the LF characters are converted. In a specific scenario (the local MTA is Postfix and then the message goes through sendmail on another machine), the MIME boundaries get scrambled in sendmail. However, this doesn't seem to happen if the local MTA is sendmail.</span></code></div>
  </div>
 </div>
  <div class="note" id="36653">  <div class="votes">
    <div id="Vu36653">
    <a href="https://www.php.net/manual/vote-note.php?id=36653&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36653">
    <a href="https://www.php.net/manual/vote-note.php?id=36653&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36653" title="100% like this...">
    2
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#36653" class="name">
  <strong class="user"><em>Maciej_Niemir at ilim dot poznan dot pl</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#36653"> &para;</a><div class="date" title="2003-10-17 07:46"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36653">
<div class="phpcode"><code><span class="html">This command doesn't work correctly on WIN32 with IIS. Mails aren?t interpreted correctly by IIS SMTP Server (and by Outlook too). The reason is that UNIX and WINDOWS interpret the ?enter to the next line? ascii code in a different way.<br /><br />Below I present an improved code:<br /><br /><span class="default">&lt;?php<br /><br />$data </span><span class="keyword">= &lt;&lt;&lt;EOD<br /></span><span class="string"><br />Testing 123<br /><br />This is a test<br /><br />Test<br /><br /></span><span class="keyword">EOD;<br /><br /></span><span class="comment">//save the message to a file<br /></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">);<br /></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">,</span><span class="default">$data</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br /><br /></span><span class="comment">//sign the message using the sender's keys<br /></span><span class="default">openssl_pkcs7_sign</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"signed.eml"</span><span class="keyword">, </span><span class="string">"file://c:/max/cert.pem"</span><span class="keyword">,<br />array(</span><span class="string">"file://c:/max/priv.pem"</span><span class="keyword">,</span><span class="string">"your_password"</span><span class="keyword">),<br />array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"recipient &lt;recipients@mail.com&gt;"</span><span class="keyword">,<br /></span><span class="string">"From" </span><span class="keyword">=&gt; </span><span class="string">"sender &lt;sender@mail.com&gt;"</span><span class="keyword">,<br /></span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"Order Notification - Test"</span><span class="keyword">),</span><span class="default">PKCS7_DETACHED</span><span class="keyword">,</span><span class="string">"c:\max\extra_cert.pem"</span><span class="keyword">);<br /><br /></span><span class="default">$file_arry </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">"signed.eml"</span><span class="keyword">);<br /></span><span class="default">$file </span><span class="keyword">= </span><span class="default">join </span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">$file_arry</span><span class="keyword">);<br /></span><span class="default">$message </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\r\n|\r|\n/"</span><span class="keyword">, </span><span class="string">"\r\n"</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">);<br /><br /></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"c:\Inetpub\mailroot\Pickup\signed.eml"</span><span class="keyword">, </span><span class="string">"wb"</span><span class="keyword">);<br /></span><span class="default">flock</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /></span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">);                                                     <br /></span><span class="default">flock</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;<br /></span><br />Besides, if you want to use the keys created with Windows, you should export them (from IE) to the form of PKCS#12 file (*.pfx).<br /><br />Install OpenSSLWin32 from<br /><a href="http://www.shininglightpro.com/search.php?searchname=Win32+OpenSSL" rel="nofollow" target="_blank">http://www.shininglightpro.com/search.php?searchname=Win32+OpenSSL</a><br /><br />execute: openssl.exe<br /><br />enter the commands:<br /><br />pkcs12 -in &lt;pfx-file&gt; -nokeys -out &lt;pem-certs-file&gt;<br /><br />pkcs12 -in &lt;pfx-file&gt; -nocerts -nodes -out &lt;pem-key-file&gt;<br /><br />Next export from IE Root CA certificate as Base-64 *.cer and rename the file to *.pem<br /><br />And that's all!</span></code></div>
  </div>
 </div>
  <div class="note" id="96155">  <div class="votes">
    <div id="Vu96155">
    <a href="https://www.php.net/manual/vote-note.php?id=96155&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd96155">
    <a href="https://www.php.net/manual/vote-note.php?id=96155&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V96155" title="55% like this...">
    1
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#96155" class="name">
  <strong class="user"><em>ungdi at hotmail dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#96155"> &para;</a><div class="date" title="2010-02-11 05:34"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom96155">
<div class="phpcode"><code><span class="html">Amongst the many discussions about signing or encrypting email by itself, none really discuss the pain of having an email BOTH signed AND encrypted.<br /><br />According to RFC 2311, you can encrypt then sign or sign then encrypt. However, it depends on the client in which you are programming for. In my experience, in Outlook 2000, it prefers it Encrypt then Sign. While in Outlook 2003, it is Sign then Encrypt. Generally, you want Sign then Encrypt, as it seems most logical from a snail-mail piece point of view. You first sign a letter than put it in an envelope. Certain clients complain if you do it in an order it does not like, so you may want to experiement with it.<br /><br />When you perform the first function, do NOT put in any headers in the headers array parameters, you want to put it in the SECOND function you want to perform. If you put the headers in the first function, the second function will hide it from the mail servers. You do not want that. Here I will sign then encrypt.<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Setup mail headers.<br /></span><span class="default">$headers </span><span class="keyword">= array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"someone@nowhere.net"</span><span class="keyword">,<br />     </span><span class="string">"From" </span><span class="keyword">=&gt; </span><span class="string">"noone@somewhere.net"</span><span class="keyword">,<br />     </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"A signed and encrypted message."</span><span class="keyword">);<br /><br /></span><span class="comment">// Sign the message first<br /></span><span class="default">openssl_pkcs7_sign</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">,</span><span class="string">"signed.txt"</span><span class="keyword">,<br />     </span><span class="string">"signing_cert.pem"</span><span class="keyword">,array(</span><span class="string">"private_key.pem"</span><span class="keyword">,<br />     </span><span class="string">"password"</span><span class="keyword">),array());<br /><br /></span><span class="comment">// Get the public key certificate.<br /></span><span class="default">$pubkey </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"cert.pem"</span><span class="keyword">);<br /><br /></span><span class="comment">//encrypt the message, now put in the headers.<br /></span><span class="default">openssl_pkcs7_encrypt</span><span class="keyword">(</span><span class="string">"signed.txt"</span><span class="keyword">, </span><span class="string">"enc.txt"</span><span class="keyword">,<br />     </span><span class="default">$pubkey</span><span class="keyword">,</span><span class="default">$headers</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br /><br /></span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"enc.txt"</span><span class="keyword">);<br /><br /></span><span class="comment">// separate header and body, to use with mail function<br />//  unfortunate but required, else we have two sets of headers<br />//  and the email client doesn't decode the attachment<br /></span><span class="default">$parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /><br /></span><span class="comment">// send mail (headers in the Headers parameter will override those<br />//  generated for the To &amp; Subject parameters)<br /></span><span class="default">mail</span><span class="keyword">(</span><span class="default">$mail</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">, </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /></span><span class="default">?&gt;<br /></span><br />Note that if you use a function that picks up the data from the disk to be used in another function in your program, remember that you may have used the explode("\n\n",$data,2) function which may have removed the spacing between the header and the message content.<br /><br />When you take the signed message and feed it in to the encryption part, you have to remember that the line spacing must also be fed AS PART OF THE MESSAGE BODY! If you plan to sign then encrypt, do not feed the header output from the signing into the encrypting as part of the headers array parameter! The output of the signing should stay as part of the message body being encrypted. (And the same is true if you are doing the reverse of encrypting then signing.) An example of both the signing and encryption function made in to a routine for reusability, and then called to sign and encrypt a message.<br /><br />THIS IS WRONG!:<br /><span class="default">&lt;?php<br /></span><span class="comment">// [0] of Array contains headers of message. [1] of Array contains signed body of message.<br /></span><span class="default">$signedOutputArray </span><span class="keyword">= </span><span class="default">signMessage</span><span class="keyword">(</span><span class="default">$inputMessage</span><span class="keyword">,</span><span class="default">$headers</span><span class="keyword">);<br /><br /></span><span class="comment">// [0] of Array contains headers of message and the signing.<br />// [1] of Array contains encrypted body of message without the signing header.<br /></span><span class="default">$signedAndEncryptedArray </span><span class="keyword">= </span><span class="default">encryptMessage</span><span class="keyword">(</span><span class="default">$signedOutputArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],<br />     </span><span class="default">$signedOutputArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /><br /></span><span class="default">mail</span><span class="keyword">(</span><span class="default">$emailAddr</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">,</span><span class="default">$signedAndEncryptedArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],<br />      </span><span class="default">$signedAndEncryptedArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /></span><span class="default">?&gt;<br /></span><br />THIS IS CORRECT!<br /><span class="default">&lt;?php<br /></span><span class="comment">// [0] of Array contains headers of signing.<br />// [1] of Array contains signed body of message.<br /></span><span class="default">$signedOutputArray </span><span class="keyword">= </span><span class="default">signMessage</span><span class="keyword">(</span><span class="default">$inputMessage</span><span class="keyword">,array());<br /><br /></span><span class="comment">// [0] of Array contains headers of message.<br />// [1] of Array contains encrypted contents of both the signed message and its headers of the signing.<br /></span><span class="default">$signedAndEncryptedArray </span><span class="keyword">=<br />     </span><span class="default">encryptMessage</span><span class="keyword">(</span><span class="default">$signedOutputArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="string">"\n\n" </span><span class="keyword">. </span><span class="default">$signedOutputArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">$headers</span><span class="keyword">);<br /><br /></span><span class="default">mail</span><span class="keyword">(</span><span class="default">$emailAddr</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">,</span><span class="default">$signedAndEncryptedArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],<br />     </span><span class="default">$signedAndEncryptedArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="88645">  <div class="votes">
    <div id="Vu88645">
    <a href="https://www.php.net/manual/vote-note.php?id=88645&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd88645">
    <a href="https://www.php.net/manual/vote-note.php?id=88645&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V88645" title="55% like this...">
    1
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#88645" class="name">
  <strong class="user"><em>yurchenko dot anton at gmail dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#88645"> &para;</a><div class="date" title="2009-02-01 10:13"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom88645">
<div class="phpcode"><code><span class="html">I also spent hours when trying to find the reason of error:<br />"error getting private key". <br /><br />Sometimes this error appeared, sometimes not. <br /><br />My solution is using the realpath() for every parameter of openssl_pkcs7_sign. In my case the code looks like:<br /><br /><span class="default">&lt;?php<br />$Certif_path </span><span class="keyword">= </span><span class="string">'certificate/mycertificate.pem'</span><span class="keyword">;<br /><br /></span><span class="default">$clearfile </span><span class="keyword">= </span><span class="string">"certificate/random_name"</span><span class="keyword">;<br /></span><span class="default">$encfile </span><span class="keyword">= </span><span class="default">$clearfile </span><span class="keyword">. </span><span class="string">".enc"</span><span class="keyword">;<br /></span><span class="default">$clearfile </span><span class="keyword">= </span><span class="default">$clearfile </span><span class="keyword">. </span><span class="string">".txt"</span><span class="keyword">;<br /><br /></span><span class="comment">// ---- <br />// -- fill $clearfile with the mail to be signed ...<br />// ----<br /><br /></span><span class="default">openssl_pkcs7_sign</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$clearfile</span><span class="keyword">), <br />                           </span><span class="default">realpath</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$encfile</span><span class="keyword">, </span><span class="comment">// because $encfile does not exist yet we cannot use realpath($encfile);<br />                           </span><span class="string">'file://'</span><span class="keyword">.</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$Certif_path</span><span class="keyword">),<br />                           <br />                           array(</span><span class="string">'file://'</span><span class="keyword">.</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$Certif_path</span><span class="keyword">), </span><span class="default">PUBLIC_KEY</span><span class="keyword">), <br />                           <br />                           array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="default">TO_EMAIL</span><span class="keyword">,<br />                                 </span><span class="string">"From" </span><span class="keyword">=&gt; </span><span class="default">FROM_EMAIL</span><span class="keyword">,<br />                                 </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">""</span><span class="keyword">), <br />                           <br />                           </span><span class="default">PKCS7_DETACHED</span><span class="keyword">));<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="124271">  <div class="votes">
    <div id="Vu124271">
    <a href="https://www.php.net/manual/vote-note.php?id=124271&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124271">
    <a href="https://www.php.net/manual/vote-note.php?id=124271&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124271" title="no votes...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#124271" class="name">
  <strong class="user"><em>spam at isag dot melbourne</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#124271"> &para;</a><div class="date" title="2019-10-08 12:23"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom124271">
<div class="phpcode"><code><span class="html">If you want to use mail() with headers, then you'll need to alter the signed version before embedding in the body or the headers and boundaries will end up in the message.<br /><br /><span class="default">&lt;?php<br />openssl_pkcs7_sign</span><span class="keyword">(</span><span class="default">$basedir </span><span class="keyword">. </span><span class="string">'email.txt'</span><span class="keyword">, </span><span class="default">$basedir </span><span class="keyword">. </span><span class="string">'signed.txt'</span><span class="keyword">, </span><span class="string">'file://' </span><span class="keyword">. </span><span class="default">$basedir </span><span class="keyword">. </span><span class="string">'cert.pem'</span><span class="keyword">, array(</span><span class="string">'file://' </span><span class="keyword">. </span><span class="default">$basedir </span><span class="keyword">. </span><span class="string">'key.pem'</span><span class="keyword">, </span><span class="default">$keypass</span><span class="keyword">), array(</span><span class="string">'To' </span><span class="keyword">=&gt; </span><span class="default">$smime_to</span><span class="keyword">, </span><span class="string">'From' </span><span class="keyword">=&gt; </span><span class="default">$smime_from</span><span class="keyword">, </span><span class="string">'Subject' </span><span class="keyword">=&gt; </span><span class="default">$smime_subject</span><span class="keyword">));<br />if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/To: [^\r\n]+(\r|\n)+(From: [^\r\n]+(\r|\n)+)Subject: [^\r\n]+(\r|\n)+MIME-Version: [^\r\n]+(\r|\n)+(Content-Type: [^\r\n]+)(\r|\n)+/'</span><span class="keyword">, </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$basedir </span><span class="keyword">. </span><span class="string">'signed.txt'</span><span class="keyword">), </span><span class="default">$matches</span><span class="keyword">))<br />{<br />    </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mail</span><span class="keyword">(</span><span class="default">$smime_to</span><span class="keyword">, </span><span class="default">$smime_subject</span><span class="keyword">, </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="string">''</span><span class="keyword">, </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$basedir </span><span class="keyword">. </span><span class="string">'signed.txt'</span><span class="keyword">)), </span><span class="default">$mailheaders </span><span class="keyword">. </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] . </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">]);<br />}<br /></span><span class="default">?&gt;<br /></span><br />With the signed headers removed ($matches[0]) and the headers updated with From (not part of mail()) and Content-Type ($matches[2] / $matches[6] respectively).</span></code></div>
  </div>
 </div>
  <div class="note" id="73139">  <div class="votes">
    <div id="Vu73139">
    <a href="https://www.php.net/manual/vote-note.php?id=73139&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd73139">
    <a href="https://www.php.net/manual/vote-note.php?id=73139&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V73139" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#73139" class="name">
  <strong class="user"><em>ungdi at hotmail dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#73139"> &para;</a><div class="date" title="2007-02-10 01:10"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom73139">
<div class="phpcode"><code><span class="html">I would like to make a modification from my previous note. Some clients prefer a certain order in which messages should be signed and encrypted (if both is desired). Newer email clients, such as Thunderbird and Outlook 2003 will accept the most secure method of "sign -&gt; encrypt -&gt; sign again".<br /><br />Why?<br /><br />The first signing authenticates the message saying that you did indeed write it. Then the email is encrypted so that only the recipient can open and read it. Then the second signing ensure confidentiality by identifying that the person encrypting is the one whom encrypted it, a message intended for the decrypting person. This is the most secure method. This ensures: Non-Repudiation of message (first sign), Confidentiality (encrypt), and Context Integrity [you were intended to be addressed] (second sign).<br /><br />If you only sign then encrypt, there is no way you can guarantee that (aside from the contents of the letter, headers are placed in plain text outside the message) that the message was intended for you by the original sender. For example:<br /><br />Bob signs a love letter and encrypts it to Amy saying only "I love you. -- Bob". Amy decrypts it, sees the message (and plays a joke) and forwards the message to John using John's public key, re-encrypting, but not tampering with the message contents keeping the signature valid. This allows Amy to make it look like Bob sent John a love letter and that Bob loves John, as you cannot verify whom sent it during encryption. That is not what you want!<br /><br />This is also analogous to someone taking a government document, put it in an envelope themselves and write the government address in the return address and send it to you. You know the letter is written by the government, but you don't know for sure whether the government sent it to you directly or was opened and relayed.<br /><br />While encrypting then signing has a problem, this is affectively signing on the envelope of a snail mail piece. I know you sent it, but is the message really from you? Or are you forwarding it?<br /><br />Sign - Encrypt - Sign Again method will make the first sign show that you know the writer of the message is the person, encrypt it to keep others from reading it, sign again to indicate the message was not relayed and that the sender intended to sent the mail to address you.<br /><br />Just make sure the headers of the mail is applied in the last step and not the second or third step.<br /><br />For more information about the security and integrity risks of this situation, please read this web page: <a href="http://world.std.com/~dtd/sign_encrypt/sign_encrypt7.html" rel="nofollow" target="_blank">http://world.std.com/~dtd/sign_encrypt/sign_encrypt7.html</a></span></code></div>
  </div>
 </div>
  <div class="note" id="49892">  <div class="votes">
    <div id="Vu49892">
    <a href="https://www.php.net/manual/vote-note.php?id=49892&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd49892">
    <a href="https://www.php.net/manual/vote-note.php?id=49892&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V49892" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#49892" class="name">
  <strong class="user"><em>maarten at xolphin dot nl</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#49892"> &para;</a><div class="date" title="2005-02-11 02:24"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom49892">
<div class="phpcode"><code><span class="html">It is also possible to sign message including attachments. An easy way to do this:<br /><br /><span class="default">&lt;?php<br />  $boundary </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">uniqid</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">()));<br />  </span><span class="default">$boddy </span><span class="keyword">= </span><span class="string">"MIME-Version: 1.0\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Type: multipart/mixed; boundary=\"" </span><span class="keyword">. </span><span class="default">$boundary</span><span class="keyword">. </span><span class="string">"\"\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Transfer-Encoding: quoted-printable\n\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"This is a multi-part message in MIME format.\n\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"--</span><span class="default">$boundary</span><span class="string">\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Type: text/plain; charset=\"iso-8859-1\"\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Transfer-Encoding: quoted-printable\n\n"</span><span class="keyword">;<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="default">$EmailText </span><span class="keyword">. </span><span class="string">"\n\n"</span><span class="keyword">;<br />  </span><span class="comment">// Add the attachment to the message<br />  </span><span class="keyword">do  {<br />    </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"--</span><span class="default">$boundary</span><span class="string">\n"</span><span class="keyword">;<br />    </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Type: application/pdf; name=\"FileName\"\n"</span><span class="keyword">;<br />    </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Transfer-Encoding: base64\n"</span><span class="keyword">;<br />    </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"Content-Disposition: attachment;\n\n"</span><span class="keyword">;<br />    </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="default">chunk_split</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)) . </span><span class="string">"\n\n"</span><span class="keyword">;<br />  } while ( {</span><span class="default">files left to be attached</span><span class="keyword">} );<br />  </span><span class="default">$boddy </span><span class="keyword">.= </span><span class="string">"--</span><span class="default">$boundary</span><span class="string">--\n"</span><span class="keyword">;<br /><br />  </span><span class="comment">// Save message to a file<br />  </span><span class="default">$msg </span><span class="keyword">= </span><span class="string">'msg.txt'</span><span class="keyword">;<br />  </span><span class="default">$signed </span><span class="keyword">= </span><span class="string">'signed.txt'</span><span class="keyword">;<br />  </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br />  </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$boddy</span><span class="keyword">);<br />  </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br /><br />  </span><span class="comment">// Sign it<br />  </span><span class="keyword">if (</span><span class="default">openssl_pkcs7_sign</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="default">$signed</span><span class="keyword">, </span><span class="string">'file://cert.pem'</span><span class="keyword">,<br />    array(</span><span class="string">'file://key.pem'</span><span class="keyword">, </span><span class="string">'test'</span><span class="keyword">),<br />    array(</span><span class="string">"To" </span><span class="keyword">=&gt; </span><span class="string">"joes@example.com"</span><span class="keyword">, </span><span class="comment">// keyed syntax<br />         </span><span class="string">"From: HQ &lt;ceo@example.com&gt;"</span><span class="keyword">, </span><span class="comment">// indexed syntax<br />         </span><span class="string">"Subject" </span><span class="keyword">=&gt; </span><span class="string">"Eyes only"</span><span class="keyword">), </span><span class="default">PKCS7_DETACHED</span><span class="keyword">, </span><span class="string">'intermediate_cert.pem' </span><span class="keyword">)) {  <br />    </span><span class="default">exec</span><span class="keyword">(</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'sendmail_path'</span><span class="keyword">) . </span><span class="string">' &lt; ' </span><span class="keyword">. </span><span class="default">$signed</span><span class="keyword">);<br />  }<br /></span><span class="default">?&gt;<br /></span><br />The same can be established by using the PEAR package Mail_Mime in combination with openssl_pkcs7_sign.</span></code></div>
  </div>
 </div>
  <div class="note" id="21212">  <div class="votes">
    <div id="Vu21212">
    <a href="https://www.php.net/manual/vote-note.php?id=21212&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd21212">
    <a href="https://www.php.net/manual/vote-note.php?id=21212&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V21212" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#21212" class="name">
  <strong class="user"><em>del at babel dot com dot au</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#21212"> &para;</a><div class="date" title="2002-05-03 03:09"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom21212">
<div class="phpcode"><code><span class="html">The "mycert.pem" parameters as shown in the example above are not correct.  You either have to pass a string containing the PEM encoded certificate or key, or the location of a file in file://path/to/file.pem notation.  See the comments on the OpenSSL functions page (the page above this one).</span></code></div>
  </div>
 </div>
  <div class="note" id="15290">  <div class="votes">
    <div id="Vu15290">
    <a href="https://www.php.net/manual/vote-note.php?id=15290&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd15290">
    <a href="https://www.php.net/manual/vote-note.php?id=15290&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V15290" title="no votes...">
    0
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#15290" class="name">
  <strong class="user"><em>meint dot post at bigfoot dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#15290"> &para;</a><div class="date" title="2001-09-04 04:35"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom15290">
<div class="phpcode"><code><span class="html">If you want to integrate PKCS7 signing/verifying with a browser and it's not a problem that it's only Internet Explorer (or Netscape + ActiveX plugin) you can look at Capicom. It's a free component and available at the MSDN website.</span></code></div>
  </div>
 </div>
  <div class="note" id="36038">  <div class="votes">
    <div id="Vu36038">
    <a href="https://www.php.net/manual/vote-note.php?id=36038&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36038">
    <a href="https://www.php.net/manual/vote-note.php?id=36038&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36038" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#36038" class="name">
  <strong class="user"><em>php at toyingwithfate dot com</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#36038"> &para;</a><div class="date" title="2003-09-23 02:55"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36038">
<div class="phpcode"><code><span class="html">It's probably worth noting that I had a great deal of difficulty getting either Mozilla 1.4 or Outlook Express 6 to verify signatures generated by openssl_pkcs7_sign() until I added a newline (\n) to the beginning of the message I was signing.  Not sure why that is, but as soon as I made that change all problems disappeared.</span></code></div>
  </div>
 </div>
  <div class="note" id="63971">  <div class="votes">
    <div id="Vu63971">
    <a href="https://www.php.net/manual/vote-note.php?id=63971&amp;page=function.openssl-pkcs7-sign&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd63971">
    <a href="https://www.php.net/manual/vote-note.php?id=63971&amp;page=function.openssl-pkcs7-sign&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V63971" title="0% like this...">
    -2
    </div>
  </div>
  <a href="function.openssl-pkcs7-sign.php.html#63971" class="name">
  <strong class="user"><em>dmitri at gmx dot net</em></strong></a><a class="genanchor" href="function.openssl-pkcs7-sign.php.html#63971"> &para;</a><div class="date" title="2006-04-04 01:01"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom63971">
<div class="phpcode"><code><span class="html">Working example:<br /><br /><span class="default">&lt;?php<br /><br />$data </span><span class="keyword">= &lt;&lt;&lt; EOF<br /></span><span class="string">Content-Type: text/plain;<br />    charset="us-ascii"<br />Content-Transfer-Encoding: 7bit<br /><br />You have my authorization to spend 10,000 on dinner expenses.<br />The CEO<br /></span><span class="keyword">EOF;<br /><br /></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br /></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br /><br /></span><span class="default">$headers </span><span class="keyword">= array(</span><span class="string">"From" </span><span class="keyword">=&gt; </span><span class="string">"me@email.com"</span><span class="keyword">);<br /><br /></span><span class="default">openssl_pkcs7_sign</span><span class="keyword">(</span><span class="string">"msg.txt"</span><span class="keyword">, </span><span class="string">"signed.txt"</span><span class="keyword">, </span><span class="string">"file://email.pem"</span><span class="keyword">, array(</span><span class="string">"file://email.pem"</span><span class="keyword">, </span><span class="string">"123456"</span><span class="keyword">), </span><span class="default">$headers</span><span class="keyword">);<br /><br /></span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"signed.txt"</span><span class="keyword">);<br /><br /></span><span class="default">$parts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br /><br /></span><span class="default">mail</span><span class="keyword">(</span><span class="string">"you@email.com"</span><span class="keyword">, </span><span class="string">"Signed message."</span><span class="keyword">, </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br /><br />echo </span><span class="string">"Email sent"</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.openssl-pkcs7-sign&amp;redirect=https://www.php.net/manual/ru/function.openssl-pkcs7-sign.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.openssl.php.html">Функции OpenSSL</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.openssl-cipher-iv-length.php.html" title="openssl_&#8203;cipher_&#8203;iv_&#8203;length">openssl_&#8203;cipher_&#8203;iv_&#8203;length</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cipher-key-length.php.html" title="openssl_&#8203;cipher_&#8203;key_&#8203;length">openssl_&#8203;cipher_&#8203;key_&#8203;length</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-decrypt.php.html" title="openssl_&#8203;cms_&#8203;decrypt">openssl_&#8203;cms_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-encrypt.php.html" title="openssl_&#8203;cms_&#8203;encrypt">openssl_&#8203;cms_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-read.php.html" title="openssl_&#8203;cms_&#8203;read">openssl_&#8203;cms_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-sign.php.html" title="openssl_&#8203;cms_&#8203;sign">openssl_&#8203;cms_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-cms-verify.php.html" title="openssl_&#8203;cms_&#8203;verify">openssl_&#8203;cms_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-export-to-file.php.html" title="openssl_&#8203;csr_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;csr_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-export.php.html" title="openssl_&#8203;csr_&#8203;export">openssl_&#8203;csr_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-get-public-key.php.html" title="openssl_&#8203;csr_&#8203;get_&#8203;public_&#8203;key">openssl_&#8203;csr_&#8203;get_&#8203;public_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-get-subject.php.html" title="openssl_&#8203;csr_&#8203;get_&#8203;subject">openssl_&#8203;csr_&#8203;get_&#8203;subject</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-new.php.html" title="openssl_&#8203;csr_&#8203;new">openssl_&#8203;csr_&#8203;new</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-csr-sign.php.html" title="openssl_&#8203;csr_&#8203;sign">openssl_&#8203;csr_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-decrypt.php.html" title="openssl_&#8203;decrypt">openssl_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-dh-compute-key.php.html" title="openssl_&#8203;dh_&#8203;compute_&#8203;key">openssl_&#8203;dh_&#8203;compute_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-digest.php.html" title="openssl_&#8203;digest">openssl_&#8203;digest</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-encrypt.php.html" title="openssl_&#8203;encrypt">openssl_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-error-string.php.html" title="openssl_&#8203;error_&#8203;string">openssl_&#8203;error_&#8203;string</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-free-key.php.html" title="openssl_&#8203;free_&#8203;key">openssl_&#8203;free_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-cert-locations.php.html" title="openssl_&#8203;get_&#8203;cert_&#8203;locations">openssl_&#8203;get_&#8203;cert_&#8203;locations</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-cipher-methods.php.html" title="openssl_&#8203;get_&#8203;cipher_&#8203;methods">openssl_&#8203;get_&#8203;cipher_&#8203;methods</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-curve-names.php.html" title="openssl_&#8203;get_&#8203;curve_&#8203;names">openssl_&#8203;get_&#8203;curve_&#8203;names</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-md-methods.php.html" title="openssl_&#8203;get_&#8203;md_&#8203;methods">openssl_&#8203;get_&#8203;md_&#8203;methods</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-privatekey.php.html" title="openssl_&#8203;get_&#8203;privatekey">openssl_&#8203;get_&#8203;privatekey</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-get-publickey.php.html" title="openssl_&#8203;get_&#8203;publickey">openssl_&#8203;get_&#8203;publickey</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-open.php.html" title="openssl_&#8203;open">openssl_&#8203;open</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pbkdf2.php.html" title="openssl_&#8203;pbkdf2">openssl_&#8203;pbkdf2</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs12-export-to-file.php.html" title="openssl_&#8203;pkcs12_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;pkcs12_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs12-export.php.html" title="openssl_&#8203;pkcs12_&#8203;export">openssl_&#8203;pkcs12_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs12-read.php.html" title="openssl_&#8203;pkcs12_&#8203;read">openssl_&#8203;pkcs12_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-decrypt.php.html" title="openssl_&#8203;pkcs7_&#8203;decrypt">openssl_&#8203;pkcs7_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-encrypt.php.html" title="openssl_&#8203;pkcs7_&#8203;encrypt">openssl_&#8203;pkcs7_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-read.php.html" title="openssl_&#8203;pkcs7_&#8203;read">openssl_&#8203;pkcs7_&#8203;read</a>
                        </li>
                                                <li class="current">
                            <a href="function.openssl-pkcs7-sign.php.html" title="openssl_&#8203;pkcs7_&#8203;sign">openssl_&#8203;pkcs7_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkcs7-verify.php.html" title="openssl_&#8203;pkcs7_&#8203;verify">openssl_&#8203;pkcs7_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-derive.php.html" title="openssl_&#8203;pkey_&#8203;derive">openssl_&#8203;pkey_&#8203;derive</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-export-to-file.php.html" title="openssl_&#8203;pkey_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;pkey_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-export.php.html" title="openssl_&#8203;pkey_&#8203;export">openssl_&#8203;pkey_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-free.php.html" title="openssl_&#8203;pkey_&#8203;free">openssl_&#8203;pkey_&#8203;free</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-get-details.php.html" title="openssl_&#8203;pkey_&#8203;get_&#8203;details">openssl_&#8203;pkey_&#8203;get_&#8203;details</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-get-private.php.html" title="openssl_&#8203;pkey_&#8203;get_&#8203;private">openssl_&#8203;pkey_&#8203;get_&#8203;private</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-get-public.php.html" title="openssl_&#8203;pkey_&#8203;get_&#8203;public">openssl_&#8203;pkey_&#8203;get_&#8203;public</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-pkey-new.php.html" title="openssl_&#8203;pkey_&#8203;new">openssl_&#8203;pkey_&#8203;new</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-private-decrypt.php.html" title="openssl_&#8203;private_&#8203;decrypt">openssl_&#8203;private_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-private-encrypt.php.html" title="openssl_&#8203;private_&#8203;encrypt">openssl_&#8203;private_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-public-decrypt.php.html" title="openssl_&#8203;public_&#8203;decrypt">openssl_&#8203;public_&#8203;decrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-public-encrypt.php.html" title="openssl_&#8203;public_&#8203;encrypt">openssl_&#8203;public_&#8203;encrypt</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-random-pseudo-bytes.php.html" title="openssl_&#8203;random_&#8203;pseudo_&#8203;bytes">openssl_&#8203;random_&#8203;pseudo_&#8203;bytes</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-seal.php.html" title="openssl_&#8203;seal">openssl_&#8203;seal</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-sign.php.html" title="openssl_&#8203;sign">openssl_&#8203;sign</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-export-challenge.php.html" title="openssl_&#8203;spki_&#8203;export_&#8203;challenge">openssl_&#8203;spki_&#8203;export_&#8203;challenge</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-export.php.html" title="openssl_&#8203;spki_&#8203;export">openssl_&#8203;spki_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-new.php.html" title="openssl_&#8203;spki_&#8203;new">openssl_&#8203;spki_&#8203;new</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-spki-verify.php.html" title="openssl_&#8203;spki_&#8203;verify">openssl_&#8203;spki_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-verify.php.html" title="openssl_&#8203;verify">openssl_&#8203;verify</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-check-private-key.php.html" title="openssl_&#8203;x509_&#8203;check_&#8203;private_&#8203;key">openssl_&#8203;x509_&#8203;check_&#8203;private_&#8203;key</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-checkpurpose.php.html" title="openssl_&#8203;x509_&#8203;checkpurpose">openssl_&#8203;x509_&#8203;checkpurpose</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-export-to-file.php.html" title="openssl_&#8203;x509_&#8203;export_&#8203;to_&#8203;file">openssl_&#8203;x509_&#8203;export_&#8203;to_&#8203;file</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-export.php.html" title="openssl_&#8203;x509_&#8203;export">openssl_&#8203;x509_&#8203;export</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-fingerprint.php.html" title="openssl_&#8203;x509_&#8203;fingerprint">openssl_&#8203;x509_&#8203;fingerprint</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-free.php.html" title="openssl_&#8203;x509_&#8203;free">openssl_&#8203;x509_&#8203;free</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-parse.php.html" title="openssl_&#8203;x509_&#8203;parse">openssl_&#8203;x509_&#8203;parse</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-read.php.html" title="openssl_&#8203;x509_&#8203;read">openssl_&#8203;x509_&#8203;read</a>
                        </li>
                                                <li class="">
                            <a href="function.openssl-x509-verify.php.html" title="openssl_&#8203;x509_&#8203;verify">openssl_&#8203;x509_&#8203;verify</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
