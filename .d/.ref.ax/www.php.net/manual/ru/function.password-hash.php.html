<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: password_hash - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.password-hash.php.html">
 <link rel="shorturl" href="https://www.php.net/password-hash">
 <link rel="alternate" href="https://www.php.net/password-hash" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.password.php.html">
 <link rel="prev" href="function.password-get-info.php.html">
 <link rel="next" href="function.password-needs-rehash.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.password-hash.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.password-hash.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.password-hash.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.password-hash.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.password-hash.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.password-hash.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.password-hash.php" hreflang="pt_BR">
 <link rel="alternate" href="function.password-hash.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.password-hash.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.password-hash.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.password-needs-rehash.php.html">
          password_needs_rehash &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.password-get-info.php.html">
          &laquo; password_get_info        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.crypto.php.html'>Криптографические модули</a></li>      <li><a href='book.password.php.html'>Хеширование паролей</a></li>      <li><a href='ref.password.php.html'>Функции хеширования паролей</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.password-hash.php'>English</option>
            <option value='de/function.password-hash.php'>German</option>
            <option value='es/function.password-hash.php'>Spanish</option>
            <option value='fr/function.password-hash.php'>French</option>
            <option value='it/function.password-hash.php'>Italian</option>
            <option value='ja/function.password-hash.php'>Japanese</option>
            <option value='pt_BR/function.password-hash.php'>Brazilian Portuguese</option>
            <option value='ru/function.password-hash.php' selected="selected">Russian</option>
            <option value='tr/function.password-hash.php'>Turkish</option>
            <option value='zh/function.password-hash.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/password/functions/password-hash.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.password-hash%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.password-hash" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">password_hash</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">password_hash</span> &mdash; <span class="dc-title">Создаёт хеш пароля</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.password-hash-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>password_hash</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>, <span class="methodparam"><span class="type"><span class="type">string</span>|<span class="type">int</span>|<span class="type">null</span></span> <code class="parameter">$algo</code></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = []</span></span>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   Функция <span class="function"><strong>password_hash()</strong></span> создаёт хеш пароля, используя сильный необратимый алгоритм хеширования.
  </p>
  <p class="simpara">
   Поддерживаются следующие алгоритмы:
  </p>
  <p class="para">
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_DEFAULT</code></strong> — будет выбран алгоритм bcrypt (по умолчанию с PHP 5.5.0).
      Обратите внимание, алгоритм может измениться на более
      сильный, когда такой добавится в PHP. При изменении алгоритма и длина результата
      также может измениться. Поэтому длину поля для хранения
      в базе данных лучше устанавливать более 60 символов (255 символов будет хорошим значением).
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_BCRYPT</code></strong> — будет выбран алгоритм
      <strong><code>CRYPT_BLOWFISH</code></strong>. Генерирует стандартный хеш с идентификатором &quot;$2y$&quot;,
      совместимый с тем, который генерирует функция <span class="function"><a href="function.crypt.php.html" class="function">crypt()</a></span>.
      В результате будет сгенерирована строка длиной 60 символов или <strong><code>false</code></strong> в случае возникновения ошибки.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_ARGON2I</code></strong> — будет выбран алгоритм хеширования Argon2i.
      Этот алгоритм будет доступен, только если PHP собран с поддержкой Argon2.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_ARGON2ID</code></strong> — будет выбран алгоритм хеширования Argon2id.
      Этот алгоритм будет доступен, только если PHP собран с поддержкой Argon2.
     </span>
    </li>
   </ul>
  </p>
  <p class="simpara">
   Поддерживаемые опции для <strong><code>PASSWORD_BCRYPT</code></strong>:
  </p>
  <p class="para">
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <code class="literal">salt</code> (<span class="type">string</span>) — для самостоятельного задания соли для хеширования.
      Обратите внимание, что это приведёт к переопределению и предотвратит
      автоматическое создание соли.
     </p>
     <p class="para">
      Если не задано, то функция <span class="function"><strong>password_hash()</strong></span> будет генерировать
      случайную соль для каждого хешируемого пароля. Это предпочтительный
      режим работы.
     </p>
     <div class="warning"><strong class="warning">Внимание</strong>
      <p class="para">
       Эта опция объявлена устаревшей.
       Рекомендуется использовать автоматически генерируемую соль.
       Начиная с PHP 8.0.0 явно заданная соль игнорируется.
      </p>
     </div>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">cost</code> (<span class="type">int</span>) — задаёт алгоритмическую сложность.
      Пример с этой опцией можно посмотреть на странице, посвящённой
      функции <span class="function"><a href="function.crypt.php.html" class="function">crypt()</a></span>.
     </p>
     <p class="para">
      Если не задано, то будет выбрано значение по умолчанию: <code class="literal">10</code>.
      Это хорошая базовая стоимость, но можно увеличить её,
      если позволяет производительность оборудования.
     </p>
    </li>
   </ul>
  </p>
  <p class="simpara">
   Поддерживаемые опции для <strong><code>PASSWORD_ARGON2I</code></strong> и
   <strong><code>PASSWORD_ARGON2ID</code></strong>:
  </p>
  <p class="para">
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <code class="literal">memory_cost</code> (<span class="type">int</span>) — максимальный размер
      памяти (в килобайтах), которая будет использована для вычисления хеша Argon2.
      По умолчанию будет выбрано значение константы <strong><code>PASSWORD_ARGON2_DEFAULT_MEMORY_COST</code></strong>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">time_cost</code> (<span class="type">int</span>) — максимально возможное время,
      которое можно потратить на вычисление хеша Argon2.
      По умолчанию будет выбрано значение константы <strong><code>PASSWORD_ARGON2_DEFAULT_TIME_COST</code></strong>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">threads</code> (<span class="type">int</span>) — количество потоков, которые
      можно задействовать для вычисления хеша Argon2.
      По умолчанию будет выбрано значение константы <strong><code>PASSWORD_ARGON2_DEFAULT_THREADS</code></strong>.
     </p>
     <div class="warning"><strong class="warning">Внимание</strong>
      <p class="para">
       Доступно только тогда, когда в PHP доступен модуль libargon2, но не при реализации libsodium.
      </p>
     </div>
    </li>
   </ul>
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.password-hash-parameters">
  <h3 class="title">Список параметров</h3>
  <dl>
   
    <dt>
<code class="parameter">password</code></dt>

    <dd>

     <p class="para">
      Пользовательский пароль.
     </p>
     <div class="caution"><strong class="caution">Предостережение</strong>
      <p class="para">
       Использование алгоритма <strong><code>PASSWORD_BCRYPT</code></strong> приведёт
       к обрезанию поля <code class="parameter">password</code> до максимальной длины — 72 байта.
      </p>
     </div>
    </dd>

   
   
    <dt>
<code class="parameter">algo</code></dt>

    <dd>

     <p class="para">
      <a href="password.constants.php.html" class="link">Константа</a>, обозначающая используемый алгоритм хеширования пароля.
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">options</code></dt>

    <dd>

     <p class="para">
      Ассоциативный массив с опциями. За документацией по поддерживаемым опциям для каждого алгоритма обратитесь к разделу <a href="password.constants.php.html" class="link">Константы алгоритмов хеширования паролей</a>.
     </p>
     <p class="para">
      Если не задано, то будет использована стандартная стоимость, и соль будет
      сгенерирована автоматически.
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.password-hash-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает хешированный пароль.
  </p>
  <p class="para">
   Выбранный алгоритм, стоимость и соль будут возвращены как часть хеша.
   Таким образом, информация, необходимая для проверки хеша, будет в него
   включена. Это позволит функции <span class="function"><a href="function.password-verify.php.html" class="function">password_verify()</a></span> проверять
   хеш без отдельного хранения информации о соли и алгоритме.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.password-hash-changelog">
  <h3 class="title">Список изменений</h3>
 <p class="para">
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Версия</th>
      <th>Описание</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
       <td>8.0.0</td>
       <td>
        <span class="function"><strong>password_hash()</strong></span> больше не возвращает значение <strong><code>false</code></strong> в случае возникновения ошибки.
        Вместо этого будет выброшено исключение <span class="classname"><a href="class.valueerror.php.html" class="classname">ValueError</a></span>,
        если алгоритм хеширования пароля недействителен, или <span class="classname"><a href="class.error.php.html" class="classname">Error</a></span>,
        если хеширование пароля не удалось из-за неизвестной ошибки.
       </td>
      </tr>

      <tr>
       <td>8.0.0</td>
       <td>
        Параметр <code class="parameter">algo</code> теперь допускает значение <strong><code>null</code></strong>.
       </td>
      </tr>

     <tr>
      <td>7.4.0</td>
      <td>
       Параметр <code class="parameter">algo</code> теперь ожидает строку (<span class="type">string</span>), но всё ещё принимает
       число (<span class="type">int</span>) для обратной совместимости.
      </td>
     </tr>

      <tr>
       <td>7.4.0</td>
       <td>
        Модуль sodium обеспечивает альтернативную реализацию паролей Argon2.
       </td>
      </tr>

     <tr>
      <td>7.3.0</td>
      <td>
       Добавлена поддержка алгоритма хеширования паролей Argon2id с помощью <strong><code>PASSWORD_ARGON2ID</code></strong>.
      </td>
     </tr>

     <tr>
      <td>7.2.0</td>
      <td>
       Добавлена поддержка хеширующего алгоритма Argon2i с помощью <strong><code>PASSWORD_ARGON2I</code></strong>.
      </td>
     </tr>

    </tbody>
   
  </table>

 </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.password-hash-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-2920">
    <p><strong>Пример #1 Пример использования <span class="function"><strong>password_hash()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br /> * Мы просто хотим захешировать пароль с настройками по умолчанию.<br /> * Значит, будет выбран алгоритм BCRYPT и результат будет длиной 60 символов.<br /> *<br /> * Помните, что алгоритм по умолчанию может измениться в будущем, так что<br /> * имеет смысл заранее позаботиться о том, чтобы система хранения хешей<br /> * смогла хранить более 60 символов (а лучше 255)<br /> */<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">"rasmuslerdorf"</span><span style="color: #007700">, </span><span style="color: #0000BB">PASSWORD_DEFAULT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

    
<div class="example-contents"><p>
 Вывод приведённого примера будет похож на:
</p></div>

    <div class="example-contents screen">
<div class="cdata"><pre>
$2y$10$.vGA1O9wmRjrwAVXD98HNOgsNpDczlqm3Jq7KnEd1rVAGv3Fykk1a
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2923">
    <p><strong>Пример #2 Пример использования <span class="function"><strong>password_hash()</strong></span> с ручным заданием стоимости</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br /> * Тут мы увеличиваем алгоритмическую стоимость BCRYPT до 12.<br /> * Но это никак не скажется на длине полученного результата, она останется 60 символов<br /> */<br /></span><span style="color: #0000BB">$options </span><span style="color: #007700">= [<br />    </span><span style="color: #DD0000">'cost' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">12</span><span style="color: #007700">,<br />];<br />echo </span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">"rasmuslerdorf"</span><span style="color: #007700">, </span><span style="color: #0000BB">PASSWORD_BCRYPT</span><span style="color: #007700">, </span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

    
<div class="example-contents"><p>
 Вывод приведённого примера будет похож на:
</p></div>

    <div class="example-contents screen">
<div class="cdata"><pre>
$2y$12$QjSH496pcT5CEbzjD/vtVeH03tfHKFy36d4J0Ltp3lRtee9HDxY3K
</pre></div>
    </div>
   </div>
  </p>

  <p class="para">
   <div class="example" id="example-2926">
    <p><strong>Пример #3 Пример поиска хорошего значения стоимости для функции <span class="function"><strong>password_hash()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br /> * Данный код замерит скорость выполнения операции с разными значениями алгоритмической сложности хеширования<br /> * на вашем сервере и определит<br /> * его максимальное значение, не приводящее к деградации производительности. Хорошее базовое<br /> * значение — 10, но если ваш сервер достаточно мощный, то можно<br /> * задать и больше. Данный скрипт ищет максимальное значение, при котором<br /> * хеширование уложится в значение ≤ 350 миллисекундам, что считается приемлемой задержкой<br /> * для систем, которые обрабатывают интерактивные входы.<br /> */<br /></span><span style="color: #0000BB">$timeTarget </span><span style="color: #007700">= </span><span style="color: #0000BB">0.350</span><span style="color: #007700">; </span><span style="color: #FF8000">// 350 миллисекунд<br /><br /></span><span style="color: #0000BB">$cost </span><span style="color: #007700">= </span><span style="color: #0000BB">8</span><span style="color: #007700">;<br />do {<br />    </span><span style="color: #0000BB">$cost</span><span style="color: #007700">++;<br />    </span><span style="color: #0000BB">$start </span><span style="color: #007700">= </span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />    </span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">"test"</span><span style="color: #007700">, </span><span style="color: #0000BB">PASSWORD_BCRYPT</span><span style="color: #007700">, [</span><span style="color: #DD0000">"cost" </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$cost</span><span style="color: #007700">]);<br />    </span><span style="color: #0000BB">$end </span><span style="color: #007700">= </span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />} while ((</span><span style="color: #0000BB">$end </span><span style="color: #007700">- </span><span style="color: #0000BB">$start</span><span style="color: #007700">) &lt; </span><span style="color: #0000BB">$timeTarget</span><span style="color: #007700">);<br /><br />echo </span><span style="color: #DD0000">"Оптимальная стоимость: " </span><span style="color: #007700">. </span><span style="color: #0000BB">$cost</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

    
<div class="example-contents"><p>
 Вывод приведённого примера будет похож на:
</p></div>

    <div class="example-contents screen">
<div class="cdata"><pre>
Оптимальная стоимость: 12
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2929">
    <p><strong>Пример #4 Пример использования функции <span class="function"><strong>password_hash()</strong></span> с Argon2i</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo </span><span style="color: #DD0000">'Хеш Argon2i: ' </span><span style="color: #007700">. </span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">, </span><span style="color: #0000BB">PASSWORD_ARGON2I</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

    
<div class="example-contents"><p>
 Вывод приведённого примера будет похож на:
</p></div>

    <div class="example-contents screen">
<div class="cdata"><pre>
Хеш Argon2i: $argon2i$v=19$m=1024,t=2,p=2$YzJBSzV4TUhkMzc3d3laeg$zqU/1IN0/AogfP4cmSJI1vc8lpXRW9/S0sYY2i2jHT0
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.password-hash-notes">
  <h3 class="title">Примечания</h3>
  <div class="caution"><strong class="caution">Предостережение</strong>
   <p class="para">
    Настоятельно рекомендуется использовать автоматическую генерацию соли.
    Данная функция самостоятельно создаст хорошую соль, если вы не будете ей мешать
    подсовывая свою.
   </p>
   <p class="para">
    Как было замечено выше, опция <code class="literal">salt</code> была объявлена
    устаревшей в PHP 7.0 и будет вызывать соответствующее предупреждение.
    Поддержка ручного задания соли была удалена в PHP 8.0.
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Рекомендуется протестировать данную функцию на вашем оборудовании для определения
    оптимального значения алгоритмической сложности. Убедитесь, что с выбранной
    сложностью функция выполняется быстрее 350 миллисекунд для интерактивных
    систем. Скрипт в приведённом выше примере поможет выбрать оптимальное значение.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <span class="simpara">
    Обновление поддерживаемых алгоритмов для этой функции (или изменение значения по
    умолчанию) обязаны следовать правилам:
   </span>
   <p class="para">
    <ul class="itemizedlist">
     <li class="listitem">
      <span class="simpara">
       Любой новый алгоритм должен присутствовать в ядре как минимум
       1 полный релиз PHP для того, чтобы его можно было установить по умолчанию.
       Таким образом, если, к примеру, новый алгоритм был добавлен в
       7.5.5, то задать по умолчанию его можно будет только в 7.7 (7.6 будет тем самым
       полным релизом, в течение которого он должен присутствовать, от 7.6.0 до 7.7.0). Но
       если новый алгоритм добавлен в 7.6.0, то его также можно будет задать по умолчанию
       в версии 7.7.0.
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       Алгоритм по умолчанию может быть изменён только в полном релизе
       (7.3.0, 8.0.0 и т. д.), но не в промежуточных. Единственное исключение —
       это критическая уязвимость, найденная в текущем алгоритме.
      </span>
     </li>
    </ul>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.password-hash-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.password-verify.php.html" class="function" rel="rdfs-seeAlso">password_verify()</a> - Проверяет, соответствует ли пароль хешу</span></li>
    <li class="member"><span class="function"><a href="function.password-needs-rehash.php.html" class="function" rel="rdfs-seeAlso">password_needs_rehash()</a> - Проверяет, что указанный хеш соответствует заданным опциям</span></li>
    <li class="member"><span class="function"><a href="function.crypt.php.html" class="function" rel="rdfs-seeAlso">crypt()</a> - Необратимое хеширование строки</span></li>
    <li class="member"><span class="function"><a href="function.sodium-crypto-pwhash-str.php.html" class="function" rel="rdfs-seeAlso">sodium_crypto_pwhash_str()</a> - Получить ASCII-кодированный хеш</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.password-hash&amp;redirect=https://www.php.net/manual/ru/function.password-hash.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">10 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="124138">  <div class="votes">
    <div id="Vu124138">
    <a href="https://www.php.net/manual/vote-note.php?id=124138&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124138">
    <a href="https://www.php.net/manual/vote-note.php?id=124138&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124138" title="78% like this...">
    136
    </div>
  </div>
  <a href="function.password-hash.php.html#124138" class="name">
  <strong class="user"><em>phpnetcomment201908 at lucb1e dot com</em></strong></a><a class="genanchor" href="function.password-hash.php.html#124138"> &para;</a><div class="date" title="2019-08-25 02:17"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom124138">
<div class="phpcode"><code><span class="html">Since 2017, NIST recommends using a secret input when hashing memorized secrets such as passwords. By mixing in a secret input (commonly called a "pepper"), one prevents an attacker from brute-forcing the password hashes altogether, even if they have the hash and salt. For example, an SQL injection typically affects only the database, not files on disk, so a pepper stored in a config file would still be out of reach for the attacker. A pepper must be randomly generated once and can be the same for all users. Many password leaks could have been made completely useless if site owners had done this.<br /><br />Since there is no pepper parameter for password_hash (even though Argon2 has a "secret" parameter, PHP does not allow to set it), the correct way to mix in a pepper is to use hash_hmac(). The "add note" rules of php.net say I can't link external sites, so I can't back any of this up with a link to NIST, Wikipedia, posts from the security stackexchange site that explain the reasoning, or anything... You'll have to verify this manually. The code:<br /><br />// config.conf<br />pepper=c1isvFdxMDdmjOlvxpecFw<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// register.php<br /></span><span class="default">$pepper </span><span class="keyword">= </span><span class="default">getConfigVariable</span><span class="keyword">(</span><span class="string">"pepper"</span><span class="keyword">);<br /></span><span class="default">$pwd </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">];<br /></span><span class="default">$pwd_peppered </span><span class="keyword">= </span><span class="default">hash_hmac</span><span class="keyword">(</span><span class="string">"sha256"</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">, </span><span class="default">$pepper</span><span class="keyword">);<br /></span><span class="default">$pwd_hashed </span><span class="keyword">= </span><span class="default">password_hash</span><span class="keyword">(</span><span class="default">$pwd_peppered</span><span class="keyword">, </span><span class="default">PASSWORD_ARGON2ID</span><span class="keyword">);<br /></span><span class="default">add_user_to_database</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="default">$pwd_hashed</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br /><span class="default">&lt;?php<br /></span><span class="comment">// login.php<br /></span><span class="default">$pepper </span><span class="keyword">= </span><span class="default">getConfigVariable</span><span class="keyword">(</span><span class="string">"pepper"</span><span class="keyword">);<br /></span><span class="default">$pwd </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">];<br /></span><span class="default">$pwd_peppered </span><span class="keyword">= </span><span class="default">hash_hmac</span><span class="keyword">(</span><span class="string">"sha256"</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">, </span><span class="default">$pepper</span><span class="keyword">);<br /></span><span class="default">$pwd_hashed </span><span class="keyword">= </span><span class="default">get_pwd_from_db</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">);<br />if (</span><span class="default">password_verify</span><span class="keyword">(</span><span class="default">$pwd_peppered</span><span class="keyword">, </span><span class="default">$pwd_hashed</span><span class="keyword">)) {<br />    echo </span><span class="string">"Password matches."</span><span class="keyword">;<br />}<br />else {<br />    echo </span><span class="string">"Password incorrect."</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;<br /></span><br />Note that this code contains a timing attack that leaks whether the username exists. But my note was over the length limit so I had to cut this paragraph out.<br /><br />Also note that the pepper is useless if leaked or if it can be cracked. Consider how it might be exposed, for example different methods of passing it to a docker container. Against cracking, use a long randomly generated value (like in the example above), and change the pepper when you do a new install with a clean user database. Changing the pepper for an existing database is the same as changing other hashing parameters: you can either wrap the old value in a new one and layer the hashing (more complex), you compute the new password hash whenever someone logs in (leaving old users at risk, so this might be okay depending on what the reason is that you're upgrading).<br /><br />Why does this work? Because an attacker does the following after stealing the database:<br /><br />password_verify("a", $stolen_hash)<br />password_verify("b", $stolen_hash)<br />...<br />password_verify("z", $stolen_hash)<br />password_verify("aa", $stolen_hash)<br />etc.<br /><br />(More realistically, they use a cracking dictionary, but in principle, the way to crack a password hash is by guessing. That's why we use special algorithms: they are slower, so each verify() operation will be slower, so they can try much fewer passwords per hour of cracking.)<br /><br />Now what if you used that pepper? Now they need to do this:<br /><br />password_verify(hmac_sha256("a", $secret), $stolen_hash)<br /><br />Without that $secret (the pepper), they can't do this computation. They would have to do:<br /><br />password_verify(hmac_sha256("a", "a"), $stolen_hash)<br />password_verify(hmac_sha256("a", "b"), $stolen_hash)<br />...<br />etc., until they found the correct pepper.<br /><br />If your pepper contains 128 bits of entropy, and so long as hmac-sha256 remains secure (even MD5 is technically secure for use in hmac: only its collision resistance is broken, but of course nobody would use MD5 because more and more flaws are found), this would take more energy than the sun outputs. In other words, it's currently impossible to crack a pepper that strong, even given a known password and salt.</span></code></div>
  </div>
 </div>
  <div class="note" id="110872">  <div class="votes">
    <div id="Vu110872">
    <a href="https://www.php.net/manual/vote-note.php?id=110872&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd110872">
    <a href="https://www.php.net/manual/vote-note.php?id=110872&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V110872" title="72% like this...">
    161
    </div>
  </div>
  <a href="function.password-hash.php.html#110872" class="name">
  <strong class="user"><em>martinstoeckli</em></strong></a><a class="genanchor" href="function.password-hash.php.html#110872"> &para;</a><div class="date" title="2012-12-17 08:56"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom110872">
<div class="phpcode"><code><span class="html">There is a compatibility pack available for PHP versions 5.3.7 and later, so you don't have to wait on version 5.5 for using this function. It comes in form of a single php file:<br /><a href="https://github.com/ircmaxell/password_compat" rel="nofollow" target="_blank">https://github.com/ircmaxell/password_compat</a></span></code></div>
  </div>
 </div>
  <div class="note" id="128853">  <div class="votes">
    <div id="Vu128853">
    <a href="https://www.php.net/manual/vote-note.php?id=128853&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd128853">
    <a href="https://www.php.net/manual/vote-note.php?id=128853&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V128853" title="80% like this...">
    3
    </div>
  </div>
  <a href="function.password-hash.php.html#128853" class="name">
  <strong class="user"><em>bhare at duck dot com</em></strong></a><a class="genanchor" href="function.password-hash.php.html#128853"> &para;</a><div class="date" title="2023-09-03 04:36"><strong>5 months ago</strong></div>
  <div class="text" id="Hcom128853">
<div class="phpcode"><code><span class="html">If you are you going to use bcrypt then you should pepper the passwords with random large string, as commodity hardware can break bcrypt 8 character passwords within an hour; <a href="https://www.tomshardware.com/news/eight-rtx-4090s-can-break-passwords-in-under-an-hour" rel="nofollow" target="_blank">https://www.tomshardware.com/news/eight-rtx-4090s-can-break-passwords-in-under-an-hour</a></span></code></div>
  </div>
 </div>
  <div class="note" id="113397">  <div class="votes">
    <div id="Vu113397">
    <a href="https://www.php.net/manual/vote-note.php?id=113397&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113397">
    <a href="https://www.php.net/manual/vote-note.php?id=113397&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113397" title="64% like this...">
    41
    </div>
  </div>
  <a href="function.password-hash.php.html#113397" class="name">
  <strong class="user"><em>nicoSWD</em></strong></a><a class="genanchor" href="function.password-hash.php.html#113397"> &para;</a><div class="date" title="2013-10-06 03:29"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113397">
<div class="phpcode"><code><span class="html">I agree with martinstoeckli,<br /><br />don't create your own salts unless you really know what you're doing.<br /><br />By default, it'll use /dev/urandom to create the salt, which is based on noise from device drivers.<br /><br />And on Windows, it uses CryptGenRandom().<br /><br />Both have been around for many years, and are considered secure for cryptography (the former probably more than the latter, though).<br /><br />Don't try to outsmart these defaults by creating something less secure. Anything that is based on rand(), mt_rand(), uniqid(), or variations of these is *not* good.</span></code></div>
  </div>
 </div>
  <div class="note" id="118603">  <div class="votes">
    <div id="Vu118603">
    <a href="https://www.php.net/manual/vote-note.php?id=118603&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd118603">
    <a href="https://www.php.net/manual/vote-note.php?id=118603&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V118603" title="60% like this...">
    22
    </div>
  </div>
  <a href="function.password-hash.php.html#118603" class="name">
  <strong class="user"><em>Lyo Mi</em></strong></a><a class="genanchor" href="function.password-hash.php.html#118603"> &para;</a><div class="date" title="2016-01-06 06:11"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom118603">
<div class="phpcode"><code><span class="html">Please note that password_hash will ***truncate*** the password at the first NULL-byte.<br /><br /><a href="http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html" rel="nofollow" target="_blank">http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html</a><br /><br />If you use anything as an input that can generate NULL bytes (sha1 with raw as true, or if NULL bytes can naturally end up in people's passwords), you may make your application much less secure than what you might be expecting.<br /><br />The password <br />$a = "\01234567"; <br />is zero bytes long (an empty password) for bcrypt.<br /><br />The workaround, of course, is to make sure you don't ever pass NULL-bytes to password_hash.</span></code></div>
  </div>
 </div>
  <div class="note" id="113490">  <div class="votes">
    <div id="Vu113490">
    <a href="https://www.php.net/manual/vote-note.php?id=113490&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113490">
    <a href="https://www.php.net/manual/vote-note.php?id=113490&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113490" title="55% like this...">
    23
    </div>
  </div>
  <a href="function.password-hash.php.html#113490" class="name">
  <strong class="user"><em>Cloxy</em></strong></a><a class="genanchor" href="function.password-hash.php.html#113490"> &para;</a><div class="date" title="2013-10-18 09:45"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113490">
<div class="phpcode"><code><span class="html">You can produce the same hash in php 5.3.7+ with crypt() function:<br /><br /><span class="default">&lt;?php<br /><br />$salt </span><span class="keyword">= </span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">22</span><span class="keyword">, </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">);<br /></span><span class="default">$salt </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$salt</span><span class="keyword">);<br /></span><span class="default">$salt </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'+'</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$salt</span><span class="keyword">);<br /></span><span class="default">$hash </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">(</span><span class="string">'rasmuslerdorf'</span><span class="keyword">, </span><span class="string">'$2y$10$'</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">.</span><span class="string">'$'</span><span class="keyword">);<br /><br />echo </span><span class="default">$hash</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="111620">  <div class="votes">
    <div id="Vu111620">
    <a href="https://www.php.net/manual/vote-note.php?id=111620&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111620">
    <a href="https://www.php.net/manual/vote-note.php?id=111620&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111620" title="57% like this...">
    16
    </div>
  </div>
  <a href="function.password-hash.php.html#111620" class="name">
  <strong class="user"><em>martinstoeckli</em></strong></a><a class="genanchor" href="function.password-hash.php.html#111620"> &para;</a><div class="date" title="2013-03-08 10:36"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom111620">
<div class="phpcode"><code><span class="html">In most cases it is best to omit the salt parameter. Without this parameter, the function will generate a cryptographically safe salt, from the random source of the operating system.</span></code></div>
  </div>
 </div>
  <div class="note" id="115629">  <div class="votes">
    <div id="Vu115629">
    <a href="https://www.php.net/manual/vote-note.php?id=115629&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115629">
    <a href="https://www.php.net/manual/vote-note.php?id=115629&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115629" title="53% like this...">
    7
    </div>
  </div>
  <a href="function.password-hash.php.html#115629" class="name">
  <strong class="user"><em>Mike Robinson</em></strong></a><a class="genanchor" href="function.password-hash.php.html#115629"> &para;</a><div class="date" title="2014-08-28 02:52"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom115629">
<div class="phpcode"><code><span class="html">For passwords, you generally want the hash calculation time to be between 250 and 500 ms (maybe more for administrator accounts). Since calculation time is dependent on the capabilities of the server, using the same cost parameter on two different servers may result in vastly different execution times. Here's a quick little function that will help you determine what cost parameter you should be using for your server to make sure you are within this range (note, I am providing a salt to eliminate any latency caused by creating a pseudorandom salt, but this should not be done when hashing passwords):<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">/**<br /> * @Param int $min_ms Minimum amount of time in milliseconds that it should take<br /> * to calculate the hashes<br /> */<br /></span><span class="keyword">function </span><span class="default">getOptimalBcryptCostParameter</span><span class="keyword">(</span><span class="default">$min_ms </span><span class="keyword">= </span><span class="default">250</span><span class="keyword">) {<br />    for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">31</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />        </span><span class="default">$options </span><span class="keyword">= [ </span><span class="string">'cost' </span><span class="keyword">=&gt; </span><span class="default">$i</span><span class="keyword">, </span><span class="string">'salt' </span><span class="keyword">=&gt; </span><span class="string">'usesomesillystringforsalt' </span><span class="keyword">];<br />        </span><span class="default">$time_start </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />        </span><span class="default">password_hash</span><span class="keyword">(</span><span class="string">"rasmuslerdorf"</span><span class="keyword">, </span><span class="default">PASSWORD_BCRYPT</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);<br />        </span><span class="default">$time_end </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />        if ((</span><span class="default">$time_end </span><span class="keyword">- </span><span class="default">$time_start</span><span class="keyword">) * </span><span class="default">1000 </span><span class="keyword">&gt; </span><span class="default">$min_ms</span><span class="keyword">) {<br />            return </span><span class="default">$i</span><span class="keyword">;<br />        }<br />    }<br />}<br />echo </span><span class="default">getOptimalBcryptCostParameter</span><span class="keyword">(); </span><span class="comment">// prints 12 in my case<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="124294">  <div class="votes">
    <div id="Vu124294">
    <a href="https://www.php.net/manual/vote-note.php?id=124294&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124294">
    <a href="https://www.php.net/manual/vote-note.php?id=124294&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124294" title="51% like this...">
    1
    </div>
  </div>
  <a href="function.password-hash.php.html#124294" class="name">
  <strong class="user"><em>ms1 at rdrecs dot com</em></strong></a><a class="genanchor" href="function.password-hash.php.html#124294"> &para;</a><div class="date" title="2019-10-14 05:07"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom124294">
<div class="phpcode"><code><span class="html">Timing attacks simply put, are attacks that can calculate what characters of the password are due to speed of the execution.<br /><br />More at...<br /><a href="https://paragonie.com/blog/2015/11/preventing-timing-attacks-on-string-comparison-with-double-hmac-strategy" rel="nofollow" target="_blank">https://paragonie.com/blog/2015/11/preventing-timing-attacks-on-string-comparison-with-double-hmac-strategy</a><br /><br />I have added code to phpnetcomment201908 at lucb1e dot com's suggestion to make this possible "timing attack" more difficult using the code phpnetcomment201908 at lucb1e dot com posted.<br /><br />$pph_strt = microtime(true);<br /><br />//...<br />/*The code he posted for login.php*/<br />//...<br /><br />$end = (microtime(true) - $pph_strt);<br /><br />$wait = bcmul((1 - $end), 1000000);  // usleep(250000) 1/4 of a second<br /><br />usleep ( $wait );<br /><br />echo "&lt;br&gt;Execution time:".(microtime(true) - $pph_strt)."; ";<br /><br />Note I suggest changing the wait time to suit your needs but make sure that it is more than than the highest execution time the script takes on your server.<br /><br />Also, this is my workaround to obfuscate the execution time to nullify timing attacks. You can find an in-depth discussion and more from people far more equipped than I for cryptography at the link I posted. I do not believe this was there but there are others. It is where I found out what timing attacks were as I am new to this but would like solid security.</span></code></div>
  </div>
 </div>
  <div class="note" id="123949">  <div class="votes">
    <div id="Vu123949">
    <a href="https://www.php.net/manual/vote-note.php?id=123949&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd123949">
    <a href="https://www.php.net/manual/vote-note.php?id=123949&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V123949" title="42% like this...">
    -9
    </div>
  </div>
  <a href="function.password-hash.php.html#123949" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="function.password-hash.php.html#123949"> &para;</a><div class="date" title="2019-06-18 01:09"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom123949">
<div class="phpcode"><code><span class="html">According to the draft specification, Argon2di is the recommended mode of operation:<br /><br />&gt; 9.4.  Recommendations<br />&gt;<br />&gt;   The Argon2id variant with t=1 and maximum available memory is<br />&gt;   recommended as a default setting for all environments.  This setting<br />&gt;   is secure against side-channel attacks and maximizes adversarial<br />&gt;   costs on dedicated bruteforce hardware.<br /><br />source: <a href="https://tools.ietf.org/html/draft-irtf-cfrg-argon2-06#section-9.4" rel="nofollow" target="_blank">https://tools.ietf.org/html/draft-irtf-cfrg-argon2-06#section-9.4</a></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.password-hash&amp;redirect=https://www.php.net/manual/ru/function.password-hash.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.password.php.html">Функции хеширования паролей</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.password-algos.php.html" title="password_&#8203;algos">password_&#8203;algos</a>
                        </li>
                                                <li class="">
                            <a href="function.password-get-info.php.html" title="password_&#8203;get_&#8203;info">password_&#8203;get_&#8203;info</a>
                        </li>
                                                <li class="current">
                            <a href="function.password-hash.php.html" title="password_&#8203;hash">password_&#8203;hash</a>
                        </li>
                                                <li class="">
                            <a href="function.password-needs-rehash.php.html" title="password_&#8203;needs_&#8203;rehash">password_&#8203;needs_&#8203;rehash</a>
                        </li>
                                                <li class="">
                            <a href="function.password-verify.php.html" title="password_&#8203;verify">password_&#8203;verify</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
