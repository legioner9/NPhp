<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: pcntl_wait - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.pcntl-wait.php.html">
 <link rel="shorturl" href="https://www.php.net/pcntl-wait">
 <link rel="alternate" href="https://www.php.net/pcntl-wait" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.pcntl.php.html">
 <link rel="prev" href="function.pcntl-unshare.php.html">
 <link rel="next" href="function.pcntl-waitpid.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.pcntl-wait.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.pcntl-wait.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.pcntl-wait.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.pcntl-wait.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.pcntl-wait.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.pcntl-wait.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.pcntl-wait.php" hreflang="pt_BR">
 <link rel="alternate" href="function.pcntl-wait.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.pcntl-wait.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.pcntl-wait.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.pcntl-waitpid.php.html">
          pcntl_waitpid &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.pcntl-unshare.php.html">
          &laquo; pcntl_unshare        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.fileprocess.process.php.html'>Модули для управления процессами программ</a></li>      <li><a href='book.pcntl.php.html'>PCNTL</a></li>      <li><a href='ref.pcntl.php.html'>Функции PCNTL</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.pcntl-wait.php'>English</option>
            <option value='de/function.pcntl-wait.php'>German</option>
            <option value='es/function.pcntl-wait.php'>Spanish</option>
            <option value='fr/function.pcntl-wait.php'>French</option>
            <option value='it/function.pcntl-wait.php'>Italian</option>
            <option value='ja/function.pcntl-wait.php'>Japanese</option>
            <option value='pt_BR/function.pcntl-wait.php'>Brazilian Portuguese</option>
            <option value='ru/function.pcntl-wait.php' selected="selected">Russian</option>
            <option value='tr/function.pcntl-wait.php'>Turkish</option>
            <option value='zh/function.pcntl-wait.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/pcntl/functions/pcntl-wait.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.pcntl-wait%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.pcntl-wait" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">pcntl_wait</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">pcntl_wait</span> &mdash; <span class="dc-title">Ожидает или возвращает статус порождённого дочернего процесса</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.pcntl-wait-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>pcntl_wait</strong></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter reference">&$status</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = 0</span></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$resource_usage</code><span class="initializer"> = []</span></span>): <span class="type">int</span></div>

  <p class="para rdfs-comment">
   Функция ожидания приостанавливает выполнение текущего процесса до тех пор,
   пока дочерний процесс не завершится или пока не будет получен сигнал
   который завершает текущий процесс или вызывает функцию обработки сигнала.
   Если дочерний процесс уже завершился ко времени вызова
   (так называемые &quot;зомби&quot; процессы), функция незамедлительно вернёт управление.
   Обратитесь к вашей системному руководству (man) wait(2) для уточнения
   специфики работы wait в вашей системе.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Эта функция эквивалентна вызову <span class="function"><a href="function.pcntl-waitpid.php.html" class="function">pcntl_waitpid()</a></span>
    с аргументом <code class="parameter">process_id</code> равным <code class="literal">-1</code> и
    без аргумента <code class="parameter">flags</code>.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.pcntl-wait-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">status</code></dt>

     <dd>

      <p class="para">
       <span class="function"><strong>pcntl_wait()</strong></span> разместит информацию о статусе
       по ссылке в аргументе <code class="parameter">status</code>, который может
       быть передан в следующие функции:
       <span class="function"><a href="function.pcntl-wifexited.php.html" class="function">pcntl_wifexited()</a></span>,
       <span class="function"><a href="function.pcntl-wifstopped.php.html" class="function">pcntl_wifstopped()</a></span>,
       <span class="function"><a href="function.pcntl-wifsignaled.php.html" class="function">pcntl_wifsignaled()</a></span>,
       <span class="function"><a href="function.pcntl-wexitstatus.php.html" class="function">pcntl_wexitstatus()</a></span>,
       <span class="function"><a href="function.pcntl-wtermsig.php.html" class="function">pcntl_wtermsig()</a></span> и
       <span class="function"><a href="function.pcntl-wstopsig.php.html" class="function">pcntl_wstopsig()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       Если системный вызов wait3 (man 2 wait3) доступен в вашей системе (как правило в BSD-подобных системах),
       вы можете задать необязательный аргумент <code class="parameter">flags</code>.
       Если этот параметр не задан, будет использован стандартный системный вызов wait.
       Если системный вызов wait3 не доступен для вашей системы, передача значения
       аргумента <code class="parameter">flags</code> не будет иметь значения.
       Значение аргумента <code class="parameter">flags</code> - это битовая маска,
       которая может принимать значение ноль или более путём логического объединения следующих констант:
       <table class="doctable table">
        <caption><strong>Возможные значения для <code class="parameter">flags</code></strong></caption>
        
         <tbody class="tbody">
          <tr>
           <td><code class="literal">WNOHANG</code></td>
           <td>
            Незамедлительно вернуть управление, если ни один из дочерних процессов не завершён
           </td>
          </tr>

          <tr>
           <td><code class="literal">WUNTRACED</code></td>
           <td>
            Вернуть управление для остановленных дочерних процессов, о статусе которых ещё не сообщено
           </td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.pcntl-wait-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   <span class="function"><strong>pcntl_wait()</strong></span> возвращает ID завершённого дочернего процесса,
   -1 в случае возникновения ошибки или ноль, если <code class="literal">WNOHANG</code> был передан в аргумент
   <code class="parameter">options</code> (на системах с доступным системным вызовом wait3)
   и не было доступных дочерних процессов.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.pcntl-wait-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.pcntl-fork.php.html" class="function" rel="rdfs-seeAlso">pcntl_fork()</a> - Разветвить (fork) текущий запущенный процесс</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-signal.php.html" class="function" rel="rdfs-seeAlso">pcntl_signal()</a> - Установка обработчика сигнала</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-wifexited.php.html" class="function" rel="rdfs-seeAlso">pcntl_wifexited()</a> - Проверяет, соответствует ли код завершения процесса нормальному завершению</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-wifstopped.php.html" class="function" rel="rdfs-seeAlso">pcntl_wifstopped()</a> - Проверить, остановлен ли дочерний процесс</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-wifsignaled.php.html" class="function" rel="rdfs-seeAlso">pcntl_wifsignaled()</a> - Проверить, соответствует ли код завершения процесса завершению по сигналу</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-wexitstatus.php.html" class="function" rel="rdfs-seeAlso">pcntl_wexitstatus()</a> - Получить код возврата завершённого дочернего процесса</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-wtermsig.php.html" class="function" rel="rdfs-seeAlso">pcntl_wtermsig()</a> - Получить сигнал, из-за которого был принудительно завершён дочерний процесс</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-wstopsig.php.html" class="function" rel="rdfs-seeAlso">pcntl_wstopsig()</a> - Получить сигнал, из-за которого был остановлен дочерний процесс</span></li>
    <li class="member"><span class="function"><a href="function.pcntl-waitpid.php.html" class="function" rel="rdfs-seeAlso">pcntl_waitpid()</a> - Ожидает или возвращает статус порождённого дочернего процесса</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.pcntl-wait&amp;redirect=https://www.php.net/manual/ru/function.pcntl-wait.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">7 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="62099">  <div class="votes">
    <div id="Vu62099">
    <a href="https://www.php.net/manual/vote-note.php?id=62099&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd62099">
    <a href="https://www.php.net/manual/vote-note.php?id=62099&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V62099" title="62% like this...">
    4
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#62099" class="name">
  <strong class="user"><em>federico at nextware dot it</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#62099"> &para;</a><div class="date" title="2006-02-19 04:39"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom62099">
<div class="phpcode"><code><span class="html">This a simple multi process application where you can choose <br />the maximun process that can run at the same time.<br />This is useful when you need to limit the fork of process.<br />When the MAXPROCESS is reached the program wait on pcntl_wait()<br /><br /><span class="default">&lt;?php<br /><br />DEFINE</span><span class="keyword">(</span><span class="default">MAXPROCESS</span><span class="keyword">,</span><span class="default">25</span><span class="keyword">);<br /><br />for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">100</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />    </span><span class="default">$pid </span><span class="keyword">= </span><span class="default">pcntl_fork</span><span class="keyword">();<br />    <br />    if (</span><span class="default">$pid </span><span class="keyword">== -</span><span class="default">1</span><span class="keyword">) {<br />       die(</span><span class="string">"could not fork"</span><span class="keyword">);<br />    } elseif (</span><span class="default">$pid</span><span class="keyword">) {<br />                echo </span><span class="string">"I'm the Parent </span><span class="default">$i</span><span class="string">\n"</span><span class="keyword">;<br />        </span><span class="default">$execute</span><span class="keyword">++;<br />        if (</span><span class="default">$execute</span><span class="keyword">&gt;=</span><span class="default">MAXPROCESS</span><span class="keyword">){<br />            </span><span class="default">pcntl_wait</span><span class="keyword">(</span><span class="default">$status</span><span class="keyword">);<br />            </span><span class="default">$execute</span><span class="keyword">--;<br />        }<br />    } else {<br />       echo </span><span class="string">"I am the child, </span><span class="default">$i</span><span class="string"> pid = </span><span class="default">$pid</span><span class="string"> \n"</span><span class="keyword">;<br />       </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">));<br />       echo </span><span class="string">"Bye Bye from </span><span class="default">$i</span><span class="string">\n"</span><span class="keyword">;        <br />       exit;<br />    }<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="98710">  <div class="votes">
    <div id="Vu98710">
    <a href="https://www.php.net/manual/vote-note.php?id=98710&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98710">
    <a href="https://www.php.net/manual/vote-note.php?id=98710&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98710" title="75% like this...">
    2
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#98710" class="name">
  <strong class="user"><em>duerra at yahoo dot com</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#98710"> &para;</a><div class="date" title="2010-07-01 06:45"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom98710">
<div class="phpcode"><code><span class="html">Using pcntl_fork() can be a little tricky in some situations.  For fast jobs, a child can finish processing before the parent process has executed some code related to the launching of the process.  The parent can receive a signal before it's ready to handle the child process' status.  To handle this scenario, I add an id to a "queue" of processes in the signal handler that need to be cleaned up if the parent process is not yet ready to handle them.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">declare(</span><span class="default">ticks</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">);<br /></span><span class="comment">//A very basic job daemon that you can extend to your needs.  <br /></span><span class="keyword">class </span><span class="default">JobDaemon</span><span class="keyword">{<br /><br />    public </span><span class="default">$maxProcesses </span><span class="keyword">= </span><span class="default">25</span><span class="keyword">;<br />    protected </span><span class="default">$jobsStarted </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; <br />    protected </span><span class="default">$currentJobs </span><span class="keyword">= array();<br />    protected </span><span class="default">$signalQueue</span><span class="keyword">=array();    <br />    protected </span><span class="default">$parentPID</span><span class="keyword">;<br />    <br />    public function </span><span class="default">__construct</span><span class="keyword">(){<br />        echo </span><span class="string">"constructed \n"</span><span class="keyword">;<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parentPID </span><span class="keyword">= </span><span class="default">getmypid</span><span class="keyword">();<br />        </span><span class="default">pcntl_signal</span><span class="keyword">(</span><span class="default">SIGCHLD</span><span class="keyword">, array(</span><span class="default">$this</span><span class="keyword">, </span><span class="string">"childSignalHandler"</span><span class="keyword">));<br />    }<br />    <br />    </span><span class="comment">/** <br />    * Run the Daemon<br />    */<br />    </span><span class="keyword">public function </span><span class="default">run</span><span class="keyword">(){<br />        echo </span><span class="string">"Running \n"</span><span class="keyword">;<br />        for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">10000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />            </span><span class="default">$jobID </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">10000000000000</span><span class="keyword">);<br />            </span><span class="default">$launched </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">launchJob</span><span class="keyword">(</span><span class="default">$jobID</span><span class="keyword">);<br />        }<br />        <br />        </span><span class="comment">//Wait for child processes to finish before exiting here<br />        </span><span class="keyword">while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentJobs</span><span class="keyword">)){<br />            echo </span><span class="string">"Waiting for current jobs to finish... \n"</span><span class="keyword">;<br />            </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />        }<br />    }<br />    <br />    </span><span class="comment">/** <br />    * Launch a job from the job queue<br />    */<br />    </span><span class="keyword">protected function </span><span class="default">launchJob</span><span class="keyword">(</span><span class="default">$jobID</span><span class="keyword">){<br />        </span><span class="default">$pid </span><span class="keyword">= </span><span class="default">pcntl_fork</span><span class="keyword">();<br />        if(</span><span class="default">$pid </span><span class="keyword">== -</span><span class="default">1</span><span class="keyword">){<br />            </span><span class="comment">//Problem launching the job<br />            </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">'Could not launch new job, exiting'</span><span class="keyword">);<br />            return </span><span class="default">false</span><span class="keyword">;<br />        }<br />        else if (</span><span class="default">$pid</span><span class="keyword">){<br />            </span><span class="comment">// Parent process<br />            // Sometimes you can receive a signal to the childSignalHandler function before this code executes if <br />            // the child script executes quickly enough!<br />            //<br />            </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentJobs</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">] = </span><span class="default">$jobID</span><span class="keyword">;<br />            <br />            </span><span class="comment">// In the event that a signal for this pid was caught before we get here, it will be in our signalQueue array<br />            // So let's go ahead and process it now as if we'd just received the signal<br />            </span><span class="keyword">if(isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">signalQueue</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">])){<br />                echo </span><span class="string">"found </span><span class="default">$pid</span><span class="string"> in the signal queue, processing it now \n"</span><span class="keyword">;<br />                </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">childSignalHandler</span><span class="keyword">(</span><span class="default">SIGCHLD</span><span class="keyword">, </span><span class="default">$pid</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">signalQueue</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">]);<br />                unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">signalQueue</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">]);<br />            }<br />        }<br />        else{<br />            </span><span class="comment">//Forked child, do your deeds.... <br />            </span><span class="default">$exitStatus </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">//Error code if you need to or whatever<br />            </span><span class="keyword">echo </span><span class="string">"Doing something fun in pid "</span><span class="keyword">.</span><span class="default">getmypid</span><span class="keyword">().</span><span class="string">"\n"</span><span class="keyword">;<br />            exit(</span><span class="default">$exitStatus</span><span class="keyword">);<br />        }<br />        return </span><span class="default">true</span><span class="keyword">;<br />    }<br />    <br />    public function </span><span class="default">childSignalHandler</span><span class="keyword">(</span><span class="default">$signo</span><span class="keyword">, </span><span class="default">$pid</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">, </span><span class="default">$status</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">){<br />        <br />        </span><span class="comment">//If no pid is provided, that means we're getting the signal from the system.  Let's figure out<br />        //which child process ended<br />        </span><span class="keyword">if(!</span><span class="default">$pid</span><span class="keyword">){<br />            </span><span class="default">$pid </span><span class="keyword">= </span><span class="default">pcntl_waitpid</span><span class="keyword">(-</span><span class="default">1</span><span class="keyword">, </span><span class="default">$status</span><span class="keyword">, </span><span class="default">WNOHANG</span><span class="keyword">);<br />        }<br />        <br />        </span><span class="comment">//Make sure we get all of the exited children<br />        </span><span class="keyword">while(</span><span class="default">$pid </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">){<br />            if(</span><span class="default">$pid </span><span class="keyword">&amp;&amp; isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentJobs</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">])){<br />                </span><span class="default">$exitCode </span><span class="keyword">= </span><span class="default">pcntl_wexitstatus</span><span class="keyword">(</span><span class="default">$status</span><span class="keyword">);<br />                if(</span><span class="default">$exitCode </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">){<br />                    echo </span><span class="string">"</span><span class="default">$pid</span><span class="string"> exited with status "</span><span class="keyword">.</span><span class="default">$exitCode</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />                }<br />                unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentJobs</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">]);<br />            }<br />            else if(</span><span class="default">$pid</span><span class="keyword">){<br />                </span><span class="comment">//Oh no, our job has finished before this parent process could even note that it had been launched!<br />                //Let's make note of it and handle it when the parent process is ready for it<br />                </span><span class="keyword">echo </span><span class="string">"..... Adding </span><span class="default">$pid</span><span class="string"> to the signal queue ..... \n"</span><span class="keyword">;<br />                </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">signalQueue</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">] = </span><span class="default">$status</span><span class="keyword">;<br />            }<br />            </span><span class="default">$pid </span><span class="keyword">= </span><span class="default">pcntl_waitpid</span><span class="keyword">(-</span><span class="default">1</span><span class="keyword">, </span><span class="default">$status</span><span class="keyword">, </span><span class="default">WNOHANG</span><span class="keyword">);<br />        }<br />        return </span><span class="default">true</span><span class="keyword">;<br />    }<br />}</span></span></code></div>
  </div>
 </div>
  <div class="note" id="98534">  <div class="votes">
    <div id="Vu98534">
    <a href="https://www.php.net/manual/vote-note.php?id=98534&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98534">
    <a href="https://www.php.net/manual/vote-note.php?id=98534&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98534" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#98534" class="name">
  <strong class="user"><em>digitalaudiorock at gmail dot com</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#98534"> &para;</a><div class="date" title="2010-06-21 02:44"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom98534">
<div class="phpcode"><code><span class="html">I was unable to get pcntl_wait or pcntl_waitpid to terminate when I had an active signal handler.  I then noticed the post below from gaylord at 100days dot de, however I'm a little confused by that post as I found the exact opposite to be true.  The default value of the third parameter of pcntl_signal (the restart_syscalls parameter) is true and this seems to cause the wait to continue when the signal arrives.  In order to prevent this I had to expressly set it to false.  That is:<br /><br />pcntl_signal(SIGTERM, 'my_handler_function', false);</span></code></div>
  </div>
 </div>
  <div class="note" id="98450">  <div class="votes">
    <div id="Vu98450">
    <a href="https://www.php.net/manual/vote-note.php?id=98450&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98450">
    <a href="https://www.php.net/manual/vote-note.php?id=98450&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98450" title="100% like this...">
    2
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#98450" class="name">
  <strong class="user"><em>gaylord at 100days dot de</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#98450"> &para;</a><div class="date" title="2010-06-16 05:17"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom98450">
<div class="phpcode"><code><span class="html">pcntl_wait will not terminate on signals if you have a PHP signal handler activated (pcntl_signal).<br />This is unless the signal handler was activated with 3rd parameter=true.<br /><br />Example:<br /><span class="default">&lt;?php<br /></span><span class="keyword">declare(</span><span class="default">ticks</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">);<br /></span><span class="default">pcntl_signal</span><span class="keyword">(</span><span class="default">SIGTERM</span><span class="keyword">, </span><span class="string">"myHandler"</span><span class="keyword">);<br /></span><span class="default">$pid</span><span class="keyword">=</span><span class="default">pcntl_wait</span><span class="keyword">(</span><span class="default">$status</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />This will not terminate on SIGTERM sent to the process, because "wait" will be restarted after php recieves the signal. The signal handler "myHandler" will not be called unless pcntl_wait terminates for some other reason.<br /><br />Change to:<br /><span class="default">&lt;?php<br /></span><span class="keyword">declare(</span><span class="default">ticks</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">);<br /></span><span class="default">pcntl_signal</span><span class="keyword">(</span><span class="default">SIGTERM</span><span class="keyword">, </span><span class="string">"myHandler"</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br /></span><span class="default">$pid</span><span class="keyword">=</span><span class="default">pcntl_wait</span><span class="keyword">(</span><span class="default">$status</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />Now the pcntl_wait terminates when a signal comes in and "myHandler" will be called on SIGTERM. (Make sure to put the wait in a loop though, because it will now not only terminate when a child exits but also when a signal arrives. Test for $pid&gt;0 to detect a exit message from a child)<br />(thanks to Andrey for helping me debugging this)</span></code></div>
  </div>
 </div>
  <div class="note" id="98712">  <div class="votes">
    <div id="Vu98712">
    <a href="https://www.php.net/manual/vote-note.php?id=98712&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98712">
    <a href="https://www.php.net/manual/vote-note.php?id=98712&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98712" title="no votes...">
    0
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#98712" class="name">
  <strong class="user"><em>duerra at yahoo dot com</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#98712"> &para;</a><div class="date" title="2010-07-01 07:12"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom98712">
<div class="phpcode"><code><span class="html">Oops, I stripped just a little much from the job daemon code in the previous comment.  You'll want to add a little line before the -&gt;launchJob() method is called:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentJobs</span><span class="keyword">) &gt;= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">maxProcesses</span><span class="keyword">){<br />    echo </span><span class="string">"Maximum children allowed, waiting...\n"</span><span class="keyword">;<br />    </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">); <br />}</span></span></code></div>
  </div>
 </div>
  <div class="note" id="57932">  <div class="votes">
    <div id="Vu57932">
    <a href="https://www.php.net/manual/vote-note.php?id=57932&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd57932">
    <a href="https://www.php.net/manual/vote-note.php?id=57932&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V57932" title="no votes...">
    0
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#57932" class="name">
  <strong class="user"><em>thisisroot at gmail dot com</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#57932"> &para;</a><div class="date" title="2005-10-19 07:14"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom57932">
<div class="phpcode"><code><span class="html">Below is a simple example of forking some children and timing the total duration (useful for stress tests).<br /><br /><span class="default">&lt;?php<br /><br />$isParent    </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br /></span><span class="default">$children    </span><span class="keyword">= array();<br /></span><span class="default">$start        </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">( </span><span class="default">true</span><span class="keyword">);<br /><br /></span><span class="comment">/* Fork you!<br /> * (Sorry, I had to)<br /> */<br /></span><span class="default">$ceiling </span><span class="keyword">= </span><span class="default">$CONCURRENCY </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;<br /><br />for ( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; (( </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$ceiling</span><span class="keyword">) &amp;&amp; ( </span><span class="default">$isParent</span><span class="keyword">)); </span><span class="default">$i</span><span class="keyword">++) {<br />    </span><span class="default">$pid </span><span class="keyword">= </span><span class="default">pcntl_fork</span><span class="keyword">();<br />    if ( </span><span class="default">$pid </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />        </span><span class="default">$isParent </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />        <br />    } elseif ( </span><span class="default">$pid </span><span class="keyword">!= -</span><span class="default">1</span><span class="keyword">) {<br />        </span><span class="default">$children</span><span class="keyword">[] = </span><span class="default">$pid</span><span class="keyword">;<br />        <br />    }<br /><br />}<br /><br /></span><span class="comment">/* Process body */<br /></span><span class="keyword">echo </span><span class="string">"Do stuff here\n"</span><span class="keyword">;<br /><br /></span><span class="comment">/* Cleanup */<br /></span><span class="keyword">if ( </span><span class="default">$isParent</span><span class="keyword">) {<br />    </span><span class="default">$status </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />    while ( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$children</span><span class="keyword">)) {<br />        </span><span class="default">pcntl_wait</span><span class="keyword">( </span><span class="default">$status</span><span class="keyword">);<br />        </span><span class="default">array_pop</span><span class="keyword">( </span><span class="default">$children</span><span class="keyword">);<br />    }<br />    <br />    echo </span><span class="string">"Completed in " </span><span class="keyword">. ( </span><span class="default">microtime</span><span class="keyword">( </span><span class="default">true</span><span class="keyword">) - </span><span class="default">$start</span><span class="keyword">) . </span><span class="string">" seconds.\n"</span><span class="keyword">;<br />    <br />}<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="63594">  <div class="votes">
    <div id="Vu63594">
    <a href="https://www.php.net/manual/vote-note.php?id=63594&amp;page=function.pcntl-wait&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd63594">
    <a href="https://www.php.net/manual/vote-note.php?id=63594&amp;page=function.pcntl-wait&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V63594" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.pcntl-wait.php.html#63594" class="name">
  <strong class="user"><em>thomas dot nicolai at unisg dot ch</em></strong></a><a class="genanchor" href="function.pcntl-wait.php.html#63594"> &para;</a><div class="date" title="2006-03-24 11:19"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom63594">
<div class="phpcode"><code><span class="html">The code before isnt working for me cause the children are correctly started but not refreshed after they died. So keep in mind to use this instead and use the signal handler to know when a child exits to know when you have to start a new one. I added a few lines to the posting from {andy at cbeyond dot net} cause his post wasnt working for me as well (PHP5.1). Same effect like the one below.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">declare(</span><span class="default">ticks </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">);<br /><br /></span><span class="default">$max</span><span class="keyword">=</span><span class="default">5</span><span class="keyword">;<br /></span><span class="default">$child</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br /><br /></span><span class="comment">// function for signal handler<br /></span><span class="keyword">function </span><span class="default">sig_handler</span><span class="keyword">(</span><span class="default">$signo</span><span class="keyword">) {<br />  global </span><span class="default">$child</span><span class="keyword">;<br />  switch (</span><span class="default">$signo</span><span class="keyword">) {<br />   case </span><span class="default">SIGCHLD</span><span class="keyword">:<br />     echo </span><span class="string">"SIGCHLD received\n"</span><span class="keyword">;<br />     </span><span class="default">$child</span><span class="keyword">--;<br />  }<br />}<br /><br /></span><span class="comment">// install signal handler for dead kids<br /></span><span class="default">pcntl_signal</span><span class="keyword">(</span><span class="default">SIGCHLD</span><span class="keyword">, </span><span class="string">"sig_handler"</span><span class="keyword">);<br /><br />while (</span><span class="default">1</span><span class="keyword">){<br />       </span><span class="default">$child</span><span class="keyword">++;<br />       </span><span class="default">$pid</span><span class="keyword">=</span><span class="default">pcntl_fork</span><span class="keyword">();<br />       <br />       if (</span><span class="default">$pid </span><span class="keyword">== -</span><span class="default">1</span><span class="keyword">) {<br />               die(</span><span class="string">"could not fork"</span><span class="keyword">);<br />       } else if (</span><span class="default">$pid</span><span class="keyword">) {<br />               <br />               </span><span class="comment">// we are the parent<br />               </span><span class="keyword">if ( </span><span class="default">$child </span><span class="keyword">&gt;= </span><span class="default">$max </span><span class="keyword">){<br />                   </span><span class="default">pcntl_wait</span><span class="keyword">(</span><span class="default">$status</span><span class="keyword">);<br />                   </span><span class="default">$child</span><span class="keyword">++;<br />               }<br />       } else {<br />               </span><span class="comment">// we are the child<br />               </span><span class="keyword">echo </span><span class="string">"\t Starting new child | now we de have </span><span class="default">$child</span><span class="string"> child processes\n"</span><span class="keyword">;<br />               </span><span class="comment">// presumably doing something interesting<br />               </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">3</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">));<br />               exit;<br />       }<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.pcntl-wait&amp;redirect=https://www.php.net/manual/ru/function.pcntl-wait.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.pcntl.php.html">Функции PCNTL</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.pcntl-alarm.php.html" title="pcntl_&#8203;alarm">pcntl_&#8203;alarm</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-async-signals.php.html" title="pcntl_&#8203;async_&#8203;signals">pcntl_&#8203;async_&#8203;signals</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-errno.php.html" title="pcntl_&#8203;errno">pcntl_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-exec.php.html" title="pcntl_&#8203;exec">pcntl_&#8203;exec</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-fork.php.html" title="pcntl_&#8203;fork">pcntl_&#8203;fork</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-get-last-error.php.html" title="pcntl_&#8203;get_&#8203;last_&#8203;error">pcntl_&#8203;get_&#8203;last_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-getpriority.php.html" title="pcntl_&#8203;getpriority">pcntl_&#8203;getpriority</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-rfork.php.html" title="pcntl_&#8203;rfork">pcntl_&#8203;rfork</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-setpriority.php.html" title="pcntl_&#8203;setpriority">pcntl_&#8203;setpriority</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-signal-dispatch.php.html" title="pcntl_&#8203;signal_&#8203;dispatch">pcntl_&#8203;signal_&#8203;dispatch</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-signal-get-handler.php.html" title="pcntl_&#8203;signal_&#8203;get_&#8203;handler">pcntl_&#8203;signal_&#8203;get_&#8203;handler</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-signal.php.html" title="pcntl_&#8203;signal">pcntl_&#8203;signal</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-sigprocmask.php.html" title="pcntl_&#8203;sigprocmask">pcntl_&#8203;sigprocmask</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-sigtimedwait.php.html" title="pcntl_&#8203;sigtimedwait">pcntl_&#8203;sigtimedwait</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-sigwaitinfo.php.html" title="pcntl_&#8203;sigwaitinfo">pcntl_&#8203;sigwaitinfo</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-strerror.php.html" title="pcntl_&#8203;strerror">pcntl_&#8203;strerror</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-unshare.php.html" title="pcntl_&#8203;unshare">pcntl_&#8203;unshare</a>
                        </li>
                                                <li class="current">
                            <a href="function.pcntl-wait.php.html" title="pcntl_&#8203;wait">pcntl_&#8203;wait</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-waitpid.php.html" title="pcntl_&#8203;waitpid">pcntl_&#8203;waitpid</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-wexitstatus.php.html" title="pcntl_&#8203;wexitstatus">pcntl_&#8203;wexitstatus</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-wifexited.php.html" title="pcntl_&#8203;wifexited">pcntl_&#8203;wifexited</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-wifsignaled.php.html" title="pcntl_&#8203;wifsignaled">pcntl_&#8203;wifsignaled</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-wifstopped.php.html" title="pcntl_&#8203;wifstopped">pcntl_&#8203;wifstopped</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-wstopsig.php.html" title="pcntl_&#8203;wstopsig">pcntl_&#8203;wstopsig</a>
                        </li>
                                                <li class="">
                            <a href="function.pcntl-wtermsig.php.html" title="pcntl_&#8203;wtermsig">pcntl_&#8203;wtermsig</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
