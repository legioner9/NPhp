<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: posix_setuid - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.posix-setuid.php.html">
 <link rel="shorturl" href="https://www.php.net/posix-setuid">
 <link rel="alternate" href="https://www.php.net/posix-setuid" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.posix.php.html">
 <link rel="prev" href="function.posix-setsid.php.html">
 <link rel="next" href="function.posix-strerror.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.posix-setuid.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.posix-setuid.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.posix-setuid.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.posix-setuid.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.posix-setuid.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.posix-setuid.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.posix-setuid.php" hreflang="pt_BR">
 <link rel="alternate" href="function.posix-setuid.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.posix-setuid.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.posix-setuid.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.posix-strerror.php.html">
          posix_strerror &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.posix-setsid.php.html">
          &laquo; posix_setsid        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.fileprocess.process.php.html'>Модули для управления процессами программ</a></li>      <li><a href='book.posix.php.html'>POSIX</a></li>      <li><a href='ref.posix.php.html'>POSIX Функции</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.posix-setuid.php'>English</option>
            <option value='de/function.posix-setuid.php'>German</option>
            <option value='es/function.posix-setuid.php'>Spanish</option>
            <option value='fr/function.posix-setuid.php'>French</option>
            <option value='it/function.posix-setuid.php'>Italian</option>
            <option value='ja/function.posix-setuid.php'>Japanese</option>
            <option value='pt_BR/function.posix-setuid.php'>Brazilian Portuguese</option>
            <option value='ru/function.posix-setuid.php' selected="selected">Russian</option>
            <option value='tr/function.posix-setuid.php'>Turkish</option>
            <option value='zh/function.posix-setuid.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/posix/functions/posix-setuid.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.posix-setuid%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.posix-setuid" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">posix_setuid</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">posix_setuid</span> &mdash; <span class="dc-title">Устанавливает UID текущего процесса</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.posix-setuid-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>posix_setuid</strong></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter">$user_id</code></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   Устанавливает фактический идентификатор пользователя текущего процесса. Это
   привилегированный процесс и требует соответствующих прав (обычно прав
   суперпользователя root) в системе для возможности выполнить эту функцию.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.posix-setuid-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">user_id</code></dt>

     <dd>

      <p class="para">
       Идентификатор пользователя.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.posix-setuid-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.posix-setuid-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="">
    <p><strong>Пример #1 Пример использования <span class="function"><strong>posix_setuid()</strong></span></strong></p>
    <div class="example-contents"><p>Данный код выводит текущий идентификатор пользователя, затем изменяет его.</p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">posix_getuid</span><span style="color: #007700">().</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">//10001<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">posix_geteuid</span><span style="color: #007700">().</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">//10001<br /></span><span style="color: #0000BB">posix_setuid</span><span style="color: #007700">(</span><span style="color: #0000BB">10000</span><span style="color: #007700">);<br />echo </span><span style="color: #0000BB">posix_getuid</span><span style="color: #007700">().</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">//10000<br /></span><span style="color: #007700">echo </span><span style="color: #0000BB">posix_geteuid</span><span style="color: #007700">().</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">; </span><span style="color: #FF8000">//10000<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.posix-setuid-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.posix-setgid.php.html" class="function" rel="rdfs-seeAlso">posix_setgid()</a> - Устанавливает идентификатор группы для текущего процесса GID</span></li>
    <li class="member"><span class="function"><a href="function.posix-seteuid.php.html" class="function" rel="rdfs-seeAlso">posix_seteuid()</a> - Устанавливает эффективный идентификатор пользователя для текущего процесса EUID</span></li>
    <li class="member"><span class="function"><a href="function.posix-getuid.php.html" class="function" rel="rdfs-seeAlso">posix_getuid()</a> - Возвращает фактический идентификатор пользователя текущего процесса UID</span></li>
    <li class="member"><span class="function"><a href="function.posix-geteuid.php.html" class="function" rel="rdfs-seeAlso">posix_geteuid()</a> - Возвращает эффективный идентификатор пользователя текущего процесса EUID</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.posix-setuid&amp;redirect=https://www.php.net/manual/ru/function.posix-setuid.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">7 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="115069">  <div class="votes">
    <div id="Vu115069">
    <a href="https://www.php.net/manual/vote-note.php?id=115069&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115069">
    <a href="https://www.php.net/manual/vote-note.php?id=115069&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115069" title="100% like this...">
    2
    </div>
  </div>
  <a href="function.posix-setuid.php.html#115069" class="name">
  <strong class="user"><em>Leigh</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#115069"> &para;</a><div class="date" title="2014-05-22 02:08"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom115069">
<div class="phpcode"><code><span class="html">Note that on unix, if your target user does not have a valid shell, some php functions (eg: tempnam) will not work correctly:<br /><br />$ grep www-data /etc/passwd<br />www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br /><br />$ cat test.php <br />#!/usr/bin/php -q<br /><span class="default">&lt;?php<br />    $info</span><span class="keyword">=</span><span class="default">posix_getpwnam</span><span class="keyword">(</span><span class="string">"www-data"</span><span class="keyword">);<br />    </span><span class="default">$id</span><span class="keyword">=</span><span class="default">$info</span><span class="keyword">[</span><span class="string">"uid"</span><span class="keyword">];<br /><br />    </span><span class="default">$file</span><span class="keyword">=</span><span class="default">tempnam</span><span class="keyword">(</span><span class="string">"/tmp"</span><span class="keyword">,</span><span class="string">"something"</span><span class="keyword">);<br />    print </span><span class="string">"PRE SetUID: </span><span class="default">$file</span><span class="string">\n"</span><span class="keyword">;<br /><br />    </span><span class="default">$SETUID</span><span class="keyword">=</span><span class="default">posix_setuid</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">);<br /><br />    </span><span class="default">$file</span><span class="keyword">=</span><span class="default">tempnam</span><span class="keyword">(</span><span class="string">"/tmp"</span><span class="keyword">,</span><span class="string">"something"</span><span class="keyword">);<br />    print </span><span class="string">"POST SetUID: </span><span class="default">$file</span><span class="string">\n"</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span><br />$ sudo ./test.php <br />PRE SetUID: /tmp/somethingrsb1qZ<br />POST SetUID:</span></code></div>
  </div>
 </div>
  <div class="note" id="73113">  <div class="votes">
    <div id="Vu73113">
    <a href="https://www.php.net/manual/vote-note.php?id=73113&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd73113">
    <a href="https://www.php.net/manual/vote-note.php?id=73113&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V73113" title="66% like this...">
    1
    </div>
  </div>
  <a href="function.posix-setuid.php.html#73113" class="name">
  <strong class="user"><em>TheWanderer</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#73113"> &para;</a><div class="date" title="2007-02-09 04:16"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom73113">
<div class="phpcode"><code><span class="html">On many UNIX systems (tested on Debian GNU/Linux), SUID is disabled for scripts and works only for binaries. If you need to setuid, you must use a wrapper binary that runs setuid() php script. Here's an example:<br /><br />$ nano suexec.cpp<br />#include &lt;stdlib&gt;<br />using namespace std;<br />int main()<br />{<br />system("php /home/php/php_user.php");<br />return 0;<br />}<br /><br />$ g++ -o suexec suexec.cpp<br />$ sudo chown root:root suexec<br />$ sudo chmod 4755 root<br /><br />Then we create short PHP script to set process uid (you should already know how to do this). Don't even try to experiment with auto_prepend_file in php.ini, it doesn't work as expected.</span></code></div>
  </div>
 </div>
  <div class="note" id="74747">  <div class="votes">
    <div id="Vu74747">
    <a href="https://www.php.net/manual/vote-note.php?id=74747&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd74747">
    <a href="https://www.php.net/manual/vote-note.php?id=74747&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V74747" title="100% like this...">
    1
    </div>
  </div>
  <a href="function.posix-setuid.php.html#74747" class="name">
  <strong class="user"><em>reuben @ nospam me</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#74747"> &para;</a><div class="date" title="2007-04-25 06:25"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom74747">
<div class="phpcode"><code><span class="html">In response to a note above that advocated the user of system() in a setuid program written in C, this is generally a bad idea for security.  <br /><br />You should use the standard library calls like execl() instead because system() can be manipulated to execute the wrong thing using the SHELL, IFS and possibly other variables.</span></code></div>
  </div>
 </div>
  <div class="note" id="78554">  <div class="votes">
    <div id="Vu78554">
    <a href="https://www.php.net/manual/vote-note.php?id=78554&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd78554">
    <a href="https://www.php.net/manual/vote-note.php?id=78554&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V78554" title="no votes...">
    0
    </div>
  </div>
  <a href="function.posix-setuid.php.html#78554" class="name">
  <strong class="user"><em>fm at farhad.ca</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#78554"> &para;</a><div class="date" title="2007-10-17 03:44"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom78554">
<div class="phpcode"><code><span class="html">When you do a posix_setuid from root to some other users you will not have access to files owned by root according to their permissions. For instance if you change owner of the process and still need to open a file for read or write with 600 permission owned by root you will receive a permission denied.<br />There are some ways to do this (i.e. a unix socket or tcp daemon etc), but probably the most easiest way is:<br /><br />Open the file before changing ownership of process, save the file pointer in a global variable and use it after changing ownership. <br /><br />For example assume /root/test_file is a file owned by root:root and have a permission of 600 and you are running this script under root. This code will not work:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Change ownership of process to nobody<br /></span><span class="default">posix_setgid</span><span class="keyword">(</span><span class="default">99</span><span class="keyword">);<br /></span><span class="default">posix_setuid</span><span class="keyword">(</span><span class="default">99</span><span class="keyword">);<br /><br /></span><span class="default">$fd </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/root/test_file'</span><span class="keyword">,</span><span class="string">'a'</span><span class="keyword">);<br /></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">,</span><span class="string">"some test strings"</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">();<br /><br /></span><span class="default">?&gt;<br /></span><br />But this one will work:<br /><br /><span class="default">&lt;?php<br />$fd </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/root/test_file'</span><span class="keyword">,</span><span class="string">'a'</span><span class="keyword">);<br /><br /></span><span class="comment">// Change ownership of process to nobody<br /></span><span class="default">posix_setgid</span><span class="keyword">(</span><span class="default">99</span><span class="keyword">);<br /></span><span class="default">posix_setuid</span><span class="keyword">(</span><span class="default">99</span><span class="keyword">);<br /><br /></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">,</span><span class="string">"some test strings"</span><span class="keyword">);<br /></span><span class="default">fclose</span><span class="keyword">();<br /><br /></span><span class="default">?&gt;<br /></span><br />Hope this helps some one.<br /><br />[Tested on CentOS 5 - Linux 2.6.x - PHP 5.2.x]</span></code></div>
  </div>
 </div>
  <div class="note" id="68493">  <div class="votes">
    <div id="Vu68493">
    <a href="https://www.php.net/manual/vote-note.php?id=68493&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd68493">
    <a href="https://www.php.net/manual/vote-note.php?id=68493&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V68493" title="no votes...">
    0
    </div>
  </div>
  <a href="function.posix-setuid.php.html#68493" class="name">
  <strong class="user"><em>hpaul/at/abo/dot/fi</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#68493"> &para;</a><div class="date" title="2006-07-29 11:56"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom68493">
<div class="phpcode"><code><span class="html">It seems like this function returns true if you try to change uid to the already active user - even if you aren't root.<br /><br />Should save you one if-statement in some cases.</span></code></div>
  </div>
 </div>
  <div class="note" id="23983">  <div class="votes">
    <div id="Vu23983">
    <a href="https://www.php.net/manual/vote-note.php?id=23983&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd23983">
    <a href="https://www.php.net/manual/vote-note.php?id=23983&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V23983" title="no votes...">
    0
    </div>
  </div>
  <a href="function.posix-setuid.php.html#23983" class="name">
  <strong class="user"><em>simon at dont-spam-me-pleease dot simonster dot com</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#23983"> &para;</a><div class="date" title="2002-08-02 03:53"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom23983">
<div class="phpcode"><code><span class="html">Here's some Perl code to run a PHP script setuid. Just put it into a CGI, make that CGI setuid and executable, then call the CGI where you would usually call the PHP script.<br /><br />#!/usr/local/bin/perl<br /><br /># Perl wrapper to execute a PHP script setuid<br /># ?2002 Simon Kornblith<br /># Requires PHP CGI<br /><br /># Make UID = EUID (so that PHP can run system()s and execs() setuid)<br />$&lt; = $&gt;;<br /># Set this to the path, so that we can't get poisoned<br />$ENV{'PATH'} = "/home/httpd/cgi-bin/ssl/admin";      <br /># Open the PHP script (must start with !#/usr/local/bin/php or similar and<br /># be executable<br />open(STDOUT, "| /home/httpd/cgi-bin/ssl/admin/new.php");<br /># Write STDIN to PHP script <br />print while &lt;STDIN&gt;;</span></code></div>
  </div>
 </div>
  <div class="note" id="37289">  <div class="votes">
    <div id="Vu37289">
    <a href="https://www.php.net/manual/vote-note.php?id=37289&amp;page=function.posix-setuid&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd37289">
    <a href="https://www.php.net/manual/vote-note.php?id=37289&amp;page=function.posix-setuid&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V37289" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.posix-setuid.php.html#37289" class="name">
  <strong class="user"><em>rjmooney at syr dot edu</em></strong></a><a class="genanchor" href="function.posix-setuid.php.html#37289"> &para;</a><div class="date" title="2003-11-09 03:40"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom37289">
<div class="phpcode"><code><span class="html">For simple operations, you can easily create a privilege-separation mechanism to perform commands that require elevated privileges.<br /><br />For example, in creating a document repository, I had the need to provide access to certain directory and file operations based on a user's login name.  It's unrealistic and unsecure to provide the web server access to all of the directories that the user may need to access, so I created a setuid() script to perform the required operations for me.<br /><br />An exerpt from the code demonstrates this:<br /><br />&lt;?<br /><br />//<br />// main.php<br />//<br /><br />// Perform a privileged stat()<br />function privsep_stat($path)<br />{<br />        // Call the privilege separation program, ask for a stat of the specified path<br />        $serialized_result = exec("/path/to/privsep.php stat " . $path, $oa, $return_code);<br />        if ($return_code != 0)<br />        {<br />                return false;<br />        }<br /><br />        // Return the unserialized object<br />        return unserialize($serialized_result);<br />}<br /><br />// Get file statistics on a file we don't have access to as the web server user<br />$st = privsep_stat("/private_directory/private_file");<br />print_r($st);<br /><br />?&gt;<br /><br />privsep.php looks like this:<br /><br />#!/usr/local/bin/php<br />&lt;?<br /><br />//<br />// privsep.php<br />//<br /><br />// Don't allow this script to be run from the web<br />if (isset($_SERVER['REQUEST_METHOD']))<br />{<br />    print "&lt;br&gt;This program is not intended to be run directly from the WWW.\n";<br />    return 1;<br />}<br /><br />// TODO: add your argument validation here<br /><br />// A stat was requested<br />if ($argv[1] == "stat")<br />{<br />    // Reset the stat() cache<br />    clearstatcache();<br /><br />    // Original user ID<br />    $original_uid = posix_get_uid();<br /><br />    // Set our real user ID to root<br />    $success = posix_setuid(0);<br />    if (!$success)<br />    {<br />        print "Error: Cannot setuid().\n";<br />        return 1;<br />    }<br /><br />    // Store the file statistics<br />    $st = stat($argv[2]);<br /><br />    // Drop the real UID back to the calling user ID<br />    $success = posix_setuid($original_uid); <br />    if (!$success)<br />    {<br />        print "Error: Cannot setuid().\n";<br />        return 1;<br />    }<br /><br />    // Drop the effective UID as well<br />    $success = posix_seteuid($original_uid); <br />    if (!$success)<br />    {<br />        print "Error: Cannot seteuid().\n";<br />        return 1;<br />    }<br /><br />    // Serialize the result and print it<br />    $result = serialize($st);<br />    print $result;<br /><br />    // Success!<br />    return 0;<br />}<br />?&gt;<br /><br />Finally, privsep.php's permissions are configured like this:<br /><br /># chown root:wheel privsep.php<br /># chmod 4755 privsep.php<br /><br />And look like this:<br /><br />-rwsr-xr-x  1 root      wheel     1000 Nov  1 00:00 privsep.php<br /><br />It's probably wise to keep privsep.php out of your document root to help mitigate any successful attack. <br /><br />This method can be extended for other functions.  Use at your own risk.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.posix-setuid&amp;redirect=https://www.php.net/manual/ru/function.posix-setuid.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.posix.php.html">POSIX Функции</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.posix-access.php.html" title="posix_&#8203;access">posix_&#8203;access</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-ctermid.php.html" title="posix_&#8203;ctermid">posix_&#8203;ctermid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-eaccess.php.html" title="posix_&#8203;eaccess">posix_&#8203;eaccess</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-errno.php.html" title="posix_&#8203;errno">posix_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-fpathconf.php.html" title="posix_&#8203;fpathconf">posix_&#8203;fpathconf</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-get-last-error.php.html" title="posix_&#8203;get_&#8203;last_&#8203;error">posix_&#8203;get_&#8203;last_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getcwd.php.html" title="posix_&#8203;getcwd">posix_&#8203;getcwd</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getegid.php.html" title="posix_&#8203;getegid">posix_&#8203;getegid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-geteuid.php.html" title="posix_&#8203;geteuid">posix_&#8203;geteuid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getgid.php.html" title="posix_&#8203;getgid">posix_&#8203;getgid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getgrgid.php.html" title="posix_&#8203;getgrgid">posix_&#8203;getgrgid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getgrnam.php.html" title="posix_&#8203;getgrnam">posix_&#8203;getgrnam</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getgroups.php.html" title="posix_&#8203;getgroups">posix_&#8203;getgroups</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getlogin.php.html" title="posix_&#8203;getlogin">posix_&#8203;getlogin</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getpgid.php.html" title="posix_&#8203;getpgid">posix_&#8203;getpgid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getpgrp.php.html" title="posix_&#8203;getpgrp">posix_&#8203;getpgrp</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getpid.php.html" title="posix_&#8203;getpid">posix_&#8203;getpid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getppid.php.html" title="posix_&#8203;getppid">posix_&#8203;getppid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getpwnam.php.html" title="posix_&#8203;getpwnam">posix_&#8203;getpwnam</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getpwuid.php.html" title="posix_&#8203;getpwuid">posix_&#8203;getpwuid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getrlimit.php.html" title="posix_&#8203;getrlimit">posix_&#8203;getrlimit</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getsid.php.html" title="posix_&#8203;getsid">posix_&#8203;getsid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-getuid.php.html" title="posix_&#8203;getuid">posix_&#8203;getuid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-initgroups.php.html" title="posix_&#8203;initgroups">posix_&#8203;initgroups</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-isatty.php.html" title="posix_&#8203;isatty">posix_&#8203;isatty</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-kill.php.html" title="posix_&#8203;kill">posix_&#8203;kill</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-mkfifo.php.html" title="posix_&#8203;mkfifo">posix_&#8203;mkfifo</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-mknod.php.html" title="posix_&#8203;mknod">posix_&#8203;mknod</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-pathconf.php.html" title="posix_&#8203;pathconf">posix_&#8203;pathconf</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-setegid.php.html" title="posix_&#8203;setegid">posix_&#8203;setegid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-seteuid.php.html" title="posix_&#8203;seteuid">posix_&#8203;seteuid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-setgid.php.html" title="posix_&#8203;setgid">posix_&#8203;setgid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-setpgid.php.html" title="posix_&#8203;setpgid">posix_&#8203;setpgid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-setrlimit.php.html" title="posix_&#8203;setrlimit">posix_&#8203;setrlimit</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-setsid.php.html" title="posix_&#8203;setsid">posix_&#8203;setsid</a>
                        </li>
                                                <li class="current">
                            <a href="function.posix-setuid.php.html" title="posix_&#8203;setuid">posix_&#8203;setuid</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-strerror.php.html" title="posix_&#8203;strerror">posix_&#8203;strerror</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-sysconf.php.html" title="posix_&#8203;sysconf">posix_&#8203;sysconf</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-times.php.html" title="posix_&#8203;times">posix_&#8203;times</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-ttyname.php.html" title="posix_&#8203;ttyname">posix_&#8203;ttyname</a>
                        </li>
                                                <li class="">
                            <a href="function.posix-uname.php.html" title="posix_&#8203;uname">posix_&#8203;uname</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
