<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: session_decode - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.session-decode.php.html">
 <link rel="shorturl" href="https://www.php.net/session-decode">
 <link rel="alternate" href="https://www.php.net/session-decode" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="ref.session.php.html">
 <link rel="prev" href="function.session-create-id.php.html">
 <link rel="next" href="function.session-destroy.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/function.session-decode.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/function.session-decode.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/function.session-decode.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.session-decode.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/function.session-decode.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.session-decode.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.session-decode.php" hreflang="pt_BR">
 <link rel="alternate" href="function.session-decode.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.session-decode.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.session-decode.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.session-destroy.php.html">
          session_destroy &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.session-create-id.php.html">
          &laquo; session_create_id        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.basic.session.php.html'>Модули для работы с сессиями</a></li>      <li><a href='book.session.php.html'>Сессии</a></li>      <li><a href='ref.session.php.html'>Функции для работы с сессиями</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.session-decode.php'>English</option>
            <option value='de/function.session-decode.php'>German</option>
            <option value='es/function.session-decode.php'>Spanish</option>
            <option value='fr/function.session-decode.php'>French</option>
            <option value='it/function.session-decode.php'>Italian</option>
            <option value='ja/function.session-decode.php'>Japanese</option>
            <option value='pt_BR/function.session-decode.php'>Brazilian Portuguese</option>
            <option value='ru/function.session-decode.php' selected="selected">Russian</option>
            <option value='tr/function.session-decode.php'>Turkish</option>
            <option value='zh/function.session-decode.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/session/functions/session-decode.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.session-decode%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.session-decode" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_decode</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">session_decode</span> &mdash; <span class="dc-title">Декодирует данные сессии из закодированной строки сессии</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.session-decode-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>session_decode</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_decode()</strong></span> декодирует сериализованные данные сессии,
   переданные в <code class="parameter">$data</code> и заполняет суперглобальный массив
   $_SESSION полученным результатом.
  </p>
  <p class="para">
   По умолчанию используется внутренний метод десериализации PHP, и результат будет отличаться от формата, возвращаемого функцией <span class="function"><a href="function.unserialize.php.html" class="function">unserialize()</a></span>.
   Метод сериализации может быть установлен с помощью <a href="session.configuration.php.html#ini.session.serialize-handler" class="link">session.serialize_handler</a>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.session-decode-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       Закодированные данные, которые необходимо сохранить.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-decode-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-decode-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.session-encode.php.html" class="function" rel="rdfs-seeAlso">session_encode()</a> - Кодирует данные текущей сессии в формате строки сессии</span></li>
    <li class="member"><a href="session.configuration.php.html#ini.session.serialize-handler" class="link">session.serialize_handler</a></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=function.session-decode&amp;redirect=https://www.php.net/manual/ru/function.session-decode.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">17 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="108037">  <div class="votes">
    <div id="Vu108037">
    <a href="https://www.php.net/manual/vote-note.php?id=108037&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd108037">
    <a href="https://www.php.net/manual/vote-note.php?id=108037&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V108037" title="77% like this...">
    45
    </div>
  </div>
  <a href="function.session-decode.php.html#108037" class="name">
  <strong class="user"><em>Frits dot vanCampen at moxio dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#108037"> &para;</a><div class="date" title="2012-03-23 05:24"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom108037">
<div class="phpcode"><code><span class="html">I noticed that the posted solutions for manually decoding sessions are not perfect, so I've contributed a more robust solution.<br /><br />The preg_match solution can never work. It's not so hard to find a case that might break unserialization.<br />In the case of jason-joeymail is breaks on:<br /><br /><span class="default">&lt;?php<br />$_SESSION</span><span class="keyword">[</span><span class="string">"test"</span><span class="keyword">] = </span><span class="string">";oops|"</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span><br />Below you can find my solution. It doesn't use a regular expression but rather the reversibility of the serialize operation and the 'feature' that serialize ignores all further input when it thinks it's done. It's by no means a beautiful or particularly fast solution but it is a more robust solution.<br />I've added a deserializer for "php" and "php_binary". It should be trivial to add one for "wddx".<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Session </span><span class="keyword">{<br />    public static function </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">) {<br />        </span><span class="default">$method </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">"session.serialize_handler"</span><span class="keyword">);<br />        switch (</span><span class="default">$method</span><span class="keyword">) {<br />            case </span><span class="string">"php"</span><span class="keyword">:<br />                return </span><span class="default">self</span><span class="keyword">::</span><span class="default">unserialize_php</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">);<br />                break;<br />            case </span><span class="string">"php_binary"</span><span class="keyword">:<br />                return </span><span class="default">self</span><span class="keyword">::</span><span class="default">unserialize_phpbinary</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">);<br />                break;<br />            default:<br />                throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Unsupported session.serialize_handler: " </span><span class="keyword">. </span><span class="default">$method </span><span class="keyword">. </span><span class="string">". Supported: php, php_binary"</span><span class="keyword">);<br />        }<br />    }<br /><br />    private static function </span><span class="default">unserialize_php</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">) {<br />        </span><span class="default">$return_data </span><span class="keyword">= array();<br />        </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />        while (</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">)) {<br />            if (!</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">), </span><span class="string">"|"</span><span class="keyword">)) {<br />                throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"invalid data, remaining: " </span><span class="keyword">. </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">));<br />            }<br />            </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="string">"|"</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />            </span><span class="default">$num </span><span class="keyword">= </span><span class="default">$pos </span><span class="keyword">- </span><span class="default">$offset</span><span class="keyword">;<br />            </span><span class="default">$varname </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">);<br />            </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">$num </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br />            </span><span class="default">$data </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">));<br />            </span><span class="default">$return_data</span><span class="keyword">[</span><span class="default">$varname</span><span class="keyword">] = </span><span class="default">$data</span><span class="keyword">;<br />            </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">));<br />        }<br />        return </span><span class="default">$return_data</span><span class="keyword">;<br />    }<br /><br />    private static function </span><span class="default">unserialize_phpbinary</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">) {<br />        </span><span class="default">$return_data </span><span class="keyword">= array();<br />        </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />        while (</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">)) {<br />            </span><span class="default">$num </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">[</span><span class="default">$offset</span><span class="keyword">]);<br />            </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />            </span><span class="default">$varname </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">);<br />            </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">$num</span><span class="keyword">;<br />            </span><span class="default">$data </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">));<br />            </span><span class="default">$return_data</span><span class="keyword">[</span><span class="default">$varname</span><span class="keyword">] = </span><span class="default">$data</span><span class="keyword">;<br />            </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">));<br />        }<br />        return </span><span class="default">$return_data</span><span class="keyword">;<br />    }<br />}<br /></span><span class="default">?&gt;<br /></span><br />Usage:<br /><br /><span class="default">&lt;?php<br />Session</span><span class="keyword">::</span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">session_encode</span><span class="keyword">());<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="35147">  <div class="votes">
    <div id="Vu35147">
    <a href="https://www.php.net/manual/vote-note.php?id=35147&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd35147">
    <a href="https://www.php.net/manual/vote-note.php?id=35147&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V35147" title="80% like this...">
    3
    </div>
  </div>
  <a href="function.session-decode.php.html#35147" class="name">
  <strong class="user"><em>petej*shaman_ca</em></strong></a><a class="genanchor" href="function.session-decode.php.html#35147"> &para;</a><div class="date" title="2003-08-21 01:44"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom35147">
<div class="phpcode"><code><span class="html">Seems like there was a change in the behavior of this function somewhere between 4.1.2 and 4.3.3.  In 4.1.2 session_decode() didn't care whether the session was started, and would just decode the string into the _SESSION array.  In my 4.3.3 install, session_decode() wouldn't work unless I explicitly started the session with session_start().</span></code></div>
  </div>
 </div>
  <div class="note" id="113523">  <div class="votes">
    <div id="Vu113523">
    <a href="https://www.php.net/manual/vote-note.php?id=113523&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113523">
    <a href="https://www.php.net/manual/vote-note.php?id=113523&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113523" title="68% like this...">
    9
    </div>
  </div>
  <a href="function.session-decode.php.html#113523" class="name">
  <strong class="user"><em>frank at interactinet dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#113523"> &para;</a><div class="date" title="2013-10-24 03:58"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113523">
<div class="phpcode"><code><span class="html">I found this to be the simplest solution:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// if session is not started<br /></span><span class="default">session_start</span><span class="keyword">();<br /><br /></span><span class="comment">// store our current session<br /></span><span class="default">$my_sess </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br /><br /></span><span class="comment">// decode $data (the encoded session data, either from a file or database). Remember, decoded data is put directly into $_SESSION<br /></span><span class="default">session_decode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br /></span><span class="default">$data </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br /><br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br /><br /></span><span class="comment">// restore our own session<br /></span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">$my_sess</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="69111">  <div class="votes">
    <div id="Vu69111">
    <a href="https://www.php.net/manual/vote-note.php?id=69111&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd69111">
    <a href="https://www.php.net/manual/vote-note.php?id=69111&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V69111" title="63% like this...">
    3
    </div>
  </div>
  <a href="function.session-decode.php.html#69111" class="name">
  <strong class="user"><em>leon dot pegg at gmail dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#69111"> &para;</a><div class="date" title="2006-08-23 08:14"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom69111">
<div class="phpcode"><code><span class="html">i have found this to be a better way to restore session data while keeping your current session.<br /><br />function decode_session($session_string){<br />    $current_session = session_encode();<br />    foreach ($_SESSION as $key =&gt; $value){<br />        unset($_SESSION[$key]);<br />    }<br />    session_decode($session_string);<br />    $restored_session = $_SESSION;<br />    foreach ($_SESSION as $key =&gt; $value){<br />        unset($_SESSION[$key]);<br />    }<br />    session_decode($current_session);<br />    return $restored_session;<br />}<br /><br />enjoy</span></code></div>
  </div>
 </div>
  <div class="note" id="41187">  <div class="votes">
    <div id="Vu41187">
    <a href="https://www.php.net/manual/vote-note.php?id=41187&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd41187">
    <a href="https://www.php.net/manual/vote-note.php?id=41187&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V41187" title="61% like this...">
    3
    </div>
  </div>
  <a href="function.session-decode.php.html#41187" class="name">
  <strong class="user"><em>forum at orthanc dot co dot nz</em></strong></a><a class="genanchor" href="function.session-decode.php.html#41187"> &para;</a><div class="date" title="2004-04-02 12:26"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom41187">
<div class="phpcode"><code><span class="html">Becarful using this if you are trying to switch out of an existing session rather than load one into a clean slate.<br /><br />session_decode doesn't destroy the existing session data, it will over write it if there is a session variable of the same name, but if the names don't clash the existing session variables will hang around.<br /><br />I have yet to find a better solution than<br /><br />session_destroy()<br />session_start()<br />session_decode(....);<br /><br />-----------------------------------------<br />To explain what I'm talking about<br /><br />&lt;?<br />    session_start();<br />    $a = 5;<br />    session_register('a');<br />    session_decode("&lt;session that doesn't have a as a session variable&gt;");<br />    print (session_is_registered('a') ? $a : 'Not Registered' );<br />?&gt;<br /><br />The above code will print '5' as $a hasn't been destroyed or even unregistered by the session_decode</span></code></div>
  </div>
 </div>
  <div class="note" id="101428">  <div class="votes">
    <div id="Vu101428">
    <a href="https://www.php.net/manual/vote-note.php?id=101428&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd101428">
    <a href="https://www.php.net/manual/vote-note.php?id=101428&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V101428" title="60% like this...">
    2
    </div>
  </div>
  <a href="function.session-decode.php.html#101428" class="name">
  <strong class="user"><em>davyvandenbremt at gmail dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#101428"> &para;</a><div class="date" title="2010-12-16 01:18"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom101428">
<div class="phpcode"><code><span class="html">Here's what we are using to unserialize the session.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">unserialize_session</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />  </span><span class="default">$result </span><span class="keyword">= array();<br />  <br />  </span><span class="comment">// prefixing with semicolon to make it easier to write the regular expression<br />  </span><span class="default">$val </span><span class="keyword">= </span><span class="string">';' </span><span class="keyword">. </span><span class="default">$val</span><span class="keyword">;<br />  <br />  </span><span class="comment">// regularexpression to find the keys<br />  </span><span class="default">$keyreg </span><span class="keyword">= </span><span class="string">'/;([^|{}"]+)\|/'</span><span class="keyword">;<br />  <br />  </span><span class="comment">// find all keys<br />  </span><span class="default">$matches </span><span class="keyword">= array();<br />  </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="default">$keyreg</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br />  <br />  </span><span class="comment">// only go further if we found some keys<br />  </span><span class="keyword">if (isset(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) {<br />    </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />    <br />    </span><span class="comment">// find the values by splitting the input on the key regular expression<br />    </span><span class="default">$values </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="default">$keyreg</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />    <br />    </span><span class="comment">// unshift the first value since it's always empty (due to our semicolon prefix)<br />    </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">) &gt; </span><span class="default">1</span><span class="keyword">) {<br />      </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">);<br />    }<br />    <br />    </span><span class="comment">// combine the $keys and $values<br />    </span><span class="default">$result </span><span class="keyword">= </span><span class="default">array_combine</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">);<br />  }<br />  <br />  return </span><span class="default">$result</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="79244">  <div class="votes">
    <div id="Vu79244">
    <a href="https://www.php.net/manual/vote-note.php?id=79244&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd79244">
    <a href="https://www.php.net/manual/vote-note.php?id=79244&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V79244" title="57% like this...">
    1
    </div>
  </div>
  <a href="function.session-decode.php.html#79244" class="name">
  <strong class="user"><em>deminy at deminy dot net</em></strong></a><a class="genanchor" href="function.session-decode.php.html#79244"> &para;</a><div class="date" title="2007-11-16 01:24"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom79244">
<div class="phpcode"><code><span class="html">1. Reply to ac's post:<br /><br />As I mentioned at <a href="http://us.php.net/manual/en/function.unserialize.php#76977" rel="nofollow" target="_blank">http://us.php.net/manual/en/function.unserialize.php#76977</a> , the regular expression used to unserialize a PHP session data won't work if the session data contains string variable which contains character '|'.<br /><br />Here is a simple example I just come up with to show when the function unserializesession() won't work.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">unserializesession</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />    </span><span class="default">$vars</span><span class="keyword">=</span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">'/([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff^|]*)\|/'</span><span class="keyword">,<br />              </span><span class="default">$data</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">PREG_SPLIT_NO_EMPTY </span><span class="keyword">| </span><span class="default">PREG_SPLIT_DELIM_CAPTURE</span><span class="keyword">);<br />    for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$vars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]; </span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$vars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">++]]=</span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$vars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />    return </span><span class="default">$result</span><span class="keyword">;<br />}<br /><br /></span><span class="default">session_start</span><span class="keyword">();<br /><br /></span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'var'</span><span class="keyword">] = </span><span class="string">'a|b'</span><span class="keyword">; <br /></span><span class="default">$str </span><span class="keyword">= </span><span class="default">session_encode</span><span class="keyword">();<br /></span><span class="default">$arr </span><span class="keyword">= </span><span class="default">unserializesession</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br /><br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />echo </span><span class="string">"&lt;br /&gt;\n"</span><span class="keyword">;<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />2. Reply to bmorel's post:<br /><br />Your function session_real_decode() is very nice to decode session data without involving with session functions. It works in most cases, but when dealing with reference variables, there is another case which should also be handled:<br /><br />    <span class="default">&lt;?php </span><span class="keyword">case </span><span class="string">'r'</span><span class="keyword">: </span><span class="comment">/* reference  */ // R in lowercase </span><span class="default">?&gt;<br /></span><br />I found this bug on PHP 5.1.6 several months ago, but don't know if it exsits in other version of PHP or not. Also, I am not sure if similiar bugs exist when handling other data types.<br /><br />So here is my suggestion to revise the function, <br />2.1. <br />    change the switch statement from<br />    <span class="default">&lt;?php </span><span class="keyword">switch (</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$q</span><span class="keyword">]) { </span><span class="default">?&gt;<br /></span>    to<br />    <span class="default">&lt;?php </span><span class="keyword">switch (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$q</span><span class="keyword">])) { </span><span class="default">?&gt;<br /></span>2.2. <br />    In all case statements, use lowercase characters only for character comparison. For example,<br />    <span class="default">&lt;?php </span><span class="keyword">case </span><span class="string">'R'</span><span class="keyword">: </span><span class="comment">/* reference  */ </span><span class="default">?&gt;<br /></span>    should be be written as <br />    <span class="default">&lt;?php </span><span class="keyword">case </span><span class="string">'r'</span><span class="keyword">: </span><span class="comment">/* reference  */ </span><span class="default">?&gt;<br /></span><br />(I don't want to put long code here, so just leave pieces of code to save spaces)</span></code></div>
  </div>
 </div>
  <div class="note" id="42945">  <div class="votes">
    <div id="Vu42945">
    <a href="https://www.php.net/manual/vote-note.php?id=42945&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd42945">
    <a href="https://www.php.net/manual/vote-note.php?id=42945&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V42945" title="50% like this...">
    0
    </div>
  </div>
  <a href="function.session-decode.php.html#42945" class="name">
  <strong class="user"><em>sco at postmaster dot co dot uk</em></strong></a><a class="genanchor" href="function.session-decode.php.html#42945"> &para;</a><div class="date" title="2004-06-04 07:52"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom42945">
<div class="phpcode"><code><span class="html">If you're trying to access your session data from outside the regular php session functions, you might want to use WDDX as your serializer, as opposed to the normal php serializer. When your data is serialized as XML, obviously it's easy to unserialize as you please.<br /><br />WDDX seems to be a little slower, and the text string it creates is much bigger than that created by the normal php serializer, but it provides the functionality with minimal hassle.<br /><br />Donal</span></code></div>
  </div>
 </div>
  <div class="note" id="53232">  <div class="votes">
    <div id="Vu53232">
    <a href="https://www.php.net/manual/vote-note.php?id=53232&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd53232">
    <a href="https://www.php.net/manual/vote-note.php?id=53232&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V53232" title="0% like this...">
    -1
    </div>
  </div>
  <a href="function.session-decode.php.html#53232" class="name">
  <strong class="user"><em>vesely at tana dot it</em></strong></a><a class="genanchor" href="function.session-decode.php.html#53232"> &para;</a><div class="date" title="2005-05-26 03:25"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom53232">
<div class="phpcode"><code><span class="html">When using this function to manage sessions, it is MUCH<br />better to have register_globals turned off. Then one can<br />examine the session content given its id.<br /><br /><span class="default">&lt;?php<br />   $fname </span><span class="keyword">= </span><span class="default">session_save_path</span><span class="keyword">() . </span><span class="string">"/sess_" </span><span class="keyword">. </span><span class="default">$the_sid</span><span class="keyword">;<br />   if (</span><span class="default">session_decode</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fname</span><span class="keyword">)))<br />   {<br />      </span><span class="default">$vars </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />      </span><span class="default">$_SESSION </span><span class="keyword">= array();<br /><br />      </span><span class="comment">// examine $vars...<br />   </span><span class="keyword">}<br /></span><span class="default">?&gt;<br /></span><br />Depending on PHP version, you may need to have a dummy<br />session started for the code above to work. I reset the<br />$_SESSION immediately in order to avoid writing the<br />dummy session: that's needed while testing the code!</span></code></div>
  </div>
 </div>
  <div class="note" id="38221">  <div class="votes">
    <div id="Vu38221">
    <a href="https://www.php.net/manual/vote-note.php?id=38221&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd38221">
    <a href="https://www.php.net/manual/vote-note.php?id=38221&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V38221" title="0% like this...">
    -2
    </div>
  </div>
  <a href="function.session-decode.php.html#38221" class="name">
  <strong class="user"><em>njail</em></strong></a><a class="genanchor" href="function.session-decode.php.html#38221"> &para;</a><div class="date" title="2003-12-12 12:28"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom38221">
<div class="phpcode"><code><span class="html"><span class="default">&lt;?PHP<br /></span><span class="comment">// Get Session Content<br /></span><span class="default">$varsess </span><span class="keyword">= Array(</span><span class="string">'SESSION'</span><span class="keyword">);<br />for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$varsess</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />{<br />  if (</span><span class="default">is_array</span><span class="keyword">(${</span><span class="string">"_</span><span class="keyword">{</span><span class="default">$varsess</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">}))<br />  {<br />    foreach (${</span><span class="string">"_</span><span class="keyword">{</span><span class="default">$varsess</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">} as </span><span class="default">$var</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)<br />    {<br />    $</span><span class="default">$var </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />    </span><span class="comment">// print "Var :".$var." -- Value :".$val."\n&lt;br&gt;";<br />    </span><span class="keyword">}<br />  }<br />  unset(${</span><span class="string">"_</span><span class="keyword">{</span><span class="default">$varsess</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">});<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="52874">  <div class="votes">
    <div id="Vu52874">
    <a href="https://www.php.net/manual/vote-note.php?id=52874&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd52874">
    <a href="https://www.php.net/manual/vote-note.php?id=52874&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V52874" title="40% like this...">
    -1
    </div>
  </div>
  <a href="function.session-decode.php.html#52874" class="name">
  <strong class="user"><em>fabrizio dot messina at gmail dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#52874"> &para;</a><div class="date" title="2005-05-16 06:40"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom52874">
<div class="phpcode"><code><span class="html">this function _really_ split and decode session data:<br /><br />function unserializesession($data) {<br />   $vars=preg_split('/([a-zA-Z0-9]+)\|/',$data,-1,PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);<br />   for($i=0; $vars[$i]; $i++) {<br />       $result[$vars[$i++]]=unserialize($vars[$i]);       <br />   }<br />   return $result;<br />}<br /><br />the difference from previously posted 'unserializesession' function is the regular expression inside function preg_split ('[a-zA-Z0-9]+' vs  '[a-z,A-Z]+' )</span></code></div>
  </div>
 </div>
  <div class="note" id="101687">  <div class="votes">
    <div id="Vu101687">
    <a href="https://www.php.net/manual/vote-note.php?id=101687&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd101687">
    <a href="https://www.php.net/manual/vote-note.php?id=101687&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V101687" title="33% like this...">
    -2
    </div>
  </div>
  <a href="function.session-decode.php.html#101687" class="name">
  <strong class="user"><em>jason at joeymail dot net</em></strong></a><a class="genanchor" href="function.session-decode.php.html#101687"> &para;</a><div class="date" title="2011-01-04 04:23"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom101687">
<div class="phpcode"><code><span class="html">Yet another attempt a wheel re-invention, using match with offsets rather than split...<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">unserializesession</span><span class="keyword">( </span><span class="default">$data </span><span class="keyword">)<br />{<br />    if(  </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">)<br />    {<br />        return array();<br />    }<br />    <br />    </span><span class="comment">// match all the session keys and offsets<br />    </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/(^|;|\})([a-zA-Z0-9_]+)\|/i'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">$matchesarray</span><span class="keyword">, </span><span class="default">PREG_OFFSET_CAPTURE</span><span class="keyword">);<br /><br />    </span><span class="default">$returnArray </span><span class="keyword">= array();<br /><br />    </span><span class="default">$lastOffset </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />    </span><span class="default">$currentKey </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />    foreach ( </span><span class="default">$matchesarray</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] as </span><span class="default">$value </span><span class="keyword">)<br />    {<br />        </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />        if(!</span><span class="default">is_null</span><span class="keyword">( </span><span class="default">$lastOffset</span><span class="keyword">))<br />        {<br />            </span><span class="default">$valueText </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$lastOffset</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">- </span><span class="default">$lastOffset </span><span class="keyword">);<br />            </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">] = </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$valueText</span><span class="keyword">);<br />        }<br />        </span><span class="default">$currentKey </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br /><br />        </span><span class="default">$lastOffset </span><span class="keyword">= </span><span class="default">$offset </span><span class="keyword">+ </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$currentKey </span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">;<br />    }<br /><br />    </span><span class="default">$valueText </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$lastOffset </span><span class="keyword">);<br />    </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">] = </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$valueText</span><span class="keyword">);<br />    <br />    return </span><span class="default">$returnArray</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="57897">  <div class="votes">
    <div id="Vu57897">
    <a href="https://www.php.net/manual/vote-note.php?id=57897&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd57897">
    <a href="https://www.php.net/manual/vote-note.php?id=57897&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V57897" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.session-decode.php.html#57897" class="name">
  <strong class="user"><em>erwinmoller at xs4all dot nl</em></strong></a><a class="genanchor" href="function.session-decode.php.html#57897"> &para;</a><div class="date" title="2005-10-18 07:25"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom57897">
<div class="phpcode"><code><span class="html">The regExp-method describe earlier doesn't work under all conditions.<br /><br />If I feed this:<br />voornaam|s:8:"Ai|;\'\"";achternaam|s:6:"werrwe";leeftijd|i:44;<br /><br />I get this:<br />array(4) {<br />  ["voornaam"]=&gt;<br />  bool(false)<br />  ["Ai"]=&gt;<br />  bool(false)<br />  ["achternaam"]=&gt;<br />  string(6) "werrwe"<br />  ["leeftijd"]=&gt;<br />  int(44)<br />}<br /><br />while I expected:<br />array(3) {<br />  ["voornaam"]=&gt;<br />  string(8) "Ai|;\'\""<br />  ["achternaam"]=&gt;<br />  string(6) "werrwe"<br />  ["leeftijd"]=&gt;<br />  int(44)<br />}<br /><br />I think the | is messing things up. :-/</span></code></div>
  </div>
 </div>
  <div class="note" id="55307">  <div class="votes">
    <div id="Vu55307">
    <a href="https://www.php.net/manual/vote-note.php?id=55307&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd55307">
    <a href="https://www.php.net/manual/vote-note.php?id=55307&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V55307" title="33% like this...">
    -1
    </div>
  </div>
  <a href="function.session-decode.php.html#55307" class="name">
  <strong class="user"><em>brett at brettbrewer dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#55307"> &para;</a><div class="date" title="2005-07-29 11:25"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom55307">
<div class="phpcode"><code><span class="html">I have made a minor change to fabrizio's (et all) version of the unserializesession function because it was choking on underscores in my variable names.  Here is the correct version which should account for ALL possible PHP variable names:<br /><br />function unserializesession($data) {<br />   $vars=preg_split(<br />             '/([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)\|/',<br />             $data,-1,PREG_SPLIT_NO_EMPTY |                 <br />              PREG_SPLIT_DELIM_CAPTURE<br />             );<br />   for($i=0; $vars[$i]; $i++) {<br />       $result[$vars[$i++]]=unserialize($vars[$i]);     <br />   }<br />   return $result;<br />}<br /><br />Please note that I had to split the preg_split function call above into 4 lines due to the limitations of this forum. This version changes the regex used to find variable names so that it complies with the specs for  variable names as specified in the PHP manual at <a href="http://us3.php.net/manual/en/language.variables.php." rel="nofollow" target="_blank">http://us3.php.net/manual/en/language.variables.php.</a> I just took the regex directly from the PHP manual pages where they give the regex equivalent for a valid variable name as: <br /><br />[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*<br /><br />Anyway, this seems to work great for me now, even on gigantic strings of encoded session data.</span></code></div>
  </div>
 </div>
  <div class="note" id="78640">  <div class="votes">
    <div id="Vu78640">
    <a href="https://www.php.net/manual/vote-note.php?id=78640&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd78640">
    <a href="https://www.php.net/manual/vote-note.php?id=78640&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V78640" title="25% like this...">
    -2
    </div>
  </div>
  <a href="function.session-decode.php.html#78640" class="name">
  <strong class="user"><em>ac</em></strong></a><a class="genanchor" href="function.session-decode.php.html#78640"> &para;</a><div class="date" title="2007-10-20 07:46"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom78640">
<div class="phpcode"><code><span class="html">this solved my | problem:<br /><br />function unserializesession($data) {<br />    $vars=preg_split('/([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff^|]*)\|/',<br />              $data,-1,PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);<br />    for($i=0; $vars[$i]; $i++) $result[$vars[$i++]]=unserialize($vars[$i]);<br />    return $result;<br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="68155">  <div class="votes">
    <div id="Vu68155">
    <a href="https://www.php.net/manual/vote-note.php?id=68155&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd68155">
    <a href="https://www.php.net/manual/vote-note.php?id=68155&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V68155" title="0% like this...">
    -4
    </div>
  </div>
  <a href="function.session-decode.php.html#68155" class="name">
  <strong class="user"><em>xueron at gmail dot com</em></strong></a><a class="genanchor" href="function.session-decode.php.html#68155"> &para;</a><div class="date" title="2006-07-15 09:30"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom68155">
<div class="phpcode"><code><span class="html">a perl reg:<br /><br />$s = session_encoded_value;<br />%res = $s =~ /([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)\|([^\|]*[\;\}])/g;</span></code></div>
  </div>
 </div>
  <div class="note" id="61177">  <div class="votes">
    <div id="Vu61177">
    <a href="https://www.php.net/manual/vote-note.php?id=61177&amp;page=function.session-decode&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd61177">
    <a href="https://www.php.net/manual/vote-note.php?id=61177&amp;page=function.session-decode&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V61177" title="0% like this...">
    -6
    </div>
  </div>
  <a href="function.session-decode.php.html#61177" class="name">
  <strong class="user"><em>nero321 at zmail dot sk</em></strong></a><a class="genanchor" href="function.session-decode.php.html#61177"> &para;</a><div class="date" title="2006-01-27 05:01"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom61177">
<div class="phpcode"><code><span class="html">Another solution for decoding session string to "$_SESSION"-like array:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="comment">// returns decoded string as arrays of variables<br />//   or false on error (when session_decode returns false)<br /></span><span class="keyword">function </span><span class="default">DecodeSession</span><span class="keyword">(</span><span class="default">$sess_string</span><span class="keyword">)<br />{<br />    </span><span class="comment">// save current session data<br />    //   and flush $_SESSION array<br />    </span><span class="default">$old </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />    </span><span class="default">$_SESSION </span><span class="keyword">= array();<br /><br />    </span><span class="comment">// try to decode passed string<br />    </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">session_decode</span><span class="keyword">(</span><span class="default">$sess_string</span><span class="keyword">);<br />    if (!</span><span class="default">$ret</span><span class="keyword">) {<br />        </span><span class="comment">// if passed string is not session data,<br />        //   retrieve saved (old) session data<br />        //   and return false<br />        </span><span class="default">$_SESSION </span><span class="keyword">= array();<br />        </span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">$old</span><span class="keyword">;<br /><br />        return </span><span class="default">false</span><span class="keyword">;<br />    }<br /><br />    </span><span class="comment">// save decoded session data to sess_array<br />    //   and flush $_SESSION array<br />    </span><span class="default">$sess_array </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />    </span><span class="default">$_SESSION </span><span class="keyword">= array();<br /><br />    </span><span class="comment">// restore old session data<br />    </span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">$old</span><span class="keyword">;<br /><br />    </span><span class="comment">// return decoded session data<br />    </span><span class="keyword">return </span><span class="default">$sess_array</span><span class="keyword">;<br />}<br /><br /></span><span class="default">?&gt;<br /></span><br />Example of use:<br /><br /><span class="default">&lt;?php<br /><br />$sarr </span><span class="keyword">= </span><span class="default">DecodeSession</span><span class="keyword">(</span><span class="default">$sess_str</span><span class="keyword">);<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$sarr</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;<br /></span><br />But I have not tested performance.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=function.session-decode&amp;redirect=https://www.php.net/manual/ru/function.session-decode.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.session.php.html">Функции для работы с сессиями</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.session-abort.php.html" title="session_&#8203;abort">session_&#8203;abort</a>
                        </li>
                                                <li class="">
                            <a href="function.session-cache-expire.php.html" title="session_&#8203;cache_&#8203;expire">session_&#8203;cache_&#8203;expire</a>
                        </li>
                                                <li class="">
                            <a href="function.session-cache-limiter.php.html" title="session_&#8203;cache_&#8203;limiter">session_&#8203;cache_&#8203;limiter</a>
                        </li>
                                                <li class="">
                            <a href="function.session-commit.php.html" title="session_&#8203;commit">session_&#8203;commit</a>
                        </li>
                                                <li class="">
                            <a href="function.session-create-id.php.html" title="session_&#8203;create_&#8203;id">session_&#8203;create_&#8203;id</a>
                        </li>
                                                <li class="current">
                            <a href="function.session-decode.php.html" title="session_&#8203;decode">session_&#8203;decode</a>
                        </li>
                                                <li class="">
                            <a href="function.session-destroy.php.html" title="session_&#8203;destroy">session_&#8203;destroy</a>
                        </li>
                                                <li class="">
                            <a href="function.session-encode.php.html" title="session_&#8203;encode">session_&#8203;encode</a>
                        </li>
                                                <li class="">
                            <a href="function.session-gc.php.html" title="session_&#8203;gc">session_&#8203;gc</a>
                        </li>
                                                <li class="">
                            <a href="function.session-get-cookie-params.php.html" title="session_&#8203;get_&#8203;cookie_&#8203;params">session_&#8203;get_&#8203;cookie_&#8203;params</a>
                        </li>
                                                <li class="">
                            <a href="function.session-id.php.html" title="session_&#8203;id">session_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="function.session-module-name.php.html" title="session_&#8203;module_&#8203;name">session_&#8203;module_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="function.session-name.php.html" title="session_&#8203;name">session_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="function.session-regenerate-id.php.html" title="session_&#8203;regenerate_&#8203;id">session_&#8203;regenerate_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="function.session-register-shutdown.php.html" title="session_&#8203;register_&#8203;shutdown">session_&#8203;register_&#8203;shutdown</a>
                        </li>
                                                <li class="">
                            <a href="function.session-reset.php.html" title="session_&#8203;reset">session_&#8203;reset</a>
                        </li>
                                                <li class="">
                            <a href="function.session-save-path.php.html" title="session_&#8203;save_&#8203;path">session_&#8203;save_&#8203;path</a>
                        </li>
                                                <li class="">
                            <a href="function.session-set-cookie-params.php.html" title="session_&#8203;set_&#8203;cookie_&#8203;params">session_&#8203;set_&#8203;cookie_&#8203;params</a>
                        </li>
                                                <li class="">
                            <a href="function.session-set-save-handler.php.html" title="session_&#8203;set_&#8203;save_&#8203;handler">session_&#8203;set_&#8203;save_&#8203;handler</a>
                        </li>
                                                <li class="">
                            <a href="function.session-start.php.html" title="session_&#8203;start">session_&#8203;start</a>
                        </li>
                                                <li class="">
                            <a href="function.session-status.php.html" title="session_&#8203;status">session_&#8203;status</a>
                        </li>
                                                <li class="">
                            <a href="function.session-unset.php.html" title="session_&#8203;unset">session_&#8203;unset</a>
                        </li>
                                                <li class="">
                            <a href="function.session-write-close.php.html" title="session_&#8203;write_&#8203;close">session_&#8203;write_&#8203;close</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
