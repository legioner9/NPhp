<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Конструкторы и деструкторы - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="language.oop5.decon.php.html">
 <link rel="shorturl" href="https://www.php.net/oop5.decon">
 <link rel="alternate" href="https://www.php.net/oop5.decon" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="language.oop5.php.html">
 <link rel="prev" href="language.oop5.autoload.php.html">
 <link rel="next" href="language.oop5.visibility.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/language.oop5.decon.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/language.oop5.decon.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/language.oop5.decon.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/language.oop5.decon.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/language.oop5.decon.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/language.oop5.decon.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/language.oop5.decon.php" hreflang="pt_BR">
 <link rel="alternate" href="language.oop5.decon.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/language.oop5.decon.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/language.oop5.decon.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="language.oop5.visibility.php.html">
          Область видимости &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="language.oop5.autoload.php.html">
          &laquo; Автоматическая загрузка классов        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='langref.php.html'>Справочник языка</a></li>      <li><a href='language.oop5.php.html'>Классы и объекты</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/language.oop5.decon.php'>English</option>
            <option value='de/language.oop5.decon.php'>German</option>
            <option value='es/language.oop5.decon.php'>Spanish</option>
            <option value='fr/language.oop5.decon.php'>French</option>
            <option value='it/language.oop5.decon.php'>Italian</option>
            <option value='ja/language.oop5.decon.php'>Japanese</option>
            <option value='pt_BR/language.oop5.decon.php'>Brazilian Portuguese</option>
            <option value='ru/language.oop5.decon.php' selected="selected">Russian</option>
            <option value='tr/language.oop5.decon.php'>Turkish</option>
            <option value='zh/language.oop5.decon.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/language/oop5/decon.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Flanguage.oop5.decon%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="language.oop5.decon" class="sect1">
 <h2 class="title">Конструкторы и деструкторы</h2>

 <div class="sect2" id="language.oop5.decon.constructor">
  <h3 class="title">Конструктор</h3>
  <div class="methodsynopsis dc-description" id="object.construct">
   <span class="methodname"><strong>__construct</strong></span>(<span class="methodparam"><span class="type"><a href="language.types.declarations.php.html#language.types.declarations.mixed" class="type mixed">mixed</a></span> <code class="parameter">...$values</code><span class="initializer"> = &quot;&quot;</span></span>): <span class="type"><span class="type void">void</span></span></div>

  <p class="para">
   PHP разрешает разработчикам объявлять для классов методы-конструкторы.
   Метод-конструктор будет вызван на каждом
   вновь созданном экземпляре класса. Поэтому объявление
   метода-конструктора удобно для инициализации того, что может потребоваться объекту
   в начале работы.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <span class="simpara">
    Конструкторы, которые определены в классах-родителях, не вызываются автоматически,
    если дочерний класс определяет свой конструктор.
    Чтобы запустить конструктор родительского класса,
    необходимо вызвать его внутри конструктора дочернего класса —
    <span class="function"><strong>parent::__construct()</strong></span>.
    Если в дочернем классе не определён конструктор, то он будет унаследован
    от родительского класса как обычный метод (если родительский конструктор не был
    определён как приватный).
   </span>
  </p></blockquote>
  <div class="example" id="example-682">
   <p><strong>Пример #1 Конструкторы при наследовании</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />   function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">() {<br />       print </span><span style="color: #DD0000">"Конструктор класса BaseClass\n"</span><span style="color: #007700">;<br />   }<br />}<br /><br />class </span><span style="color: #0000BB">SubClass </span><span style="color: #007700">extends </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />   function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">() {<br />       </span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">__construct</span><span style="color: #007700">();<br />       print </span><span style="color: #DD0000">"Конструктор класса SubClass\n"</span><span style="color: #007700">;<br />   }<br />}<br /><br />class </span><span style="color: #0000BB">OtherSubClass </span><span style="color: #007700">extends </span><span style="color: #0000BB">BaseClass </span><span style="color: #007700">{<br />    </span><span style="color: #FF8000">// наследует конструктор класса BaseClass<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">// Конструктор класса BaseClass<br /></span><span style="color: #0000BB">$obj </span><span style="color: #007700">= new </span><span style="color: #0000BB">BaseClass</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// Конструктор класса BaseClass<br />// Конструктор класса SubClass<br /></span><span style="color: #0000BB">$obj </span><span style="color: #007700">= new </span><span style="color: #0000BB">SubClass</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// Конструктор класса BaseClass<br /></span><span style="color: #0000BB">$obj </span><span style="color: #007700">= new </span><span style="color: #0000BB">OtherSubClass</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
  <p class="para">
   В отличие от других методов, метод <a href="language.oop5.decon.php.html#object.construct" class="link">__construct()</a>
   освобождается от обычных <a href="language.oop5.basic.php.html#language.oop.lsp" class="link">правил совместимости сигнатуры</a> при наследовании.
  </p>
  <p class="para">
   Конструкторы — это обычные методы, которые вызываются при
   инстанциировании объектов, которые их содержат, или объектов дочерних классов без конструктора.
   Поэтому в них может быть определено произвольное количество аргументов, которые можно объявить обязательными,
   типизированными, со значением по умолчанию. Аргументы конструктора
   указываются в круглых скобках после имени класса.
  </p>
  <div class="example" id="example-685">
   <p><strong>Пример #2 Объявление аргументов в конструкторах</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">Point </span><span style="color: #007700">{<br />    protected </span><span style="color: #0000BB">int $x</span><span style="color: #007700">;<br />    protected </span><span style="color: #0000BB">int $y</span><span style="color: #007700">;<br /><br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">int $x</span><span style="color: #007700">, </span><span style="color: #0000BB">int $y </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">) {<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">x </span><span style="color: #007700">= </span><span style="color: #0000BB">$x</span><span style="color: #007700">;<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">y </span><span style="color: #007700">= </span><span style="color: #0000BB">$y</span><span style="color: #007700">;<br />    }<br />}<br /><br /></span><span style="color: #FF8000">// Передаём оба параметра.<br /></span><span style="color: #0000BB">$p1 </span><span style="color: #007700">= new </span><span style="color: #0000BB">Point</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">, </span><span style="color: #0000BB">5</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// Передаём только обязательные параметры. Для переменной $y установлено значение по умолчанию 0.<br /></span><span style="color: #0000BB">$p2 </span><span style="color: #007700">= new </span><span style="color: #0000BB">Point</span><span style="color: #007700">(</span><span style="color: #0000BB">4</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">// Вызываем с именованными параметрами (начиная с PHP 8.0):<br /></span><span style="color: #0000BB">$p3 </span><span style="color: #007700">= new </span><span style="color: #0000BB">Point</span><span style="color: #007700">(</span><span style="color: #0000BB">y</span><span style="color: #007700">: </span><span style="color: #0000BB">5</span><span style="color: #007700">, </span><span style="color: #0000BB">x</span><span style="color: #007700">: </span><span style="color: #0000BB">4</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
  <p class="para">
   Если у класса нет конструктора, или его конструктор не содержит обязательных параметров, скобки
   после имени класса можно не писать.
  </p>
  <div class="sect3">
   <h4 class="title">Конструкторы в старом стиле</h4>
   <p class="para">
    До PHP 8.0.0 классы в глобальном пространстве имён будут интерпретировать названный именем класса метод
    как конструктор старого стиля. Этот синтаксис
    устарел и будет вызывать ошибку уровня <strong><code>E_DEPRECATED</code></strong>, но
    всё равно эти методы будут вызываться в качестве конструктора.
    Если в классе присутствуют и метод <a href="language.oop5.decon.php.html#object.construct" class="link">__construct()</a>,
    и метод с именем класса, то в качестве конструктора будет вызван
    метод <a href="language.oop5.decon.php.html#object.construct" class="link">__construct()</a>.
   </p>
   <p class="para">
    Начиная с PHP 8.0.0 для классов внутри пространства имён и для всех классов метод, названный по имени класса, будет проигнорирован.
   </p>
   <p class="para">В новом коде всегда используют метод <a href="language.oop5.decon.php.html#object.construct" class="link">__construct()</a>.
   </p>
  </div>
  <div class="sect3" id="language.oop5.decon.constructor.promotion">
   <h4 class="title">Определение свойств объекта в конструкторе</h4>
   <p class="para">
    Начиная с PHP 8.0.0 через параметры конструктора можно устанавливать
    свойства объекта. Это распространённая практика — присваивать
    свойствам объекта значения только за счёт переданных в конструктор параметров.
    Определение свойств класса в конструкторе значительно
    сокращает количество шаблонного кода для такого случая. Пример выше можно будет
    переписать как показано ниже:
   </p>
   <div class="example" id="example-688">
    <p><strong>Пример #3 Использование определения свойств в конструкторе</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">Point </span><span style="color: #007700">{<br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(protected </span><span style="color: #0000BB">int $x</span><span style="color: #007700">, protected </span><span style="color: #0000BB">int $y </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">) {<br />    }<br />}</span></span></code></div>
    </div>

   </div>
   <p class="para">
    Если декларация аргумента конструктора включает модификатор, PHP интерпретирует
    его одновременно и как аргумент конструктора, и как свойство объекта, и автоматически
    установит свойству значение, переданное в конструктор. При этом, если не требуется
    дополнительной логики, тело конструктора можно оставить пустым. Код
    конструктора выполнится после того, как значения аргументов будут присвоены параметрам функции или свойствам класса.
   </p>
   <p class="para">
    Не все передаваемые в конструктор аргументы обязаны быть продвинутыми (устанавливающими свойства объекта).
    Продвинутые и обычные аргументы можно указывать и сопоставлять в любом порядке.
    Продвинутые аргументы не влияют на код, исполняемый в конструкторе.
   </p>
   <blockquote class="note"><p><strong class="note">Замечание</strong>: 
    <p class="para">
     Указать <a href="language.oop5.visibility.php.html" class="link">модификатор области видимости</a> (<code class="literal">public</code>,
     <code class="literal">protected</code> или <code class="literal">private</code>) — это наиболее вероятный способ
     применить продвинутую установку свойств,
     но любой другой модификатор (например, <code class="literal">readonly</code>) даст такой же эффект.
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Замечание</strong>: 
    <p class="para">
     Нельзя указывать свойствам объекта тип <span class="type"><a href="language.types.callable.php.html" class="type callable">callable</a></span>. Это связано с неоднозначностью,
     которую они представляют для движка PHP. Поэтому и аргументам конструктора,
     которые устанавливают классу свойства, также нельзя указывать тип <span class="type"><a href="language.types.callable.php.html" class="type callable">callable</a></span>. Любые другие
     <a href="language.types.declarations.php.html" class="link">декларации типов</a> допустимы.
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Замечание</strong>: 
    <p class="para">
     Поскольку при разборе кода PHP трансформирует синтаксический сахар продвинутых свойств в обычное декларирование свойств конструктора
     с теми же модификаторами видимости и типом данных, которые указаны в продвинутом аргументе,
     а также присваивает значение продвинутого аргумента и параметру функции, и свойству класса,
     все без исключения ограничения на определение аргументов конструктора будут применены как к параметрам функции, так и к свойствам класса.
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Замечание</strong>: 
    <p class="para">
     <a href="language.attributes.php.html" class="link">Атрибуты</a>, установленные для аргумента в продвинутом конструкторе,
     будут реплицированы как на аргумент, так и на свойство класса.
     Значение по умолчанию для аргумента в продвинутом конструкторе распространяется только на аргумент, а не свойство.
    </p>
   </p></blockquote>
  </div>

  <div class="sect3" id="language.oop5.decon.constructor.new">
   <h4 class="title">New в инициализации класса</h4>
   <p class="para">
    С PHP 8.1.0 объекты можно присваивать в качестве значений параметров по умолчанию,
    статических переменных и глобальных констант, а также в аргументах атрибутов.
    Объекты также можно передавать в функцию <span class="function"><a href="function.define.php.html" class="function">define()</a></span>.
   </p>
   <blockquote class="note"><p><strong class="note">Замечание</strong>: 
    <p class="para">
     При этом динамические или нестроковые имена классов или анонимных классов не разрешены.
     Использовать распаковку аргументов не разрешено.
     Неподдерживаемые выражения в качестве аргументов не разрешены.
    </p>
   </p></blockquote>
   <div class="example" id="example-691">
    <p><strong>Пример #4 Пример использования new в инициализации класса</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// Всё допустимо:<br /></span><span style="color: #007700">static </span><span style="color: #0000BB">$x </span><span style="color: #007700">= new </span><span style="color: #0000BB">Foo</span><span style="color: #007700">;<br />const </span><span style="color: #0000BB">C </span><span style="color: #007700">= new </span><span style="color: #0000BB">Foo</span><span style="color: #007700">;<br /><br />function </span><span style="color: #0000BB">test</span><span style="color: #007700">(</span><span style="color: #0000BB">$param </span><span style="color: #007700">= new </span><span style="color: #0000BB">Foo</span><span style="color: #007700">) {}<br /><br />#[</span><span style="color: #0000BB">AnAttribute</span><span style="color: #007700">(new </span><span style="color: #0000BB">Foo</span><span style="color: #007700">)]<br />class </span><span style="color: #0000BB">Test </span><span style="color: #007700">{<br />    public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(<br />        public </span><span style="color: #0000BB">$prop </span><span style="color: #007700">= new </span><span style="color: #0000BB">Foo</span><span style="color: #007700">,<br />    ) {}<br />}<br /></span><span style="color: #FF8000">// Всё недопустимо (ошибка во времени компиляции):<br /></span><span style="color: #007700">function </span><span style="color: #0000BB">test</span><span style="color: #007700">(<br />    </span><span style="color: #0000BB">$a </span><span style="color: #007700">= new (</span><span style="color: #0000BB">CLASS_NAME_CONSTANT</span><span style="color: #007700">)(), </span><span style="color: #FF8000">// динамическое имя класса<br />    </span><span style="color: #0000BB">$b </span><span style="color: #007700">= new class {}, </span><span style="color: #FF8000">// анонимный класс<br />    </span><span style="color: #0000BB">$c </span><span style="color: #007700">= new </span><span style="color: #0000BB">A</span><span style="color: #007700">(...[]), </span><span style="color: #FF8000">// распаковка аргументов<br />    </span><span style="color: #0000BB">$d </span><span style="color: #007700">= new </span><span style="color: #0000BB">B</span><span style="color: #007700">(</span><span style="color: #0000BB">$abc</span><span style="color: #007700">), </span><span style="color: #FF8000">// неподдерживаемое постоянное выражение<br /></span><span style="color: #007700">) {}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </div>

  <div class="sect3" id="language.oop5.decon.constructor.static">
   <h4 class="title">Статические методы создания объекта</h4>
   <p class="para">
    PHP поддерживает только один конструктор для класса. Однако бывает так,
    что нужно создавать разные объекты для разных входных данных.
    Рекомендуемый способ — использовать статические методы как обёртки над конструктором.
   </p>
   <div class="example" id="example-694">
    <p><strong>Пример #5 Использование статических методов для создания объектов</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">Product </span><span style="color: #007700">{<br /><br />    private ?</span><span style="color: #0000BB">int $id</span><span style="color: #007700">;<br />    private ?</span><span style="color: #0000BB">string $name</span><span style="color: #007700">;<br /><br />    private function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">(?</span><span style="color: #0000BB">int $id </span><span style="color: #007700">= </span><span style="color: #0000BB">null</span><span style="color: #007700">, ?</span><span style="color: #0000BB">string $name </span><span style="color: #007700">= </span><span style="color: #0000BB">null</span><span style="color: #007700">) {<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id </span><span style="color: #007700">= </span><span style="color: #0000BB">$id</span><span style="color: #007700">;<br />        </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name </span><span style="color: #007700">= </span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br />    }<br /><br />    public static function </span><span style="color: #0000BB">fromBasicData</span><span style="color: #007700">(</span><span style="color: #0000BB">int $id</span><span style="color: #007700">, </span><span style="color: #0000BB">string $name</span><span style="color: #007700">): static {<br />        </span><span style="color: #0000BB">$new </span><span style="color: #007700">= new static(</span><span style="color: #0000BB">$id</span><span style="color: #007700">, </span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br />        return </span><span style="color: #0000BB">$new</span><span style="color: #007700">;<br />    }<br /><br />    public static function </span><span style="color: #0000BB">fromJson</span><span style="color: #007700">(</span><span style="color: #0000BB">string $json</span><span style="color: #007700">): static {<br />        </span><span style="color: #0000BB">$data </span><span style="color: #007700">= </span><span style="color: #0000BB">json_decode</span><span style="color: #007700">(</span><span style="color: #0000BB">$json</span><span style="color: #007700">);<br />        return new static(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">], </span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]);<br />    }<br /><br />    public static function </span><span style="color: #0000BB">fromXml</span><span style="color: #007700">(</span><span style="color: #0000BB">string $xml</span><span style="color: #007700">): static {<br />        </span><span style="color: #FF8000">// Пользовательская логика.<br />        </span><span style="color: #0000BB">$data </span><span style="color: #007700">= </span><span style="color: #0000BB">convert_xml_to_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$xml</span><span style="color: #007700">);<br />        </span><span style="color: #0000BB">$new </span><span style="color: #007700">= new static();<br />        </span><span style="color: #0000BB">$new</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id </span><span style="color: #007700">= </span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">];<br />        </span><span style="color: #0000BB">$new</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name </span><span style="color: #007700">= </span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">];<br />        return </span><span style="color: #0000BB">$new</span><span style="color: #007700">;<br />    }<br />}<br /><br /></span><span style="color: #0000BB">$p1 </span><span style="color: #007700">= </span><span style="color: #0000BB">Product</span><span style="color: #007700">::</span><span style="color: #0000BB">fromBasicData</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">, </span><span style="color: #DD0000">'Widget'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$p2 </span><span style="color: #007700">= </span><span style="color: #0000BB">Product</span><span style="color: #007700">::</span><span style="color: #0000BB">fromJson</span><span style="color: #007700">(</span><span style="color: #0000BB">$some_json_string</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$p3 </span><span style="color: #007700">= </span><span style="color: #0000BB">Product</span><span style="color: #007700">::</span><span style="color: #0000BB">fromXml</span><span style="color: #007700">(</span><span style="color: #0000BB">$some_xml_string</span><span style="color: #007700">);</span></span></code></div>
    </div>

   </div>
   <p class="para">
    Конструктор можно сделать закрытым или защищённым для предотвращения его прямого вызова.
    Тогда объект класса можно будет создать только вызовом статического
    метода. Поскольку это методы того же класса, у них есть доступ ко всем его скрытым
    методам, даже если они относятся к разным экземплярам класса. Закрытый конструктор
    опционален, и может быть объявлен или не иметь смысла в разных ситуациях.
   </p>
   <p class="para">
    В примере выше три публичных статических метода показывают разные способы
    создания экземпляра объекта.
   </p>
   <ul class="simplelist">
    <li class="member">Метод <code class="code">fromBasicData()</code> принимает явные параметры, создаёт экземпляр
     класса через конструктор и возвращает объект.</li>
    <li class="member">Метод <code class="code">fromJson()</code> принимает JSON-строку, производит над ней
     преобразования, извлекает необходимые для создания объекта данные и, так же как и
     предыдущий метод, вызывает конструктор и возвращает созданный объект.</li>
    <li class="member">Метод <code class="code">fromXml()</code> принимает XML-строку, извлекает нужные данные и, так
     как в конструкторе нет обязательных параметров, вызывает его без них. После этого, так
     как ему доступны скрытые свойства, он присваивает им значения напрямую. После чего
     возвращает готовый объект.</li>
   </ul>
   <p class="para">
    Во всех трёх случаях ключевое слово <code class="code">static</code> транслируется в имя класса,
    в котором этот код вызывается. В нашем случае — в класс <code class="code">Product</code>.
   </p>
  </div>
 </div>

 <div class="sect2" id="language.oop5.decon.destructor">
  <h3 class="title">Деструкторы</h3>
  <div class="methodsynopsis dc-description" id="object.destruct">
   <span class="methodname"><strong>__destruct</strong></span>(): <span class="type"><span class="type void">void</span></span></div>

  <p class="para">
   PHP наследует концепцию деструктора, аналогичную другим объектно-ориентированным языкам, например, C++.
   Деструктор будет вызван при освобождении всех ссылок
   на объект или при завершении
   скрипта (порядок выполнения деструкторов не гарантируется).
  </p>
  <div class="example" id="example-697">
   <p><strong>Пример #6 Пример использования деструктора</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class </span><span style="color: #0000BB">MyDestructableClass<br /></span><span style="color: #007700">{<br />   function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">() {<br />       print </span><span style="color: #DD0000">"Конструктор\n"</span><span style="color: #007700">;<br />   }<br /><br />   function </span><span style="color: #0000BB">__destruct</span><span style="color: #007700">() {<br />       print </span><span style="color: #DD0000">"Уничтожается " </span><span style="color: #007700">. </span><span style="color: #0000BB">__CLASS__  </span><span style="color: #007700">. </span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />   }<br />}<br /><br /></span><span style="color: #0000BB">$obj </span><span style="color: #007700">= new </span><span style="color: #0000BB">MyDestructableClass</span><span style="color: #007700">();</span></span></code></div>
   </div>

  </div>
  <p class="para">
   Как и конструкторы, деструкторы, объявленные
   в родительском классе, не будут вызываться автоматически.
   Чтобы запустить деструктор родительского класса,
   необходимо вызвать <span class="function"><strong>parent::__destruct()</strong></span>
   в теле деструктора дочернего класса. Аналогично конструкторам, дочерний класс, в котором
   не определен деструктор, наследует его из родительского класса.
  </p>
  <p class="para">
   Деструктор будет вызван даже если скрипт был остановлен
   функцией <span class="function"><a href="function.exit.php.html" class="function">exit()</a></span>. Вызов функции <span class="function"><a href="function.exit.php.html" class="function">exit()</a></span>
   в деструкторе предотвратит запуск всех остальных процедур завершения работы.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Деструкторы, вызываемые при завершении скрипта, вызываются после отправки
    HTTP-заголовков. На этапе завершения работы скрипта
    рабочая директория SAPI (например, в Apache) может измениться.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Попытка выбросить исключение из деструктора (вызванного во время
    завершения работы скрипта) вызовет фатальную ошибку.
   </p>
  </p></blockquote>
 </div>

</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=language.oop5.decon&amp;redirect=https://www.php.net/manual/ru/language.oop5.decon.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">15 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="105368">  <div class="votes">
    <div id="Vu105368">
    <a href="https://www.php.net/manual/vote-note.php?id=105368&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd105368">
    <a href="https://www.php.net/manual/vote-note.php?id=105368&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V105368" title="69% like this...">
    150
    </div>
  </div>
  <a href="language.oop5.decon.php.html#105368" class="name">
  <strong class="user"><em>david dot scourfield at llynfi dot co dot uk</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#105368"> &para;</a><div class="date" title="2011-08-12 04:17"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom105368">
<div class="phpcode"><code><span class="html">Be aware of potential memory leaks caused by circular references within objects.  The PHP manual states "[t]he destructor method will be called as soon as all references to a particular object are removed" and this is precisely true: if two objects reference each other (or even if one object has a field that points to itself as in $this-&gt;foo = $this) then this reference will prevent the destructor being called even when there are no other references to the object at all.  The programmer can no longer access the objects, but they still stay in memory.<br /><br />Consider the following example:<br /><br /><span class="default">&lt;?php<br /><br />header</span><span class="keyword">(</span><span class="string">"Content-type: text/plain"</span><span class="keyword">);<br /><br />class </span><span class="default">Foo </span><span class="keyword">{<br />    <br />    </span><span class="comment">/**<br />     * An indentifier<br />     * @var string <br />     */<br />    </span><span class="keyword">private </span><span class="default">$name</span><span class="keyword">;<br />    </span><span class="comment">/**<br />     * A reference to another Foo object<br />     * @var Foo<br />     */<br />    </span><span class="keyword">private </span><span class="default">$link</span><span class="keyword">;<br /><br />    public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />    }<br /><br />    public function </span><span class="default">setLink</span><span class="keyword">(</span><span class="default">Foo $link</span><span class="keyword">){<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">link </span><span class="keyword">= </span><span class="default">$link</span><span class="keyword">;<br />    }<br /><br />    public function </span><span class="default">__destruct</span><span class="keyword">() {<br />        echo </span><span class="string">'Destroying: '</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">, </span><span class="default">PHP_EOL</span><span class="keyword">;<br />    }<br />}<br /><br /></span><span class="comment">// create two Foo objects:<br /></span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 1'</span><span class="keyword">);<br /></span><span class="default">$bar </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 2'</span><span class="keyword">);<br /><br /></span><span class="comment">// make them point to each other<br /></span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">setLink</span><span class="keyword">(</span><span class="default">$bar</span><span class="keyword">);<br /></span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">setLink</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br /><br /></span><span class="comment">// destroy the global references to them<br /></span><span class="default">$foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /></span><span class="default">$bar </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /><br /></span><span class="comment">// we now have no way to access Foo 1 or Foo 2, so they OUGHT to be __destruct()ed<br />// but they are not, so we get a memory leak as they are still in memory.<br />//<br />// Uncomment the next line to see the difference when explicitly calling the GC:<br />// gc_collect_cycles();<br />// <br />// see also: <a href="http://www.php.net/manual/en/features.gc.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/features.gc.php</a><br />// <br /><br />// create two more Foo objects, but DO NOT set their internal Foo references<br />// so nothing except the vars $foo and $bar point to them:<br /></span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 3'</span><span class="keyword">);<br /></span><span class="default">$bar </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 4'</span><span class="keyword">);<br /><br /></span><span class="comment">// destroy the global references to them<br /></span><span class="default">$foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /></span><span class="default">$bar </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /><br /></span><span class="comment">// we now have no way to access Foo 3 or Foo 4 and as there are no more references<br />// to them anywhere, their __destruct() methods are automatically called here,<br />// BEFORE the next line is executed:<br /><br /></span><span class="keyword">echo </span><span class="string">'End of script'</span><span class="keyword">, </span><span class="default">PHP_EOL</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;<br /></span><br />This will output:<br /><br />Destroying: Foo 3<br />Destroying: Foo 4<br />End of script<br />Destroying: Foo 1<br />Destroying: Foo 2<br /><br />But if we uncomment the gc_collect_cycles(); function call in the middle of the script, we get:<br /><br />Destroying: Foo 2<br />Destroying: Foo 1<br />Destroying: Foo 3<br />Destroying: Foo 4<br />End of script<br /><br />As may be desired.<br /><br />NOTE: calling gc_collect_cycles() does have a speed overhead, so only use it if you feel you need to.</span></code></div>
  </div>
 </div>
  <div class="note" id="121521">  <div class="votes">
    <div id="Vu121521">
    <a href="https://www.php.net/manual/vote-note.php?id=121521&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121521">
    <a href="https://www.php.net/manual/vote-note.php?id=121521&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121521" title="64% like this...">
    28
    </div>
  </div>
  <a href="language.oop5.decon.php.html#121521" class="name">
  <strong class="user"><em>domger at freenet dot de</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#121521"> &para;</a><div class="date" title="2017-08-14 07:53"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121521">
<div class="phpcode"><code><span class="html">The __destruct magic method must be public. <br /><br />public function __destruct()<br />{<br />    ;<br />}<br /><br />The method will automatically be called externally to the instance.  Declaring __destruct as protected or private will result in a warning and the magic method will not be called. <br /><br />Note: In PHP 5.3.10 i saw strange side effects while some Destructors were declared as protected.</span></code></div>
  </div>
 </div>
  <div class="note" id="86423">  <div class="votes">
    <div id="Vu86423">
    <a href="https://www.php.net/manual/vote-note.php?id=86423&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd86423">
    <a href="https://www.php.net/manual/vote-note.php?id=86423&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V86423" title="61% like this...">
    24
    </div>
  </div>
  <a href="language.oop5.decon.php.html#86423" class="name">
  <strong class="user"><em>spleen</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#86423"> &para;</a><div class="date" title="2008-10-17 04:35"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom86423">
<div class="phpcode"><code><span class="html">It's always the easy things that get you -<br /><br />Being new to OOP, it took me quite a while to figure out that there are TWO underscores in front of the word __construct.<br /><br />It is __construct<br />Not _construct<br /><br />Extremely obvious once you figure it out, but it can be sooo frustrating until you do.<br /><br />I spent quite a bit of needless time debugging working code.<br /><br />I even thought about it a few times, thinking it looked a little long in the examples, but at the time that just seemed silly(always thinking "oh somebody would have made that clear if it weren't just a regular underscore...")<br /><br />All the manuals I looked at, all the tuturials I read, all the examples I browsed through  - not once did anybody mention this!  <br /><br />(please don't tell me it's explained somewhere on this page and I just missed it,  you'll only add to my pain.)<br /><br />I hope this helps somebody else!</span></code></div>
  </div>
 </div>
  <div class="note" id="124619">  <div class="votes">
    <div id="Vu124619">
    <a href="https://www.php.net/manual/vote-note.php?id=124619&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124619">
    <a href="https://www.php.net/manual/vote-note.php?id=124619&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124619" title="60% like this...">
    7
    </div>
  </div>
  <a href="language.oop5.decon.php.html#124619" class="name">
  <strong class="user"><em>iwwp at outlook dot com</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#124619"> &para;</a><div class="date" title="2020-01-16 07:58"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom124619">
<div class="phpcode"><code><span class="html">To better understand the __destrust method:<br /><br />class A {<br />    protected $id;<br /><br />    public function __construct($id)<br />    {<br />        $this-&gt;id = $id;<br />        echo "construct {$this-&gt;id}\n";<br />    }<br /><br />    public function __destruct()<br />    {<br />        echo "destruct {$this-&gt;id}\n";<br />    }<br />}<br /><br />$a = new A(1);<br />echo "-------------\n";<br />$aa = new A(2);<br />echo "=============\n";<br /><br />The output content:<br /><br />construct 1<br />-------------<br />construct 2<br />=============<br />destruct 2<br />destruct 1</span></code></div>
  </div>
 </div>
  <div class="note" id="76710">  <div class="votes">
    <div id="Vu76710">
    <a href="https://www.php.net/manual/vote-note.php?id=76710&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd76710">
    <a href="https://www.php.net/manual/vote-note.php?id=76710&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V76710" title="58% like this...">
    10
    </div>
  </div>
  <a href="language.oop5.decon.php.html#76710" class="name">
  <strong class="user"><em>prieler at abm dot at</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#76710"> &para;</a><div class="date" title="2007-07-27 12:42"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom76710">
<div class="phpcode"><code><span class="html">i have written a quick example about the order of destructors and shutdown functions in php 5.2.1:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">destruction </span><span class="keyword">{<br />    var </span><span class="default">$name</span><span class="keyword">;<br /><br />    function </span><span class="default">destruction</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />        </span><span class="default">register_shutdown_function</span><span class="keyword">(array(&amp;</span><span class="default">$this</span><span class="keyword">, </span><span class="string">"shutdown"</span><span class="keyword">));<br />    }<br /><br />    function </span><span class="default">shutdown</span><span class="keyword">() {<br />        echo </span><span class="string">'shutdown: '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />    }<br /><br />    function </span><span class="default">__destruct</span><span class="keyword">() {<br />        echo </span><span class="string">'destruct: '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />    }<br />}<br /><br /></span><span class="default">$a </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'a: global 1'</span><span class="keyword">);<br /><br />function </span><span class="default">test</span><span class="keyword">() {<br />    </span><span class="default">$b </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'b: func 1'</span><span class="keyword">);<br />    </span><span class="default">$c </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'c: func 2'</span><span class="keyword">);<br />}<br /></span><span class="default">test</span><span class="keyword">();<br /><br /></span><span class="default">$d </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'d: global 2'</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;<br /></span><br />this will output:<br />shutdown: a: global 1<br />shutdown: b: func 1<br />shutdown: c: func 2<br />shutdown: d: global 2<br />destruct: b: func 1<br />destruct: c: func 2<br />destruct: d: global 2<br />destruct: a: global 1<br /><br />conclusions:<br />destructors are always called on script end.<br />destructors are called in order of their "context": first functions, then global objects<br />objects in function context are deleted in order as they are set (older objects first).<br />objects in global context are deleted in reverse order (older objects last)<br /><br />shutdown functions are called before the destructors.<br />shutdown functions are called in there "register" order. ;)<br /><br />regards, J</span></code></div>
  </div>
 </div>
  <div class="note" id="126914">  <div class="votes">
    <div id="Vu126914">
    <a href="https://www.php.net/manual/vote-note.php?id=126914&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd126914">
    <a href="https://www.php.net/manual/vote-note.php?id=126914&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V126914" title="56% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.decon.php.html#126914" class="name">
  <strong class="user"><em>mmulej at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#126914"> &para;</a><div class="date" title="2022-03-10 04:56"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom126914">
<div class="phpcode"><code><span class="html">*&lt;Double post&gt; I can't edit my previous note to elaborate on modifiers. Please excuse me.*<br /><br />If both parent and child classes have a method with the same name defined, and it is called in parent's constructor, using `parent::__construct()` will call the method in the child.<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />    public function </span><span class="default">__construct</span><span class="keyword">() {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">();<br />    }<br />    public function </span><span class="default">method</span><span class="keyword">() {<br />        echo </span><span class="string">'A' </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br />    }<br />}<br />class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />    public function </span><span class="default">__construct</span><span class="keyword">() {<br />        </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();<br />    }<br />}<br />class </span><span class="default">C </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />    public function </span><span class="default">__construct</span><span class="keyword">() {<br />        </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();<br />    }<br />    public function </span><span class="default">method</span><span class="keyword">() {<br />        echo </span><span class="string">'C' </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br />    }<br />}<br /></span><span class="default">$b </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">; </span><span class="comment">// A<br /></span><span class="default">$c </span><span class="keyword">= new </span><span class="default">C</span><span class="keyword">; </span><span class="comment">// C<br /><br /></span><span class="default">?&gt;<br /></span><br />In this example both A::method and C::method are public.<br /><br />You may change A::method to protected, and C::method to protected or public and it will still work the same.<br /><br />If however you set A::method as private, it doesn't matter whether C::method is private, protected or public. Both $b and $c will echo 'A'.</span></code></div>
  </div>
 </div>
  <div class="note" id="108598">  <div class="votes">
    <div id="Vu108598">
    <a href="https://www.php.net/manual/vote-note.php?id=108598&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd108598">
    <a href="https://www.php.net/manual/vote-note.php?id=108598&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V108598" title="54% like this...">
    7
    </div>
  </div>
  <a href="language.oop5.decon.php.html#108598" class="name">
  <strong class="user"><em>Per Persson</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#108598"> &para;</a><div class="date" title="2012-05-09 01:57"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom108598">
<div class="phpcode"><code><span class="html">As of PHP 5.3.10 destructors are not run on shutdown caused by fatal errors.<br /><br />For example:<br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Logger<br /></span><span class="keyword">{<br />    protected </span><span class="default">$rows </span><span class="keyword">= array();<br /><br />    public function </span><span class="default">__destruct</span><span class="keyword">()<br />    {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">();<br />    }<br /><br />    public function </span><span class="default">log</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">)<br />    {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />    }<br /><br />    public function </span><span class="default">save</span><span class="keyword">()<br />    {<br />        echo </span><span class="string">'&lt;ul&gt;'</span><span class="keyword">;<br />        foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">)<br />        {<br />            echo </span><span class="string">'&lt;li&gt;'</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">, </span><span class="string">'&lt;/li&gt;'</span><span class="keyword">;<br />        }<br />        echo </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">;<br />    }<br />}<br /><br /></span><span class="default">$logger </span><span class="keyword">= new </span><span class="default">Logger</span><span class="keyword">;<br /></span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'Before'</span><span class="keyword">);<br /><br /></span><span class="default">$nonset</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">();<br /><br /></span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'After'</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />Without the $nonset-&gt;foo(); line, Before and After will both be printed, but with the line neither will be printed.<br /><br />One can however register the destructor or another method as a shutdown function:<br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Logger<br /></span><span class="keyword">{<br />    protected </span><span class="default">$rows </span><span class="keyword">= array();<br /><br />    public function </span><span class="default">__construct</span><span class="keyword">()<br />    {<br />        </span><span class="default">register_shutdown_function</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">, </span><span class="string">'__destruct'</span><span class="keyword">));<br />    }<br />    <br />    public function </span><span class="default">__destruct</span><span class="keyword">()<br />    {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">();<br />    }<br />    <br />    public function </span><span class="default">log</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">)<br />    {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />    }<br />    <br />    public function </span><span class="default">save</span><span class="keyword">()<br />    {<br />        echo </span><span class="string">'&lt;ul&gt;'</span><span class="keyword">;<br />        foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">)<br />        {<br />            echo </span><span class="string">'&lt;li&gt;'</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">, </span><span class="string">'&lt;/li&gt;'</span><span class="keyword">;<br />        }<br />        echo </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">;<br />    }<br />}<br /><br /></span><span class="default">$logger </span><span class="keyword">= new </span><span class="default">Logger</span><span class="keyword">;<br /></span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'Before'</span><span class="keyword">);<br /><br /></span><span class="default">$nonset</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">();<br /><br /></span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'After'</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span>Now Before will be printed, but not After, so you can see that a shutdown occurred after Before.</span></code></div>
  </div>
 </div>
  <div class="note" id="113052">  <div class="votes">
    <div id="Vu113052">
    <a href="https://www.php.net/manual/vote-note.php?id=113052&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113052">
    <a href="https://www.php.net/manual/vote-note.php?id=113052&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113052" title="53% like this...">
    4
    </div>
  </div>
  <a href="language.oop5.decon.php.html#113052" class="name">
  <strong class="user"><em>Yousef Ismaeil cliprz[At]gmail[Dot]com</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#113052"> &para;</a><div class="date" title="2013-08-22 09:06"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113052">
<div class="phpcode"><code><span class="html"><span class="default">&lt;?php<br /><br /></span><span class="comment">/**<br /> * a funny example Mobile class<br /> * <br /> * @author Yousef Ismaeil Cliprz[At]gmail[Dot]com<br /> */<br /><br /></span><span class="keyword">class </span><span class="default">Mobile </span><span class="keyword">{<br /><br />    </span><span class="comment">/**<br />     * Some device properties<br />     * <br />     * @var string<br />     * @access public<br />     */<br />    </span><span class="keyword">public </span><span class="default">$deviceName</span><span class="keyword">,</span><span class="default">$deviceVersion</span><span class="keyword">,</span><span class="default">$deviceColor</span><span class="keyword">;<br />    <br />    </span><span class="comment">/**<br />     * Set some values for Mobile::properties<br />     * <br />     * @param string device name<br />     * @param string device version<br />     * @param string device color<br />     */<br />    </span><span class="keyword">public function </span><span class="default">__construct </span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$version</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">) {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceVersion </span><span class="keyword">= </span><span class="default">$version</span><span class="keyword">;<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceColor </span><span class="keyword">= </span><span class="default">$color</span><span class="keyword">;<br />        echo </span><span class="string">"The "</span><span class="keyword">.</span><span class="default">__CLASS__</span><span class="keyword">.</span><span class="string">" class is stratup.&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />    }<br />    <br />    </span><span class="comment">/**<br />     * Some Output<br />     * <br />     * @access public<br />     */<br />    </span><span class="keyword">public function </span><span class="default">printOut </span><span class="keyword">() {<br />        echo </span><span class="string">'I have a '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName<br />            </span><span class="keyword">.</span><span class="string">' version '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceVersion<br />            </span><span class="keyword">.</span><span class="string">' my device color is : '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceColor</span><span class="keyword">;<br />    }<br />    <br />    </span><span class="comment">/**<br />     * Umm only for example we will remove Mobile::$deviceName Hum not unset only to check how __destruct working <br />     * <br />     * @access public<br />     */<br />    </span><span class="keyword">public function </span><span class="default">__destruct </span><span class="keyword">() {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName </span><span class="keyword">= </span><span class="string">'Removed'</span><span class="keyword">;<br />        echo </span><span class="string">'&lt;br /&gt;&lt;br /&gt;Dumpping Mobile::deviceName to make sure its removed, Olay :'</span><span class="keyword">;<br />        </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName</span><span class="keyword">);<br />        echo </span><span class="string">"&lt;br /&gt;The "</span><span class="keyword">.</span><span class="default">__CLASS__</span><span class="keyword">.</span><span class="string">" class is shutdown."</span><span class="keyword">;<br />    }<br /><br />}<br /><br /></span><span class="comment">// Oh ya instance<br /></span><span class="default">$mob </span><span class="keyword">= new </span><span class="default">Mobile</span><span class="keyword">(</span><span class="string">'iPhone'</span><span class="keyword">,</span><span class="string">'5'</span><span class="keyword">,</span><span class="string">'Black'</span><span class="keyword">);<br /><br /></span><span class="comment">// print output<br /></span><span class="default">$mob</span><span class="keyword">-&gt;</span><span class="default">printOut</span><span class="keyword">();<br /><br /></span><span class="default">?&gt;<br /></span><br />The Mobile class is stratup.<br /><br />I have a iPhone version 5 my device color is : Black<br /><br />Dumpping Mobile::deviceName to make sure its removed, Olay :<br />string 'Removed' (length=7)<br /><br />The Mobile class is shutdown.</span></code></div>
  </div>
 </div>
  <div class="note" id="82577">  <div class="votes">
    <div id="Vu82577">
    <a href="https://www.php.net/manual/vote-note.php?id=82577&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd82577">
    <a href="https://www.php.net/manual/vote-note.php?id=82577&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V82577" title="52% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.decon.php.html#82577" class="name">
  <strong class="user"><em>bolshun at mail dot ru</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#82577"> &para;</a><div class="date" title="2008-04-16 06:13"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom82577">
<div class="phpcode"><code><span class="html">Ensuring that instance of some class will be available in destructor of some other class is easy: just keep a reference to that instance in this other class.</span></code></div>
  </div>
 </div>
  <div class="note" id="128839">  <div class="votes">
    <div id="Vu128839">
    <a href="https://www.php.net/manual/vote-note.php?id=128839&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd128839">
    <a href="https://www.php.net/manual/vote-note.php?id=128839&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V128839" title="no votes...">
    0
    </div>
  </div>
  <a href="language.oop5.decon.php.html#128839" class="name">
  <strong class="user"><em>Hayley Watson</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#128839"> &para;</a><div class="date" title="2023-08-29 03:11"><strong>5 months ago</strong></div>
  <div class="text" id="Hcom128839">
<div class="phpcode"><code><span class="html">There are other advantages to using static factory methods to wrap object construction instead of bare constructor calls.<br /><br />As well as allowing for different methods to use in different scenarios, with more relevant names both for the methods and the parameters and without the constructor having to handle different sets of arguments of different types:<br /><br />* You can do all your input validation before attempting to construct the object.<br />* The object itself can bypass that input validation when constructing new instances of its own class, since you can ensure that it knows what it's doing.<br />* With input validation/preprocessing moved to the factory methods, the constructor itself can often be reduced to "set these properties to these arguments", meaning the constructor promotion syntax becomes more useful.<br />* Having been hidden away from users, the constructor's signature can be a bit uglier without becoming a pain for them. Heh.<br />* Static methods can be lifted and passed around as first class closures, to be called in the normal fashion wherever functions can be called, without the special "new" syntax.<br />* The factory method need not return a new instance of that exact class. It could return a pre-existing instance that would do the same job as the new one would (especially useful in the case of immutable "value type" objects by reducing duplication); or a simpler or more specific subclass to do the job with less overhead than a more generic instance of the original class. Returning a subclass means LSP still holds.</span></code></div>
  </div>
 </div>
  <div class="note" id="95569">  <div class="votes">
    <div id="Vu95569">
    <a href="https://www.php.net/manual/vote-note.php?id=95569&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd95569">
    <a href="https://www.php.net/manual/vote-note.php?id=95569&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V95569" title="52% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.decon.php.html#95569" class="name">
  <strong class="user"><em>Jonathon Hibbard</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#95569"> &para;</a><div class="date" title="2010-01-09 04:32"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom95569">
<div class="phpcode"><code><span class="html">Please be aware of when using __destruct() in which you are unsetting variables...<br /><br />Consider the following code:<br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">my_class </span><span class="keyword">{<br />  public </span><span class="default">$error_reporting </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br /><br />  function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$error_reporting </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />    </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error_reporting </span><span class="keyword">= </span><span class="default">$error_reporting</span><span class="keyword">;<br />  }<br /><br />  function </span><span class="default">__destruct</span><span class="keyword">() {<br />    if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error_reporting </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">show_report</span><span class="keyword">();<br />    unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error_reporting</span><span class="keyword">);<br />  }<br /></span><span class="default">?&gt;<br /></span><br />The above will result in an error:<br />Notice: Undefined property: my_class::$error_reporting in my_class.php on line 10<br /><br />It appears as though the variable will be unset BEFORE it actually can execute the if statement.  Removing the unset will fix this.  It's not needed anyways as PHP will release everything anyways, but just in case you run across this, you know why ;)</span></code></div>
  </div>
 </div>
  <div class="note" id="80107">  <div class="votes">
    <div id="Vu80107">
    <a href="https://www.php.net/manual/vote-note.php?id=80107&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd80107">
    <a href="https://www.php.net/manual/vote-note.php?id=80107&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V80107" title="52% like this...">
    1
    </div>
  </div>
  <a href="language.oop5.decon.php.html#80107" class="name">
  <strong class="user"><em>david at synatree dot com</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#80107"> &para;</a><div class="date" title="2007-12-29 01:26"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom80107">
<div class="phpcode"><code><span class="html">When a script is in the process of die()ing, you can't count on the order in which __destruct() will be called.<br /><br />For a script I have been working on, I wanted to do transparent low-level encryption of any outgoing data.  To accomplish this, I used a global singleton class configured like this:<br /><br />class EncryptedComms<br />{<br />    private $C;<br />    private $objs = array();<br />    private static $_me;<br />    <br />    public static function destroyAfter(&amp;$obj)<br />    {<br />        self::getInstance()-&gt;objs[] =&amp; $obj;<br />        /*<br />            Hopefully by forcing a reference to another object to exist <br />            inside this class, the referenced object will need to be destroyed<br />            before garbage collection can occur on this object.  This will force <br />            this object's destruct method to be fired AFTER the destructors of<br />            all the objects referenced here.<br />        */<br />    }<br />    public function __construct($key)<br />    {<br />            $this-&gt;C = new SimpleCrypt($key);<br />            ob_start(array($this,'getBuffer'));<br />    }<br />    public static function &amp;getInstance($key=NULL)<br />    {<br />        if(!self::$_me &amp;&amp; $key)<br />            self::$_me = new EncryptedComms($key);<br />        else<br />            return self::$_me;<br />    }<br />    <br />    public function __destruct()<br />    {<br />        ob_end_flush();<br />    }<br />    <br />    public function getBuffer($str)<br />    {<br />        return $this-&gt;C-&gt;encrypt($str);<br />    }<br /><br />}<br /><br />In this example, I tried to register other objects to always be destroyed just before this object.  Like this:<br /><br />class A<br />{<br /><br />public function __construct()<br />{<br />     EncryptedComms::destroyAfter($this);<br />}<br />}<br /><br />One would think that the references to the objects contained in the singleton would be destroyed first, but this is not the case.  In fact, this won't work even if you reverse the paradigm and store a reference to EncryptedComms in every object you'd like to be destroyed before it.<br /><br />In short, when a script die()s, there doesn't seem to be any way to predict the order in which the destructors will fire.</span></code></div>
  </div>
 </div>
  <div class="note" id="68028">  <div class="votes">
    <div id="Vu68028">
    <a href="https://www.php.net/manual/vote-note.php?id=68028&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd68028">
    <a href="https://www.php.net/manual/vote-note.php?id=68028&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V68028" title="50% like this...">
    0
    </div>
  </div>
  <a href="language.oop5.decon.php.html#68028" class="name">
  <strong class="user"><em>Reza Mahjourian</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#68028"> &para;</a><div class="date" title="2006-07-10 02:18"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom68028">
<div class="phpcode"><code><span class="html">Peter has suggested using static methods to compensate for unavailability of multiple constructors in PHP.  This works fine for most purposes, but if you have a class hierarchy and want to delegate parts of initialization to the parent class, you can no longer use this scheme.  It is because unlike constructors, in a static method you need to do the instantiation yourself.  So if you call the parent static method, you will get an object of parent type which you can't continue to initialize with derived class fields.<br /><br />Imagine you have an Employee class and a derived HourlyEmployee class and you want to be able to construct these objects out of some XML input too.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Employee </span><span class="keyword">{<br />   public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$inName</span><span class="keyword">) {<br />       </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$inName</span><span class="keyword">;<br />   }<br /><br />   public static function </span><span class="default">constructFromDom</span><span class="keyword">(</span><span class="default">$inDom</span><span class="keyword">)<br />   {<br />       </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$inDom</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;<br />       return new </span><span class="default">Employee</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />   }<br /><br />   private </span><span class="default">$name</span><span class="keyword">;<br />}<br /><br />class </span><span class="default">HourlyEmployee </span><span class="keyword">extends </span><span class="default">Employee </span><span class="keyword">{<br />   public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$inName</span><span class="keyword">, </span><span class="default">$inHourlyRate</span><span class="keyword">) {<br />       </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$inName</span><span class="keyword">);<br />       </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">hourlyRate </span><span class="keyword">= </span><span class="default">$inHourlyRate</span><span class="keyword">;<br />   }<br /><br />   public static function </span><span class="default">constructFromDom</span><span class="keyword">(</span><span class="default">$inDom</span><span class="keyword">)<br />   {<br />       </span><span class="comment">// can't call parent::constructFromDom($inDom)<br />       // need to do all the work here again<br />       </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$inDom</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;  </span><span class="comment">// increased coupling<br />       </span><span class="default">$hourlyRate </span><span class="keyword">= </span><span class="default">$inDom</span><span class="keyword">-&gt;</span><span class="default">hourlyrate</span><span class="keyword">;<br />       return new </span><span class="default">EmployeeHourly</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$hourlyRate</span><span class="keyword">);<br />   }<br /><br />   private </span><span class="default">$hourlyRate</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;<br /></span><br />The only solution is to merge the two constructors in one by adding an optional $inDom parameter to every constructor.</span></code></div>
  </div>
 </div>
  <div class="note" id="127493">  <div class="votes">
    <div id="Vu127493">
    <a href="https://www.php.net/manual/vote-note.php?id=127493&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd127493">
    <a href="https://www.php.net/manual/vote-note.php?id=127493&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V127493" title="36% like this...">
    -3
    </div>
  </div>
  <a href="language.oop5.decon.php.html#127493" class="name">
  <strong class="user"><em>ziggy at start dot dust</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#127493"> &para;</a><div class="date" title="2022-08-16 09:04"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom127493">
<div class="phpcode"><code><span class="html">Please note that constructor argument promotion is kind of half-baked (at least as of 8.1 and it does not look to be changed in 8.2) and you are not allowed to reuse promoted argument with other promoted arguments. For example having "old style" constructor:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(protected </span><span class="default">string $val</span><span class="keyword">, protected </span><span class="default">Foo $foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />    </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">val </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />    </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">= </span><span class="default">$foo </span><span class="keyword">?? new </span><span class="default">Foo</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />you will not be able to use argument promotion like this:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(protected </span><span class="default">string $val</span><span class="keyword">, protected </span><span class="default">Foo $foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {}<br /></span><span class="default">?&gt;<br /></span><br />nor<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(protected </span><span class="default">string $val</span><span class="keyword">, protected </span><span class="default">Foo $foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">val</span><span class="keyword">)) {}<br /></span><span class="default">?&gt;<br /></span><br />as in both cases you will face "PHP Fatal error:  Constant expression contains invalid operations".</span></code></div>
  </div>
 </div>
  <div class="note" id="125863">  <div class="votes">
    <div id="Vu125863">
    <a href="https://www.php.net/manual/vote-note.php?id=125863&amp;page=language.oop5.decon&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125863">
    <a href="https://www.php.net/manual/vote-note.php?id=125863&amp;page=language.oop5.decon&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125863" title="35% like this...">
    -5
    </div>
  </div>
  <a href="language.oop5.decon.php.html#125863" class="name">
  <strong class="user"><em>instatiendaweb at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.decon.php.html#125863"> &para;</a><div class="date" title="2021-02-27 10:07"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom125863">
<div class="phpcode"><code><span class="html">/**<br /> * Haciendo una prueba con dos clases y dos destructores<br /> * La prueba consta de acceder a la variable global del primer objeto en el segundo<br /> * objeto el destructor 2<br /> * Primera clase ==&gt; $GLOBALS['obj']<br /> * SEgunda clase ==&gt; $GLOBALS['obj2']<br /> * Se ejecuta construct y todo el codigo....<br /> * Primer destruct borra el objeto y lo hace null<br /> * Tratamos de acceder a $GLOBALS['obj'] en el segundo destruct pero <br /> * ya no esta es un objeto null<br /> * Warning: Undefined array key "obj" in...<br /> */<br /><br />class MyDestructableClass{<br />public $parametro;<br /><br />     function __construct($parametro) {<br />echo("&lt;div class=\"div\"&gt;"), "Construyendo ",__CLASS__ , ("&lt;/div&gt;");<br />         escribir::verifacionnota($this ,'Antes de guardar la variable  ');<br />         $this-&gt;parametro = $parametro;<br />         escribir::verifacionnota($this ,'Despues de guardar la variable  ');<br />     }<br /> <br />   <br /><br />     function __destruct() {<br />        escribir::linea(5); //Separador<br />        echo("&lt;div class=\"div\"&gt;"), "Destruyendo " ,  __CLASS__ , ("&lt;/div&gt;");<br />        escribir::verifacionnota($this ,'Antes de borrar la variable  ');<br />        unset($this-&gt;parametro);<br />        escribir::verifacionnota($this ,'Despues de borrar la variable  ');<br /><br />       // unset($GLOBALS[$this]);<br />     }<br /> }<br /> <br /> $obj = new MyDestructableClass('parametroone');<br /> escribir::verifacionnota($obj ,' Verificar la clase MyDestructableClass, no es necesario<br /> borrar la clase porque se ejecuta al final del script  ');<br /> escribir::titulosep('Provando ejemplo aqui se puede acceder a la variable global');<br /> escribir::verificacion($GLOBALS['obj']);<br /><br />class destructora{<br />    function __destruct(){<br />        escribir::titulosep('Sin embargo esta variable muere aqui');<br />        escribir::verificacion($GLOBALS['obj']);<br />    }<br />}<br /><br />$obj2 = new destructora();</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=language.oop5.decon&amp;redirect=https://www.php.net/manual/ru/language.oop5.decon.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="language.oop5.php.html">Классы и объекты</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="oop5.intro.php.html" title="Введение">Введение</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.basic.php.html" title="Основы">Основы</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.properties.php.html" title="Свойства">Свойства</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.constants.php.html" title="Константы классов">Константы классов</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.autoload.php.html" title="Автоматическая загрузка классов">Автоматическая загрузка классов</a>
                        </li>
                                                <li class="current">
                            <a href="language.oop5.decon.php.html" title="Конструкторы и деструкторы">Конструкторы и деструкторы</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.visibility.php.html" title="Область видимости">Область видимости</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.inheritance.php.html" title="Наследование">Наследование</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.paamayim-nekudotayim.php.html" title="Оператор разрешения области видимости (::)">Оператор разрешения области видимости (::)</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.static.php.html" title="Ключевое слово static">Ключевое слово static</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.abstract.php.html" title="Абстрактные классы">Абстрактные классы</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.interfaces.php.html" title="Интерфейсы объектов">Интерфейсы объектов</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.traits.php.html" title="Трейты">Трейты</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.anonymous.php.html" title="Анонимные классы">Анонимные классы</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.overloading.php.html" title="Перегрузка">Перегрузка</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.iterations.php.html" title="Итераторы объектов">Итераторы объектов</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.magic.php.html" title="Магические методы">Магические методы</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.final.php.html" title="Ключевое слово final">Ключевое слово final</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.cloning.php.html" title="Клонирование объектов">Клонирование объектов</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.object-comparison.php.html" title="Сравнение объектов">Сравнение объектов</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.late-static-bindings.php.html" title="Позднее статическое связывание">Позднее статическое связывание</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.references.php.html" title="Объекты и ссылки">Объекты и ссылки</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.serialization.php.html" title="Сериализация объектов">Сериализация объектов</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.variance.php.html" title="Ковариантность и контравариантность">Ковариантность и контравариантность</a>
                        </li>
                                                <li class="">
                            <a href="language.oop5.changelog.php.html" title="Журнал изменений ООП">Журнал изменений ООП</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
