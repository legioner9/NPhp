<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Memcache::addServer - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="memcache.addserver.php.html">
 <link rel="shorturl" href="memcache.addserver.php.html">
 <link rel="alternate" href="memcache.addserver.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="class.memcache.php.html">
 <link rel="prev" href="memcache.add.php.html">
 <link rel="next" href="memcache.close.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/memcache.addserver.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/memcache.addserver.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/memcache.addserver.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/memcache.addserver.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/memcache.addserver.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/memcache.addserver.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/memcache.addserver.php" hreflang="pt_BR">
 <link rel="alternate" href="memcache.addserver.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/memcache.addserver.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/memcache.addserver.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="memcache.close.php.html">
          Memcache::close &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="memcache.add.php.html">
          &laquo; Memcache::add        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.remote.other.php.html'>Другие службы</a></li>      <li><a href='book.memcache.php.html'>Memcache</a></li>      <li><a href='class.memcache.php.html'>Memcache</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/memcache.addserver.php'>English</option>
            <option value='de/memcache.addserver.php'>German</option>
            <option value='es/memcache.addserver.php'>Spanish</option>
            <option value='fr/memcache.addserver.php'>French</option>
            <option value='it/memcache.addserver.php'>Italian</option>
            <option value='ja/memcache.addserver.php'>Japanese</option>
            <option value='pt_BR/memcache.addserver.php'>Brazilian Portuguese</option>
            <option value='ru/memcache.addserver.php' selected="selected">Russian</option>
            <option value='tr/memcache.addserver.php'>Turkish</option>
            <option value='zh/memcache.addserver.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/memcache/memcache/addserver.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fmemcache.addserver%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="memcache.addserver" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Memcache::addServer</h1>
  <p class="verinfo">(PECL memcache &gt;= 2.0.0)</p><p class="refpurpose"><span class="refname">Memcache::addServer</span> &mdash; <span class="dc-title">Добавляет сервер memcached в пул соединений</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-memcache.addserver-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>Memcache::addServer</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$host</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$port</code><span class="initializer"> = 11211</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$persistent</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$weight</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$timeout</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$retry_interval</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">bool</span> <code class="parameter">$status</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.callable.php.html" class="type callable">callable</a></span> <code class="parameter">$failure_callback</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$timeoutms</code><span class="initializer"> = ?</span></span><br>): <span class="type">bool</span></div>


  <p class="para rdfs-comment">
   <span class="function"><strong>Memcache::addServer()</strong></span> добавляет сервер в пул соединений.
   Вы также можете использовать функцию <span class="function"><strong>memcache_add_server()</strong></span>.
  </p>

  <p class="para">
   При использовании этого метода (в отличие от <span class="function"><a href="memcache.connect.php.html" class="function">Memcache::connect()</a></span> и
   <span class="function"><a href="memcache.pconnect.php.html" class="function">Memcache::pconnect()</a></span>) сетевое соединение не будет установлено,
   пока в нем не возникнет необходимость. В связи с этим можно не опасаться
   снижения
   производительности при добавлении большого количества серверов в пул, так
   как, возможно, они никогда не будут использованы.
  </p>

  <p class="para">
   Потребность в обеспечении отказоустойчивости может возникнуть на любом этапе в любом методе и
   если при этом будут доступен хотя бы один сервер из пула - пользователь не получит какого-либо
   оповещения. Любой тип ошибки сокета или сервера Memcached (за исключением ошибки переполнения
   памяти) может включить протокол обеспечения отказоустойчивости. Обычные клиентские ошибки,
   такие как добавление существующего ключа, не вызовут подобного поведения.
  </p>

  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Эта функция была добавлена в Memcache версии 2.0.0.
   </p>
  </p></blockquote>

 </div>


 <div class="refsect1 parameters" id="refsect1-memcache.addserver-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">host</code></dt>

     <dd>

      <p class="para">
       Указывает на хост с запущенным сервисом memcached. Этот параметр можно задать в
       виде <code class="literal">unix:///path/to/memcached.sock</code> для использования сокетов Unix, но
       в таком случае будет необходимо установить параметр <code class="parameter">port</code>, равным
       <code class="literal">0</code>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">port</code></dt>

     <dd>

      <p class="para">
       Указывает порт, по которому доступен сервис memcached. Необходимо установить равным
       <code class="literal">0</code> если используются сокеты Unix.
      </p>
      <p class="para">
       Пожалуйста обратите внимание: <code class="parameter">port</code> по умолчанию равен
       <a href="memcache.ini.php.html#ini.memcache.default-port" class="link">memcache.default_port</a>.
       Поэтому рекомендуется всегда указывать номер порта при использовании этого метода.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">persistent</code></dt>

     <dd>

      <p class="para">
       Использовать ли постоянное соединение. По умолчанию <strong><code>true</code></strong>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">weight</code></dt>

     <dd>

      <p class="para">
       Необходимое количество созданных пакетов данных для этого сервера, что,
       в свою очередь, определяет вероятность его выбора. Вероятность
       рассчитывается относительно общего веса всех серверов.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeout</code></dt>

     <dd>

      <p class="para">
       Время ожидания в секундах для установления соединения с сервером.
       Дважды подумайте прежде чем устанавливать это значение больше чем 1.
       Это может нивелировать всю пользу от использования memcached.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">retry_interval</code></dt>

     <dd>

      <p class="para">
       Управляет частотой проверки доступности отказавшего сервера, по умолчанию
       15 секунд.
       Если задать значение &quot;-1&quot;, то попыток проверить доступность сервера
       предприниматься не будет.
       Ни этот параметр, ни параметр <code class="parameter">persistent</code> не
       оказывают никакого влияния,
       если модуль загружен динамически через функцию
       <span class="function"><a href="function.dl.php.html" class="function">dl()</a></span>.
      </p>
      <p class="para">
       Каждая провалившаяся структура соединения имеет собственное значение
       времени ожидания и, пока оно не превышено, структура будет пропущена, после чего
       попробует выбрать другой сервер для обслуживания запроса. После того
       как время соединения истекло, оно либо удачно пересоединится, либо будет
       помечено провалившимся и будет ждать ещё
       <code class="parameter">retry_interval</code> секунд.
       Обычно эффект заключается в том, что каждый процесс веб-сервера будет
       ожидать <code class="parameter">retry_interval</code> секунд при обслуживании
       запроса.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">status</code></dt>

     <dd>

      <p class="para">
       Определяет, должен ли сервер помечен флагом как &quot;онлайн&quot;. Установка этого
       параметра в <strong><code>false</code></strong> и <code class="parameter">retry_interval</code> в -1 позволит
       сохранить сервер в пуле, но не использовать его в алгоритме распределения
       ключей.
       Запрос к этому серверу либо запустит механизм обеспечения
       отказоустойчивости, либо
       сразу же прервётся с ошибкой, в зависимости от настройки
       <code class="parameter">memcache.allow_failover</code>. По умолчанию равно <strong><code>true</code></strong>,
       что означает, что сервер активен и готов принимать запросы.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">failure_callback</code></dt>

     <dd>

      <p class="para">
       Позволяет пользователю задать функцию обратного вызова, которая запустится
       в случае какой-либо ошибки. Эта функция будет вызвана раньше, чем будет
       запущен механизм обеспечения отказоустойчивости. Функция принимает два
       параметра - имя хоста и порт отказавшего сервера.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeoutms</code></dt>

     <dd>

      <p class="para">

      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-memcache.addserver-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-memcache.addserver-examples">
  <h3 class="title">Примеры</h3>
 <p class="para">
  <div class="example" id="">
   <p><strong>Пример #1 Пример использования <span class="function"><strong>Memcache::addServer()</strong></span></strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/* объектно-ориентированное API */<br /><br /></span><span style="color: #0000BB">$memcache </span><span style="color: #007700">= new </span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">, </span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host2'</span><span style="color: #007700">, </span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* процедурное API */<br /><br /></span><span style="color: #0000BB">$memcache_obj </span><span style="color: #007700">= </span><span style="color: #0000BB">memcache_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">, </span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">memcache_add_server</span><span style="color: #007700">(</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">, </span><span style="color: #DD0000">'memcache_host2'</span><span style="color: #007700">, </span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
 </p>
 </div>


 <div class="refsect1 notes" id="refsect1-memcache.addserver-notes">
  <h3 class="title">Примечания</h3>
  <div class="warning"><strong class="warning">Внимание</strong>
   <p class="para">
    Когда значение <code class="parameter">port</code> не указано, этот метод использует значение, указанное в ini-директиве PHP
    <a href="memcache.ini.php.html#ini.memcache.default-port" class="link">memcache.default_port</a>.
    Если это значение было изменено где-нибудь ещё в вашем приложении, то это может дать непредсказуемые результаты. По этой причине лучше всегда явно указывать порт при вызове метода.
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-memcache.addserver-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="memcache.connect.php.html" class="function" rel="rdfs-seeAlso">Memcache::connect()</a> - Открывает соединение с сервером memcached</span></li>
    <li class="member"><span class="function"><a href="memcache.pconnect.php.html" class="function" rel="rdfs-seeAlso">Memcache::pconnect()</a> - Открывает постоянное соединение с сервером memcached</span></li>
    <li class="member"><span class="function"><a href="memcache.close.php.html" class="function" rel="rdfs-seeAlso">Memcache::close()</a> - Закрыть соединение с сервером memcached</span></li>
    <li class="member"><span class="function"><a href="memcache.setserverparams.php.html" class="function" rel="rdfs-seeAlso">Memcache::setServerParams()</a> - Изменяет параметры сервера и статус во время выполнения</span></li>
    <li class="member"><span class="function"><a href="memcache.getserverstatus.php.html" class="function" rel="rdfs-seeAlso">Memcache::getServerStatus()</a> - Возвращает статус сервера</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=memcache.addserver&amp;redirect=https://www.php.net/manual/ru/memcache.addserver.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">6 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="104484">  <div class="votes">
    <div id="Vu104484">
    <a href="https://www.php.net/manual/vote-note.php?id=104484&amp;page=memcache.addserver&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd104484">
    <a href="https://www.php.net/manual/vote-note.php?id=104484&amp;page=memcache.addserver&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V104484" title="87% like this...">
    6
    </div>
  </div>
  <a href="memcache.addserver.php.html#104484" class="name">
  <strong class="user"><em>rstaveley at seseit dot com</em></strong></a><a class="genanchor" href="memcache.addserver.php.html#104484"> &para;</a><div class="date" title="2011-06-17 04:06"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom104484">
<div class="phpcode"><code><span class="html">The Memcache client library is responsible for picking the right server to set/get data. That's why addServer is what you want to use rather than connect, when you have more than one Memcache server. A subsequent set/get will then connect on demand to the appropriate instance as needs be. Disconnection to whatever servers were connected to happening when you close or your script terminates.<br /><br />Memcache instances added to your Memcache object via addServer should be added in the same order in your application to ensure that the same server is picked for use with the same key. <br /><br />A client library may be implemented to run a CRC on the key and do a modulus over the number of instances in the list to select an instance from the list for the set/get. This ensures that data is spread nicely across the nodes. <br /><br />That all works nicely behind the scenes for you in your PHP code, as long as you add your list of Memcache instances in a consistent manner with addServer.</span></code></div>
  </div>
 </div>
  <div class="note" id="105728">  <div class="votes">
    <div id="Vu105728">
    <a href="https://www.php.net/manual/vote-note.php?id=105728&amp;page=memcache.addserver&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd105728">
    <a href="https://www.php.net/manual/vote-note.php?id=105728&amp;page=memcache.addserver&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V105728" title="71% like this...">
    3
    </div>
  </div>
  <a href="memcache.addserver.php.html#105728" class="name">
  <strong class="user"><em>enno dot rehling at gmail dot com</em></strong></a><a class="genanchor" href="memcache.addserver.php.html#105728"> &para;</a><div class="date" title="2011-09-09 04:11"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom105728">
<div class="phpcode"><code><span class="html">The $timeoutms argument can be used to specify the timeout in milliseconds, but isn't available in all versions. For example, it exists in php_memcache 2.2.6, but not in 3.0.4. In 2.2.6, if you specify it, then it overrides $timeout.<br /><br />Caveat emptor: If $timeoutms is not specified, it defaults to the value of memcache.default_timeout_ms in php.ini, which defaults to 1000 if not set. This also overrides $timeout, which has the curious effect that $timeout is always ignored in php_memcache 2.2.6 (either in favor of $timeoutms, memcache.default_timeout_ms or the value 1000, in that order of priority).</span></code></div>
  </div>
 </div>
  <div class="note" id="113527">  <div class="votes">
    <div id="Vu113527">
    <a href="https://www.php.net/manual/vote-note.php?id=113527&amp;page=memcache.addserver&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113527">
    <a href="https://www.php.net/manual/vote-note.php?id=113527&amp;page=memcache.addserver&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113527" title="62% like this...">
    2
    </div>
  </div>
  <a href="memcache.addserver.php.html#113527" class="name">
  <strong class="user"><em>joewynn dot nz+phpnet at gmail dot com</em></strong></a><a class="genanchor" href="memcache.addserver.php.html#113527"> &para;</a><div class="date" title="2013-10-25 10:12"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom113527">
<div class="phpcode"><code><span class="html">Note that this method will always return TRUE because a connection is not actually made at call time. See this bug report for more information: <a href="https://bugs.php.net/bug.php?id=58193" rel="nofollow" target="_blank">https://bugs.php.net/bug.php?id=58193</a></span></code></div>
  </div>
 </div>
  <div class="note" id="103801">  <div class="votes">
    <div id="Vu103801">
    <a href="https://www.php.net/manual/vote-note.php?id=103801&amp;page=memcache.addserver&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd103801">
    <a href="https://www.php.net/manual/vote-note.php?id=103801&amp;page=memcache.addserver&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V103801" title="57% like this...">
    1
    </div>
  </div>
  <a href="memcache.addserver.php.html#103801" class="name">
  <strong class="user"><em>eu at serbannistor dot ro</em></strong></a><a class="genanchor" href="memcache.addserver.php.html#103801"> &para;</a><div class="date" title="2011-05-04 06:30"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom103801">
<div class="phpcode"><code><span class="html">Actually if you have two memcached servers from which one of them is on localhost, and the other is on a remote machine you can communicate with both even if you specify the loopback address for the local one.<br /><br /><span class="default">&lt;?php<br />$memcache_obj </span><span class="keyword">= </span><span class="default">memcache_connect</span><span class="keyword">(</span><span class="string">"127.0.0.1"</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);<br /></span><span class="default">memcache_add_server</span><span class="keyword">(</span><span class="default">$memcache_obj</span><span class="keyword">, </span><span class="string">"memcache_remote_host"</span><span class="keyword">);<br /></span><span class="default">$memcache_obj</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">'var_key'</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">());<br /></span><span class="default">?&gt;<br /></span><br />This WILL communicate with both hosts but however there are two aspects that must be taken into account:<br />1. the communication will be done through different network interfaces with the two hosts. It will use the loopback interface for the "127.0.0.1" host (lo in my case on Linux) and the external interface for the "memcache_remote_host" (eth0 in my case). Only if you want to use the same network interface to communicate with both hosts you must use the external IPs of both machines (and all communication will go out through the eth0 interface).<br />2. the connection with the two hosts will be established differently because of how memcache_connect() and memcache_add_server() work. Therefore the memcache_connect() will initiate the connection to localhost through the loopback interface when it is called, while memcache_add_server() will just add the second server to the pool, but it will not send any package through the network until it's absolutely needed (for example when a memcache_set() command is issued).</span></code></div>
  </div>
 </div>
  <div class="note" id="96084">  <div class="votes">
    <div id="Vu96084">
    <a href="https://www.php.net/manual/vote-note.php?id=96084&amp;page=memcache.addserver&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd96084">
    <a href="https://www.php.net/manual/vote-note.php?id=96084&amp;page=memcache.addserver&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V96084" title="50% like this...">
    0
    </div>
  </div>
  <a href="memcache.addserver.php.html#96084" class="name">
  <strong class="user"><em>iwind dot liu at gmail dot com</em></strong></a><a class="genanchor" href="memcache.addserver.php.html#96084"> &para;</a><div class="date" title="2010-02-08 12:14"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom96084">
<div class="phpcode"><code><span class="html">The weight of the server must be greater than 0.<br /><br />If there is no memcached server to use, and you try to set/add variables, the apache will be crashed, with the error message "[notice] child pid 18725 exit signal Segmentation fault (11)" in error_log file.</span></code></div>
  </div>
 </div>
  <div class="note" id="82984">  <div class="votes">
    <div id="Vu82984">
    <a href="https://www.php.net/manual/vote-note.php?id=82984&amp;page=memcache.addserver&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd82984">
    <a href="https://www.php.net/manual/vote-note.php?id=82984&amp;page=memcache.addserver&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V82984" title="28% like this...">
    -6
    </div>
  </div>
  <a href="memcache.addserver.php.html#82984" class="name">
  <strong class="user"><em>Jean-Baptiste Quenot</em></strong></a><a class="genanchor" href="memcache.addserver.php.html#82984"> &para;</a><div class="date" title="2008-05-05 01:08"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom82984">
<div class="phpcode"><code><span class="html">The default value for the "weight" argument is 1</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=memcache.addserver&amp;redirect=https://www.php.net/manual/ru/memcache.addserver.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="class.memcache.php.html">Memcache</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="memcache.add.php.html" title="add">add</a>
                        </li>
                                                <li class="current">
                            <a href="memcache.addserver.php.html" title="addServer">addServer</a>
                        </li>
                                                <li class="">
                            <a href="memcache.close.php.html" title="close">close</a>
                        </li>
                                                <li class="">
                            <a href="memcache.connect.php.html" title="connect">connect</a>
                        </li>
                                                <li class="">
                            <a href="memcache.decrement.php.html" title="decrement">decrement</a>
                        </li>
                                                <li class="">
                            <a href="memcache.delete.php.html" title="delete">delete</a>
                        </li>
                                                <li class="">
                            <a href="memcache.flush.php.html" title="flush">flush</a>
                        </li>
                                                <li class="">
                            <a href="memcache.get.php.html" title="get">get</a>
                        </li>
                                                <li class="">
                            <a href="memcache.getextendedstats.php.html" title="getExtendedStats">getExtendedStats</a>
                        </li>
                                                <li class="">
                            <a href="memcache.getserverstatus.php.html" title="getServerStatus">getServerStatus</a>
                        </li>
                                                <li class="">
                            <a href="memcache.getstats.php.html" title="getStats">getStats</a>
                        </li>
                                                <li class="">
                            <a href="memcache.getversion.php.html" title="getVersion">getVersion</a>
                        </li>
                                                <li class="">
                            <a href="memcache.increment.php.html" title="increment">increment</a>
                        </li>
                                                <li class="">
                            <a href="memcache.pconnect.php.html" title="pconnect">pconnect</a>
                        </li>
                                                <li class="">
                            <a href="memcache.replace.php.html" title="replace">replace</a>
                        </li>
                                                <li class="">
                            <a href="memcache.set.php.html" title="set">set</a>
                        </li>
                                                <li class="">
                            <a href="memcache.setcompressthreshold.php.html" title="setCompressThreshold">setCompressThreshold</a>
                        </li>
                                                <li class="">
                            <a href="memcache.setserverparams.php.html" title="setServerParams">setServerParams</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
