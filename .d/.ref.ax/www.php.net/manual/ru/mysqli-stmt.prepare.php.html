<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: mysqli_stmt::prepare - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="mysqli-stmt.prepare.php.html">
 <link rel="shorturl" href="mysqli-stmt.prepare.php.html">
 <link rel="alternate" href="mysqli-stmt.prepare.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="class.mysqli-stmt.php.html">
 <link rel="prev" href="mysqli-stmt.param-count.php.html">
 <link rel="next" href="mysqli-stmt.reset.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/mysqli-stmt.prepare.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/mysqli-stmt.prepare.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/mysqli-stmt.prepare.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/mysqli-stmt.prepare.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/mysqli-stmt.prepare.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/mysqli-stmt.prepare.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/mysqli-stmt.prepare.php" hreflang="pt_BR">
 <link rel="alternate" href="mysqli-stmt.prepare.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/mysqli-stmt.prepare.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/mysqli-stmt.prepare.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="mysqli-stmt.reset.php.html">
          mysqli_stmt::reset &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="mysqli-stmt.param-count.php.html">
          &laquo; mysqli_stmt::$param_count        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.vendors.php.html'>Модули для работы с базами данных отдельных производителей</a></li>      <li><a href='set.mysqlinfo.php.html'>MySQL</a></li>      <li><a href='book.mysqli.php.html'>MySQLi</a></li>      <li><a href='class.mysqli-stmt.php.html'>mysqli_stmt</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/mysqli-stmt.prepare.php'>English</option>
            <option value='de/mysqli-stmt.prepare.php'>German</option>
            <option value='es/mysqli-stmt.prepare.php'>Spanish</option>
            <option value='fr/mysqli-stmt.prepare.php'>French</option>
            <option value='it/mysqli-stmt.prepare.php'>Italian</option>
            <option value='ja/mysqli-stmt.prepare.php'>Japanese</option>
            <option value='pt_BR/mysqli-stmt.prepare.php'>Brazilian Portuguese</option>
            <option value='ru/mysqli-stmt.prepare.php' selected="selected">Russian</option>
            <option value='tr/mysqli-stmt.prepare.php'>Turkish</option>
            <option value='zh/mysqli-stmt.prepare.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/mysqli/mysqli_stmt/prepare.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fmysqli-stmt.prepare%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="mysqli-stmt.prepare" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqli_stmt::prepare</h1>
  <h1 class="refname">mysqli_stmt_prepare</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mysqli_stmt::prepare</span> -- <span class="refname">mysqli_stmt_prepare</span> &mdash; <span class="dc-title">Подготавливает утверждение SQL к выполнению</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mysqli-stmt.prepare-description">
  <h3 class="title">Описание</h3>
  <p class="para">Объектно-ориентированный стиль</p>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>mysqli_stmt::prepare</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">Процедурный стиль</p>
  <div class="methodsynopsis dc-description"><span class="methodname"><strong>mysqli_stmt_prepare</strong></span>(<span class="methodparam"><span class="type"><a href="class.mysqli-stmt.php.html" class="type mysqli_stmt">mysqli_stmt</a></span> <code class="parameter">$statement</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   Подготавливает утверждение к выполнению.
   Запрос должен состоять из одного оператора SQL.
  </p>
  <p class="para">
   Шаблон утверждения может содержать ноль или несколько вопросительных знаков
   (<code class="literal">?</code>), меток параметров, также называемых заполнителями.
   Метки параметров должны быть привязаны к переменным приложения с помощью
   <span class="function"><a href="mysqli-stmt.bind-param.php.html" class="function">mysqli_stmt_bind_param()</a></span> перед выполнением утверждения.
   строк.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    В случае, если длина выражения, которое передаётся в
    <span class="function"><strong>mysqli_stmt_prepare()</strong></span>, больше, чем
    <code class="literal">max_allowed_packet</code> сервера, возвращаемые коды ошибки могут
    различаться в зависимости от используемого драйвера. А это может быть либо
    родной MySQL-драйвер (<code class="literal">mysqlnd</code>), либо клиентская библиотека
    MySQL (<code class="literal">libmysqlclient</code>). Поведение функции будет следующим:
   </p>
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <code class="literal">mysqlnd</code> на платформе Linux возвращает код ошибки 1153.
      Сообщение об ошибке означает <q class="quote">размер пакета превышает
      <code class="literal">max_allowed_packet</code> байт</q>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">mysqlnd</code> на платформе Windows возвращает код ошибки 2006.
      Это сообщение об ошибке означает <q class="quote">сервер недоступен</q>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">libmysqlclient</code> на всех платформах возвращает код ошибки 2006.
      Это сообщение об ошибке означает <q class="quote">сервер недоступен</q>.
     </p>
    </li>
   </ul>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-mysqli-stmt.prepare-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    <dt>

<code class="parameter">stmt</code></dt>
<dd>
<p class="para">Только для процедурного стиля: объект <span class="classname"><a href="class.mysqli-stmt.php.html" class="classname">mysqli_stmt</a></span>, который вернула функция
<span class="function"><a href="mysqli.stmt-init.php.html" class="function">mysqli_stmt_init()</a></span>.</p></dd>

    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       Текст запроса в виде строки. Запрос должен состоять из одного SQL-выражения.
      </p>
      <p class="para">
       Утверждение SQL может содержать ноль или более меток параметров,
       представленных знаками вопроса (<code class="literal">?</code>)
       в соответствующих позициях.
      </p>
      <blockquote class="note"><p><strong class="note">Замечание</strong>: 
       <p class="para">
        Метки параметров запроса можно встраивать только в определённые места в
        выражении. Например, они допустимы в списке <code class="literal">VALUES()</code> выражения
        <code class="literal">INSERT</code> (чтобы задать значения столбцов для строки),
        или в операциях сравнения предложения
        <code class="literal">WHERE</code> для задания сравниваемого значения.
        Однако, эти метки недопустимы в качестве идентификаторов (таких как имена столбцов или таблиц).
       </p>
      </p></blockquote>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mysqli-stmt.prepare-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>true</code></strong> в случае успешного выполнения или <strong><code>false</code></strong> в случае возникновения ошибки.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-mysqli-stmt.prepare-errors">
  <h3 class="title">Ошибки</h3>
  <p class="para">
Если уведомления об ошибках mysqli включены (<strong><code>MYSQLI_REPORT_ERROR</code></strong>) и запрошенная операция не удалась,
выдаётся предупреждение. Если, кроме того, установлен режим <strong><code>MYSQLI_REPORT_STRICT</code></strong>,
вместо этого будет выброшено исключение <span class="classname"><a href="class.mysqli-sql-exception.php.html" class="classname">mysqli_sql_exception</a></span>.</p>
 </div>


<div class="refsect1 examples" id="refsect1-mysqli-stmt.prepare-examples">
  <h3 class="title">Примеры</h3>
  <div class="example" id="example-4561">
   <p><strong>Пример #1 Пример использования <span class="methodname"><strong>mysqli_stmt::prepare()</strong></span></strong></p>
   <div class="example-contents"><p>Объектно-ориентированный стиль</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR </span><span style="color: #007700">| </span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mysqli </span><span style="color: #007700">= new </span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">, </span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$city </span><span style="color: #007700">= </span><span style="color: #DD0000">"Amersfoort"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/* Создаём подготовленное утверждение */<br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">stmt_init</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT District FROM City WHERE Name=?"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Связываем переменные с метками */<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_param</span><span style="color: #007700">(</span><span style="color: #DD0000">"s"</span><span style="color: #007700">, </span><span style="color: #0000BB">$city</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Выполняем запрос */<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/* Связываем переменные результата */<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$district</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Получаем значение */<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s находится в районе %s\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">$city</span><span style="color: #007700">, </span><span style="color: #0000BB">$district</span><span style="color: #007700">);</span></span></code></div>
   </div>

   <div class="example-contents"><p>Процедурный стиль</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR </span><span style="color: #007700">| </span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$link </span><span style="color: #007700">= </span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">, </span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$city </span><span style="color: #007700">= </span><span style="color: #DD0000">"Amersfoort"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/* Создаём подготовленное утверждение */<br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">mysqli_stmt_init</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">mysqli_stmt_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT District FROM City WHERE Name=?"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Связываем переменные с метками */<br /></span><span style="color: #0000BB">mysqli_stmt_bind_param</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, </span><span style="color: #DD0000">"s"</span><span style="color: #007700">, </span><span style="color: #0000BB">$city</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Выполняем запрос */<br /></span><span style="color: #0000BB">mysqli_stmt_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Связываем переменные результата */<br /></span><span style="color: #0000BB">mysqli_stmt_bind_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">, </span><span style="color: #0000BB">$district</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Получаем значение */<br /></span><span style="color: #0000BB">mysqli_stmt_fetch</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s находится в районе %s\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">$city</span><span style="color: #007700">, </span><span style="color: #0000BB">$district</span><span style="color: #007700">);</span></span></code></div>
   </div>

   
<div class="example-contents"><p>
 Результат выполнения приведённых примеров:
</p></div>

   <div class="example-contents screen">
<div class="cdata"><pre>
Amersfoort находится в районе Utrecht
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-mysqli-stmt.prepare-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli.stmt-init.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_init()</a> - Инициализирует запрос и возвращает объект для использования в
   mysqli_stmt_prepare</span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.execute.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_execute()</a> - Выполняет подготовленное утверждение</span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.fetch.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_fetch()</a> - Связывает результаты подготовленного выражения с переменными</span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.bind-param.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_bind_param()</a> - Привязка переменных к параметрам подготавливаемого запроса</span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.bind-result.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_bind_result()</a> - Привязка переменных к подготовленному запросу для размещения результата</span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.get-result.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_get_result()</a> - Получает результат из подготовленного запроса в виде объекта mysqli_result</span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.close.php.html" class="function" rel="rdfs-seeAlso">mysqli_stmt_close()</a> - Закрывает подготовленный запрос</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=mysqli-stmt.prepare&amp;redirect=https://www.php.net/manual/ru/mysqli-stmt.prepare.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">9 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="108023">  <div class="votes">
    <div id="Vu108023">
    <a href="https://www.php.net/manual/vote-note.php?id=108023&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd108023">
    <a href="https://www.php.net/manual/vote-note.php?id=108023&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V108023" title="83% like this...">
    20
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#108023" class="name">
  <strong class="user"><em>logos-php at kith dot org</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#108023"> &para;</a><div class="date" title="2012-03-23 07:06"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom108023">
<div class="phpcode"><code><span class="html">Note that if you're using a question mark as a placeholder for a string value, you don't surround it with quotation marks in the MySQL query.<br /><br />For example, do this:<br /><br />mysqli_stmt_prepare($stmt, "SELECT * FROM foo WHERE foo.Date &gt; ?");<br /><br />Do not do this:<br /><br />mysqli_stmt_prepare($stmt, "SELECT * FROM foo WHERE foo.Date &gt; '?'");<br /><br />If you put quotation marks around a question mark in the query, then PHP doesn't recognize the question mark as a placeholder, and then when you try to use mysqli_stmt_bind_param(), it gives an error to the effect that you have the wrong number of parameters.<br /><br />The lack of quotation marks around a string placeholder is implicit in the official example on this page, but it's not explicitly stated in the docs, and I had trouble figuring it out, so figured it was worth posting.</span></code></div>
  </div>
 </div>
  <div class="note" id="108038">  <div class="votes">
    <div id="Vu108038">
    <a href="https://www.php.net/manual/vote-note.php?id=108038&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd108038">
    <a href="https://www.php.net/manual/vote-note.php?id=108038&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V108038" title="88% like this...">
    7
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#108038" class="name">
  <strong class="user"><em>logos-php at kith dot orgpp</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#108038"> &para;</a><div class="date" title="2012-03-23 05:34"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom108038">
<div class="phpcode"><code><span class="html">Turns out you can't directly use a prepared statement for a query that has a placeholder in an IN() clause.<br /><br />There are ways around that (such as constructing a string that consists of n question marks separated by commas, then using that set of placeholders in the IN() clause), but you can't just say IN (?).<br /><br />This is a MySQL restriction rather than a PHP restriction, but it's not really documented in the MySQL docs either, so I figured it was worth mentioning here.<br /><br />(Btw, turns out someone else had previously posted the info that I put in my previous comment, about not using quotation marks. Sorry for the repeat; not sure how I missed the earlier comment.)</span></code></div>
  </div>
 </div>
  <div class="note" id="57563">  <div class="votes">
    <div id="Vu57563">
    <a href="https://www.php.net/manual/vote-note.php?id=57563&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd57563">
    <a href="https://www.php.net/manual/vote-note.php?id=57563&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V57563" title="75% like this...">
    4
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#57563" class="name">
  <strong class="user"><em>andrey at php dot net</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#57563"> &para;</a><div class="date" title="2005-10-07 05:35"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom57563">
<div class="phpcode"><code><span class="html">If you select LOBs use the following order of execution or you risk mysqli allocating more memory that actually used<br /><br />1)prepare()<br />2)execute()<br />3)store_result()<br />4)bind_result()<br /><br />If you skip 3) or exchange 3) and 4) then mysqli will allocate memory for the maximal length of the column which is 255 for tinyblob, 64k for blob(still ok), 16MByte for MEDIUMBLOB - quite a lot and 4G for LONGBLOB (good if you have so much memory). Queries which use this order a bit slower when there is a LOB but this is the price of not having memory exhaustion in seconds.</span></code></div>
  </div>
 </div>
  <div class="note" id="83873">  <div class="votes">
    <div id="Vu83873">
    <a href="https://www.php.net/manual/vote-note.php?id=83873&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83873">
    <a href="https://www.php.net/manual/vote-note.php?id=83873&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83873" title="66% like this...">
    2
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#83873" class="name">
  <strong class="user"><em>kontakt at arthur minus schiwon dot de</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#83873"> &para;</a><div class="date" title="2008-06-16 07:22"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83873">
<div class="phpcode"><code><span class="html">If you wrap the placeholders with quotation marks you will experience warnings like "Number of variables doesn't match number of parameters in prepared statement" (at least with INSERT Statements).</span></code></div>
  </div>
 </div>
  <div class="note" id="90436">  <div class="votes">
    <div id="Vu90436">
    <a href="https://www.php.net/manual/vote-note.php?id=90436&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd90436">
    <a href="https://www.php.net/manual/vote-note.php?id=90436&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V90436" title="60% like this...">
    1
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#90436" class="name">
  <strong class="user"><em>ndungi at gmail dot com</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#90436"> &para;</a><div class="date" title="2009-04-22 02:25"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom90436">
<div class="phpcode"><code><span class="html">The `prepare` , `bind_param`, `bind_result`, `fetch` result, `close` stmt cycle can be tedious at times. Here is an object that does all the mysqli mumbo jumbo for you when all you want is a select leaving you to the bare essential `preparedSelect` on a prepared stmt. The method returns the result set as a 2D associative array with the `select`ed columns as keys. I havent done sufficient error-checking and it also may have some bugs. Help debug and improve on it. <br /><br />I used the bible.sql db from <a href="http://www.biblesql.net/sites/biblesql.net/files/bible.mysql.gz." rel="nofollow" target="_blank">http://www.biblesql.net/sites/biblesql.net/files/bible.mysql.gz.</a><br /><br />Baraka tele!<br /><br />============================<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">DB<br /></span><span class="keyword">{<br />    public </span><span class="default">$connection</span><span class="keyword">;<br />    <br />    </span><span class="comment">#establish db connection<br />    </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">=</span><span class="string">"localhost"</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">=</span><span class="string">"user"</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">=</span><span class="string">"bible"</span><span class="keyword">)<br />    {<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">);<br />                  <br />        if(</span><span class="default">mysqli_connect_errno</span><span class="keyword">())<br />        {<br />            echo(</span><span class="string">"Database connect Error : " <br />            </span><span class="keyword">. </span><span class="default">mysqli_connect_error</span><span class="keyword">(</span><span class="default">$mysqli</span><span class="keyword">));<br />        }    <br />    }<br />    <br />    </span><span class="comment">#store mysqli object<br />    </span><span class="keyword">public function </span><span class="default">connect</span><span class="keyword">()<br />    {<br />        return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">;<br />    }<br /><br />    </span><span class="comment">#run a prepared query<br />    </span><span class="keyword">public function </span><span class="default">runPreparedQuery</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$params_r</span><span class="keyword">)<br />    {<br />        </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bindParameters</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">, </span><span class="default">$params_r</span><span class="keyword">);<br /><br />        if (</span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">()) {<br />            return </span><span class="default">$stmt</span><span class="keyword">;<br />        } else {<br />            echo(</span><span class="string">"Error in </span><span class="default">$statement</span><span class="string">: " <br />                      </span><span class="keyword">. </span><span class="default">mysqli_error</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connection</span><span class="keyword">));<br />            return </span><span class="default">0</span><span class="keyword">;<br />        }<br />        <br />    }<br /><br /> </span><span class="comment"># To run a select statement with bound parameters and bound results. <br /> # Returns an associative array two dimensional array which u can easily  <br /> # manipulate with array functions.<br /> <br />    </span><span class="keyword">public function </span><span class="default">preparedSelect</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$bind_params_r</span><span class="keyword">)<br />    {<br />        </span><span class="default">$select </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">runPreparedQuery</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$bind_params_r</span><span class="keyword">);<br />        </span><span class="default">$fields_r </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fetchFields</span><span class="keyword">(</span><span class="default">$select</span><span class="keyword">);<br />        <br />        foreach (</span><span class="default">$fields_r </span><span class="keyword">as </span><span class="default">$field</span><span class="keyword">) {<br />            </span><span class="default">$bind_result_r</span><span class="keyword">[] = &amp;${</span><span class="default">$field</span><span class="keyword">};<br />        } <br />        <br />        </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bindResult</span><span class="keyword">(</span><span class="default">$select</span><span class="keyword">, </span><span class="default">$bind_result_r</span><span class="keyword">);<br />        <br />        </span><span class="default">$result_r </span><span class="keyword">= array();<br />        </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />        while (</span><span class="default">$select</span><span class="keyword">-&gt;</span><span class="default">fetch</span><span class="keyword">()) {<br />            foreach (</span><span class="default">$fields_r </span><span class="keyword">as </span><span class="default">$field</span><span class="keyword">) {<br />                </span><span class="default">$result_r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$field</span><span class="keyword">] = $</span><span class="default">$field</span><span class="keyword">;<br />            }<br />            </span><span class="default">$i</span><span class="keyword">++;<br />        }<br />        </span><span class="default">$select</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />        return </span><span class="default">$result_r</span><span class="keyword">;    <br />    }<br />    <br />    <br />    </span><span class="comment">#takes in array of bind parameters and binds them to result of <br />    #executed prepared stmt<br />    <br />    </span><span class="keyword">private function </span><span class="default">bindParameters</span><span class="keyword">(&amp;</span><span class="default">$obj</span><span class="keyword">, &amp;</span><span class="default">$bind_params_r</span><span class="keyword">)<br />    {<br />        </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$obj</span><span class="keyword">, </span><span class="string">"bind_param"</span><span class="keyword">), </span><span class="default">$bind_params_r</span><span class="keyword">);<br />    }<br />    <br />    private function </span><span class="default">bindResult</span><span class="keyword">(&amp;</span><span class="default">$obj</span><span class="keyword">, &amp;</span><span class="default">$bind_result_r</span><span class="keyword">)<br />    {<br />        </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$obj</span><span class="keyword">, </span><span class="string">"bind_result"</span><span class="keyword">), </span><span class="default">$bind_result_r</span><span class="keyword">);<br />    }<br />    <br />    </span><span class="comment">#returns a list of the selected field names<br />    <br />    </span><span class="keyword">private function </span><span class="default">fetchFields</span><span class="keyword">(</span><span class="default">$selectStmt</span><span class="keyword">)<br />    {<br />        </span><span class="default">$metadata </span><span class="keyword">= </span><span class="default">$selectStmt</span><span class="keyword">-&gt;</span><span class="default">result_metadata</span><span class="keyword">();<br />        </span><span class="default">$fields_r </span><span class="keyword">= array();<br />        while (</span><span class="default">$field </span><span class="keyword">= </span><span class="default">$metadata</span><span class="keyword">-&gt;</span><span class="default">fetch_field</span><span class="keyword">()) {<br />            </span><span class="default">$fields_r</span><span class="keyword">[] = </span><span class="default">$field</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;<br />        }<br /><br />        return </span><span class="default">$fields_r</span><span class="keyword">;<br />    }<br />}<br /></span><span class="comment">#end of class<br /> <br />#An example of the DB class in use<br /><br /></span><span class="default">$DB </span><span class="keyword">= new </span><span class="default">DB</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">, </span><span class="string">"root"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="string">"bible"</span><span class="keyword">);<br /></span><span class="default">$var </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">; <br /></span><span class="default">$query </span><span class="keyword">= </span><span class="string">"SELECT abbr, name from books where id &gt; ?" </span><span class="keyword">;<br /></span><span class="default">$bound_params_r </span><span class="keyword">= array(</span><span class="string">"i"</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">);<br /><br /></span><span class="default">$result_r </span><span class="keyword">= </span><span class="default">$DB</span><span class="keyword">-&gt;</span><span class="default">preparedSelect</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$bound_params_r</span><span class="keyword">);<br /><br /></span><span class="comment">#loop thru result array and display result<br /><br /></span><span class="keyword">foreach (</span><span class="default">$result_r </span><span class="keyword">as </span><span class="default">$result</span><span class="keyword">) {<br />    echo </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'abbr'</span><span class="keyword">] . </span><span class="string">" : " </span><span class="keyword">. </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] . </span><span class="string">"&lt;br/&gt;" </span><span class="keyword">;<br />}<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="83224">  <div class="votes">
    <div id="Vu83224">
    <a href="https://www.php.net/manual/vote-note.php?id=83224&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83224">
    <a href="https://www.php.net/manual/vote-note.php?id=83224&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83224" title="50% like this...">
    0
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#83224" class="name">
  <strong class="user"><em>mhradek AT gmail.com</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#83224"> &para;</a><div class="date" title="2008-05-15 04:06"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83224">
<div class="phpcode"><code><span class="html">A particularly helpful adaptation of this function and the call_user_func_array function:<br /><br />// $params is sent as array($val=&gt;'i', $val=&gt;'d', etc...)<br /><br />function db_stmt_bind_params($stmt, $params)<br />{ <br />    $funcArg[] = $stmt; <br />    foreach($params as $val=&gt;$type)<br />    { <br />        $funcArg['type'] .= $type; <br />        $funcArg[] = $val; <br />    } <br />    return call_user_func_array('mysqli_stmt_bind_param', $funcArgs); <br />} <br /><br />Thanks to 'sned' for the code.</span></code></div>
  </div>
 </div>
  <div class="note" id="75534">  <div class="votes">
    <div id="Vu75534">
    <a href="https://www.php.net/manual/vote-note.php?id=75534&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd75534">
    <a href="https://www.php.net/manual/vote-note.php?id=75534&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V75534" title="50% like this...">
    0
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#75534" class="name">
  <strong class="user"><em>st dot john dot johnson at gmail dot com</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#75534"> &para;</a><div class="date" title="2007-06-04 08:59"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom75534">
<div class="phpcode"><code><span class="html">In reference to what lachlan76 said before, stored procedures CAN be executed through prepared statements as long as you tell the DB to move to the next result before executing again.<br /><br />Example (Five calls to a stored procedure):<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">5</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />  </span><span class="default">$statement </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">stmt_init</span><span class="keyword">();<br />  </span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"CALL some_procedure( ? )"</span><span class="keyword">);<br /><br />  </span><span class="comment">// Bind, execute, and bind.<br />  </span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">bind_param</span><span class="keyword">(</span><span class="string">"i"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />  </span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />  </span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">bind_result</span><span class="keyword">(</span><span class="default">$results</span><span class="keyword">);<br /><br />  while(</span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">fetch</span><span class="keyword">()) {<br />    </span><span class="comment">// Do what you want with your results.<br />  </span><span class="keyword">}<br /><br />  </span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br /><br />  </span><span class="comment">// Now move the mysqli connection to a new result.<br />  </span><span class="keyword">while(</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">next_result</span><span class="keyword">()) { }<br />}<br /></span><span class="default">?&gt;<br /></span><br />If you include the last statement, this code should execute without the nasty "Commands out of sync" error.</span></code></div>
  </div>
 </div>
  <div class="note" id="80426">  <div class="votes">
    <div id="Vu80426">
    <a href="https://www.php.net/manual/vote-note.php?id=80426&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd80426">
    <a href="https://www.php.net/manual/vote-note.php?id=80426&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V80426" title="33% like this...">
    -1
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#80426" class="name">
  <strong class="user"><em>lukaszNOSPAMPLEASE at epas dot pl</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#80426"> &para;</a><div class="date" title="2008-01-15 07:15"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom80426">
<div class="phpcode"><code><span class="html">i've got some bad news for you guys if you haven't found out already.<br />the trick with mysqli_next_result() only prevents having the connection dropped after a stored procedure call.<br />apparently you can bind parameters for a prepared stored procedure call, but you'll get messed up records from mysqli_stmt_fetch() after mysqli_stmt_bind_result(), at least when the stored procedure itself contains a prepared statement.<br />a way to avoid data corruption could be specifying the CLIENT_MULTI_STATEMENTS flag in mysqli_real_connect(), if it wasn't disabled entirely (for security reasons, as they say). another option is to use mysqli_multi_query(), but then you can't bind at all.</span></code></div>
  </div>
 </div>
  <div class="note" id="71439">  <div class="votes">
    <div id="Vu71439">
    <a href="https://www.php.net/manual/vote-note.php?id=71439&amp;page=mysqli-stmt.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd71439">
    <a href="https://www.php.net/manual/vote-note.php?id=71439&amp;page=mysqli-stmt.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V71439" title="25% like this...">
    -2
    </div>
  </div>
  <a href="mysqli-stmt.prepare.php.html#71439" class="name">
  <strong class="user"><em>lachlan76 at gmail dot com</em></strong></a><a class="genanchor" href="mysqli-stmt.prepare.php.html#71439"> &para;</a><div class="date" title="2006-11-28 08:59"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom71439">
<div class="phpcode"><code><span class="html">Do not try to use a stored procedure through a prepared statement.<br /><br />Example:<br /><br /><span class="default">&lt;?php<br />$statement </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">stmt_init</span><span class="keyword">();<br /></span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"CALL some_procedure()"</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />If you attempt to do this, it will fail by dropping the connection during the next query.  Use mysqli_multi_query instead.<br /><br />Example:<br /><br /><span class="default">&lt;?php<br />$mysqli</span><span class="keyword">-&gt;</span><span class="default">multi_query</span><span class="keyword">(</span><span class="string">"CALL some_procedure()"</span><span class="keyword">);<br />do<br />{<br />  </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">store_result</span><span class="keyword">();<br /><br />   </span><span class="comment">// Do your processing work here  <br />  <br />  </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">free</span><span class="keyword">();<br />} while(</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">next_result</span><span class="keyword">());<br /></span><span class="default">?&gt;<br /></span><br />This means that you cannot bind parameters or results, however.</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=mysqli-stmt.prepare&amp;redirect=https://www.php.net/manual/ru/mysqli-stmt.prepare.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="class.mysqli-stmt.php.html">mysqli_stmt</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="mysqli-stmt.affected-rows.php.html" title="$affected_&#8203;rows">$affected_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.attr-get.php.html" title="attr_&#8203;get">attr_&#8203;get</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.attr-set.php.html" title="attr_&#8203;set">attr_&#8203;set</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.bind-param.php.html" title="bind_&#8203;param">bind_&#8203;param</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.bind-result.php.html" title="bind_&#8203;result">bind_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.close.php.html" title="close">close</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.construct.php.html" title="_&#8203;_&#8203;construct">_&#8203;_&#8203;construct</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.data-seek.php.html" title="data_&#8203;seek">data_&#8203;seek</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.errno.php.html" title="$errno">$errno</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.error-list.php.html" title="$error_&#8203;list">$error_&#8203;list</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.error.php.html" title="$error">$error</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.execute.php.html" title="execute">execute</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.fetch.php.html" title="fetch">fetch</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.field-count.php.html" title="$field_&#8203;count">$field_&#8203;count</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.free-result.php.html" title="free_&#8203;result">free_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.get-result.php.html" title="get_&#8203;result">get_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.get-warnings.php.html" title="get_&#8203;warnings">get_&#8203;warnings</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.insert-id.php.html" title="$insert_&#8203;id">$insert_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.more-results.php.html" title="more_&#8203;results">more_&#8203;results</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.next-result.php.html" title="next_&#8203;result">next_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.num-rows.php.html" title="$num_&#8203;rows">$num_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.param-count.php.html" title="$param_&#8203;count">$param_&#8203;count</a>
                        </li>
                                                <li class="current">
                            <a href="mysqli-stmt.prepare.php.html" title="prepare">prepare</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.reset.php.html" title="reset">reset</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.result-metadata.php.html" title="result_&#8203;metadata">result_&#8203;metadata</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.send-long-data.php.html" title="send_&#8203;long_&#8203;data">send_&#8203;long_&#8203;data</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.sqlstate.php.html" title="$sqlstate">$sqlstate</a>
                        </li>
                                                <li class="">
                            <a href="mysqli-stmt.store-result.php.html" title="store_&#8203;result">store_&#8203;result</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
