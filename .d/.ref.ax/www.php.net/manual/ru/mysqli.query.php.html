<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: mysqli::query - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="mysqli.query.php.html">
 <link rel="shorturl" href="mysqli.query.php.html">
 <link rel="alternate" href="mysqli.query.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="class.mysqli.php.html">
 <link rel="prev" href="mysqli.prepare.php.html">
 <link rel="next" href="mysqli.real-connect.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/mysqli.query.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/mysqli.query.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/mysqli.query.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/mysqli.query.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/mysqli.query.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/mysqli.query.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/mysqli.query.php" hreflang="pt_BR">
 <link rel="alternate" href="mysqli.query.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/mysqli.query.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/mysqli.query.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="mysqli.real-connect.php.html">
          mysqli::real_connect &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="mysqli.prepare.php.html">
          &laquo; mysqli::prepare        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.vendors.php.html'>Модули для работы с базами данных отдельных производителей</a></li>      <li><a href='set.mysqlinfo.php.html'>MySQL</a></li>      <li><a href='book.mysqli.php.html'>MySQLi</a></li>      <li><a href='class.mysqli.php.html'>mysqli</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/mysqli.query.php'>English</option>
            <option value='de/mysqli.query.php'>German</option>
            <option value='es/mysqli.query.php'>Spanish</option>
            <option value='fr/mysqli.query.php'>French</option>
            <option value='it/mysqli.query.php'>Italian</option>
            <option value='ja/mysqli.query.php'>Japanese</option>
            <option value='pt_BR/mysqli.query.php'>Brazilian Portuguese</option>
            <option value='ru/mysqli.query.php' selected="selected">Russian</option>
            <option value='tr/mysqli.query.php'>Turkish</option>
            <option value='zh/mysqli.query.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/mysqli/mysqli/query.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fmysqli.query%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="mysqli.query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqli::query</h1>
  <h1 class="refname">mysqli_query</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mysqli::query</span> -- <span class="refname">mysqli_query</span> &mdash; <span class="dc-title">
   Выполняет запрос к базе данных
  </span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mysqli.query-description">
  <h3 class="title">Описание</h3>
  <p class="para">Объектно-ориентированный стиль</p>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>mysqli::query</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$result_mode</code><span class="initializer"> = <strong><code>MYSQLI_STORE_RESULT</code></strong></span></span>): <span class="type"><span class="type"><a href="class.mysqli-result.php.html" class="type mysqli_result">mysqli_result</a></span>|<span class="type">bool</span></span></div>

  <p class="para rdfs-comment">Процедурный стиль</p>
  <div class="methodsynopsis dc-description"><span class="methodname"><strong>mysqli_query</strong></span>(<span class="methodparam"><span class="type"><a href="class.mysqli.php.html" class="type mysqli">mysqli</a></span> <code class="parameter">$mysql</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$result_mode</code><span class="initializer"> = <strong><code>MYSQLI_STORE_RESULT</code></strong></span></span>): <span class="type"><span class="type"><a href="class.mysqli-result.php.html" class="type mysqli_result">mysqli_result</a></span>|<span class="type">bool</span></span></div>

  <p class="para rdfs-comment">
   Выполняет запрос <code class="parameter">query</code> к базе данных.
  </p>
  <div class="warning"><strong class="warning">Внимание</strong>
<h1 class="title">Предупреждение безопасности: SQL-инъекция</h1><p class="para">Вместо составления строки запроса с включением переменных значений
необходимо <a href="mysqli.quickstart.prepared-statements.php.html" class="link">подготавливать запросы</a>. Либо строки запроса должны быть экранированы
функцией <span class="function"><a href="mysqli.real-escape-string.php.html" class="function">mysqli_real_escape_string()</a></span> и правильно отформатированы.</p></div>
  <p class="para">
   Для не DML-запросов (не INSERT, UPDATE или DELETE),
   эта функция равносильна вызову
   функции <span class="function"><a href="mysqli.real-query.php.html" class="function">mysqli_real_query()</a></span>, а затем
   <span class="function"><a href="mysqli.use-result.php.html" class="function">mysqli_use_result()</a></span> или
   <span class="function"><a href="mysqli.store-result.php.html" class="function">mysqli_store_result()</a></span>.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Если длина передаваемого в функцию
    <span class="function"><strong>mysqli_query()</strong></span> выражения больше
    значения системной переменной <code class="literal">max_allowed_packet</code> сервера, будет сгенерирована ошибка.
    MySQL-драйвер (<code class="literal">mysqlnd</code>) и клиентская библиотека
    MySQL (<code class="literal">libmysqlclient</code>) выбрасывают разные коды ошибок.
    Поведение функции будет следующим:
   </p>

   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <code class="literal">mysqlnd</code> на платформе Linux возвращает код ошибки 1153.
      Сообщение об ошибке означает <q class="quote">размер пакета превышает
      <code class="literal">max_allowed_packet</code> байт</q>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">mysqlnd</code> на платформе Windows возвращает код ошибки 2006.
      Это сообщение об ошибке означает <q class="quote">отказ сервера</q>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">libmysqlclient</code> на всех платформах возвращает код ошибки 2006.
      Это сообщение об ошибке означает <q class="quote">отказ сервера</q>.
     </p>
    </li>
   </ul>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-mysqli.query-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    <dt>

<code class="parameter">mysql</code></dt>
<dd>
<p class="para">Только для процедурного стиля: объект <span class="classname"><a href="class.mysqli.php.html" class="classname">mysqli</a></span>, который вернула функция
<span class="function"><a href="function.mysqli-connect.php.html" class="function">mysqli_connect()</a></span> или функция <span class="function"><a href="mysqli.init.php.html" class="function">mysqli_init()</a></span>.
</p></dd>

    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       Текст запроса.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">result_mode</code></dt>

     <dd>

      <p class="para">
       Режим результата может быть одной из 3 констант, указывающих,
       как результат будет возвращён сервером MySQL.
      </p>
      <p class="para">
       <strong><code>MYSQLI_STORE_RESULT</code></strong> (по умолчанию) — возвращает объект
       <span class="classname"><a href="class.mysqli-result.php.html" class="classname">mysqli_result</a></span> с буферизованным набором результатов.
      </p>
      <p class="para">
       <strong><code>MYSQLI_USE_RESULT</code></strong> — возвращает объект
       <span class="classname"><a href="class.mysqli-result.php.html" class="classname">mysqli_result</a></span> с небуферизованным набором результатов.
       Пока есть отложенные записи, ожидающие выборки, линия соединения будет занята
       и все последующие вызовы будут возвращать ошибку <code class="literal">Commands out of sync</code>.
       Чтобы избежать ошибки, все записи должны быть получены с сервера или набор результатов должен быть отброшен путём вызова <span class="function"><a href="mysqli-result.free.php.html" class="function">mysqli_free_result()</a></span>.
      </p>
      <p class="para">
       <strong><code>MYSQLI_ASYNC</code></strong> (доступно с mysqlnd) — запрос выполняется асинхронно, набор результатов сразу не возвращается.
       Затем вызывают функцию <span class="function"><a href="mysqli.poll.php.html" class="function">mysqli_poll()</a></span> для получения результатов по этим запросам.
       Можно использовать в сочетании с константой
       <strong><code>MYSQLI_STORE_RESULT</code></strong> или
       <strong><code>MYSQLI_USE_RESULT</code></strong>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mysqli.query-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <strong><code>false</code></strong> в случае возникновения ошибки. В случае успешного выполнения запросов,
   которые создают набор результатов, таких как <code class="literal">SELECT, SHOW, DESCRIBE</code> или
   <code class="literal">EXPLAIN</code>, функция <span class="function"><strong>mysqli_query()</strong></span> вернёт объект <span class="classname"><a href="class.mysqli-result.php.html" class="classname">mysqli_result</a></span>.
   Для остальных успешных запросов <span class="function"><strong>mysqli_query()</strong></span> вернёт <strong><code>true</code></strong>.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-mysqli.query-errors">
  <h3 class="title">Ошибки</h3>
  <p class="para">
Если уведомления об ошибках mysqli включены (<strong><code>MYSQLI_REPORT_ERROR</code></strong>) и запрошенная операция не удалась,
выдаётся предупреждение. Если, кроме того, установлен режим <strong><code>MYSQLI_REPORT_STRICT</code></strong>,
вместо этого будет выброшено исключение <span class="classname"><a href="class.mysqli-sql-exception.php.html" class="classname">mysqli_sql_exception</a></span>.</p>
 </div>


 <div class="refsect1 examples" id="refsect1-mysqli.query-examples">
  <h3 class="title">Примеры</h3>
  <div class="example" id="ldap-count-entries.example.basic">
   <p><strong>Пример #1 Пример использования <span class="methodname"><strong>mysqli::query()</strong></span></strong></p>
   <div class="example-contents"><p>Объектно-ориентированный стиль</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR </span><span style="color: #007700">| </span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mysqli </span><span style="color: #007700">= new </span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">, </span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Создание таблицы, не возвращает набор результатов */<br /></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"CREATE TEMPORARY TABLE myCity LIKE City"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Таблица myCity создана.\n"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Запросы SELECT, возвращают набор результатов */<br /></span><span style="color: #0000BB">$result </span><span style="color: #007700">= </span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT Name FROM City LIMIT 10"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Запрос SELECT вернул %d строк.\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Если нужно извлечь большой объем данных, используем MYSQLI_USE_RESULT */<br /></span><span style="color: #0000BB">$result </span><span style="color: #007700">= </span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT * FROM City"</span><span style="color: #007700">, </span><span style="color: #0000BB">MYSQLI_USE_RESULT</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Важно заметить, что мы не можем вызывать функции, которые взаимодействуют<br />   с сервером, пока не закроем набор результатов. Все подобные вызовы<br />   будут вызывать ошибку 'out of sync' */<br /></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SET @a:='this will not work'"</span><span style="color: #007700">);</span></span></code></div>
   </div>

   <div class="example-contents"><p>Процедурный стиль</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR </span><span style="color: #007700">| </span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$link </span><span style="color: #007700">= </span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">, </span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">, </span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Создание таблицы, не возвращает набор результатов */<br /></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">, </span><span style="color: #DD0000">"CREATE TEMPORARY TABLE myCity LIKE City"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Таблица myCity создана.\n"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Запросы SELECT, возвращают набор результатов */<br /></span><span style="color: #0000BB">$result </span><span style="color: #007700">= </span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT Name FROM City LIMIT 10"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Запрос SELECT вернул %d строк.\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">mysqli_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">/* Если нужно извлечь большой объем данных, используем MYSQLI_USE_RESULT */<br /></span><span style="color: #0000BB">$result </span><span style="color: #007700">= </span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">, </span><span style="color: #DD0000">"SELECT * FROM City"</span><span style="color: #007700">, </span><span style="color: #0000BB">MYSQLI_USE_RESULT</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/* Важно заметить, что мы не можем вызывать функции, которые взаимодействуют<br />   с сервером, пока не закроем набор результатов. Все подобные вызовы<br />   будут вызывать ошибку 'out of sync' */<br /></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">, </span><span style="color: #DD0000">"SET @a:='this will not work'"</span><span style="color: #007700">);</span></span></code></div>
   </div>

   
<div class="example-contents"><p>
 Результат выполнения приведённых примеров:
</p></div>

   <div class="example-contents screen">
<div class="cdata"><pre>
Таблица myCity создана.
Запрос SELECT вернул 10 строк.

Fatal error: Uncaught mysqli_sql_exception: Commands out of sync; you can&#039;t run this command now in...
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-mysqli.query-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli.execute-query.php.html" class="function" rel="rdfs-seeAlso">mysqli_execute_query()</a> - Подготавливает, связывает параметры и выполняет SQL-запрос</span></li>
    <li class="member"><span class="function"><a href="mysqli.real-query.php.html" class="function" rel="rdfs-seeAlso">mysqli_real_query()</a> - Выполнение SQL запроса</span></li>
    <li class="member"><span class="function"><a href="mysqli.multi-query.php.html" class="function" rel="rdfs-seeAlso">mysqli_multi_query()</a> - Выполняет один или несколько запросов к базе данных</span></li>
    <li class="member"><span class="function"><a href="mysqli.prepare.php.html" class="function" rel="rdfs-seeAlso">mysqli_prepare()</a> - Подготавливает SQL выражение к выполнению</span></li>
    <li class="member"><span class="function"><a href="mysqli-result.free.php.html" class="function" rel="rdfs-seeAlso">mysqli_free_result()</a> - Освобождает память, занятую результатами запроса</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=mysqli.query&amp;redirect=https://www.php.net/manual/ru/mysqli.query.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">21 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="80821">  <div class="votes">
    <div id="Vu80821">
    <a href="https://www.php.net/manual/vote-note.php?id=80821&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd80821">
    <a href="https://www.php.net/manual/vote-note.php?id=80821&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V80821" title="56% like this...">
    48
    </div>
  </div>
  <a href="mysqli.query.php.html#80821" class="name">
  <strong class="user"><em>NUNTIUS</em></strong></a><a class="genanchor" href="mysqli.query.php.html#80821"> &para;</a><div class="date" title="2008-02-01 01:33"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom80821">
<div class="phpcode"><code><span class="html">This may or may not be obvious to people but perhaps it will help someone.<br /><br />When running joins in SQL you may encounter a problem if you are trying to pull two columns with the same name. mysqli returns the last in the query when called by name. So to get what you need you can use an alias.<br /><br />Below I am trying to join a user id with a user role. in the first table (tbl_usr), role is a number and in the second is a  text name (tbl_memrole is a lookup table). If I call them both as role I get the text as it is the last "role" in the query. If I use an alias then I get both as desired as shown below.<br /><br /><span class="default">&lt;?php<br />$sql </span><span class="keyword">= </span><span class="string">"SELECT a.uid, a.role AS roleid, b.role, <br />            FROM tbl_usr a<br />            INNER JOIN tbl_memrole b<br />            ON a.role = b.id<br />            "</span><span class="keyword">;<br /><br />    if (</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">)) {<br />        while(</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_object</span><span class="keyword">()){<br />            </span><span class="default">$line</span><span class="keyword">.=</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">uid</span><span class="keyword">;<br />            </span><span class="default">$line</span><span class="keyword">.=</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">role</span><span class="keyword">;<br />            </span><span class="default">$line</span><span class="keyword">.=</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">roleid</span><span class="keyword">;<br />        }<br />    }<br />    </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />    unset(</span><span class="default">$obj</span><span class="keyword">);<br />    unset(</span><span class="default">$sql</span><span class="keyword">);<br />    unset(</span><span class="default">$query</span><span class="keyword">);<br />    <br /></span><span class="default">?&gt;<br /></span>In this situation I guess I could have just renamed the role column in the first table roleid and that would have taken care of it, but it was a learning experience.</span></code></div>
  </div>
 </div>
  <div class="note" id="103422">  <div class="votes">
    <div id="Vu103422">
    <a href="https://www.php.net/manual/vote-note.php?id=103422&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd103422">
    <a href="https://www.php.net/manual/vote-note.php?id=103422&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V103422" title="53% like this...">
    34
    </div>
  </div>
  <a href="mysqli.query.php.html#103422" class="name">
  <strong class="user"><em>theyranos at gmail dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#103422"> &para;</a><div class="date" title="2011-04-12 06:35"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom103422">
<div class="phpcode"><code><span class="html">The cryptic "Couldn't fetch mysqli" error message can mean any number of things, including:<br /><br />1. You're trying to use a database object that you've already closed (as noted by ceo at l-i-e dot com). Reopen your database connection, or find the call to <span class="default">&lt;?php mysqli_close</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">); </span><span class="default">?&gt;</span> or <span class="default">&lt;?php $db</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">(); </span><span class="default">?&gt;</span> and remove it.<br />2. Your MySQLi object has been serialized and unserialized for some reason. Define a wakeup function to re-create your database connection. <a href="http://php.net/__wakeup" rel="nofollow" target="_blank">http://php.net/__wakeup</a> <br />3. Something besides you closed your mysqli connection (in particular, see <a href="http://bugs.php.net/bug.php?id=33772" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=33772</a>)<br />4. You mixed OOP and functional calls to the database object. (So, you have <span class="default">&lt;?php $db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">() </span><span class="default">?&gt;</span> in the same program as <span class="default">&lt;?php mysqli_query</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">) </span><span class="default">?&gt;</span>).</span></code></div>
  </div>
 </div>
  <div class="note" id="102904">  <div class="votes">
    <div id="Vu102904">
    <a href="https://www.php.net/manual/vote-note.php?id=102904&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd102904">
    <a href="https://www.php.net/manual/vote-note.php?id=102904&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V102904" title="52% like this...">
    34
    </div>
  </div>
  <a href="mysqli.query.php.html#102904" class="name">
  <strong class="user"><em>petrus.jvr</em></strong></a><a class="genanchor" href="mysqli.query.php.html#102904"> &para;</a><div class="date" title="2011-03-14 03:40"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom102904">
<div class="phpcode"><code><span class="html">When calling multiple stored procedures, you can run into the following error: "Commands out of sync; you can't run this command now".<br />This can happen even when using the close() function on the result object between calls. <br />To fix the problem, remember to call the next_result() function on the mysqli object after each stored procedure call. See example below:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// New Connection<br /></span><span class="default">$db </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">,</span><span class="string">'user'</span><span class="keyword">,</span><span class="string">'pass'</span><span class="keyword">,</span><span class="string">'database'</span><span class="keyword">);<br /><br /></span><span class="comment">// Check for errors<br /></span><span class="keyword">if(</span><span class="default">mysqli_connect_errno</span><span class="keyword">()){<br /> echo </span><span class="default">mysqli_connect_error</span><span class="keyword">();<br />}<br /><br /></span><span class="comment">// 1st Query<br /></span><span class="default">$result </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"call getUsers()"</span><span class="keyword">);<br />if(</span><span class="default">$result</span><span class="keyword">){<br />     </span><span class="comment">// Cycle through results<br />    </span><span class="keyword">while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_object</span><span class="keyword">()){<br />        </span><span class="default">$user_arr</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />    }<br />    </span><span class="comment">// Free result set<br />    </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />    </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">next_result</span><span class="keyword">();<br />}<br /><br /></span><span class="comment">// 2nd Query<br /></span><span class="default">$result </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"call getGroups()"</span><span class="keyword">);<br />if(</span><span class="default">$result</span><span class="keyword">){<br />     </span><span class="comment">// Cycle through results<br />    </span><span class="keyword">while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_object</span><span class="keyword">()){<br />        </span><span class="default">$group_arr</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />    }<br />     </span><span class="comment">// Free result set<br />     </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />     </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">next_result</span><span class="keyword">();<br />}<br />else echo(</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">);<br /><br /></span><span class="comment">// Close connection<br /></span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="127646">  <div class="votes">
    <div id="Vu127646">
    <a href="https://www.php.net/manual/vote-note.php?id=127646&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd127646">
    <a href="https://www.php.net/manual/vote-note.php?id=127646&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V127646" title="61% like this...">
    6
    </div>
  </div>
  <a href="mysqli.query.php.html#127646" class="name">
  <strong class="user"><em>xa at sagexa dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#127646"> &para;</a><div class="date" title="2022-09-16 04:33"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom127646">
<div class="phpcode"><code><span class="html">"In PHP 8.1, the default error handling behavior of the MySQLi extension has changed from silencing errors to throw an Exception on errors. "<br />This is true even for the procedural use of mysqli, i.e. mysqli_query.<br />Hence, using if(!mysqli_query($c, $sql)) [...] is pointless.<br />To disable Exception throwing : mysqli_report(MYSQLI_REPORT_OFF);</span></code></div>
  </div>
 </div>
  <div class="note" id="122800">  <div class="votes">
    <div id="Vu122800">
    <a href="https://www.php.net/manual/vote-note.php?id=122800&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122800">
    <a href="https://www.php.net/manual/vote-note.php?id=122800&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122800" title="51% like this...">
    12
    </div>
  </div>
  <a href="mysqli.query.php.html#122800" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="mysqli.query.php.html#122800"> &para;</a><div class="date" title="2018-06-05 11:21"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom122800">
<div class="phpcode"><code><span class="html">Here is an example of a clean query into a html table<br /><br />&lt;table&gt;<br />   &lt;tr&gt;<br />     &lt;th&gt;First Name&lt;/th&gt;<br />     &lt;th&gt;Last Name&lt;/th&gt;<br />     &lt;th&gt;City&lt;/th&gt;<br />   &lt;/tr&gt;<br />   <span class="default">&lt;?php </span><span class="keyword">while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">$myquery</span><span class="keyword">-&gt;</span><span class="default">fetch_assoc</span><span class="keyword">()) { </span><span class="default">?&gt;<br /></span>   &lt;tr&gt;<br />     &lt;td&gt;<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$row</span><span class="keyword">[</span><span class="string">"firstname"</span><span class="keyword">]; </span><span class="default">?&gt;</span>&lt;/td&gt;<br />     &lt;td&gt;<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$row</span><span class="keyword">[</span><span class="string">"lastname"</span><span class="keyword">]; </span><span class="default">?&gt;</span>&lt;/td&gt;<br />     &lt;td&gt;<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$row</span><span class="keyword">[</span><span class="string">"city"</span><span class="keyword">];</span><span class="default">?&gt;</span>&lt;/td&gt;<br />   &lt;/tr&gt;<br />   <span class="default">&lt;?php </span><span class="keyword">} </span><span class="default">?&gt;<br /></span> &lt;/table&gt;</span></code></div>
  </div>
 </div>
  <div class="note" id="98535">  <div class="votes">
    <div id="Vu98535">
    <a href="https://www.php.net/manual/vote-note.php?id=98535&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98535">
    <a href="https://www.php.net/manual/vote-note.php?id=98535&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98535" title="49% like this...">
    -2
    </div>
  </div>
  <a href="mysqli.query.php.html#98535" class="name">
  <strong class="user"><em>registrations at jdfoxmicro dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#98535"> &para;</a><div class="date" title="2010-06-21 04:11"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom98535">
<div class="phpcode"><code><span class="html">I like to save the query itself in a log file, so that I don't have to worry about whether the site is live.<br /><br />For example, I might have a global function:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">UpdateLog </span><span class="keyword">( </span><span class="default">$string </span><span class="keyword">, </span><span class="default">$logfile </span><span class="keyword">)  {<br />   </span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">( </span><span class="default">$logfile </span><span class="keyword">, </span><span class="string">'a' </span><span class="keyword">);<br />   </span><span class="default">$fwrite </span><span class="keyword">( </span><span class="default">$fh </span><span class="keyword">, </span><span class="default">strftime </span><span class="keyword">(</span><span class="string">'%F %T %z'</span><span class="keyword">).</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$string</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />   </span><span class="default">fclose </span><span class="keyword">( </span><span class="default">$fh </span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />Then in my mysql function error trapper, something like this:<br /><br /><span class="default">&lt;?php<br />   $error_msg </span><span class="keyword">= </span><span class="string">"Database error in [page].php / "</span><span class="keyword">;<br />   </span><span class="default">$error_msg </span><span class="keyword">.= </span><span class="default">mysqli_error </span><span class="keyword">( </span><span class="default">$link </span><span class="keyword">).</span><span class="string">" / "</span><span class="keyword">;<br />   </span><span class="default">$error_msg </span><span class="keyword">.= </span><span class="default">$query</span><span class="keyword">;<br />   </span><span class="default">UpdateLog </span><span class="keyword">( </span><span class="default">$error_msg </span><span class="keyword">, </span><span class="default">DB_ERROR_LOG_FILE </span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />I also include the remote IP, user agent, etc., but I left it out of these code samples.  And have it e-mail me when an error is caught, too.<br /><br />Jeff</span></code></div>
  </div>
 </div>
  <div class="note" id="85367">  <div class="votes">
    <div id="Vu85367">
    <a href="https://www.php.net/manual/vote-note.php?id=85367&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd85367">
    <a href="https://www.php.net/manual/vote-note.php?id=85367&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V85367" title="49% like this...">
    -2
    </div>
  </div>
  <a href="mysqli.query.php.html#85367" class="name">
  <strong class="user"><em>ceo at l-i-e dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#85367"> &para;</a><div class="date" title="2008-08-27 07:51"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom85367">
<div class="phpcode"><code><span class="html">Translation:<br />"Couldn't fetch mysqli"<br /><br />You closed your connection and are trying to use it again.<br /><br />It has taken me DAYS to figure out what this obscure error message means...</span></code></div>
  </div>
 </div>
  <div class="note" id="60473">  <div class="votes">
    <div id="Vu60473">
    <a href="https://www.php.net/manual/vote-note.php?id=60473&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd60473">
    <a href="https://www.php.net/manual/vote-note.php?id=60473&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V60473" title="49% like this...">
    -2
    </div>
  </div>
  <a href="mysqli.query.php.html#60473" class="name">
  <strong class="user"><em>Beeners</em></strong></a><a class="genanchor" href="mysqli.query.php.html#60473"> &para;</a><div class="date" title="2006-01-08 12:16"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom60473">
<div class="phpcode"><code><span class="html">Stored Procedures.<br /><br />Use mysqli_query to call a stored procedure that returns a result set. <br /><br />Here is a short example:<br /><br /><span class="default">&lt;?php<br />$mysqli </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="default">DBURI</span><span class="keyword">,</span><span class="default">DBUSER</span><span class="keyword">,</span><span class="default">DBPASS</span><span class="keyword">,</span><span class="default">DBNAME</span><span class="keyword">);<br />if (</span><span class="default">mysqli_connect_errno</span><span class="keyword">()) <br />{<br />  </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Connection failed: %s\n"</span><span class="keyword">, </span><span class="default">mysqli_connect_error</span><span class="keyword">());<br />  exit();<br />}<br /><br /></span><span class="default">$SQL </span><span class="keyword">= </span><span class="string">"CALL my_procedure(</span><span class="default">$something</span><span class="string">)"</span><span class="keyword">;<br />if ( (</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$SQL</span><span class="keyword">))===</span><span class="default">false </span><span class="keyword">)<br />{<br />  </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Invalid query: %s\nWhole query: %s\n"</span><span class="keyword">, </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">, </span><span class="default">$SQL</span><span class="keyword">);<br />  exit();<br />}<br /><br />while (</span><span class="default">$myrow </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">(</span><span class="default">MYSQLI_ASSOC</span><span class="keyword">))<br />{<br />  </span><span class="default">$aValue</span><span class="keyword">[]=</span><span class="default">$myrow</span><span class="keyword">[</span><span class="string">"a"</span><span class="keyword">];<br />  </span><span class="default">$bValue</span><span class="keyword">[]=</span><span class="default">$myrow</span><span class="keyword">[</span><span class="string">"b"</span><span class="keyword">];<br />}<br /></span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br /></span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br /></span><span class="default">?&gt;<br /></span>I hope this saves someone some time.</span></code></div>
  </div>
 </div>
  <div class="note" id="65813">  <div class="votes">
    <div id="Vu65813">
    <a href="https://www.php.net/manual/vote-note.php?id=65813&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd65813">
    <a href="https://www.php.net/manual/vote-note.php?id=65813&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V65813" title="46% like this...">
    -11
    </div>
  </div>
  <a href="mysqli.query.php.html#65813" class="name">
  <strong class="user"><em>info at ff dot net</em></strong></a><a class="genanchor" href="mysqli.query.php.html#65813"> &para;</a><div class="date" title="2006-05-08 04:12"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom65813">
<div class="phpcode"><code><span class="html">Calling Stored Procedures<br /><br />Beeners' note/example will not work. Use mysqli_multi_query() to call a Stored Procedure. SP's have a second result-set which contains the status: 'OK' or 'ERR'. Using mysqli_query will not work, as there are multiple results.<br /><br /><span class="default">&lt;?php<br />$sQuery</span><span class="keyword">=</span><span class="string">"CALL SomeSP('params')"</span><span class="keyword">;<br />if(!</span><span class="default">mysqli_multi_query</span><span class="keyword">(</span><span class="default">$sqlLink</span><span class="keyword">,</span><span class="default">$sQuery</span><span class="keyword">)) {<br />  </span><span class="comment">// your error handler <br /></span><span class="keyword">}<br /></span><span class="default">$sqlResult</span><span class="keyword">=</span><span class="default">mysqli_store_result</span><span class="keyword">(</span><span class="default">$sqlLink</span><span class="keyword">);<br /><br />if(</span><span class="default">mysqli_more_results</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sqlLink</span><span class="keyword">))</span><span class="comment">//Catch 'OK'/'ERR'<br />  </span><span class="keyword">while(</span><span class="default">mysqli_next_result</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sqlLink</span><span class="keyword">));<br /></span><span class="default">?&gt;<br /></span><br />You will have to rewrite/expand this a bit for more usability of course, but it's just an example.</span></code></div>
  </div>
 </div>
  <div class="note" id="114636">  <div class="votes">
    <div id="Vu114636">
    <a href="https://www.php.net/manual/vote-note.php?id=114636&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd114636">
    <a href="https://www.php.net/manual/vote-note.php?id=114636&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V114636" title="45% like this...">
    -15
    </div>
  </div>
  <a href="mysqli.query.php.html#114636" class="name">
  <strong class="user"><em>joseph_robert_martinez at yahoo dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#114636"> &para;</a><div class="date" title="2014-03-14 07:00"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom114636">
<div class="phpcode"><code><span class="html">For those using with replication enabled on their servers,  add a mysqli_select_db() statement before any data modification queries.  MySQL replication does not handle statements with db.table the same and will not replicate to the slaves if a scheme is not selected before.<br /><br />Found out after days of resetting master and slaves on another site <a href="http://www.linuxquestions.org/questions/linux-server-73/mysql-5-1-not-replicating-properly-with-slave-823296/" rel="nofollow" target="_blank">http://www.linuxquestions.org/questions/linux-server-73/mysql-5-1-not-replicating-properly-with-slave-823296/</a></span></code></div>
  </div>
 </div>
  <div class="note" id="44707">  <div class="votes">
    <div id="Vu44707">
    <a href="https://www.php.net/manual/vote-note.php?id=44707&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd44707">
    <a href="https://www.php.net/manual/vote-note.php?id=44707&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V44707" title="45% like this...">
    -13
    </div>
  </div>
  <a href="mysqli.query.php.html#44707" class="name">
  <strong class="user"><em>hunreal at gmail dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#44707"> &para;</a><div class="date" title="2004-08-13 02:24"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom44707">
<div class="phpcode"><code><span class="html">Use difference collation/character for connect, result.<br />You can set the collation before your query.<br /><br />E.g. want to set the collation to utf8_general_ci <br />you can send the query "SET NAMES 'utf8'" first<br /><br /><span class="default">&lt;?php<br />$mysqli</span><span class="keyword">=new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'root'</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">, </span><span class="string">'test'</span><span class="keyword">);<br /></span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SET NAMES 'utf8'"</span><span class="keyword">);<br /></span><span class="default">$q</span><span class="keyword">=</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"select * from test"</span><span class="keyword">);<br />while(</span><span class="default">$r</span><span class="keyword">=</span><span class="default">$q</span><span class="keyword">-&gt;</span><span class="default">fetch_assoc</span><span class="keyword">()) {<br />    </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />There are many variables about character settings.<br />By running sql command, SHOW VARIABLES LIKE 'char%'; <br />There are some variables control the character usage.<br /><br />character_set_client<br />character_set_connection<br />character_set_database<br />character_set_results<br />character_set_server<br />character_set_system<br /><br />Also SET NAMES can repalce with one or some settings like SET character_set_results='utf8';</span></code></div>
  </div>
 </div>
  <div class="note" id="75144">  <div class="votes">
    <div id="Vu75144">
    <a href="https://www.php.net/manual/vote-note.php?id=75144&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd75144">
    <a href="https://www.php.net/manual/vote-note.php?id=75144&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V75144" title="45% like this...">
    -14
    </div>
  </div>
  <a href="mysqli.query.php.html#75144" class="name">
  <strong class="user"><em>jcwebb at dicoe dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#75144"> &para;</a><div class="date" title="2007-05-15 01:42"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom75144">
<div class="phpcode"><code><span class="html">When building apps, i like to see the whole statement when if fails.<br /><span class="default">&lt;?php<br />$q</span><span class="keyword">=</span><span class="string">"SELECT somecolumn FROM sometable"</span><span class="keyword">; </span><span class="comment">//some instruction<br /></span><span class="default">$r</span><span class="keyword">=</span><span class="default">mysqli_query</span><span class="keyword">(</span><span class="default">$DBlink</span><span class="keyword">,</span><span class="default">$q</span><span class="keyword">) or die(</span><span class="default">mysqli_error</span><span class="keyword">(</span><span class="default">$DBlink</span><span class="keyword">).</span><span class="string">" Q="</span><span class="keyword">.</span><span class="default">$q</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span>If theres an error (like my numerous typing mistakes) this shows the entire instruction.<br />Good for development (not so good on production servers - simply find and replace when finished: $r=mysqli_query($DBlink,$q); )<br /><br />Hope it helps. Jon</span></code></div>
  </div>
 </div>
  <div class="note" id="87203">  <div class="votes">
    <div id="Vu87203">
    <a href="https://www.php.net/manual/vote-note.php?id=87203&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd87203">
    <a href="https://www.php.net/manual/vote-note.php?id=87203&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V87203" title="45% like this...">
    -16
    </div>
  </div>
  <a href="mysqli.query.php.html#87203" class="name">
  <strong class="user"><em>Igor</em></strong></a><a class="genanchor" href="mysqli.query.php.html#87203"> &para;</a><div class="date" title="2008-11-24 06:54"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom87203">
<div class="phpcode"><code><span class="html">mysqli::query() can only execute one SQL statement.<br /><br />Use mysqli::multi_query() when you want to run multiple SQL statements within one query.</span></code></div>
  </div>
 </div>
  <div class="note" id="100079">  <div class="votes">
    <div id="Vu100079">
    <a href="https://www.php.net/manual/vote-note.php?id=100079&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd100079">
    <a href="https://www.php.net/manual/vote-note.php?id=100079&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V100079" title="44% like this...">
    -17
    </div>
  </div>
  <a href="mysqli.query.php.html#100079" class="name">
  <strong class="user"><em>thomas dekker</em></strong></a><a class="genanchor" href="mysqli.query.php.html#100079"> &para;</a><div class="date" title="2010-09-23 11:08"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom100079">
<div class="phpcode"><code><span class="html">Building inserts can be annoying. This helper function inserts an array into a table, using the key names as column names:<br /><br /><span class="default">&lt;?php<br />  </span><span class="keyword">private function </span><span class="default">store_array </span><span class="keyword">(&amp;</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$table</span><span class="keyword">, </span><span class="default">$mysqli</span><span class="keyword">)<br />  {<br />    </span><span class="default">$cols </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">));<br />    foreach (</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) as </span><span class="default">$value</span><span class="keyword">)<br />    {<br />      isset(</span><span class="default">$vals</span><span class="keyword">) ? </span><span class="default">$vals </span><span class="keyword">.= </span><span class="string">',' </span><span class="keyword">: </span><span class="default">$vals </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />      </span><span class="default">$vals </span><span class="keyword">.= </span><span class="string">'\''</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mysql</span><span class="keyword">-&gt;</span><span class="default">real_escape_string</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">).</span><span class="string">'\''</span><span class="keyword">;<br />    }<br />    </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">real_query</span><span class="keyword">(</span><span class="string">'INSERT INTO '</span><span class="keyword">.</span><span class="default">$table</span><span class="keyword">.</span><span class="string">' ('</span><span class="keyword">.</span><span class="default">$cols</span><span class="keyword">.</span><span class="string">') VALUES ('</span><span class="keyword">.</span><span class="default">$vals</span><span class="keyword">.</span><span class="string">')'</span><span class="keyword">);<br />  }<br /></span><span class="default">?&gt;<br /></span><br />Adapt it to your specific needs.</span></code></div>
  </div>
 </div>
  <div class="note" id="115718">  <div class="votes">
    <div id="Vu115718">
    <a href="https://www.php.net/manual/vote-note.php?id=115718&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115718">
    <a href="https://www.php.net/manual/vote-note.php?id=115718&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115718" title="44% like this...">
    -20
    </div>
  </div>
  <a href="mysqli.query.php.html#115718" class="name">
  <strong class="user"><em>ahmed dot 3abdolah at gmail dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#115718"> &para;</a><div class="date" title="2014-09-12 11:39"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom115718">
<div class="phpcode"><code><span class="html">Hi, i created function that add  a new table using array , i work with it on my projects ...<br /><span class="default">&lt;?PHP<br />                   </span><span class="comment">/* this function was learned from PHP.net */<br /></span><span class="keyword">function </span><span class="default">array_keys_exist</span><span class="keyword">(&amp;</span><span class="default">$key</span><span class="keyword">,array &amp;</span><span class="default">$array</span><span class="keyword">){<br />                </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"\|"</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">);<br />                foreach(</span><span class="default">$keys </span><span class="keyword">as </span><span class="default">$key_s</span><span class="keyword">){<br />                    if(</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$key_s</span><span class="keyword">, </span><span class="default">$array</span><span class="keyword">)) return </span><span class="default">true</span><span class="keyword">;<br />                    }<br />                return </span><span class="default">false</span><span class="keyword">;<br />            }<br /></span><span class="comment">/*and this is my function */<br /></span><span class="default">array_create_table</span><span class="keyword">(array &amp;</span><span class="default">$array</span><span class="keyword">){<br />        if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">)){<br />           </span><span class="default">$key </span><span class="keyword">= </span><span class="string">"table|rows|values"</span><span class="keyword">;    <br />        </span><span class="default">$info </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />        if(</span><span class="default">array_keys_exist</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">,</span><span class="default">$array</span><span class="keyword">)){<br />        if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"rows"</span><span class="keyword">]) and </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"values"</span><span class="keyword">]) ){<br />                                         <br />            if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"rows"</span><span class="keyword">]) == </span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"values"</span><span class="keyword">])) { <br />                        for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"rows"</span><span class="keyword">]); </span><span class="default">$i</span><span class="keyword">++){<br />    </span><span class="default">$info </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"rows"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">].</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"values"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">].</span><span class="string">" NOT NULL "</span><span class="keyword">;<br />            if(</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"rows"</span><span class="keyword">])-</span><span class="default">1 </span><span class="keyword">) </span><span class="default">$info </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">.</span><span class="string">","</span><span class="keyword">; <br />                    }<br />    </span><span class="default">$query </span><span class="keyword">= </span><span class="string">"CREATE TABLE "</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">private_tables_name</span><span class="keyword">.</span><span class="default">$array</span><span class="keyword">[</span><span class="string">"table"</span><span class="keyword">].</span><span class="string">" "</span><span class="keyword">;<br />    </span><span class="default">$query </span><span class="keyword">.= </span><span class="string">"( id INT NOT NULL AUTO_INCREMENT PRIMARY KEY, "</span><span class="keyword">.</span><span class="default">$info</span><span class="keyword">.</span><span class="string">" )"</span><span class="keyword">;<br />                    return </span><span class="default">$query</span><span class="keyword">;    <br />                        }<br />                        }<br />                }else return </span><span class="string">"Error"</span><span class="keyword">;<br />                    }<br />            }<br /><br /></span><span class="comment">/* the use is simple */<br /></span><span class="default">$database </span><span class="keyword">= new </span><span class="default">database</span><span class="keyword">(); </span><span class="comment">// connection to database i used mysqli ... <br /></span><span class="default">$array </span><span class="keyword">= array(</span><span class="string">"table"</span><span class="keyword">=&gt;</span><span class="string">"MRO"</span><span class="keyword">, </span><span class="string">"rows"</span><span class="keyword">=&gt;array(</span><span class="string">"name"</span><span class="keyword">,</span><span class="string">"username"</span><span class="keyword">) , </span><span class="string">"values" </span><span class="keyword">=&gt; array(</span><span class="string">"VARCHAR (50) "</span><span class="keyword">,</span><span class="string">" VARCHAR (50) "</span><span class="keyword">) );<br /><br /></span><span class="default">$query </span><span class="keyword">= </span><span class="default">array_create_table</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">); </span><span class="comment">// convert and create the query ...<br /></span><span class="keyword">if(</span><span class="default">$database</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">)) echo </span><span class="string">"Work"</span><span class="keyword">; else echo </span><span class="string">"Error"</span><span class="keyword">; </span><span class="comment">// result : work<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="104443">  <div class="votes">
    <div id="Vu104443">
    <a href="https://www.php.net/manual/vote-note.php?id=104443&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd104443">
    <a href="https://www.php.net/manual/vote-note.php?id=104443&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V104443" title="42% like this...">
    -17
    </div>
  </div>
  <a href="mysqli.query.php.html#104443" class="name">
  <strong class="user"><em>marcus at synchromedia dot co dot uk</em></strong></a><a class="genanchor" href="mysqli.query.php.html#104443"> &para;</a><div class="date" title="2011-06-15 10:17"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom104443">
<div class="phpcode"><code><span class="html">The exact type returned by a successful query is mysqli_result.</span></code></div>
  </div>
 </div>
  <div class="note" id="112537">  <div class="votes">
    <div id="Vu112537">
    <a href="https://www.php.net/manual/vote-note.php?id=112537&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112537">
    <a href="https://www.php.net/manual/vote-note.php?id=112537&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112537" title="43% like this...">
    -20
    </div>
  </div>
  <a href="mysqli.query.php.html#112537" class="name">
  <strong class="user"><em>popere dot noel at yahoo dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#112537"> &para;</a><div class="date" title="2013-06-26 09:43"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom112537">
<div class="phpcode"><code><span class="html">or you could just extend the class...<br /> in my case i already had a wraper for the db so something like this was easy :<br /><br /> public function  free($result) {<br />  <br />  $result-&gt;free_result();<br /> $this-&gt;link-&gt;next_result();<br /> }<br /><br />just tried it and it works like a charm ;-)</span></code></div>
  </div>
 </div>
  <div class="note" id="121985">  <div class="votes">
    <div id="Vu121985">
    <a href="https://www.php.net/manual/vote-note.php?id=121985&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121985">
    <a href="https://www.php.net/manual/vote-note.php?id=121985&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121985" title="34% like this...">
    -9
    </div>
  </div>
  <a href="mysqli.query.php.html#121985" class="name">
  <strong class="user"><em>omidbahrami1990 at gmail dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#121985"> &para;</a><div class="date" title="2017-12-06 10:17"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121985">
<div class="phpcode"><code><span class="html">This Is A Secure Way To Use mysqli::query<br />--------------------------------------------------------<br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">secured_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">)<br />{<br /></span><span class="default">$connection </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">,</span><span class="default">$username</span><span class="keyword">,</span><span class="default">$password</span><span class="keyword">,</span><span class="default">$name</span><span class="keyword">);<br />    <br />if (</span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">connect_error</span><span class="keyword">) <br />die(</span><span class="string">"Secured"</span><span class="keyword">);<br />    <br /></span><span class="default">$result</span><span class="keyword">=</span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />if(</span><span class="default">$result</span><span class="keyword">==</span><span class="default">FALSE</span><span class="keyword">)<br />die(</span><span class="string">"Secured"</span><span class="keyword">);<br />    <br /></span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();        <br />return </span><span class="default">$result</span><span class="keyword">;    <br />}<br /></span><span class="comment">/*<br />$host ---&gt; DataBase IP Address<br />$username ---&gt; DataBase Username<br />$password ---&gt; DataBase Password<br />$name ---&gt; DataBase Name<br />*/<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="112353">  <div class="votes">
    <div id="Vu112353">
    <a href="https://www.php.net/manual/vote-note.php?id=112353&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112353">
    <a href="https://www.php.net/manual/vote-note.php?id=112353&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112353" title="41% like this...">
    -23
    </div>
  </div>
  <a href="mysqli.query.php.html#112353" class="name">
  <strong class="user"><em>blinki bill, argodak at yahoo dot com</em></strong></a><a class="genanchor" href="mysqli.query.php.html#112353"> &para;</a><div class="date" title="2013-06-06 03:10"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom112353">
<div class="phpcode"><code><span class="html">Recently I had puzzling problem when performing DML queries, update in particular, each time a update query is called and then there are some more queries to follow this error will show on the page and go in the error_log:<br />"Fatal error:  Exception thrown without a stack frame in Unknown on line 0"<br /><br />The strange thing is that all queries go through just fine so it didn't make much sense:<br /><br />$update = mysqli_query($connection, $query_string);<br />if(!$update){<br /> echo 'Houston we have a problem '.mysqli_error($connection);<br /> exit;<br />}<br /><br />In the above example "$update" is "true", mysqli_error() is empty and of course the update operation goes through, however the nasty super cryptic error appears on the page.<br />What makes even less sense to me is how I fixed it - just called "mysqli_free_result" after the update query and the problem was gone, however because mysqli_free_result is not supposed to be called after DML queries (to free what, a boolean? lol) it needs to be wrapped in a try catch block:<br /><br />try{<br /> mysqli_free_result($update);<br />}catch (Exception $e){<br /> //do nothing<br />}<br /><br />So, I don't know why but it seems that when DML queries are responsible for:<br />"Fatal error:  Exception thrown without a stack frame in Unknown on line 0"<br />calling "mysqli_free_result" after the query seems to be fixing the issue</span></code></div>
  </div>
 </div>
  <div class="note" id="121042">  <div class="votes">
    <div id="Vu121042">
    <a href="https://www.php.net/manual/vote-note.php?id=121042&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121042">
    <a href="https://www.php.net/manual/vote-note.php?id=121042&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121042" title="28% like this...">
    -6
    </div>
  </div>
  <a href="mysqli.query.php.html#121042" class="name">
  <strong class="user"><em>David Marcus</em></strong></a><a class="genanchor" href="mysqli.query.php.html#121042"> &para;</a><div class="date" title="2017-05-03 05:43"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121042">
<div class="phpcode"><code><span class="html">If you use the default resultmode of MYSQLI_STORE_RESULT, you can call $mysqli-&gt;close() right after $mysqli-&gt;query and before you use mysqli_result. This reduces the time the connection is open, which can help if the database server has a limit on how many connections there can be.</span></code></div>
  </div>
 </div>
  <div class="note" id="120828">  <div class="votes">
    <div id="Vu120828">
    <a href="https://www.php.net/manual/vote-note.php?id=120828&amp;page=mysqli.query&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd120828">
    <a href="https://www.php.net/manual/vote-note.php?id=120828&amp;page=mysqli.query&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V120828" title="30% like this...">
    -13
    </div>
  </div>
  <a href="mysqli.query.php.html#120828" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="mysqli.query.php.html#120828"> &para;</a><div class="date" title="2017-03-17 12:55"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom120828">
<div class="phpcode"><code><span class="html">I don't know is it bug or something , then first I write it here . Query SHOW with MYSQLI_USE_RESULT option don't show num_rows :<br /><span class="default">&lt;?php<br />SHOW TABLES LIKE </span><span class="keyword">[</span><span class="default">some table</span><span class="keyword">], </span><span class="default">MYSQLI_USE_RESULT<br />num_rows </span><span class="comment">// shows 0 !<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=mysqli.query&amp;redirect=https://www.php.net/manual/ru/mysqli.query.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="class.mysqli.php.html">mysqli</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="mysqli.affected-rows.php.html" title="$affected_&#8203;rows">$affected_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.autocommit.php.html" title="autocommit">autocommit</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.begin-transaction.php.html" title="begin_&#8203;transaction">begin_&#8203;transaction</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.change-user.php.html" title="change_&#8203;user">change_&#8203;user</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.character-set-name.php.html" title="character_&#8203;set_&#8203;name">character_&#8203;set_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.close.php.html" title="close">close</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.commit.php.html" title="commit">commit</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.connect-errno.php.html" title="$connect_&#8203;errno">$connect_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.connect-error.php.html" title="$connect_&#8203;error">$connect_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.construct.php.html" title="_&#8203;_&#8203;construct">_&#8203;_&#8203;construct</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.debug.php.html" title="debug">debug</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.dump-debug-info.php.html" title="dump_&#8203;debug_&#8203;info">dump_&#8203;debug_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.errno.php.html" title="$errno">$errno</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.error-list.php.html" title="$error_&#8203;list">$error_&#8203;list</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.error.php.html" title="$error">$error</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.execute-query.php.html" title="execute_&#8203;query">execute_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.field-count.php.html" title="$field_&#8203;count">$field_&#8203;count</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-charset.php.html" title="get_&#8203;charset">get_&#8203;charset</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-client-info.php.html" title="$client_&#8203;info">$client_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-client-version.php.html" title="$client_&#8203;version">$client_&#8203;version</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-connection-stats.php.html" title="get_&#8203;connection_&#8203;stats">get_&#8203;connection_&#8203;stats</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-host-info.php.html" title="$host_&#8203;info">$host_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-proto-info.php.html" title="$protocol_&#8203;version">$protocol_&#8203;version</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-server-info.php.html" title="$server_&#8203;info">$server_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-server-version.php.html" title="$server_&#8203;version">$server_&#8203;version</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-warnings.php.html" title="get_&#8203;warnings">get_&#8203;warnings</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.info.php.html" title="$info">$info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.insert-id.php.html" title="$insert_&#8203;id">$insert_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.kill.php.html" title="kill">kill</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.more-results.php.html" title="more_&#8203;results">more_&#8203;results</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.multi-query.php.html" title="multi_&#8203;query">multi_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.next-result.php.html" title="next_&#8203;result">next_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.options.php.html" title="options">options</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.ping.php.html" title="ping">ping</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.poll.php.html" title="poll">poll</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.prepare.php.html" title="prepare">prepare</a>
                        </li>
                                                <li class="current">
                            <a href="mysqli.query.php.html" title="query">query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.real-connect.php.html" title="real_&#8203;connect">real_&#8203;connect</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.real-escape-string.php.html" title="real_&#8203;escape_&#8203;string">real_&#8203;escape_&#8203;string</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.real-query.php.html" title="real_&#8203;query">real_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.reap-async-query.php.html" title="reap_&#8203;async_&#8203;query">reap_&#8203;async_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.refresh.php.html" title="refresh">refresh</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.release-savepoint.php.html" title="release_&#8203;savepoint">release_&#8203;savepoint</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.rollback.php.html" title="rollback">rollback</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.savepoint.php.html" title="savepoint">savepoint</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.select-db.php.html" title="select_&#8203;db">select_&#8203;db</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.set-charset.php.html" title="set_&#8203;charset">set_&#8203;charset</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.sqlstate.php.html" title="$sqlstate">$sqlstate</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.ssl-set.php.html" title="ssl_&#8203;set">ssl_&#8203;set</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.stat.php.html" title="stat">stat</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.stmt-init.php.html" title="stmt_&#8203;init">stmt_&#8203;init</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.store-result.php.html" title="store_&#8203;result">store_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.thread-id.php.html" title="$thread_&#8203;id">$thread_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.thread-safe.php.html" title="thread_&#8203;safe">thread_&#8203;safe</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.use-result.php.html" title="use_&#8203;result">use_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.warning-count.php.html" title="$warning_&#8203;count">$warning_&#8203;count</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                        <li>
                <span class="header">Deprecated</span>
                <ul class="child-menu-list">
                                    <li class="">
                        <a href="mysqli.init.php.html" title="init">init</a>
                    </li>
                                </ul>
            </li>
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
