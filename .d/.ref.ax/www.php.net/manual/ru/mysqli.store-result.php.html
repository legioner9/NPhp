<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: mysqli::store_result - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="mysqli.store-result.php.html">
 <link rel="shorturl" href="mysqli.store-result.php.html">
 <link rel="alternate" href="mysqli.store-result.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="class.mysqli.php.html">
 <link rel="prev" href="mysqli.stmt-init.php.html">
 <link rel="next" href="mysqli.thread-id.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/mysqli.store-result.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/mysqli.store-result.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/mysqli.store-result.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/mysqli.store-result.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/mysqli.store-result.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/mysqli.store-result.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/mysqli.store-result.php" hreflang="pt_BR">
 <link rel="alternate" href="mysqli.store-result.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/mysqli.store-result.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/mysqli.store-result.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="mysqli.thread-id.php.html">
          mysqli::$thread_id &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="mysqli.stmt-init.php.html">
          &laquo; mysqli::stmt_init        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.vendors.php.html'>Модули для работы с базами данных отдельных производителей</a></li>      <li><a href='set.mysqlinfo.php.html'>MySQL</a></li>      <li><a href='book.mysqli.php.html'>MySQLi</a></li>      <li><a href='class.mysqli.php.html'>mysqli</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/mysqli.store-result.php'>English</option>
            <option value='de/mysqli.store-result.php'>German</option>
            <option value='es/mysqli.store-result.php'>Spanish</option>
            <option value='fr/mysqli.store-result.php'>French</option>
            <option value='it/mysqli.store-result.php'>Italian</option>
            <option value='ja/mysqli.store-result.php'>Japanese</option>
            <option value='pt_BR/mysqli.store-result.php'>Brazilian Portuguese</option>
            <option value='ru/mysqli.store-result.php' selected="selected">Russian</option>
            <option value='tr/mysqli.store-result.php'>Turkish</option>
            <option value='zh/mysqli.store-result.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/mysqli/mysqli/store-result.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fmysqli.store-result%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="mysqli.store-result" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqli::store_result</h1>
  <h1 class="refname">mysqli_store_result</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mysqli::store_result</span> -- <span class="refname">mysqli_store_result</span> &mdash; <span class="dc-title">
   Передаёт на клиента результирующий набор последнего запроса
  </span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mysqli.store-result-description">
  <h3 class="title">Описание</h3>
  <p class="para">Объектно-ориентированный стиль</p>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>mysqli::store_result</strong></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code><span class="initializer"> = 0</span></span>): <span class="type"><span class="type"><a href="class.mysqli-result.php.html" class="type mysqli_result">mysqli_result</a></span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">Процедурный стиль</p>
  <div class="methodsynopsis dc-description"><span class="methodname"><strong>mysqli_store_result</strong></span>(<span class="methodparam"><span class="type"><a href="class.mysqli.php.html" class="type mysqli">mysqli</a></span> <code class="parameter">$mysql</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code><span class="initializer"> = 0</span></span>): <span class="type"><span class="type"><a href="class.mysqli-result.php.html" class="type mysqli_result">mysqli_result</a></span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Передаёт результирующий набор последнего запроса на соединении
   <code class="parameter">mysql</code>. Дальнейшая работа с этим набором осуществляется
   функцией <span class="function"><a href="mysqli-result.data-seek.php.html" class="function">mysqli_data_seek()</a></span>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-mysqli.store-result-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
   <dt>

<code class="parameter">mysql</code></dt>
<dd>
<p class="para">Только для процедурного стиля: объект <span class="classname"><a href="class.mysqli.php.html" class="classname">mysqli</a></span>, который вернула функция
<span class="function"><a href="function.mysqli-connect.php.html" class="function">mysqli_connect()</a></span> или функция <span class="function"><a href="mysqli.init.php.html" class="function">mysqli_init()</a></span>.
</p></dd>

   
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
       Устанавливаемая опция. Начиная с PHP 8.1, параметр ни на что не влияет. Может иметь одно из следующих значений:
       <table id="mysqli.store-result.parameters" class="doctable table">
        <caption><strong>Допустимые варианты</strong></caption>
        
         <thead>
          <tr>
           <th>Имя</th>
           <th>Описание</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td><strong><code>MYSQLI_STORE_RESULT_COPY_DATA</code></strong></td>
           <td>Копирует результаты из внутреннего буфера mysqlnd в получаемые переменные PHP.
            По умолчанию mysqlnd использует ссылки, предотвращая копирование и
            дублирование результатов в памяти. В некоторых случаях, например, если результаты
            содержат много небольших рядов, копирование может уменьшить общее потребление
            памяти, так как переменные PHP, содержащие результат, можно освобождать раньше
            (доступно только при использовании mysqlnd)</td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mysqli.store-result-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает буферизованный объект результата запроса или <strong><code>false</code></strong> в случае
   ошибки.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    <span class="function"><strong>mysqli_store_result()</strong></span> возвращает <strong><code>false</code></strong>, если запрос не возвращает
    результирующей таблицы (например, в случае выражения INSERT). Также функция вернёт
    <strong><code>false</code></strong>, если данные из результирующего набора не удалось прочитать. Наличие ошибки
    можно проверить функцией <span class="function"><a href="mysqli.error.php.html" class="function">mysqli_error()</a></span>, которая в этом случае
    вернёт непустую строку; <span class="function"><a href="mysqli.errno.php.html" class="function">mysqli_errno()</a></span> вернёт ненулевое значение; и
    <span class="function"><a href="mysqli.field-count.php.html" class="function">mysqli_field_count()</a></span> также вернёт ненулевое значение. Также
    возможной причиной возврата <strong><code>false</code></strong> после успешного вызова
    <span class="function"><a href="mysqli.query.php.html" class="function">mysqli_query()</a></span> может быть слишком большой результирующий набор
    (не хватает памяти для его размещения). Если функция
    <span class="function"><a href="mysqli.field-count.php.html" class="function">mysqli_field_count()</a></span> возвращает ненулевое значение, значит
    запрос вернул непустой результирующий набор.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 errors" id="refsect1-mysqli.store-result-errors">
  <h3 class="title">Ошибки</h3>
  <p class="para">
Если уведомления об ошибках mysqli включены (<strong><code>MYSQLI_REPORT_ERROR</code></strong>) и запрошенная операция не удалась,
выдаётся предупреждение. Если, кроме того, установлен режим <strong><code>MYSQLI_REPORT_STRICT</code></strong>,
вместо этого будет выброшено исключение <span class="classname"><a href="class.mysqli-sql-exception.php.html" class="classname">mysqli_sql_exception</a></span>.</p>
 </div>


 <div class="refsect1 examples" id="refsect1-mysqli.store-result-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   Смотрите <span class="function"><a href="mysqli.multi-query.php.html" class="function">mysqli_multi_query()</a></span>.
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-mysqli.store-result-notes">
  <h3 class="title">Примечания</h3>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Даже несмотря на хорошую практику очищать память, занятую результатами
    запросов, посредством функции <span class="function"><a href="mysqli-result.free.php.html" class="function">mysqli_free_result()</a></span>,
    если <span class="function"><strong>mysqli_store_result()</strong></span> передаёт большой
    результирующий набор, это может стать проблемой.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-mysqli.store-result-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli.real-query.php.html" class="function" rel="rdfs-seeAlso">mysqli_real_query()</a> - Выполнение SQL запроса</span></li>
    <li class="member"><span class="function"><a href="mysqli.use-result.php.html" class="function" rel="rdfs-seeAlso">mysqli_use_result()</a> - Готовит результирующий набор на сервере к использованию</span></li>
   </ul>
  </p>
 </div>


</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=mysqli.store-result&amp;redirect=https://www.php.net/manual/ru/mysqli.store-result.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">5 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="96048">  <div class="votes">
    <div id="Vu96048">
    <a href="https://www.php.net/manual/vote-note.php?id=96048&amp;page=mysqli.store-result&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd96048">
    <a href="https://www.php.net/manual/vote-note.php?id=96048&amp;page=mysqli.store-result&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V96048" title="56% like this...">
    8
    </div>
  </div>
  <a href="mysqli.store-result.php.html#96048" class="name">
  <strong class="user"><em>mitchind</em></strong></a><a class="genanchor" href="mysqli.store-result.php.html#96048"> &para;</a><div class="date" title="2010-02-04 08:28"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom96048">
<div class="phpcode"><code><span class="html">After reading through original notes and example above as well as wading through the documentation, I finally got a loop to work with two stored procedures.<br /><br />Using the results of the first one as a parameter for the second one. Easier to do this way than a huge modified sequence of Inner Join queries.<br /><br />Hope this helps others...<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// Connect to server and database<br /></span><span class="default">$mysqli        </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dbServer</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$dbUser</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$dbPass</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$dbName</span><span class="string">"</span><span class="keyword">);<br /><br /></span><span class="comment">// Open First Stored Procedure using MYSQLI_STORE_RESULT to retain for looping<br /></span><span class="default">$resultPicks </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"CALL </span><span class="default">$proc</span><span class="string"> (</span><span class="default">$searchDate</span><span class="string">, </span><span class="default">$maxRSI</span><span class="string">, </span><span class="default">$incRSI</span><span class="string">, </span><span class="default">$minMACD</span><span class="string">, </span><span class="default">$minVol</span><span class="string">, </span><span class="default">$minTrades</span><span class="string">, </span><span class="default">$minClose</span><span class="string">, </span><span class="default">$maxClose</span><span class="string">)"</span><span class="keyword">, </span><span class="default">MYSQLI_STORE_RESULT</span><span class="keyword">);<br /><br /></span><span class="comment">// process one row at a time from first SP<br /></span><span class="keyword">while(</span><span class="default">$picksRow </span><span class="keyword">= </span><span class="default">$resultPicks</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">(</span><span class="default">MYSQLI_ASSOC</span><span class="keyword">)) {<br />    </span><span class="comment">// Get Parameter for next SP<br />    </span><span class="default">$symbol     </span><span class="keyword">= </span><span class="default">$picksRow</span><span class="keyword">[</span><span class="string">'Symbol'</span><span class="keyword">];<br /><br />    </span><span class="comment">// Free stored results<br />    </span><span class="default">clearStoredResults</span><span class="keyword">(</span><span class="default">$mysqli</span><span class="keyword">);<br /><br />    </span><span class="comment">// Execute second SP using value from first as a parameter (MYSQLI_USE_RESULT and free result right away)<br />    </span><span class="default">$resultData    </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"CALL prcGetLastMACDDatesBelowZero('</span><span class="default">$symbol</span><span class="string">', </span><span class="default">$searchDate</span><span class="string">)"</span><span class="keyword">, </span><span class="default">MYSQLI_USE_RESULT</span><span class="keyword">);<br />    </span><span class="default">$dataRow    </span><span class="keyword">= </span><span class="default">$resultData</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">(</span><span class="default">MYSQLI_ASSOC</span><span class="keyword">);<br /><br />    </span><span class="comment">// Dump result from both related queries<br />    </span><span class="keyword">echo </span><span class="string">"&lt;p&gt;</span><span class="default">$symbol</span><span class="string"> ... Num Dates: " </span><span class="keyword">. </span><span class="default">$dataRow</span><span class="keyword">[</span><span class="string">'NumDates'</span><span class="keyword">];<br /><br />    </span><span class="comment">// Free results from second SP<br />    </span><span class="default">$resultData</span><span class="keyword">-&gt;</span><span class="default">free</span><span class="keyword">();<br /><br />}<br /><br /></span><span class="comment">// Free results from first SP<br /></span><span class="default">$resultPicks</span><span class="keyword">-&gt;</span><span class="default">free</span><span class="keyword">();<br /><br /></span><span class="comment">// close connections<br /></span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br /><br /></span><span class="comment">#------------------------------------------<br /></span><span class="keyword">function </span><span class="default">clearStoredResults</span><span class="keyword">(</span><span class="default">$mysqli_link</span><span class="keyword">){<br /></span><span class="comment">#------------------------------------------<br />    </span><span class="keyword">while(</span><span class="default">$mysqli_link</span><span class="keyword">-&gt;</span><span class="default">next_result</span><span class="keyword">()){<br />      if(</span><span class="default">$l_result </span><span class="keyword">= </span><span class="default">$mysqli_link</span><span class="keyword">-&gt;</span><span class="default">store_result</span><span class="keyword">()){<br />              </span><span class="default">$l_result</span><span class="keyword">-&gt;</span><span class="default">free</span><span class="keyword">();<br />      }<br />    }<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="122404">  <div class="votes">
    <div id="Vu122404">
    <a href="https://www.php.net/manual/vote-note.php?id=122404&amp;page=mysqli.store-result&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122404">
    <a href="https://www.php.net/manual/vote-note.php?id=122404&amp;page=mysqli.store-result&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122404" title="66% like this...">
    2
    </div>
  </div>
  <a href="mysqli.store-result.php.html#122404" class="name">
  <strong class="user"><em>filippo at ecoms dot it</em></strong></a><a class="genanchor" href="mysqli.store-result.php.html#122404"> &para;</a><div class="date" title="2018-02-18 06:49"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom122404">
<div class="phpcode"><code><span class="html">Code to handling errors:<br /><br />if ($mysqli-&gt;multi_query($query)) {<br />    $result = $mysqli-&gt;store_result();<br />    if ($mysqli-&gt;errno == 0) {<br />    <br />        /* First result set or FALSE (if the query didn't return a result set) is stored in $result */<br /><br />        while ($mysqli-&gt;more_results()) {<br />            if ($mysqli-&gt;next_result()) {<br />                $result = $mysqli-&gt;store_result();<br />                if ($mysqli-&gt;errno == 0) {<br />                    /* The result set or FALSE (see above) is stored in $result */<br />                }<br />                else {<br />                    /* Result set read error */<br />                    break;<br />                }<br />            }<br />            else {<br />                /* Error in the query */<br />            }<br />        }<br />    }<br />    else {<br />        /* First result set read error */<br />    }<br />}<br />else {<br />    /* Error in the first query */<br />}</span></code></div>
  </div>
 </div>
  <div class="note" id="92352">  <div class="votes">
    <div id="Vu92352">
    <a href="https://www.php.net/manual/vote-note.php?id=92352&amp;page=mysqli.store-result&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd92352">
    <a href="https://www.php.net/manual/vote-note.php?id=92352&amp;page=mysqli.store-result&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V92352" title="42% like this...">
    -3
    </div>
  </div>
  <a href="mysqli.store-result.php.html#92352" class="name">
  <strong class="user"><em>Warner</em></strong></a><a class="genanchor" href="mysqli.store-result.php.html#92352"> &para;</a><div class="date" title="2009-07-21 02:45"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom92352">
<div class="phpcode"><code><span class="html">It also seems, that executing a SET statement in multi_query() returns an extra recordset too, which one would not expect.</span></code></div>
  </div>
 </div>
  <div class="note" id="74478">  <div class="votes">
    <div id="Vu74478">
    <a href="https://www.php.net/manual/vote-note.php?id=74478&amp;page=mysqli.store-result&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd74478">
    <a href="https://www.php.net/manual/vote-note.php?id=74478&amp;page=mysqli.store-result&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V74478" title="33% like this...">
    -4
    </div>
  </div>
  <a href="mysqli.store-result.php.html#74478" class="name">
  <strong class="user"><em>lau at goldenweb dot com dot au</em></strong></a><a class="genanchor" href="mysqli.store-result.php.html#74478"> &para;</a><div class="date" title="2007-04-13 01:29"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom74478">
<div class="phpcode"><code><span class="html">Beware when using stored procedures:<br />If you connect to the database and then call dbproc A followed by a call to db proc B and then close the connection to the db, the second procedure call will not work.<br /><br />It looks like there is a bug in MYSQL or mysqli that returns an extra recordset than you would expect. It then doesn't let you call another stored procedure until you finish processing all the recordsets from the first stored procedure call. <br /><br />The solution is to simply loop through the additional recordsets between calls to db procs. Here is a function that I call between db proc calls:<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">#--------------------------------<br /></span><span class="keyword">function </span><span class="default">ClearRecordsets</span><span class="keyword">(</span><span class="default">$p_Result</span><span class="keyword">){<br /></span><span class="comment">#--------------------------------<br />    </span><span class="default">$p_Result</span><span class="keyword">-&gt;</span><span class="default">free</span><span class="keyword">();    <br />    while(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Mysqli</span><span class="keyword">-&gt;</span><span class="default">next_result</span><span class="keyword">()){<br />      if(</span><span class="default">$l_result </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Mysqli</span><span class="keyword">-&gt;</span><span class="default">store_result</span><span class="keyword">()){<br />              </span><span class="default">$l_result</span><span class="keyword">-&gt;</span><span class="default">free</span><span class="keyword">();<br />      }<br />    }<br />}<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="112634">  <div class="votes">
    <div id="Vu112634">
    <a href="https://www.php.net/manual/vote-note.php?id=112634&amp;page=mysqli.store-result&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112634">
    <a href="https://www.php.net/manual/vote-note.php?id=112634&amp;page=mysqli.store-result&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112634" title="33% like this...">
    -6
    </div>
  </div>
  <a href="mysqli.store-result.php.html#112634" class="name">
  <strong class="user"><em>Tex Morgan</em></strong></a><a class="genanchor" href="mysqli.store-result.php.html#112634"> &para;</a><div class="date" title="2013-07-06 10:45"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom112634">
<div class="phpcode"><code><span class="html">There's a simpler way to clear out database stored procedure problems:<br /><br />class MySQLiQuery {<br />     protected $_resultSet;<br />     protected $databaseConnection;<br />....<br /><br />    protected function free(){<br />        $this-&gt;_resultSet-&gt;free();<br />        $this-&gt;_resultSet=null;<br />    }<br /><br />    protected function checkMoreResults(){<br />        if($this-&gt;databaseConnection-&gt;more_results()){<br />            return true;<br />        } else {<br />            return false;<br />        }<br />    }<br /><br />    protected function clearResults(){<br />        if($this-&gt;checkMoreResults()){<br />            if($this-&gt;databaseConnection-&gt;next_result()){<br />                if($this-&gt;_resultSet=$this-&gt;databaseConnection-&gt;store_result()){<br />                    $this-&gt;free();<br />                }<br />                $this-&gt;clearResults(); // &lt;----------- recursive call is your friend<br />            }<br />        }<br />    }<br />.......<br />}</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=mysqli.store-result&amp;redirect=https://www.php.net/manual/ru/mysqli.store-result.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="class.mysqli.php.html">mysqli</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="mysqli.affected-rows.php.html" title="$affected_&#8203;rows">$affected_&#8203;rows</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.autocommit.php.html" title="autocommit">autocommit</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.begin-transaction.php.html" title="begin_&#8203;transaction">begin_&#8203;transaction</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.change-user.php.html" title="change_&#8203;user">change_&#8203;user</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.character-set-name.php.html" title="character_&#8203;set_&#8203;name">character_&#8203;set_&#8203;name</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.close.php.html" title="close">close</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.commit.php.html" title="commit">commit</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.connect-errno.php.html" title="$connect_&#8203;errno">$connect_&#8203;errno</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.connect-error.php.html" title="$connect_&#8203;error">$connect_&#8203;error</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.construct.php.html" title="_&#8203;_&#8203;construct">_&#8203;_&#8203;construct</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.debug.php.html" title="debug">debug</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.dump-debug-info.php.html" title="dump_&#8203;debug_&#8203;info">dump_&#8203;debug_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.errno.php.html" title="$errno">$errno</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.error-list.php.html" title="$error_&#8203;list">$error_&#8203;list</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.error.php.html" title="$error">$error</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.execute-query.php.html" title="execute_&#8203;query">execute_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.field-count.php.html" title="$field_&#8203;count">$field_&#8203;count</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-charset.php.html" title="get_&#8203;charset">get_&#8203;charset</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-client-info.php.html" title="$client_&#8203;info">$client_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-client-version.php.html" title="$client_&#8203;version">$client_&#8203;version</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-connection-stats.php.html" title="get_&#8203;connection_&#8203;stats">get_&#8203;connection_&#8203;stats</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-host-info.php.html" title="$host_&#8203;info">$host_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-proto-info.php.html" title="$protocol_&#8203;version">$protocol_&#8203;version</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-server-info.php.html" title="$server_&#8203;info">$server_&#8203;info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-server-version.php.html" title="$server_&#8203;version">$server_&#8203;version</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.get-warnings.php.html" title="get_&#8203;warnings">get_&#8203;warnings</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.info.php.html" title="$info">$info</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.insert-id.php.html" title="$insert_&#8203;id">$insert_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.kill.php.html" title="kill">kill</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.more-results.php.html" title="more_&#8203;results">more_&#8203;results</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.multi-query.php.html" title="multi_&#8203;query">multi_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.next-result.php.html" title="next_&#8203;result">next_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.options.php.html" title="options">options</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.ping.php.html" title="ping">ping</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.poll.php.html" title="poll">poll</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.prepare.php.html" title="prepare">prepare</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.query.php.html" title="query">query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.real-connect.php.html" title="real_&#8203;connect">real_&#8203;connect</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.real-escape-string.php.html" title="real_&#8203;escape_&#8203;string">real_&#8203;escape_&#8203;string</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.real-query.php.html" title="real_&#8203;query">real_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.reap-async-query.php.html" title="reap_&#8203;async_&#8203;query">reap_&#8203;async_&#8203;query</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.refresh.php.html" title="refresh">refresh</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.release-savepoint.php.html" title="release_&#8203;savepoint">release_&#8203;savepoint</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.rollback.php.html" title="rollback">rollback</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.savepoint.php.html" title="savepoint">savepoint</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.select-db.php.html" title="select_&#8203;db">select_&#8203;db</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.set-charset.php.html" title="set_&#8203;charset">set_&#8203;charset</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.sqlstate.php.html" title="$sqlstate">$sqlstate</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.ssl-set.php.html" title="ssl_&#8203;set">ssl_&#8203;set</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.stat.php.html" title="stat">stat</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.stmt-init.php.html" title="stmt_&#8203;init">stmt_&#8203;init</a>
                        </li>
                                                <li class="current">
                            <a href="mysqli.store-result.php.html" title="store_&#8203;result">store_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.thread-id.php.html" title="$thread_&#8203;id">$thread_&#8203;id</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.thread-safe.php.html" title="thread_&#8203;safe">thread_&#8203;safe</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.use-result.php.html" title="use_&#8203;result">use_&#8203;result</a>
                        </li>
                                                <li class="">
                            <a href="mysqli.warning-count.php.html" title="$warning_&#8203;count">$warning_&#8203;count</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                        <li>
                <span class="header">Deprecated</span>
                <ul class="child-menu-list">
                                    <li class="">
                        <a href="mysqli.init.php.html" title="init">init</a>
                    </li>
                                </ul>
            </li>
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
