<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: PDO::prepare - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="pdo.prepare.php.html">
 <link rel="shorturl" href="pdo.prepare.php.html">
 <link rel="alternate" href="pdo.prepare.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="class.pdo.php.html">
 <link rel="prev" href="pdo.lastinsertid.php.html">
 <link rel="next" href="pdo.query.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/pdo.prepare.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/pdo.prepare.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/pdo.prepare.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/pdo.prepare.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/pdo.prepare.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/pdo.prepare.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/pdo.prepare.php" hreflang="pt_BR">
 <link rel="alternate" href="pdo.prepare.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/pdo.prepare.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/pdo.prepare.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="pdo.query.php.html">
          PDO::query &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="pdo.lastinsertid.php.html">
          &laquo; PDO::lastInsertId        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.abstract.php.html'>Уровни абстракции</a></li>      <li><a href='book.pdo.php.html'>PDO</a></li>      <li><a href='class.pdo.php.html'>PDO</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/pdo.prepare.php'>English</option>
            <option value='de/pdo.prepare.php'>German</option>
            <option value='es/pdo.prepare.php'>Spanish</option>
            <option value='fr/pdo.prepare.php'>French</option>
            <option value='it/pdo.prepare.php'>Italian</option>
            <option value='ja/pdo.prepare.php'>Japanese</option>
            <option value='pt_BR/pdo.prepare.php'>Brazilian Portuguese</option>
            <option value='ru/pdo.prepare.php' selected="selected">Russian</option>
            <option value='tr/pdo.prepare.php'>Turkish</option>
            <option value='zh/pdo.prepare.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/pdo/pdo/prepare.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fpdo.prepare%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="pdo.prepare" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">PDO::prepare</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.1.0, PHP 7, PHP 8, PHP 8,PECL pdo &gt;= 0.1.0)</p><p class="refpurpose"><span class="refname">PDO::prepare</span> &mdash; <span class="dc-title">
   Подготавливает запрос к выполнению и возвращает связанный с этим запросом
   объект
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-pdo.prepare-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>PDO::prepare</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = []</span></span>): <span class="type"><span class="type"><a href="class.pdostatement.php.html" class="type PDOStatement">PDOStatement</a></span>|<span class="type"><span class="type false">false</span></span></span></div>


  <p class="para rdfs-comment">
   Подготавливает SQL-запрос к базе данных к запуску посредством метода
   <span class="methodname"><a href="pdostatement.execute.php.html" class="methodname">PDOStatement::execute()</a></span>. Запрос может содержать именованные
   (:name) или неименованные (?) псевдопеременные, которые будут заменены реальными
   значениями во время запуска запроса на выполнение. Использовать одновременно и
   именованные, и неименованные псевдопеременные в одном запросе нельзя, необходимо
   выбрать что-то одно. Используйте псевдопеременные, чтобы привязать к запросу
   пользовательский ввод, не включайте данные, введённые пользователем, напрямую в
   запрос.
  </p>
  <p class="para">
   Вы должны подбирать уникальные имена псевдопеременных для каждого значения,
   которое необходимо передавать в запрос при вызове
   <span class="methodname"><a href="pdostatement.execute.php.html" class="methodname">PDOStatement::execute()</a></span>. Нельзя использовать одну псевдопеременную
   в запросе более одного раза, кроме варианта, когда включён режим эмуляции.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Псевдопеременные должны представлять только единичный объем данных.
    Ни часть значения, ни служебное слово, ни имя поля, ни какую-либо произвольную
    часть запроса. К примеру, вы не можете связать псевдопеременную с несколькими
    значениями для вставки в конструкцию IN().
   </p>
  </p></blockquote>
  <p class="para">
   Вызов <span class="methodname"><strong>PDO::prepare()</strong></span> и
   <span class="methodname"><a href="pdostatement.execute.php.html" class="methodname">PDOStatement::execute()</a></span> для запросов, которые будут
   запускаться многократно с различными параметрами, повышает производительность
   приложения, позволяя драйверу кешировать на клиенте и/или сервере
   план выполнения запроса и метаданные, а также помогает избежать SQL-инъекций,
   так как нет необходимости экранировать передаваемые параметры.
  </p>
  <p class="para">
   Если драйвер не поддерживает подготавливаемые запросы, PDO умеет их эмулировать, а
   также может заменять псевдопеременные на то, что больше подходит, если, например,
   драйвер поддерживает только именованные или, наоборот, только неименованные псевдопеременные.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <span class="simpara">
    Синтаксический анализатор, используемый для эмулируемых подготовленных операторов
    и для перезаписи именованных параметров или параметров стиля вопросительного знака, поддерживает нестандартные
    обратные слеши для одинарных и двойных кавычек. Это означает, что завершающие
    кавычки, непосредственно предшествующие обратной косой черте, не распознаются как таковые, что
    может привести к неправильному обнаружению параметров, что приведёт к сбою подготовленного оператора
    при его выполнении. Обходной путь — не использовать эмулированную подготовку к таким
    SQL-запросам и избегать перезаписи параметров, используя стиль параметров,
    который изначально поддерживается драйвером.
   </span>
  </p></blockquote>
  <p class="para">
   Начиная с PHP 7.4.0, можно избежать экранирования вопросительных знаков, удвоив их.
   Это означает, что строка <code class="literal">??</code> будет преобразована в <code class="literal">?</code> при отправке запроса в базу данных.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-pdo.prepare-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       Это должен быть корректный SQL-запрос с точки зрения целевой СУБД.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       Этот массив содержит одну или более пар ключ=&gt;значение для установки
       значений атрибутов объекта PDOStatement, который будет возвращён из
       этого метода. В основном, вы будете использовать этот массив для присвоения
       значения <code class="literal">PDO::ATTR_CURSOR</code> атрибуту
       <code class="literal">PDO::CURSOR_SCROLL</code>, чтобы получить прокручиваемый курсор.
       У некоторых драйверов могут быть свои специфические настройки, которые
       можно задать во время подготовки запроса.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-pdo.prepare-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Если СУБД успешно подготовила запрос, <span class="methodname"><strong>PDO::prepare()</strong></span> возвращает
   объект <span class="classname"><a href="class.pdostatement.php.html" class="classname">PDOStatement</a></span>. Если подготовить запрос не удалось,
   <span class="methodname"><strong>PDO::prepare()</strong></span> возвращает <strong><code>false</code></strong> или выбрасывает исключение
   <span class="classname"><a href="class.pdoexception.php.html" class="classname">PDOException</a></span> (зависит от текущего режима <a href="pdo.error-handling.php.html" class="link">обработки ошибок</a>).
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Эмулируемые подготовленные запросы не создаются на сервере баз данных,
    поэтому <span class="methodname"><strong>PDO::prepare()</strong></span> не может проверить правильность
    построенного запроса.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 errors" id="refsect1-pdo.prepare-errors">
  <h3 class="title">Ошибки</h3>
  <p class="para">
 Выдаёт ошибку уровня <strong><code>E_WARNING</code></strong>, если атрибуту <strong><code>PDO::ATTR_ERRMODE</code></strong>
 установлено значение <strong><code>PDO::ERRMODE_WARNING</code></strong>.
</p>
<p class="para">
 Выбрасывает исключение <span class="classname"><a href="class.pdoexception.php.html" class="classname">PDOException</a></span>, если атрибуту <strong><code>PDO::ATTR_ERRMODE</code></strong>
 установлено значение <strong><code>PDO::ERRMODE_EXCEPTION</code></strong>.
</p>
 </div>


 <div class="refsect1 examples" id="refsect1-pdo.prepare-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-3163">
    <p><strong>Пример #1 
     Подготовка SQL-запроса с именованными параметрами
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/* Выполнение запроса с передачей ему массива параметров */<br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">'SELECT name, colour, calories<br />    FROM fruit<br />    WHERE calories &lt; :calories AND colour = :colour'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$sth </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">, [</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">ATTR_CURSOR </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">CURSOR_FWDONLY</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #DD0000">'calories' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">150</span><span style="color: #007700">, </span><span style="color: #DD0000">'colour' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'red'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$red </span><span style="color: #007700">= </span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #FF8000">/* Ключи массива также могут начинаться с двоеточия ":" (необязательно) */<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #DD0000">':calories' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">175</span><span style="color: #007700">, </span><span style="color: #DD0000">':colour' </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">'yellow'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$yellow </span><span style="color: #007700">= </span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
   <div class="example" id="example-3166">
    <p><strong>Пример #2 Подготовка SQL-запроса с неименованными параметрами (символ &#039;?&#039;)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/* Выполнение запроса с передачей ему массива параметров */<br /></span><span style="color: #0000BB">$sth </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT name, colour, calories<br />    FROM fruit<br />    WHERE calories &lt; ? AND colour = ?'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #0000BB">150</span><span style="color: #007700">, </span><span style="color: #DD0000">'red'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$red </span><span style="color: #007700">= </span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #0000BB">175</span><span style="color: #007700">, </span><span style="color: #DD0000">'yellow'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$yellow </span><span style="color: #007700">= </span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
   <div class="example" id="example-3169">
    <p><strong>Пример #3 Подготовка SQL-запроса с экранированным вопросительным знаком</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/* замечание: работает только с базами данных PostgreSQL */<br /></span><span style="color: #0000BB">$sth </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT * FROM issues WHERE tag::jsonb ?? ?'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #DD0000">'feature'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$featureIssues </span><span style="color: #007700">= </span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #DD0000">'performance'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$performanceIssues </span><span style="color: #007700">= </span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-pdo.prepare-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="methodname"><a href="pdo.exec.php.html" class="methodname" rel="rdfs-seeAlso">PDO::exec()</a> - Выполняет SQL-запрос и возвращает количество затронутых строк</span></li>
    <li class="member"><span class="methodname"><a href="pdo.query.php.html" class="methodname" rel="rdfs-seeAlso">PDO::query()</a> - Подготавливает и выполняет выражение SQL без заполнителей</span></li>
    <li class="member"><span class="methodname"><a href="pdostatement.execute.php.html" class="methodname" rel="rdfs-seeAlso">PDOStatement::execute()</a> - Запускает подготовленный запрос на выполнение</span></li>
   </ul>
  </p>
 </div>

</div><section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=pdo.prepare&amp;redirect=https://www.php.net/manual/ru/pdo.prepare.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">26 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="111977">  <div class="votes">
    <div id="Vu111977">
    <a href="https://www.php.net/manual/vote-note.php?id=111977&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111977">
    <a href="https://www.php.net/manual/vote-note.php?id=111977&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111977" title="76% like this...">
    176
    </div>
  </div>
  <a href="pdo.prepare.php.html#111977" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#111977"> &para;</a><div class="date" title="2013-04-18 05:23"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom111977">
<div class="phpcode"><code><span class="html">To those wondering why adding quotes to around a placeholder is wrong, and why you can't use placeholders for table or column names:<br /><br />There is a common misconception about how the placeholders in prepared statements work: they are not simply substituted in as (escaped) strings, and the resulting SQL executed. Instead, a DBMS asked to "prepare" a statement comes up with a complete query plan for how it would execute that query, including which tables and indexes it would use, which will be the same regardless of how you fill in the placeholders.<br /><br />The plan for "SELECT name FROM my_table WHERE id = :value" will be the same whatever you substitute for ":value", but the seemingly similar "SELECT name FROM :table WHERE id = :value" cannot be planned, because the DBMS has no idea what table you're actually going to select from.<br /><br />Even when using "emulated prepares", PDO cannot let you use placeholders anywhere, because it would have to work out what you meant: does "Select :foo From some_table" mean ":foo" is going to be a column reference, or a literal string?<br /><br />When your query is using a dynamic column reference, you should be explicitly white-listing the columns you know to exist on the table, e.g. using a switch statement with an exception thrown in the default: clause.</span></code></div>
  </div>
 </div>
  <div class="note" id="111458">  <div class="votes">
    <div id="Vu111458">
    <a href="https://www.php.net/manual/vote-note.php?id=111458&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111458">
    <a href="https://www.php.net/manual/vote-note.php?id=111458&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111458" title="68% like this...">
    89
    </div>
  </div>
  <a href="pdo.prepare.php.html#111458" class="name">
  <strong class="user"><em>Simon Le Pine</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#111458"> &para;</a><div class="date" title="2013-02-21 05:35"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom111458">
<div class="phpcode"><code><span class="html">Hi All,<br /><br />First time posting to php.net, a little nervous.<br /><br />After a bunch of searching I've learned 2 things about prepared statements:<br />1.) It fails if you enclose in a single quote (')<br />This fails: "SELECT * FROM users WHERE email=':email'"<br />This works: "SELECT * FROM users WHERE email=:email"<br />2.) You cannot search with a prepared statement<br />This fails: "SELECT * FROM users WHERE :search=:email"<br />This succeeds: "SELECT * FROM users WHERE $search=:email"<br /><br />In my case I allow the user to enter their username or email, determine which they've entered and set $search to "username" or "email". As this value is not entered by the user there is no potential for SQL injection and thus safe to use as I have done.<br /><br />Hope that saves someone else from a lot of searching.</span></code></div>
  </div>
 </div>
  <div class="note" id="114616">  <div class="votes">
    <div id="Vu114616">
    <a href="https://www.php.net/manual/vote-note.php?id=114616&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd114616">
    <a href="https://www.php.net/manual/vote-note.php?id=114616&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V114616" title="75% like this...">
    44
    </div>
  </div>
  <a href="pdo.prepare.php.html#114616" class="name">
  <strong class="user"><em>bg at enativ dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#114616"> &para;</a><div class="date" title="2014-03-12 03:11"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom114616">
<div class="phpcode"><code><span class="html">if you run queries in a loop, don't include $pdo-&gt;prepare() inside the loop, it will save you some resources (and time).<br /><br />prepare statement inside loop:<br />for($i=0; $i&lt;1000; $i++) {<br />    $rs = $pdo-&gt;prepare("SELECT `id` FROM `admins` WHERE `groupID` = :groupID AND `id` &lt;&gt; :id");<br />    $rs-&gt;execute([':groupID' =&gt; $group, ':id' =&gt; $id]);<br />}<br /><br />// took 0.066626071929932 microseconds<br /><br />prepare statement outside loop:<br />$rs = $pdo-&gt;prepare("SELECT `id` FROM `admins` WHERE `groupID` = :groupID AND `id` &lt;&gt; :id");<br />for($i=0; $i&lt;1000; $i++) {<br />    $rs-&gt;execute([':groupID' =&gt; $group, ':id' =&gt; $id]);<br />}<br /><br />// took 0.064448118209839 microseconds<br /><br />for 1,000 (simple) queries it took 0.002 microseconds less.<br />not much, but it worth mention.</span></code></div>
  </div>
 </div>
  <div class="note" id="91078">  <div class="votes">
    <div id="Vu91078">
    <a href="https://www.php.net/manual/vote-note.php?id=91078&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd91078">
    <a href="https://www.php.net/manual/vote-note.php?id=91078&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V91078" title="70% like this...">
    56
    </div>
  </div>
  <a href="pdo.prepare.php.html#91078" class="name">
  <strong class="user"><em>daniel dot egeberg at gmail dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#91078"> &para;</a><div class="date" title="2009-05-24 01:06"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom91078">
<div class="phpcode"><code><span class="html">You can also pass an array of values to PDOStatement::execute(). This is also secured against SQL injection. You don't necessarily have to use bindParam() or bindValue().</span></code></div>
  </div>
 </div>
  <div class="note" id="90209">  <div class="votes">
    <div id="Vu90209">
    <a href="https://www.php.net/manual/vote-note.php?id=90209&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd90209">
    <a href="https://www.php.net/manual/vote-note.php?id=90209&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V90209" title="67% like this...">
    42
    </div>
  </div>
  <a href="pdo.prepare.php.html#90209" class="name">
  <strong class="user"><em>admin at wdfa dot co dot uk</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#90209"> &para;</a><div class="date" title="2009-04-09 09:52"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom90209">
<div class="phpcode"><code><span class="html">Note on the SQL injection properties of prepared statements.<br /><br />Prepared statements only project you from SQL injection IF you use the bindParam or bindValue option.<br /><br />For example if you have a table called users with two fields, username and email and someone updates their username you might run<br /><br />UPDATE `users` SET `user`='$var'<br /><br />where $var would be the user submitted text. <br /><br />Now if you did <br /><span class="default">&lt;?php<br />$a</span><span class="keyword">=new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">"mysql:host=localhost;dbname=database;"</span><span class="keyword">,</span><span class="string">"root"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">);<br /></span><span class="default">$b</span><span class="keyword">=</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"UPDATE `users` SET user='</span><span class="default">$var</span><span class="string">'"</span><span class="keyword">);<br /></span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br /></span><span class="default">?&gt;<br /></span><br />and the user had entered  User', email='test for a test the injection would occur and the email would be updated to test as well as the user being updated to User.<br /><br />Using bindParam as follows<br /> <span class="default">&lt;?php<br />$var</span><span class="keyword">=</span><span class="string">"User', email='test"</span><span class="keyword">;<br /></span><span class="default">$a</span><span class="keyword">=new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">"mysql:host=localhost;dbname=database;"</span><span class="keyword">,</span><span class="string">"root"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">);<br /></span><span class="default">$b</span><span class="keyword">=</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"UPDATE `users` SET user=:var"</span><span class="keyword">);<br /></span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">bindParam</span><span class="keyword">(</span><span class="string">":var"</span><span class="keyword">,</span><span class="default">$var</span><span class="keyword">);<br /></span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br /></span><span class="default">?&gt;<br /></span><br />The sql would be escaped and update the username to User', email='test'</span></code></div>
  </div>
 </div>
  <div class="note" id="120969">  <div class="votes">
    <div id="Vu120969">
    <a href="https://www.php.net/manual/vote-note.php?id=120969&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd120969">
    <a href="https://www.php.net/manual/vote-note.php?id=120969&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V120969" title="66% like this...">
    5
    </div>
  </div>
  <a href="pdo.prepare.php.html#120969" class="name">
  <strong class="user"><em>Mark Simon</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#120969"> &para;</a><div class="date" title="2017-04-11 11:27"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom120969">
<div class="phpcode"><code><span class="html">Many students are tempted to add single quotes around string place holders in the SQL statement, since that’s what they normally do around strings in SQL and PHP.<br /><br />I have to explain:<br /><br />Quotes are not part of the string — they are used to construct a string in the coding language. If you are creating a string literal in SQL or PHP, then it must indeed be quoted. If the string has already been created, and is being passed on, then additional quotes would be wrong at best, and mis-interpreted at worst.<br /><br />In prepared place holders, think of place holders as variables, which, whether they are strings or other values, are always written without quotes.</span></code></div>
  </div>
 </div>
  <div class="note" id="107811">  <div class="votes">
    <div id="Vu107811">
    <a href="https://www.php.net/manual/vote-note.php?id=107811&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd107811">
    <a href="https://www.php.net/manual/vote-note.php?id=107811&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V107811" title="60% like this...">
    13
    </div>
  </div>
  <a href="pdo.prepare.php.html#107811" class="name">
  <strong class="user"><em>public at grik dot net</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#107811"> &para;</a><div class="date" title="2012-03-07 12:23"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom107811">
<div class="phpcode"><code><span class="html">With PDO_MYSQL you need to remember about the PDO::ATTR_EMULATE_PREPARES option.<br /><br />The default value is TRUE, like<br />$dbh-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES,true); <br /><br />This means that no prepared statement is created with $dbh-&gt;prepare() call. With exec() call PDO replaces the placeholders with values itself and sends MySQL a generic query string.<br /><br />The first consequence is that the call  $dbh-&gt;prepare('garbage');<br />reports no error. You will get an SQL error during the $dbh-&gt;exec() call.<br />The second one is the SQL injection risk in special cases, like using a placeholder for the table name.<br /><br />The reason for emulation is a poor performance of MySQL with prepared statements. Emulation works significantly faster.</span></code></div>
  </div>
 </div>
  <div class="note" id="96544">  <div class="votes">
    <div id="Vu96544">
    <a href="https://www.php.net/manual/vote-note.php?id=96544&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd96544">
    <a href="https://www.php.net/manual/vote-note.php?id=96544&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V96544" title="55% like this...">
    4
    </div>
  </div>
  <a href="pdo.prepare.php.html#96544" class="name">
  <strong class="user"><em>Robin</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#96544"> &para;</a><div class="date" title="2010-03-04 05:01"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom96544">
<div class="phpcode"><code><span class="html">Use prepared statements to ensure integrity of binary data during storage and retrieval. Escaping/quoting by f.e. sqlite_escape_string() or PDO::quote() is NOT suited for binary data - only for strings of text.<br /><br />A simple test verifies perfect storage and retrieval with prepared statements:<br /><br /><span class="default">&lt;?php<br /><br />$num_values </span><span class="keyword">= </span><span class="default">10000</span><span class="keyword">;<br /><br /></span><span class="default">$db </span><span class="keyword">= new </span><span class="default">pdo</span><span class="keyword">( </span><span class="string">'sqlite::memory:' </span><span class="keyword">);<br /><br /></span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">exec</span><span class="keyword">( </span><span class="string">'CREATE TABLE data (binary BLOB(512));' </span><span class="keyword">);<br /><br /></span><span class="comment">// generate plenty of troublesome, binary data<br /></span><span class="keyword">for( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$num_values</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ )<br />{<br />    for( </span><span class="default">$val </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">512</span><span class="keyword">/</span><span class="default">16</span><span class="keyword">; </span><span class="default">$c</span><span class="keyword">++ )<br />        </span><span class="default">$val </span><span class="keyword">.= </span><span class="default">md5</span><span class="keyword">( </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">true </span><span class="keyword">);<br />    @</span><span class="default">$binary</span><span class="keyword">[] = </span><span class="default">$val</span><span class="keyword">;<br />}<br /><br /></span><span class="comment">// insert each value by prepared statement<br /></span><span class="keyword">for( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$num_values</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ )<br />    </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">( </span><span class="string">'INSERT INTO data VALUES (?);' </span><span class="keyword">)-&gt;</span><span class="default">execute</span><span class="keyword">( array(</span><span class="default">$binary</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) );<br /><br /></span><span class="comment">// fetch the entire row<br /></span><span class="default">$data </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">( </span><span class="string">'SELECT binary FROM data;' </span><span class="keyword">)-&gt;</span><span class="default">fetchAll</span><span class="keyword">( </span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_COLUMN </span><span class="keyword">);<br /><br /></span><span class="comment">// compare with original array, noting any mismatch<br /></span><span class="keyword">for( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$num_values</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ )<br />    if( </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] != </span><span class="default">$binary</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] ) echo </span><span class="string">"[</span><span class="default">$i</span><span class="string">] mismatch\n"</span><span class="keyword">;<br /><br /></span><span class="default">$db </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="114251">  <div class="votes">
    <div id="Vu114251">
    <a href="https://www.php.net/manual/vote-note.php?id=114251&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd114251">
    <a href="https://www.php.net/manual/vote-note.php?id=114251&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V114251" title="52% like this...">
    5
    </div>
  </div>
  <a href="pdo.prepare.php.html#114251" class="name">
  <strong class="user"><em>pbakhuis</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#114251"> &para;</a><div class="date" title="2014-01-29 03:42"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom114251">
<div class="phpcode"><code><span class="html">Noteworthy in my opinion is that if you prepare a statement but do not bind a value to the markers it will insert null by default. e.g.<br /><span class="default">&lt;?php<br /></span><span class="comment">/** @var PDO $db */<br /></span><span class="default">$prep </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'INSERT INTO item(title, link) VALUES(:title, :link)'</span><span class="keyword">);<br /></span><span class="default">$prep</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br /></span><span class="default">?&gt;<br /></span>Will attempt to insert null, null into the item table.</span></code></div>
  </div>
 </div>
  <div class="note" id="121379">  <div class="votes">
    <div id="Vu121379">
    <a href="https://www.php.net/manual/vote-note.php?id=121379&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121379">
    <a href="https://www.php.net/manual/vote-note.php?id=121379&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121379" title="51% like this...">
    1
    </div>
  </div>
  <a href="pdo.prepare.php.html#121379" class="name">
  <strong class="user"><em>machitgarha at outlook dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#121379"> &para;</a><div class="date" title="2017-07-14 06:32"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121379">
<div class="phpcode"><code><span class="html">Hello everyone.<br /><br />I want to note that it doesn't matter where you are using a variable inside the query directly, that is not secure against SQL injections (unless performing a long security operation).<br /><br />The following example is insecure against SQL injections:<br /><br /><span class="default">&lt;?php<br /><br />$statement </span><span class="keyword">= </span><span class="default">$databaseConnection</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"SELECT * FROM `</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'table']` WHERE </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'search_for']=:search"</span><span class="keyword">);<br /></span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">bindParam</span><span class="keyword">(</span><span class="string">":search"</span><span class="keyword">, </span><span class="default">$search</span><span class="keyword">);<br /></span><span class="default">$search </span><span class="keyword">= </span><span class="default">18</span><span class="keyword">; </span><span class="comment">// For example<br /></span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br /><br /></span><span class="default">?&gt;<br /></span><br />If an attacker pass '1;-- ' as input named 'search_for', he is not a very bad attacker; because he didn't delete your data! In the above example, an attacker can do anything with connected database (unless you have restricted the connected user). Unfortunately, as Simon Le Pine mentioned, you cannot use prepared statements as other parts of a query; just can be used to search in indexes.<br /><br />Hope this helps from loosing some data.<br />Sorry for my a bit weak English!</span></code></div>
  </div>
 </div>
  <div class="note" id="112626">  <div class="votes">
    <div id="Vu112626">
    <a href="https://www.php.net/manual/vote-note.php?id=112626&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112626">
    <a href="https://www.php.net/manual/vote-note.php?id=112626&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112626" title="52% like this...">
    1
    </div>
  </div>
  <a href="pdo.prepare.php.html#112626" class="name">
  <strong class="user"><em>php dot chaska at xoxy dot net</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#112626"> &para;</a><div class="date" title="2013-07-05 08:04"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom112626">
<div class="phpcode"><code><span class="html">Note that for Postgres, even though Postgres does support prepared statements, PHP's PDO driver NEVER sends the prepared statement to the Postgres server in advance of the call to PDO::execute().  <br /><br />Therefore, PDO::prepare() will never throw an error for things like faulty SQL syntax.  <br /><br />It also means the server will not parse and plan the SQL until the first time PDO::execute() is called, which may or may not adversely affect your optimization plans.</span></code></div>
  </div>
 </div>
  <div class="note" id="128138">  <div class="votes">
    <div id="Vu128138">
    <a href="https://www.php.net/manual/vote-note.php?id=128138&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd128138">
    <a href="https://www.php.net/manual/vote-note.php?id=128138&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V128138" title="100% like this...">
    1
    </div>
  </div>
  <a href="pdo.prepare.php.html#128138" class="name">
  <strong class="user"><em>theking2 at king dot ma</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#128138"> &para;</a><div class="date" title="2023-01-21 01:42"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom128138">
<div class="phpcode"><code><span class="html">There are restrictions on the placeholder string. In the following code the first execute fails with a SQLSTATE[HY093]. It is not clear exactly what characters are allowed.<br /><br /><span class="default">&lt;?php </span><span class="keyword">declare(</span><span class="default">strict_types</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">);<br /><br /></span><span class="default">$db </span><span class="keyword">= new </span><span class="default">\PDO</span><span class="keyword">(</span><span class="string">"mysql:hostname=localhost;dbname=minidwh"</span><span class="keyword">, </span><span class="string">"minidwh"</span><span class="keyword">, </span><span class="string">"Meisterstueck!"</span><span class="keyword">);<br /></span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SET NAMES 'utf8mb4'"</span><span class="keyword">);<br /><br /></span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"DROP TABLE IF EXISTS `äëïöüß`"</span><span class="keyword">);<br /></span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"CREATE TABLE `äëïöüß` ( `id` INT NOT NULL AUTO_INCREMENT, PRIMARY KEY (`id`) ) ENGINE = ARIA;"</span><span class="keyword">);<br /></span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"ALTER TABLE `äëïöüß` ADD COLUMN `äëïöüß` TEXT NULL"</span><span class="keyword">);<br />try {<br />  </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"INSERT INTO `äëïöüß` (`äëïöüß`) VALUES (:äëïöüß)"</span><span class="keyword">);<br />  </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">([</span><span class="string">':äëïöüß' </span><span class="keyword">=&gt; </span><span class="string">'test1'</span><span class="keyword">]);<br />} catch (</span><span class="default">\PDOException $e</span><span class="keyword">) {<br />  echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="string">'&lt;BR&gt;'</span><span class="keyword">;<br />}<br /><br />try {<br />  </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"INSERT INTO `äëïöüß` (`äëïöüß`) VALUES (?)"</span><span class="keyword">);<br />  </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">([</span><span class="string">'test2'</span><span class="keyword">]);<br />} catch (</span><span class="default">\PDOException $e</span><span class="keyword">) {<br />  echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="string">'&lt;BR&gt;'</span><span class="keyword">;<br />}<br /><br />try {<br />  </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"INSERT INTO `äëïöüß` (`äëïöüß`) VALUES (:column)"</span><span class="keyword">);<br />  </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">([</span><span class="string">':column' </span><span class="keyword">=&gt; </span><span class="string">'test3'</span><span class="keyword">]);<br />} catch (</span><span class="default">\PDOException $e</span><span class="keyword">) {<br />  echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="string">'&lt;BR&gt;'</span><span class="keyword">;<br />}<br /><br />try {<br />  </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"INSERT INTO `äëïöüß` (`äëïöüß`) VALUES (:column)"</span><span class="keyword">);<br />  </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">bindValue</span><span class="keyword">(</span><span class="string">':column'</span><span class="keyword">, </span><span class="string">'test4'</span><span class="keyword">);<br />  </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />} catch (</span><span class="default">\PDOException $e</span><span class="keyword">) {<br />  echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="string">'&lt;BR&gt;'</span><span class="keyword">;<br />}</span></span></code></div>
  </div>
 </div>
  <div class="note" id="108481">  <div class="votes">
    <div id="Vu108481">
    <a href="https://www.php.net/manual/vote-note.php?id=108481&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd108481">
    <a href="https://www.php.net/manual/vote-note.php?id=108481&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V108481" title="48% like this...">
    -1
    </div>
  </div>
  <a href="pdo.prepare.php.html#108481" class="name">
  <strong class="user"><em>orrd101 at gmail dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#108481"> &para;</a><div class="date" title="2012-04-30 12:46"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom108481">
<div class="phpcode"><code><span class="html">Don't just automatically use prepare() for all of your queries.<br /><br />If you are only submitting one query, using PDO::query() with PDO::quote() is much faster (about 3x faster in my test results with MySQL).  A prepared query is only faster if you are submitting thousands of identical queries at once (with different data).<br /><br />If you Google for performance comparisons you will find that this is generally consistently the case, or you can write some code and do your own comparison for your particular configuration and query scenario. But generally PDO::query() will always be faster except when submitting a large number of identical queries.  Prepared queries do have the advantage of escaping the data for you, so you have to be sure to use quote() when using query().</span></code></div>
  </div>
 </div>
  <div class="note" id="69291">  <div class="votes">
    <div id="Vu69291">
    <a href="https://www.php.net/manual/vote-note.php?id=69291&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd69291">
    <a href="https://www.php.net/manual/vote-note.php?id=69291&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V69291" title="47% like this...">
    -2
    </div>
  </div>
  <a href="pdo.prepare.php.html#69291" class="name">
  <strong class="user"><em>roth at egotec dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#69291"> &para;</a><div class="date" title="2006-08-30 01:58"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom69291">
<div class="phpcode"><code><span class="html">Attention using MySQL and prepared statements.<br />Using a placeholder multiple times inside a statement doesn't work. PDO just translates the first occurance und leaves the second one as is.<br /><br />select id,name from demo_de where name LIKE :name OR name=:name<br /><br />You have to use<br /><br />select id,name from demo_de where name LIKE :name OR name=:name2<br /><br />and bind name two times. I don't know if other databases (for example Oracle or MSSQL) support multiple occurances. If that's the fact, then the PDO behaviour for MySQL should be changed.</span></code></div>
  </div>
 </div>
  <div class="note" id="112277">  <div class="votes">
    <div id="Vu112277">
    <a href="https://www.php.net/manual/vote-note.php?id=112277&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112277">
    <a href="https://www.php.net/manual/vote-note.php?id=112277&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112277" title="42% like this...">
    -3
    </div>
  </div>
  <a href="pdo.prepare.php.html#112277" class="name">
  <strong class="user"><em>Hayley Watson</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#112277"> &para;</a><div class="date" title="2013-05-27 01:22"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom112277">
<div class="phpcode"><code><span class="html">It is possible to prepare in advance several statements against a single connection. As long as that connection remains open the statements can be executed and fetched from as often as you like in any order; their "prepare-execute-fetch" steps can be interleaved in whichever way is best.<br /><br />So if you're likely to be using several statements often (perhaps within a loop of transactions), you may like to consider preparing all the statements you'll be using up front.</span></code></div>
  </div>
 </div>
  <div class="note" id="83281">  <div class="votes">
    <div id="Vu83281">
    <a href="https://www.php.net/manual/vote-note.php?id=83281&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83281">
    <a href="https://www.php.net/manual/vote-note.php?id=83281&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83281" title="43% like this...">
    -3
    </div>
  </div>
  <a href="pdo.prepare.php.html#83281" class="name">
  <strong class="user"><em>ak_9jsz</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#83281"> &para;</a><div class="date" title="2008-05-18 10:16"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83281">
<div class="phpcode"><code><span class="html">Using cursors doesn't work with SQLite 3.5.9. I get an error message when it gets to the execute() method.<br /><br />Some of you might be saying "duh!" but i was surprised to see TRIGGER support in SQLite, so i had to try. :)<br /><br />I wanted to use Absolute referencing on a Scrollable cursor and i only wanted one column of data. So i used this instead of a cursor.<br /><br /><span class="default">&lt;?php<br /><br />$dbo </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'sqlite:tdb'</span><span class="keyword">);<br /></span><span class="default">$sql </span><span class="keyword">= </span><span class="string">'SELECT F1, F2 FROM tblA WHERE F1 &lt;&gt; "A";'</span><span class="keyword">;<br /></span><span class="default">$res </span><span class="keyword">= </span><span class="default">$dbo</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br /></span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br /></span><span class="default">$resColumn </span><span class="keyword">= </span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">FETCH_COLUMN</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br /><br />for(</span><span class="default">$r</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$r</span><span class="keyword">&lt;=</span><span class="default">3</span><span class="keyword">;</span><span class="default">$r</span><span class="keyword">++)<br />    echo </span><span class="string">'Row '</span><span class="keyword">. </span><span class="default">$r </span><span class="keyword">. </span><span class="string">' returned: ' </span><span class="keyword">. </span><span class="default">$resColumn</span><span class="keyword">[</span><span class="default">$r</span><span class="keyword">] . </span><span class="string">"\n"</span><span class="keyword">;<br /><br /></span><span class="default">$dbo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /></span><span class="default">$res </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="116220">  <div class="votes">
    <div id="Vu116220">
    <a href="https://www.php.net/manual/vote-note.php?id=116220&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd116220">
    <a href="https://www.php.net/manual/vote-note.php?id=116220&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V116220" title="40% like this...">
    -5
    </div>
  </div>
  <a href="pdo.prepare.php.html#116220" class="name">
  <strong class="user"><em>jesse dot chisholm at gmail dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#116220"> &para;</a><div class="date" title="2014-11-24 04:17"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom116220">
<div class="phpcode"><code><span class="html">@Simon Le Pine<br /><br />Be aware that:<br /><br />$search = "user";<br />$sth = db-&gt;prepare("SELECT * FROM users WHERE $search=:email");<br /><br />and<br /><br />$search = "email";<br />$sth = db-&gt;prepare("SELECT * FROM users WHERE $search=:email");<br /><br />will produce two totally different prepared statements.<br /><br />Doing this _will not work_:<br /><br />$search = "user";<br />$sth = db-&gt;prepare("SELECT * FROM users WHERE $search=:email");<br />$sth-&gt;execute(array(email=&gt;"yada"));<br />$search = "email";<br />$sth-&gt;execute(array(email=&gt;"yada@ya.da"));</span></code></div>
  </div>
 </div>
  <div class="note" id="121992">  <div class="votes">
    <div id="Vu121992">
    <a href="https://www.php.net/manual/vote-note.php?id=121992&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121992">
    <a href="https://www.php.net/manual/vote-note.php?id=121992&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121992" title="38% like this...">
    -7
    </div>
  </div>
  <a href="pdo.prepare.php.html#121992" class="name">
  <strong class="user"><em>omidbahrami1990 at gmail dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#121992"> &para;</a><div class="date" title="2017-12-06 10:09"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom121992">
<div class="phpcode"><code><span class="html">This Is A Secure Way To Sign in With pdo::prepare<br />--------------------------------------------------------<br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">secured_signin</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">,</span><span class="default">$password</span><span class="keyword">)<br />{    <br />try <br />{<br /></span><span class="default">$connection </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">"mysql:host=</span><span class="default">$dbhost</span><span class="string">;dbname=</span><span class="default">$dbname</span><span class="string">"</span><span class="keyword">, </span><span class="default">$dbusername</span><span class="keyword">, </span><span class="default">$dbpassword</span><span class="keyword">);<br /></span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">setAttribute</span><span class="keyword">(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">ATTR_ERRMODE</span><span class="keyword">, </span><span class="default">PDO</span><span class="keyword">::</span><span class="default">ERRMODE_EXCEPTION</span><span class="keyword">);<br /><br /></span><span class="default">$prepared </span><span class="keyword">= </span><span class="default">$connection</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">"SELECT COUNT(`username`) FROM `users` WHERE `username` = :bp_username AND `password` = :bp_password ; "</span><span class="keyword">);<br /></span><span class="default">$prepared</span><span class="keyword">-&gt;</span><span class="default">bindParam</span><span class="keyword">(</span><span class="string">':bp_username'</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">);<br /></span><span class="default">$prepared</span><span class="keyword">-&gt;</span><span class="default">bindParam</span><span class="keyword">(</span><span class="string">':bp_password'</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">);        <br /></span><span class="default">$prepared</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />        <br />if (</span><span class="default">$prepared</span><span class="keyword">-&gt;</span><span class="default">fetchColumn</span><span class="keyword">() == </span><span class="default">1</span><span class="keyword">)<br /></span><span class="default">$result</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;<br />    <br />else <br /></span><span class="default">$result</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;<br />}<br /><br />catch(</span><span class="default">PDOException $x</span><span class="keyword">) { die(</span><span class="string">"Secured"</span><span class="keyword">); }<br /><br /></span><span class="default">$prepared </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /></span><span class="default">$connection </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br /><br />return </span><span class="default">$result</span><span class="keyword">;    <br />}<br /></span><span class="comment">/*<br />$dbhost ---&gt; DataBase IP Address<br />$dbusername ---&gt; DataBase Username<br />$dbpassword ---&gt; DataBase Password<br />$dbname ---&gt; DataBase Name<br />*/<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="73421">  <div class="votes">
    <div id="Vu73421">
    <a href="https://www.php.net/manual/vote-note.php?id=73421&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd73421">
    <a href="https://www.php.net/manual/vote-note.php?id=73421&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V73421" title="36% like this...">
    -8
    </div>
  </div>
  <a href="pdo.prepare.php.html#73421" class="name">
  <strong class="user"><em>johniskew</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#73421"> &para;</a><div class="date" title="2007-02-22 08:03"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom73421">
<div class="phpcode"><code><span class="html">If you need to create variable sql statements in a prepare statement...for example you may need to construct a sql query with zero, one, two, etc numbers of arguments...here is a way to do it without a lot of if/else statements needed to glue the sql together:<br /><br /><span class="default">&lt;?php<br /><br />    </span><span class="keyword">public function </span><span class="default">matchCriteria</span><span class="keyword">(</span><span class="default">$field1</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">,</span><span class="default">$field2</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">,</span><span class="default">$field3</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />        </span><span class="default">$db</span><span class="keyword">=</span><span class="default">DB</span><span class="keyword">::</span><span class="default">conn</span><span class="keyword">();<br />        </span><span class="default">$sql</span><span class="keyword">=array();<br />        </span><span class="default">$paramArray</span><span class="keyword">=array();<br />        if(!empty(</span><span class="default">$field1</span><span class="keyword">)) {<br />            </span><span class="default">$sql</span><span class="keyword">[]=</span><span class="string">'field1=?'</span><span class="keyword">;<br />            </span><span class="default">$paramArray</span><span class="keyword">[]=</span><span class="default">$field1</span><span class="keyword">;<br />        }<br />        if(!empty(</span><span class="default">$field2</span><span class="keyword">)) {<br />            </span><span class="default">$sql</span><span class="keyword">[]=</span><span class="string">'field2=?'</span><span class="keyword">;<br />            </span><span class="default">$paramArray</span><span class="keyword">[]=</span><span class="default">$field2</span><span class="keyword">;<br />        }<br />        if(!empty(</span><span class="default">$field3</span><span class="keyword">)) {<br />            </span><span class="default">$sql</span><span class="keyword">[]=</span><span class="string">'field3=?'</span><span class="keyword">;<br />            </span><span class="default">$paramArray</span><span class="keyword">[]=</span><span class="default">$field3</span><span class="keyword">;<br />        }<br />        </span><span class="default">$rs</span><span class="keyword">=</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT * FROM mytable'</span><span class="keyword">.(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$paramArray</span><span class="keyword">)&gt;</span><span class="default">0 </span><span class="keyword">? </span><span class="string">' WHERE '</span><span class="keyword">.</span><span class="default">join</span><span class="keyword">(</span><span class="string">' AND '</span><span class="keyword">,</span><span class="default">$sql</span><span class="keyword">) : </span><span class="string">''</span><span class="keyword">));<br />        </span><span class="default">$result</span><span class="keyword">=</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$paramArray</span><span class="keyword">);<br />        if(</span><span class="default">$result</span><span class="keyword">) {<br />            return </span><span class="default">$rs</span><span class="keyword">;<br />        }<br />        return </span><span class="default">false</span><span class="keyword">;<br />    }<br /><br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="69335">  <div class="votes">
    <div id="Vu69335">
    <a href="https://www.php.net/manual/vote-note.php?id=69335&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd69335">
    <a href="https://www.php.net/manual/vote-note.php?id=69335&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V69335" title="35% like this...">
    -6
    </div>
  </div>
  <a href="pdo.prepare.php.html#69335" class="name">
  <strong class="user"><em>william dot clarke at gmail dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#69335"> &para;</a><div class="date" title="2006-08-31 03:58"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom69335">
<div class="phpcode"><code><span class="html">Surely if you want to use prepared statements that way you should use the syntax in the second example:<br /><br />eg. <br /><br />instead of:<br />select id,name from demo_de where name LIKE :name OR name=:name <br /><br />use:<br />select id,name from demo_de where name LIKE ? OR name=?<br /><br />I believe you are supposed to either use distinct named parameters (name, name1) OR anonymous parameters (?s)</span></code></div>
  </div>
 </div>
  <div class="note" id="94354">  <div class="votes">
    <div id="Vu94354">
    <a href="https://www.php.net/manual/vote-note.php?id=94354&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd94354">
    <a href="https://www.php.net/manual/vote-note.php?id=94354&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V94354" title="33% like this...">
    -5
    </div>
  </div>
  <a href="pdo.prepare.php.html#94354" class="name">
  <strong class="user"><em>sgirard at rossprint dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#94354"> &para;</a><div class="date" title="2009-10-29 03:15"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom94354">
<div class="phpcode"><code><span class="html">Maybe everyone else already knows this but...<br /><br />If you have a routine that prepares/executes many insert or update statements for a sqlite db then you may want to make use of the pdo transactions. <br /><br />On some old hardware my query set went from 12 seconds to 1/3-1/2 second. <br /><br />-sean</span></code></div>
  </div>
 </div>
  <div class="note" id="99697">  <div class="votes">
    <div id="Vu99697">
    <a href="https://www.php.net/manual/vote-note.php?id=99697&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd99697">
    <a href="https://www.php.net/manual/vote-note.php?id=99697&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V99697" title="32% like this...">
    -10
    </div>
  </div>
  <a href="pdo.prepare.php.html#99697" class="name">
  <strong class="user"><em>pascal dot buguet at laposte dot net</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#99697"> &para;</a><div class="date" title="2010-08-31 05:11"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom99697">
<div class="phpcode"><code><span class="html">PDO::CURSOR_SCROLL is ok with MSS.<br />You must install SQL Server Driver for PHP 2.0 CTP2 : SQLSRV20.EXE<br />and  the native client "Microsoft SQL Server 2008 R2 Native Client" : sqlncli.msi.</span></code></div>
  </div>
 </div>
  <div class="note" id="93469">  <div class="votes">
    <div id="Vu93469">
    <a href="https://www.php.net/manual/vote-note.php?id=93469&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd93469">
    <a href="https://www.php.net/manual/vote-note.php?id=93469&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V93469" title="31% like this...">
    -8
    </div>
  </div>
  <a href="pdo.prepare.php.html#93469" class="name">
  <strong class="user"><em>richard at codevanilla.com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#93469"> &para;</a><div class="date" title="2009-09-11 04:44"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom93469">
<div class="phpcode"><code><span class="html">beware<br />PDO will emulate prepared statements/bound parameters for drivers that do not natively support them, and can also rewrite named or question mark style parameter markers to something more appropriate, if the driver supports one style but not the other.<br /><br />This includes mySQL it seems so<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">try{ <br />        </span><span class="default">$sth1 </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">db1</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="default">$t1</span><span class="keyword">, array(</span><span class="default">PDO</span><span class="keyword">::</span><span class="default">ATTR_CURSOR </span><span class="keyword">=&gt; </span><span class="default">PDO</span><span class="keyword">::</span><span class="default">CURSOR_FWDONLY</span><span class="keyword">));<br />        <br />        }<br />        catch(</span><span class="default">PDOException $e</span><span class="keyword">){<br />                return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pack</span><span class="keyword">(</span><span class="string">'dbError'</span><span class="keyword">, </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">());<br />        }<br /></span><span class="default">?&gt;<br /></span><br />does not and so will not throw the exception if your SQL is wrong.<br /><br />You will need to check that $sth1 is not null.</span></code></div>
  </div>
 </div>
  <div class="note" id="111798">  <div class="votes">
    <div id="Vu111798">
    <a href="https://www.php.net/manual/vote-note.php?id=111798&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111798">
    <a href="https://www.php.net/manual/vote-note.php?id=111798&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111798" title="31% like this...">
    -11
    </div>
  </div>
  <a href="pdo.prepare.php.html#111798" class="name">
  <strong class="user"><em>Kjetil H</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#111798"> &para;</a><div class="date" title="2013-03-28 09:44"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom111798">
<div class="phpcode"><code><span class="html">Please note that the correct internal method signature is:<br /><span class="default">&lt;?php </span><span class="keyword">public function </span><span class="default">prepare </span><span class="keyword">(</span><span class="default">$statement</span><span class="keyword">, </span><span class="default">$driver_options </span><span class="keyword">= array()) </span><span class="default">?&gt;</span> <br /><br />and NOT:<br /><span class="default">&lt;?php </span><span class="keyword">public function </span><span class="default">prepare </span><span class="keyword">(</span><span class="default">$statement</span><span class="keyword">, array </span><span class="default">$driver_options </span><span class="keyword">= array()) </span><span class="default">?&gt;</span>.<br /><br />Redeclaring the method using the latter method signature throws a Stricts Standards error.</span></code></div>
  </div>
 </div>
  <div class="note" id="74362">  <div class="votes">
    <div id="Vu74362">
    <a href="https://www.php.net/manual/vote-note.php?id=74362&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd74362">
    <a href="https://www.php.net/manual/vote-note.php?id=74362&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V74362" title="20% like this...">
    -14
    </div>
  </div>
  <a href="pdo.prepare.php.html#74362" class="name">
  <strong class="user"><em>www.onphp5.com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#74362"> &para;</a><div class="date" title="2007-04-07 06:41"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom74362">
<div class="phpcode"><code><span class="html">Please note that the statement regarding driver_options is misleading:<br /><br />"This array holds one or more key=&gt;value pairs to set attribute values for the PDOStatement object that this method returns. You would most commonly use this to set the PDO::ATTR_CURSOR value to PDO::CURSOR_SCROLL to request a scrollable cursor. Some drivers have driver specific options that may be set at prepare-time"<br /><br />From this you might think that scrollable cursors work for all databases, but they don't! Check out this bug report:<br /><a href="http://bugs.php.net/bug.php?id=34625" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=34625</a></span></code></div>
  </div>
 </div>
  <div class="note" id="116859">  <div class="votes">
    <div id="Vu116859">
    <a href="https://www.php.net/manual/vote-note.php?id=116859&amp;page=pdo.prepare&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd116859">
    <a href="https://www.php.net/manual/vote-note.php?id=116859&amp;page=pdo.prepare&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V116859" title="19% like this...">
    -19
    </div>
  </div>
  <a href="pdo.prepare.php.html#116859" class="name">
  <strong class="user"><em>chatelain dot cedric dot pro at gmail dot com</em></strong></a><a class="genanchor" href="pdo.prepare.php.html#116859"> &para;</a><div class="date" title="2015-03-11 11:24"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom116859">
<div class="phpcode"><code><span class="html">you can't use CREATE DATABASE with prepared statement.<br /><br />$sql = $conn-&gt;prepare("DROP DATABASE IF EXISTS :dbname ;", <br />                    array(PDO::ATTR_CURSOR =&gt; PDO::CURSOR_FWDONLY));<br />            $sql-&gt;execute(array(':dbname' =&gt; $dbname));<br /><br />This will not work.<br />Anyone has an explanation ?</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=pdo.prepare&amp;redirect=https://www.php.net/manual/ru/pdo.prepare.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="class.pdo.php.html">PDO</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="pdo.begintransaction.php.html" title="beginTransaction">beginTransaction</a>
                        </li>
                                                <li class="">
                            <a href="pdo.commit.php.html" title="commit">commit</a>
                        </li>
                                                <li class="">
                            <a href="pdo.construct.php.html" title="_&#8203;_&#8203;construct">_&#8203;_&#8203;construct</a>
                        </li>
                                                <li class="">
                            <a href="pdo.errorcode.php.html" title="errorCode">errorCode</a>
                        </li>
                                                <li class="">
                            <a href="pdo.errorinfo.php.html" title="errorInfo">errorInfo</a>
                        </li>
                                                <li class="">
                            <a href="pdo.exec.php.html" title="exec">exec</a>
                        </li>
                                                <li class="">
                            <a href="pdo.getattribute.php.html" title="getAttribute">getAttribute</a>
                        </li>
                                                <li class="">
                            <a href="pdo.getavailabledrivers.php.html" title="getAvailableDrivers">getAvailableDrivers</a>
                        </li>
                                                <li class="">
                            <a href="pdo.intransaction.php.html" title="inTransaction">inTransaction</a>
                        </li>
                                                <li class="">
                            <a href="pdo.lastinsertid.php.html" title="lastInsertId">lastInsertId</a>
                        </li>
                                                <li class="current">
                            <a href="pdo.prepare.php.html" title="prepare">prepare</a>
                        </li>
                                                <li class="">
                            <a href="pdo.query.php.html" title="query">query</a>
                        </li>
                                                <li class="">
                            <a href="pdo.quote.php.html" title="quote">quote</a>
                        </li>
                                                <li class="">
                            <a href="pdo.rollback.php.html" title="rollBack">rollBack</a>
                        </li>
                                                <li class="">
                            <a href="pdo.setattribute.php.html" title="setAttribute">setAttribute</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
