<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Подготовленные запросы и хранимые процедуры - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="pdo.prepared-statements.php.html">
 <link rel="shorturl" href="pdo.prepared-statements.php.html">
 <link rel="alternate" href="pdo.prepared-statements.php.html" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="book.pdo.php.html">
 <link rel="prev" href="pdo.transactions.php.html">
 <link rel="next" href="pdo.error-handling.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/pdo.prepared-statements.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/pdo.prepared-statements.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/pdo.prepared-statements.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/pdo.prepared-statements.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/pdo.prepared-statements.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/pdo.prepared-statements.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/pdo.prepared-statements.php" hreflang="pt_BR">
 <link rel="alternate" href="pdo.prepared-statements.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/pdo.prepared-statements.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/pdo.prepared-statements.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="pdo.error-handling.php.html">
          Ошибки и их обработка &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="pdo.transactions.php.html">
          &laquo; Транзакции и автоматическая фиксация изменений        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.database.php.html'>Модули для работы с базами данных</a></li>      <li><a href='refs.database.abstract.php.html'>Уровни абстракции</a></li>      <li><a href='book.pdo.php.html'>PDO</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/pdo.prepared-statements.php'>English</option>
            <option value='de/pdo.prepared-statements.php'>German</option>
            <option value='es/pdo.prepared-statements.php'>Spanish</option>
            <option value='fr/pdo.prepared-statements.php'>French</option>
            <option value='it/pdo.prepared-statements.php'>Italian</option>
            <option value='ja/pdo.prepared-statements.php'>Japanese</option>
            <option value='pt_BR/pdo.prepared-statements.php'>Brazilian Portuguese</option>
            <option value='ru/pdo.prepared-statements.php' selected="selected">Russian</option>
            <option value='tr/pdo.prepared-statements.php'>Turkish</option>
            <option value='zh/pdo.prepared-statements.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/pdo/prepared-statements.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fpdo.prepared-statements%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="pdo.prepared-statements" class="chapter">
 <h1>Подготовленные запросы и хранимые процедуры</h1>

 <p class="para">
  Большинство баз данных поддерживают концепцию подготовленных запросов. Что это
  такое? Это можно описать, как некий вид скомпилированного шаблона SQL запроса,
  который будет запускаться приложением и настраиваться с помощью входных
  параметров. У подготовленных запросов есть два главных преимущества:
 </p>
 <ul class="itemizedlist">
  <li class="listitem">
   <span class="simpara">
    Запрос необходимо однажды подготовить и затем его можно запускать столько
    раз, сколько нужно, причём как с теми же, так и с отличающимися параметрами.
    Когда запрос подготовлен, СУБД анализирует его, компилирует и оптимизирует
    план его выполнения. В случае сложных запросов этот процесс может занимать
    ощутимое время и заметно замедлить работу приложения, если потребуется много
    раз выполнять запрос с разными параметрами. При использовании подготовленного
    запроса СУБД анализирует/компилирует/оптимизирует запрос любой сложности только
    один раз, а приложение запускает на выполнение уже подготовленный шаблон. Таким
    образом подготовленные запросы потребляют меньше ресурсов и работают быстрее.
   </span>
  </li>
  <li class="listitem">
   <span class="simpara">
    Параметры подготовленного запроса не требуется экранировать кавычками; драйвер
    это делает автоматически. Если в приложении используются исключительно
    подготовленные запросы, разработчик может быть уверен, что никаких
    SQL-инъекций случиться не может (однако, если другие части текста запроса создаются
    с неэкранированным вводом, то SQL инъекция по-прежнему возможна).
   </span>
  </li>
 </ul>
 <p class="para">
  Подготовленные запросы также полезны тем, что PDO может эмулировать их, если
  драйвер базы данных не имеет подобной функциональности. Это значит, что приложение
  может пользоваться одной и той же методикой доступа к данным независимо от
  возможностей СУБД.
 </p>
 <p class="para">
  <div class="example" id="example-3097">
   <p><strong>Пример #1 Повторяющиеся вставки в базу с использованием подготовленных запросов</strong></p>
   <div class="example-contents"><p>
    В этом примере 2 раза выполняется INSERT запрос с разными значениями
    <code class="literal">name</code> и <code class="literal">value</code>, которые подставляются
    вместо соответствующих псевдопеременных:
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT INTO REGISTRY (name, value) VALUES (:name, :value)"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #DD0000">':name'</span><span style="color: #007700">, </span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #DD0000">':value'</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// вставим одну строку<br /></span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #DD0000">'one'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// теперь другую строку с другими значениями<br /></span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #DD0000">'two'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
 </p>
 <p class="para">
  <div class="example" id="example-3100">
   <p><strong>Пример #2 Повторяющиеся вставки в базу с использованием подготовленных запросов</strong></p>
   <div class="example-contents"><p>
    В этом примере 2 раза выполняется INSERT запрос с разными значениями
    <code class="literal">name</code> и <code class="literal">value</code>, которые подставляются вместо
    псевдопеременных <code class="literal">?</code>.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"INSERT INTO REGISTRY (name, value) VALUES (?, ?)"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">$name</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// вставим одну строку<br /></span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #DD0000">'one'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// теперь другую строку с другими значениями<br /></span><span style="color: #0000BB">$name </span><span style="color: #007700">= </span><span style="color: #DD0000">'two'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
 </p>
 <p class="para">
  <div class="example" id="example-3103">
   <p><strong>Пример #3 Выборка данных с использованием подготовленных запросов</strong></p>
   <div class="example-contents"><p>
    В этом примере производится выборка из базы по ключу, который вводит
    пользователь через форму. Пользовательский ввод автоматически заключается
    в кавычки, поэтому нет риска SQL инъекции.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT * FROM REGISTRY where name = ?"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]]);<br />foreach (</span><span style="color: #0000BB">$stmt </span><span style="color: #007700">as </span><span style="color: #0000BB">$row</span><span style="color: #007700">) {<br />  </span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
 </p>

 <p class="para">
  <div class="example" id="example-3106">
   <p><strong>Пример #4 Вызов хранимой процедуры с выходными параметрами</strong></p>
   <div class="example-contents"><p>
    Если СУБД поддерживает выходные параметры, приложение может пользоваться ими
    также как и входными. Выходные параметры обычно используют для получения данных
    из хранимых процедур. Пользоваться выходными параметрами несколько сложнее, так
    как разработчику необходимо знать максимальный размер извлекаемых значений ещё
    на этапе задания этих параметров. Если извлекаемое значение окажется больше,
    чем предполагалось, будет вызвана ошибка.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"CALL sp_returns_string(?)"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">$return_value</span><span style="color: #007700">, </span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">PARAM_STR</span><span style="color: #007700">, </span><span style="color: #0000BB">4000</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// вызов хранимой процедуры<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br />print </span><span style="color: #DD0000">"процедура вернула </span><span style="color: #0000BB">$return_value</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
 </p>

 <p class="para">
  <div class="example" id="example-3109">
   <p><strong>Пример #5 Вызов хранимой процедуры с входным/выходным параметром</strong></p>
   <div class="example-contents"><p>
    Можно задать параметр одновременно входным и выходным; синтаксис при этом тот же,
    что и для выходных параметров. В следующем примере строка &#039;привет&#039; передаётся в
    хранимую процедуру, а затем эта строка будет заменена возвращаемым значением.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"CALL sp_takes_string_returns_string(?)"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #DD0000">'привет'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bindParam</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">, </span><span style="color: #0000BB">$value</span><span style="color: #007700">, </span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">PARAM_STR</span><span style="color: #007700">|</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">PARAM_INPUT_OUTPUT</span><span style="color: #007700">, </span><span style="color: #0000BB">4000</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">// вызов хранимой процедуры<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br />print </span><span style="color: #DD0000">"процедура вернула </span><span style="color: #0000BB">$value</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
 </p>
 <p class="para">
  <div class="example" id="example-3112">
   <p><strong>Пример #6 Неправильное использование псевдопеременной</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT * FROM REGISTRY where name LIKE '%?%'"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]]);<br /><br /></span><span style="color: #FF8000">// псевдопеременная может использоваться только в виде отдельного значения<br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT * FROM REGISTRY where name LIKE ?"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">([</span><span style="color: #DD0000">"%</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #0000BB">name</span><span style="color: #007700">]</span><span style="color: #DD0000">%"</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
   </div>

  </div>
 </p>
</div>
<section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=pdo.prepared-statements&amp;redirect=https://www.php.net/manual/ru/pdo.prepared-statements.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">3 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="97162">  <div class="votes">
    <div id="Vu97162">
    <a href="https://www.php.net/manual/vote-note.php?id=97162&amp;page=pdo.prepared-statements&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd97162">
    <a href="https://www.php.net/manual/vote-note.php?id=97162&amp;page=pdo.prepared-statements&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V97162" title="64% like this...">
    214
    </div>
  </div>
  <a href="pdo.prepared-statements.php.html#97162" class="name">
  <strong class="user"><em>adam at pyramidpower dot com dot au</em></strong></a><a class="genanchor" href="pdo.prepared-statements.php.html#97162"> &para;</a><div class="date" title="2010-04-05 06:38"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom97162">
<div class="phpcode"><code><span class="html">Note that when using name parameters with bindParam, the name itself, cannot contain a dash '-'. <br /><br />example:<br /><span class="default">&lt;?php<br />$stmt </span><span class="keyword">= </span><span class="default">$dbh</span><span class="keyword">-&gt;</span><span class="default">prepare </span><span class="keyword">(</span><span class="string">"INSERT INTO user (firstname, surname) VALUES (:f-name, :s-name)"</span><span class="keyword">);<br /></span><span class="default">$stmt </span><span class="keyword">-&gt; </span><span class="default">bindParam</span><span class="keyword">(</span><span class="string">':f-name'</span><span class="keyword">, </span><span class="string">'John'</span><span class="keyword">);<br /></span><span class="default">$stmt </span><span class="keyword">-&gt; </span><span class="default">bindParam</span><span class="keyword">(</span><span class="string">':s-name'</span><span class="keyword">, </span><span class="string">'Smith'</span><span class="keyword">);<br /></span><span class="default">$stmt </span><span class="keyword">-&gt; </span><span class="default">execute</span><span class="keyword">();<br /></span><span class="default">?&gt;<br /></span><br />The dashes in 'f-name' and 's-name' should be replaced with an underscore or no dash at all.<br /><br />See <a href="http://bugs.php.net/43130" rel="nofollow" target="_blank">http://bugs.php.net/43130</a><br /><br />Adam</span></code></div>
  </div>
 </div>
  <div class="note" id="124692">  <div class="votes">
    <div id="Vu124692">
    <a href="https://www.php.net/manual/vote-note.php?id=124692&amp;page=pdo.prepared-statements&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124692">
    <a href="https://www.php.net/manual/vote-note.php?id=124692&amp;page=pdo.prepared-statements&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124692" title="54% like this...">
    6
    </div>
  </div>
  <a href="pdo.prepared-statements.php.html#124692" class="name">
  <strong class="user"><em>w37090 at yandex dot ru</em></strong></a><a class="genanchor" href="pdo.prepared-statements.php.html#124692"> &para;</a><div class="date" title="2020-02-06 06:11"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom124692">
<div class="phpcode"><code><span class="html">Insert a multidimensional array into the database through a prepared query:<br />We have an array to write the form:<br /><br />$dataArr:<br />Array<br />(<br />    [0] =&gt; Array<br />        (<br />            [0] =&gt; 2020<br />            [1] =&gt; 23<br />            [2] =&gt; 111111<br />        )<br /> <br />    [1] =&gt; Array<br />        (<br />            [0] =&gt; 2020<br />            [1] =&gt; 24<br />            [2] =&gt; 222222222<br />        )<br />....<br /><br />Task: prepare a request and pass through binds<br />$array = [];<br />foreach ($dataArr as $k=&gt;$v) {<br />// $x = 2020, the variable is predetermined in advance, does not change the essence<br />$array[] = [$x, $k, $v];<br />}<br />$sql = ("INSERT INTO `table` (`field`,`field`,`field`) VALUES (?,?,?)");<br /><br />$db-&gt;queryBindInsert($sql,$array);<br /><br />public function queryBindInsert($sql,$bind) {<br />        $stmt = $this-&gt;pdo-&gt;prepare($sql);<br /> <br />        if(count($bind)) {<br />            foreach($bind as $param =&gt; $value) {<br />                $c = 1;<br />                for ($i=0; $i&lt;count($value); $i++) {<br />                    $stmt-&gt;bindValue($c++, $value[$i]);<br />                }<br />                $stmt-&gt;execute();<br />            }<br />        }<br />    }</span></code></div>
  </div>
 </div>
  <div class="note" id="125732">  <div class="votes">
    <div id="Vu125732">
    <a href="https://www.php.net/manual/vote-note.php?id=125732&amp;page=pdo.prepared-statements&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125732">
    <a href="https://www.php.net/manual/vote-note.php?id=125732&amp;page=pdo.prepared-statements&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125732" title="25% like this...">
    -35
    </div>
  </div>
  <a href="pdo.prepared-statements.php.html#125732" class="name">
  <strong class="user"><em>bkilinc at deyta dot net</em></strong></a><a class="genanchor" href="pdo.prepared-statements.php.html#125732"> &para;</a><div class="date" title="2021-01-28 05:38"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom125732">
<div class="phpcode"><code><span class="html">it is a good practice not using double quotes in sql strings. This way you can ensure that no variable is injected in query.<br />a simple query with parameters should be;<br />'INSERT INTO REGISTRY (name, value) VALUES (?, ?)'<br />not<br />"INSERT INTO REGISTRY (name, value) VALUES (?, ?)"</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=pdo.prepared-statements&amp;redirect=https://www.php.net/manual/ru/pdo.prepared-statements.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="book.pdo.php.html">PDO</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="intro.pdo.php.html" title="Введение">Введение</a>
                        </li>
                                                <li class="">
                            <a href="pdo.setup.php.html" title="Установка и настройка">Установка и настройка</a>
                        </li>
                                                <li class="">
                            <a href="pdo.constants.php.html" title="Предопределённые константы">Предопределённые константы</a>
                        </li>
                                                <li class="">
                            <a href="pdo.connections.php.html" title="Подключения и управление подключениями">Подключения и управление подключениями</a>
                        </li>
                                                <li class="">
                            <a href="pdo.transactions.php.html" title="Транзакции и автоматическая фиксация изменений">Транзакции и автоматическая фиксация изменений</a>
                        </li>
                                                <li class="current">
                            <a href="pdo.prepared-statements.php.html" title="Подготовленные запросы и хранимые процедуры">Подготовленные запросы и хранимые процедуры</a>
                        </li>
                                                <li class="">
                            <a href="pdo.error-handling.php.html" title="Ошибки и их обработка">Ошибки и их обработка</a>
                        </li>
                                                <li class="">
                            <a href="pdo.lobs.php.html" title="Большие объекты (LOB)">Большие объекты (LOB)</a>
                        </li>
                                                <li class="">
                            <a href="class.pdo.php.html" title="PDO">PDO</a>
                        </li>
                                                <li class="">
                            <a href="class.pdostatement.php.html" title="PDOStatement">PDOStatement</a>
                        </li>
                                                <li class="">
                            <a href="class.pdorow.php.html" title="PDORow">PDORow</a>
                        </li>
                                                <li class="">
                            <a href="class.pdoexception.php.html" title="PDOException">PDOException</a>
                        </li>
                                                <li class="">
                            <a href="pdo.drivers.php.html" title="Драйверы PDO">Драйверы PDO</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
