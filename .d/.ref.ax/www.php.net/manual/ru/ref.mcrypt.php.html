<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Mcrypt - Manual </title>

 <link rel="icon" type="image/svg+xml" sizes="any" href="../../favicon.svg%3Fv=2">
 <link rel="icon" type="image/png" sizes="196x196" href="../../favicon-196x196.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png%3Fv=2">
 <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png%3Fv=2">
 <link rel="shortcut icon" href="../../favicon.ico%3Fv=2">

 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="ref.mcrypt.php.html">
 <link rel="shorturl" href="https://www.php.net/mcrypt">
 <link rel="alternate" href="https://www.php.net/mcrypt" hreflang="x-default">

 <link rel="contents" href="index.php.html">
 <link rel="index" href="book.mcrypt.php.html">
 <link rel="prev" href="mcrypt.ciphers.php.html">
 <link rel="next" href="function.mcrypt-create-iv.php.html">

 <link rel="alternate" href="https://www.php.net/manual/en/ref.mcrypt.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/de/ref.mcrypt.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/es/ref.mcrypt.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/fr/ref.mcrypt.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/it/ref.mcrypt.php" hreflang="it">
 <link rel="alternate" href="https://www.php.net/manual/ja/ref.mcrypt.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/ref.mcrypt.php" hreflang="pt_BR">
 <link rel="alternate" href="ref.mcrypt.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/tr/ref.mcrypt.php" hreflang="tr">
 <link rel="alternate" href="https://www.php.net/manual/zh/ref.mcrypt.php" hreflang="zh">

<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1689765002&amp;f=%252Ffonts%252FFira%252Ffira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1700771401&amp;f=%252Ffonts%252FFont-Awesome%252Fcss%252Ffontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1705413607&amp;f=%252Fstyles%252Ftheme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached.php%3Ft=1701958202&amp;f=%252Fstyles%252Ftheme-medium.css" media="screen">

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="../../images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.3/index.php">
          <img src="../../images/php8/logo_php8_3.svg" alt="php8.3" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='https://www.php.net/conferences/index.php#2024-02-13-1'>Dutch PHP Conference 2024</a></div>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.attributes.php'>Predefined Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.mcrypt-create-iv.php.html">
          mcrypt_create_iv &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="mcrypt.ciphers.php.html">
          &laquo; Шифры Mcrypt        </a>
      </div>
          <ul>
            <li><a href='index.php.html'>Руководство по PHP</a></li>      <li><a href='funcref.php.html'>Справочник функций</a></li>      <li><a href='refs.crypto.php.html'>Криптографические модули</a></li>      <li><a href='book.mcrypt.php.html'>Mcrypt</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/ref.mcrypt.php'>English</option>
            <option value='de/ref.mcrypt.php'>German</option>
            <option value='es/ref.mcrypt.php'>Spanish</option>
            <option value='fr/ref.mcrypt.php'>French</option>
            <option value='it/ref.mcrypt.php'>Italian</option>
            <option value='ja/ref.mcrypt.php'>Japanese</option>
            <option value='pt_BR/ref.mcrypt.php'>Brazilian Portuguese</option>
            <option value='ru/ref.mcrypt.php' selected="selected">Russian</option>
            <option value='tr/ref.mcrypt.php'>Turkish</option>
            <option value='zh/ref.mcrypt.php'>Chinese (Simplified)</option>
            <option value='help-translate.php'>Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/reference/mcrypt/reference.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fref.mcrypt%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="ref.mcrypt" class="reference">
 <h1 class="title">Mcrypt</h1>

 































































































































































































































<h2>Содержание</h2><ul class="chunklist chunklist_reference"><li><a href="function.mcrypt-create-iv.php.html">mcrypt_create_iv</a> — Создать инициализирующий вектор (Initialization Vector или IV) из случайного источника</li><li><a href="function.mcrypt-decrypt.php.html">mcrypt_decrypt</a> — Расшифровывает данные с заданными параметрами</li><li><a href="function.mcrypt-enc-get-algorithms-name.php.html">mcrypt_enc_get_algorithms_name</a> — Возвращает имя алгоритма</li><li><a href="function.mcrypt-enc-get-block-size.php.html">mcrypt_enc_get_block_size</a> — Возвращает размер блока алгоритма</li><li><a href="function.mcrypt-enc-get-iv-size.php.html">mcrypt_enc_get_iv_size</a> — Возвращает размер инициализирующего вектора для алгоритма</li><li><a href="function.mcrypt-enc-get-key-size.php.html">mcrypt_enc_get_key_size</a> — Возвращает максимальную допустимую длину ключа алгоритма</li><li><a href="function.mcrypt-enc-get-modes-name.php.html">mcrypt_enc_get_modes_name</a> — Возвращает имя используемого режима</li><li><a href="function.mcrypt-enc-get-supported-key-sizes.php.html">mcrypt_enc_get_supported_key_sizes</a> — Возвращает массив с допустимыми размерами ключа для используемого алгоритма</li><li><a href="function.mcrypt-enc-is-block-algorithm-mode.php.html">mcrypt_enc_is_block_algorithm_mode</a> — Проверяет, используется ли блочный режим</li><li><a href="function.mcrypt-enc-is-block-algorithm.php.html">mcrypt_enc_is_block_algorithm</a> — Проверяет, использует ли алгоритм блочные режимы</li><li><a href="function.mcrypt-enc-is-block-mode.php.html">mcrypt_enc_is_block_mode</a> — Проверяет, возвращает ли текущий режим блоки</li><li><a href="function.mcrypt-enc-self-test.php.html">mcrypt_enc_self_test</a> — Запуск самопроверки открытого модуля</li><li><a href="function.mcrypt-encrypt.php.html">mcrypt_encrypt</a> — Шифрует текст с заданными параметрами</li><li><a href="function.mcrypt-generic-deinit.php.html">mcrypt_generic_deinit</a> — Эта функция деинициализирует модуль шифрования</li><li><a href="function.mcrypt-generic-init.php.html">mcrypt_generic_init</a> — Функция инициализирует все буферы, необходимые для шифрования</li><li><a href="function.mcrypt-generic.php.html">mcrypt_generic</a> — Функция шифрует данные</li><li><a href="function.mcrypt-get-block-size.php.html">mcrypt_get_block_size</a> — Возвращает размер блока для указанного шифра</li><li><a href="function.mcrypt-get-cipher-name.php.html">mcrypt_get_cipher_name</a> — Получает имя указанного шифра</li><li><a href="function.mcrypt-get-iv-size.php.html">mcrypt_get_iv_size</a> — Возвращает размер инициализирующего вектора для соответствующей комбинации шифра и режима</li><li><a href="function.mcrypt-get-key-size.php.html">mcrypt_get_key_size</a> — Получить размер ключа заданного шифра</li><li><a href="function.mcrypt-list-algorithms.php.html">mcrypt_list_algorithms</a> — Получить список всех поддерживаемых алгоритмов шифрования</li><li><a href="function.mcrypt-list-modes.php.html">mcrypt_list_modes</a> — Получить список всех поддерживаемых режимов шифрования</li><li><a href="function.mcrypt-module-close.php.html">mcrypt_module_close</a> — Закрывает модуль mcrypt</li><li><a href="function.mcrypt-module-get-algo-block-size.php.html">mcrypt_module_get_algo_block_size</a> — Возвращает размер блока указанного алгоритма</li><li><a href="function.mcrypt-module-get-algo-key-size.php.html">mcrypt_module_get_algo_key_size</a> — Возвращает максимальный размер ключа открытого режима</li><li><a href="function.mcrypt-module-get-supported-key-sizes.php.html">mcrypt_module_get_supported_key_sizes</a> — Возвращает список поддерживаемых размеров ключей для открытого алгоритма</li><li><a href="function.mcrypt-module-is-block-algorithm-mode.php.html">mcrypt_module_is_block_algorithm_mode</a> — Проверяет, является ли заданный модуль блочным или нет</li><li><a href="function.mcrypt-module-is-block-algorithm.php.html">mcrypt_module_is_block_algorithm</a> — Проверяет, является ли заданный алгоритм блочным или нет</li><li><a href="function.mcrypt-module-is-block-mode.php.html">mcrypt_module_is_block_mode</a> — Проверить, возвращает ли указанный режим данные блоками или нет</li><li><a href="function.mcrypt-module-open.php.html">mcrypt_module_open</a> — Открывает модуль шифрования с использованием указанных алгоритма и режима</li><li><a href="function.mcrypt-module-self-test.php.html">mcrypt_module_self_test</a> — Функция запускает самопроверку указанного модуля</li><li><a href="function.mdecrypt-generic.php.html">mdecrypt_generic</a> — Дешифровка данных</li></ul>
</div>
<section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=ref.mcrypt&amp;redirect=https://www.php.net/manual/ru/ref.mcrypt.php">＋<small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">24 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="69782">  <div class="votes">
    <div id="Vu69782">
    <a href="https://www.php.net/manual/vote-note.php?id=69782&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd69782">
    <a href="https://www.php.net/manual/vote-note.php?id=69782&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V69782" title="56% like this...">
    6
    </div>
  </div>
  <a href="ref.mcrypt.php.html#69782" class="name">
  <strong class="user"><em>duerra_NOT_THIS_ at pushitlive dot net</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#69782"> &para;</a><div class="date" title="2006-09-20 12:56"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom69782">
<div class="phpcode"><code><span class="html">For those of you that need to use PKCS#5 padding, the mcrypt API's for PHP do not support it.  However, you can DIY using the following:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">function </span><span class="default">encrypt_something</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)<br />{<br />    </span><span class="default">$size </span><span class="keyword">= </span><span class="default">mcrypt_get_block_size</span><span class="keyword">(</span><span class="string">'des'</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">);<br />    </span><span class="default">$input </span><span class="keyword">= </span><span class="default">pkcs5_pad</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$size</span><span class="keyword">);<br />    <br />    </span><span class="default">$key </span><span class="keyword">= </span><span class="string">'YOUR SECRET KEY HERE'</span><span class="keyword">;<br />    </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'des'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);<br />    </span><span class="default">$iv </span><span class="keyword">= </span><span class="default">mcrypt_create_iv </span><span class="keyword">(</span><span class="default">mcrypt_enc_get_iv_size</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">), </span><span class="default">MCRYPT_RAND</span><span class="keyword">);<br />    </span><span class="default">mcrypt_generic_init</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);<br />    </span><span class="default">$data </span><span class="keyword">= </span><span class="default">mcrypt_generic</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">);<br />    </span><span class="default">mcrypt_generic_deinit</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">);<br />    </span><span class="default">mcrypt_module_close</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">);<br />    </span><span class="default">$data </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />    return </span><span class="default">$data</span><span class="keyword">;<br />}<br /><br />function </span><span class="default">pkcs5_pad </span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$blocksize</span><span class="keyword">)<br />{<br />    </span><span class="default">$pad </span><span class="keyword">= </span><span class="default">$blocksize </span><span class="keyword">- (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) % </span><span class="default">$blocksize</span><span class="keyword">);<br />    return </span><span class="default">$text </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$pad</span><span class="keyword">), </span><span class="default">$pad</span><span class="keyword">);<br />}<br /><br />function </span><span class="default">pkcs5_unpad</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)<br />{<br />    </span><span class="default">$pad </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">{</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">});<br />    if (</span><span class="default">$pad </span><span class="keyword">&gt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />    if (</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$pad</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) - </span><span class="default">$pad</span><span class="keyword">) != </span><span class="default">$pad</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />    return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">* </span><span class="default">$pad</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="62850">  <div class="votes">
    <div id="Vu62850">
    <a href="https://www.php.net/manual/vote-note.php?id=62850&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd62850">
    <a href="https://www.php.net/manual/vote-note.php?id=62850&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V62850" title="71% like this...">
    3
    </div>
  </div>
  <a href="ref.mcrypt.php.html#62850" class="name">
  <strong class="user"><em>rolf at winmutt dot com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#62850"> &para;</a><div class="date" title="2006-03-10 12:19"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom62850">
<div class="phpcode"><code><span class="html">mysql AES_ENCRYPT() compatibly function for PHP :<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">mysql_aes_encrypt</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$ky</span><span class="keyword">) {<br />    </span><span class="default">$mode</span><span class="keyword">=</span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">;    <br />    </span><span class="default">$enc</span><span class="keyword">=</span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">;<br />    </span><span class="default">$val</span><span class="keyword">=</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, (</span><span class="default">16</span><span class="keyword">*(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) / </span><span class="default">16</span><span class="keyword">)+(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">?</span><span class="default">2</span><span class="keyword">:</span><span class="default">1</span><span class="keyword">))), </span><span class="default">chr</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">-(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">)));<br />    return </span><span class="default">mcrypt_encrypt</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$ky</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, </span><span class="default">mcrypt_create_iv</span><span class="keyword">( </span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">), </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">));<br />}<br /></span><span class="default">?&gt;<br /></span><br />Please note that if the strlen($ky)&gt;16 then this function will not be compatible.</span></code></div>
  </div>
 </div>
  <div class="note" id="38860">  <div class="votes">
    <div id="Vu38860">
    <a href="https://www.php.net/manual/vote-note.php?id=38860&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd38860">
    <a href="https://www.php.net/manual/vote-note.php?id=38860&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V38860" title="71% like this...">
    3
    </div>
  </div>
  <a href="ref.mcrypt.php.html#38860" class="name">
  <strong class="user"><em>groundzero at zuavra dot net</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#38860"> &para;</a><div class="date" title="2004-01-09 05:08"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom38860">
<div class="phpcode"><code><span class="html">If you've ever compiled PHP from source (any version) you may be familiar with the [in]famous MCRYPT_BLOWFISH_128 compilation error that appears when you attempt to compile --with-mcrypt. It occurs often on Debian but not only there. The problem: during compilation, the PHP configure script always assumes that libmcrypt has been built in conjunction with libltdl. Whenever that is not the case, PHP compilation will fail later saying certain headers (such as the above blowfish example) are missing from mcrypt.h (which is misleading, they're not supposed to be there nor looked after if libltdl was properly involved). Solution: make sure your libmcrypt was linked against libltdl before you even start configuring PHP. You can check by running 'ldd lybmcrypt.so' and verifying that libltdl appears in the output. libltdl can be found in libltld[3][-dev] on Debian or in libtool-libs on Red Hat.</span></code></div>
  </div>
 </div>
  <div class="note" id="92013">  <div class="votes">
    <div id="Vu92013">
    <a href="https://www.php.net/manual/vote-note.php?id=92013&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd92013">
    <a href="https://www.php.net/manual/vote-note.php?id=92013&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V92013" title="62% like this...">
    4
    </div>
  </div>
  <a href="ref.mcrypt.php.html#92013" class="name">
  <strong class="user"><em>manyagain</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#92013"> &para;</a><div class="date" title="2009-07-04 08:44"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom92013">
<div class="phpcode"><code><span class="html">if you don't have mcrypt installed, try phpseclib - <a href="http://phpseclib.sourceforge.net" rel="nofollow" target="_blank">http://phpseclib.sourceforge.net</a><br /><br />includes pure-php implementations of des, 3des, rc4, aes, and rijndael.  uses mcrypt if it's available and a pure-php implementation otherwise.  it also has the distinction of having the fastest existent pure-php aes implementation as per section 3.5.5. "Speed Comparisons" of the documentation.</span></code></div>
  </div>
 </div>
  <div class="note" id="61490">  <div class="votes">
    <div id="Vu61490">
    <a href="https://www.php.net/manual/vote-note.php?id=61490&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd61490">
    <a href="https://www.php.net/manual/vote-note.php?id=61490&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V61490" title="66% like this...">
    2
    </div>
  </div>
  <a href="ref.mcrypt.php.html#61490" class="name">
  <strong class="user"><em>triptripon at gmail dot com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#61490"> &para;</a><div class="date" title="2006-02-05 03:28"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom61490">
<div class="phpcode"><code><span class="html">Regarding storing the result on a postgres DB that uses Unicode (follow up to a post below). <br />You don't need to change the DB's encoding to ASCII. <br />Simply use BASE64 to encode the result, it's perfectly safe.<br />use base64_decode before you decrypt.<br />-- Tomer Levinboim</span></code></div>
  </div>
 </div>
  <div class="note" id="34579">  <div class="votes">
    <div id="Vu34579">
    <a href="https://www.php.net/manual/vote-note.php?id=34579&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd34579">
    <a href="https://www.php.net/manual/vote-note.php?id=34579&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V34579" title="66% like this...">
    2
    </div>
  </div>
  <a href="ref.mcrypt.php.html#34579" class="name">
  <strong class="user"><em>herowekker at hotmail dot com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#34579"> &para;</a><div class="date" title="2003-07-31 05:55"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom34579">
<div class="phpcode"><code><span class="html">mcrypt_ecb with base64_decode gave some problems, i found out that it had to be chopped to work:<br /><br /><span class="default">&lt;?php<br />chop</span><span class="keyword">(</span><span class="default">mcrypt_ecb</span><span class="keyword">(</span><span class="default">MCRYPT_BLOWFISH</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">),</span><span class="default">MCRYPT_DECRYPT</span><span class="keyword">));<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="80587">  <div class="votes">
    <div id="Vu80587">
    <a href="https://www.php.net/manual/vote-note.php?id=80587&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd80587">
    <a href="https://www.php.net/manual/vote-note.php?id=80587&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V80587" title="57% like this...">
    1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#80587" class="name">
  <strong class="user"><em>Kevin</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#80587"> &para;</a><div class="date" title="2008-01-23 09:37"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom80587">
<div class="phpcode"><code><span class="html">Solved Problem:<br /><br />when compiling php --with-mcrypt, phpinfo() says, that mcrypt ist enabled, but<br />"Supported ciphers none" and<br />"Supported modes none"<br /><br />In order to get mcrypt to work in php, you have to configure and compile the libmcrypt source package with the following options:<br />./configure --disable-posix-threads --enable-dynamic-loading</span></code></div>
  </div>
 </div>
  <div class="note" id="36291">  <div class="votes">
    <div id="Vu36291">
    <a href="https://www.php.net/manual/vote-note.php?id=36291&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36291">
    <a href="https://www.php.net/manual/vote-note.php?id=36291&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36291" title="57% like this...">
    1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#36291" class="name">
  <strong class="user"><em>simms</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#36291"> &para;</a><div class="date" title="2003-10-03 02:03"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36291">
<div class="phpcode"><code><span class="html">DEBIAN users: avoid mcrypt installation headaches. <br />to add mcrypt support to an existing php installation, get root and run <br /><br />apt-get install php4-mcrypt<br /><br />restart your webserver, and voila.</span></code></div>
  </div>
 </div>
  <div class="note" id="14536">  <div class="votes">
    <div id="Vu14536">
    <a href="https://www.php.net/manual/vote-note.php?id=14536&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd14536">
    <a href="https://www.php.net/manual/vote-note.php?id=14536&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V14536" title="55% like this...">
    1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#14536" class="name">
  <strong class="user"><em>pawelNOSPAM at rsc dot pl</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#14536"> &para;</a><div class="date" title="2001-08-02 06:37"><strong>22 years ago</strong></div>
  <div class="text" id="Hcom14536">
<div class="phpcode"><code><span class="html">If you compiled mcrypt and php without problem, but phpinfo() shows there are no supported ciphers and modes, try to change mode to 755 on libdirs (/usr/local/libmcrypt, /usr/local/libcrypt).</span></code></div>
  </div>
 </div>
  <div class="note" id="99263">  <div class="votes">
    <div id="Vu99263">
    <a href="https://www.php.net/manual/vote-note.php?id=99263&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd99263">
    <a href="https://www.php.net/manual/vote-note.php?id=99263&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V99263" title="51% like this...">
    1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#99263" class="name">
  <strong class="user"><em>patrickdk at patrickdk dot com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#99263"> &para;</a><div class="date" title="2010-08-06 10:30"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom99263">
<div class="phpcode"><code><span class="html">This works completely with mysql aes, even long keys.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">mysql_aes_decrypt</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$ky</span><span class="keyword">)<br />{<br />    </span><span class="default">$key</span><span class="keyword">=</span><span class="string">"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</span><span class="keyword">;<br />    for(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">);</span><span class="default">$a</span><span class="keyword">++)<br />      </span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]) ^ </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">]));<br />    </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">;<br />    </span><span class="default">$enc </span><span class="keyword">= </span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">;<br />    </span><span class="default">$dec </span><span class="keyword">= @</span><span class="default">mcrypt_decrypt</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, @</span><span class="default">mcrypt_create_iv</span><span class="keyword">( @</span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">), </span><span class="default">MCRYPT_DEV_URANDOM </span><span class="keyword">) );<br />    return </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">,(( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))&gt;=</span><span class="default">0 </span><span class="keyword">and </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))&lt;=</span><span class="default">16</span><span class="keyword">)? </span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))):</span><span class="default">null</span><span class="keyword">));<br />}<br /><br />function </span><span class="default">mysql_aes_encrypt</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$ky</span><span class="keyword">)<br />{<br />    </span><span class="default">$key</span><span class="keyword">=</span><span class="string">"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</span><span class="keyword">;<br />    for(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">);</span><span class="default">$a</span><span class="keyword">++)<br />      </span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]) ^ </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">]));<br />    </span><span class="default">$mode</span><span class="keyword">=</span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">;<br />    </span><span class="default">$enc</span><span class="keyword">=</span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">;<br />    </span><span class="default">$val</span><span class="keyword">=</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, (</span><span class="default">16</span><span class="keyword">*(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) / </span><span class="default">16</span><span class="keyword">)+(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">?</span><span class="default">2</span><span class="keyword">:</span><span class="default">1</span><span class="keyword">))), </span><span class="default">chr</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">-(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">)));<br />    return </span><span class="default">mcrypt_encrypt</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, </span><span class="default">mcrypt_create_iv</span><span class="keyword">( </span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">), </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">));<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="3671">  <div class="votes">
    <div id="Vu3671">
    <a href="https://www.php.net/manual/vote-note.php?id=3671&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd3671">
    <a href="https://www.php.net/manual/vote-note.php?id=3671&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V3671" title="53% like this...">
    1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#3671" class="name">
  <strong class="user"><em>mountie at paygate dot net</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#3671"> &para;</a><div class="date" title="2000-02-10 05:21"><strong>24 years ago</strong></div>
  <div class="text" id="Hcom3671">
<div class="phpcode"><code><span class="html">the encrypted result data maybe binary data and It make errors in sql query.<br />so use the base64_encode/base64_decode function with mcrypt()<br />try below<br /><br /><span class="default">&lt;?php<br />base64_encode</span><span class="keyword">(</span><span class="default">mcrypt_ecb</span><span class="keyword">(</span><span class="default">MCRYPT_BLOWFISH</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">$input</span><span class="keyword">,</span><span class="default">MCRYPT_ENCRYPT</span><span class="keyword">));<br /><br /></span><span class="default">mcrypt_ecb</span><span class="keyword">(</span><span class="default">MCRYPT_BLOWFISH</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">),</span><span class="default">MCRYPT_DECRYPT</span><span class="keyword">);<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="94373">  <div class="votes">
    <div id="Vu94373">
    <a href="https://www.php.net/manual/vote-note.php?id=94373&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd94373">
    <a href="https://www.php.net/manual/vote-note.php?id=94373&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V94373" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#94373" class="name">
  <strong class="user"><em>p ete postma - googlemail.com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#94373"> &para;</a><div class="date" title="2009-10-30 09:42"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom94373">
<div class="phpcode"><code><span class="html">mcrypt module initialization failed<br /><br />I found this circumstance:<br /><br />usemcrypt.php:<br /><span class="default">&lt;?php<br /> </span><span class="keyword">function </span><span class="default">protect</span><span class="keyword">() {<br /> </span><span class="comment">//some mcrypt/decrypt command<br /> </span><span class="keyword">}<br /></span><span class="default">?&gt;<br /></span><br />filea.php:<br /><span class="default">&lt;?php<br /></span><span class="keyword">include_once(</span><span class="string">'usemcrypt.php'</span><span class="keyword">);<br /><br />function </span><span class="default">a</span><span class="keyword">() {<br /> </span><span class="default">protect</span><span class="keyword">();<br />} </span><span class="default">?&gt;<br /></span><br />fileb.php<br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">b</span><span class="keyword">() {<br />  include_once(</span><span class="string">'usemcrypt.php'</span><span class="keyword">);<br />  </span><span class="default">protect</span><span class="keyword">();<br />}<br /></span><span class="default">?&gt;<br /></span><br />filea.php and a() work fine<br />fileb.php and b() will report a mcrypt module initialization failed<br /><br />I am assuming you can't pull that module in on the fly. If you use a file that calls mcrypt, it has to be included at the head, not in a function.</span></code></div>
  </div>
 </div>
  <div class="note" id="87274">  <div class="votes">
    <div id="Vu87274">
    <a href="https://www.php.net/manual/vote-note.php?id=87274&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd87274">
    <a href="https://www.php.net/manual/vote-note.php?id=87274&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V87274" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#87274" class="name">
  <strong class="user"><em>Rafael M. Salvioni</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#87274"> &para;</a><div class="date" title="2008-11-27 04:26"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom87274">
<div class="phpcode"><code><span class="html">The follow function is a implementation of the RC4 cypher algorithm in pure PHP code.<br /><br />The function is used to encrypt and decrypt data.<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">/**<br /> * Crypt/decrypt strings with RC4 stream cypher algorithm.<br /> *<br /> * @param string $key Key<br /> * @param string $data Encripted/pure data<br /> * @see   <a href="http://pt.wikipedia.org/wiki/RC4" rel="nofollow" target="_blank">http://pt.wikipedia.org/wiki/RC4</a><br /> * @return string<br /> */<br /></span><span class="keyword">function </span><span class="default">rc4</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">)<br />{<br />    </span><span class="comment">// Store the vectors "S" has calculated<br />    </span><span class="keyword">static </span><span class="default">$SC</span><span class="keyword">;<br />    </span><span class="comment">// Function to swaps values of the vector "S"<br />    </span><span class="default">$swap </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$v1, &amp;$v2'</span><span class="keyword">, </span><span class="string">'<br />        $v1 = $v1 ^ $v2;<br />        $v2 = $v1 ^ $v2;<br />        $v1 = $v1 ^ $v2;<br />    '</span><span class="keyword">);<br />    </span><span class="default">$ikey </span><span class="keyword">= </span><span class="default">crc32</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />    if (!isset(</span><span class="default">$SC</span><span class="keyword">[</span><span class="default">$ikey</span><span class="keyword">])) {<br />        </span><span class="comment">// Make the vector "S", basead in the key<br />        </span><span class="default">$S    </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />        </span><span class="default">$j    </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />        </span><span class="default">$n    </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />        for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">255</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />            </span><span class="default">$char  </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">{</span><span class="default">$i </span><span class="keyword">% </span><span class="default">$n</span><span class="keyword">});<br />            </span><span class="default">$j     </span><span class="keyword">= (</span><span class="default">$j </span><span class="keyword">+ </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] + </span><span class="default">$char</span><span class="keyword">) % </span><span class="default">256</span><span class="keyword">;<br />            </span><span class="default">$swap</span><span class="keyword">(</span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]);<br />        }<br />        </span><span class="default">$SC</span><span class="keyword">[</span><span class="default">$ikey</span><span class="keyword">] = </span><span class="default">$S</span><span class="keyword">;<br />    } else {<br />        </span><span class="default">$S </span><span class="keyword">= </span><span class="default">$SC</span><span class="keyword">[</span><span class="default">$ikey</span><span class="keyword">];<br />    }<br />    </span><span class="comment">// Crypt/decrypt the data<br />    </span><span class="default">$n    </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />    </span><span class="default">$data </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />    </span><span class="default">$i    </span><span class="keyword">= </span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />    for (</span><span class="default">$m </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$m </span><span class="keyword">&lt; </span><span class="default">$n</span><span class="keyword">; </span><span class="default">$m</span><span class="keyword">++) {<br />        </span><span class="default">$i        </span><span class="keyword">= (</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">) % </span><span class="default">256</span><span class="keyword">;<br />        </span><span class="default">$j        </span><span class="keyword">= (</span><span class="default">$j </span><span class="keyword">+ </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) % </span><span class="default">256</span><span class="keyword">;<br />        </span><span class="default">$swap</span><span class="keyword">(</span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]);<br />        </span><span class="default">$char     </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">]);<br />        </span><span class="default">$char     </span><span class="keyword">= </span><span class="default">$S</span><span class="keyword">[(</span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] + </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]) % </span><span class="default">256</span><span class="keyword">] ^ </span><span class="default">$char</span><span class="keyword">;<br />        </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">] = </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">);<br />    }<br />    return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;</span></span></code></div>
  </div>
 </div>
  <div class="note" id="74817">  <div class="votes">
    <div id="Vu74817">
    <a href="https://www.php.net/manual/vote-note.php?id=74817&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd74817">
    <a href="https://www.php.net/manual/vote-note.php?id=74817&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V74817" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#74817" class="name">
  <strong class="user"><em>Ivan Frederiks</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#74817"> &para;</a><div class="date" title="2007-04-28 07:03"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom74817">
<div class="phpcode"><code><span class="html">To enable mcrypt extension under Windows you need to:<br />1) uncomment line "extension=php_mcrypt.dll" in php.ini<br />2) download libmcrypt.dll from <a href="http://files.edin.dk/php/win32/mcrypt/" rel="nofollow" target="_blank">http://files.edin.dk/php/win32/mcrypt/</a> and put it to System32 directory (for example C:\Windows\System32).<br />Tested on Windows XP+Apache 1.3.37+PHP 4.4.6 (as SAPI module!!!)<br /><br />P.S.<br />I wrote this because I got "Cannot load mcrypt extension. Please check your PHP configuration." from phpMyAdmin when I simply uncommented "extension=php_mcrypt.dll" line.</span></code></div>
  </div>
 </div>
  <div class="note" id="62494">  <div class="votes">
    <div id="Vu62494">
    <a href="https://www.php.net/manual/vote-note.php?id=62494&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd62494">
    <a href="https://www.php.net/manual/vote-note.php?id=62494&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V62494" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#62494" class="name">
  <strong class="user"><em>vincent at verbrugh dot nl</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#62494"> &para;</a><div class="date" title="2006-03-01 01:55"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom62494">
<div class="phpcode"><code><span class="html">If you plan to use Mcrypt Encryption to store encrypted data (e.g. passwords) in a (MySQL) database make sure to set the column to BLOB rather than VARCHAR. Otherwise the data may change which can give unexpected results if you decrypt the value.</span></code></div>
  </div>
 </div>
  <div class="note" id="62006">  <div class="votes">
    <div id="Vu62006">
    <a href="https://www.php.net/manual/vote-note.php?id=62006&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd62006">
    <a href="https://www.php.net/manual/vote-note.php?id=62006&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V62006" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#62006" class="name">
  <strong class="user"><em>Jerry Hathaway</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#62006"> &para;</a><div class="date" title="2006-02-16 10:23"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom62006">
<div class="phpcode"><code><span class="html">After benchmarking AES in 256-bit operation, I've concluded that CBC is far faster than OFB.  Using a 14.9 MiB file, on average...<br /><br />Encrypt in CBC:   1.9 seconds<br />Encrypt in OFB:   45.7 seconds (same as CFB)<br />Just reading the file:  ~.53 seconds<br /><br />After some research, I've concluded that OFB and CFB are slightly more secure than CBC, however I believe the performance difference to be due to an implementation issue.<br /><br />As a side note on ECB:  As stated in the wiki linked to below, ECB is wholly inadequate.  It not use an IV (whether it was supplied ot MCrypt or not), meaning the same key and plaintext always produce the same ciphertext and it doesn't hide patterns.  The site shows an excellent example of this.<br /><br />Very useful info:<br /><a href="http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation</a></span></code></div>
  </div>
 </div>
  <div class="note" id="58446">  <div class="votes">
    <div id="Vu58446">
    <a href="https://www.php.net/manual/vote-note.php?id=58446&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd58446">
    <a href="https://www.php.net/manual/vote-note.php?id=58446&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V58446" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#58446" class="name">
  <strong class="user"><em>coz AT metamule D0T com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#58446"> &para;</a><div class="date" title="2005-11-04 05:15"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom58446">
<div class="phpcode"><code><span class="html">If you're going to encrypt data with something like this and store it in postgres.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">encrypt</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">){<br />        </span><span class="default">$result </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />        for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++){<br />            </span><span class="default">$char </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />            </span><span class="default">$keychar </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, (</span><span class="default">$i </span><span class="keyword">% </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">))-</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />            </span><span class="default">$char </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">)+</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$keychar</span><span class="keyword">));<br />            </span><span class="default">$result</span><span class="keyword">.=</span><span class="default">$char</span><span class="keyword">;<br />        }<br />        return </span><span class="default">$result</span><span class="keyword">;<br />    }<br /></span><span class="default">?&gt;<br /></span><br />Make sure when you create your database to set the encoding to SQL_ASCII because you won't be able to store this data in a database that uses UNICODE</span></code></div>
  </div>
 </div>
  <div class="note" id="58300">  <div class="votes">
    <div id="Vu58300">
    <a href="https://www.php.net/manual/vote-note.php?id=58300&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd58300">
    <a href="https://www.php.net/manual/vote-note.php?id=58300&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V58300" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#58300" class="name">
  <strong class="user"><em>joseph-at-digiweb-dot-net-dot-nz</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#58300"> &para;</a><div class="date" title="2005-10-30 05:22"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom58300">
<div class="phpcode"><code><span class="html">A further note for those doing interop between PHP and Java:<br /><br />If you're using the BouncyCastle library on the Java side, then you can use the ZeroBytePadding mode now available in it. Mcrypt pads the data with Nulls rather than spaces....<br /><br />I've sucessfully done interop using Blowfish/CBC/ZeroBytePadding between PHP and Java this way.</span></code></div>
  </div>
 </div>
  <div class="note" id="54717">  <div class="votes">
    <div id="Vu54717">
    <a href="https://www.php.net/manual/vote-note.php?id=54717&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd54717">
    <a href="https://www.php.net/manual/vote-note.php?id=54717&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V54717" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#54717" class="name">
  <strong class="user"><em>paul dot lewis at absolutegenius dot co dot uk</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#54717"> &para;</a><div class="date" title="2005-07-13 08:33"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom54717">
<div class="phpcode"><code><span class="html">I've spent the majority of the day attempting to get mcrypt to work under IIS6 with Windows Server 2003 (Web Edition) and PHP 5.0.4<br /><br />There seems to be some incompatability with enabling certain extensions (mcrypt being one) when you are running PHP as ISAPI in this environment.<br /><br />The way to solve the problem (the error will be that it cannot load php_mcrypt.dll - access is denied) is to run in CGI. While this isn't supposed to be as good performance wise, if you need the mcrypt support (or Oracle support, too, I believe) then this is the only way I've found to do it.</span></code></div>
  </div>
 </div>
  <div class="note" id="47626">  <div class="votes">
    <div id="Vu47626">
    <a href="https://www.php.net/manual/vote-note.php?id=47626&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd47626">
    <a href="https://www.php.net/manual/vote-note.php?id=47626&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V47626" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#47626" class="name">
  <strong class="user"><em>Jurgen Schwietering</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#47626"> &para;</a><div class="date" title="2004-11-23 01:20"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom47626">
<div class="phpcode"><code><span class="html">Attention when using keys longer than the actual key size (i.e. 160 bit instead of 128 bit). <br /><br />It will work inbetween PHP scripts, but might cause problems when using openssl or other packages with this integration of mcrypt. Cut them always to the supported size (mcrypt_enc_get_key_size) to avoid sleepless hours.</span></code></div>
  </div>
 </div>
  <div class="note" id="20267">  <div class="votes">
    <div id="Vu20267">
    <a href="https://www.php.net/manual/vote-note.php?id=20267&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd20267">
    <a href="https://www.php.net/manual/vote-note.php?id=20267&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V20267" title="50% like this...">
    0
    </div>
  </div>
  <a href="ref.mcrypt.php.html#20267" class="name">
  <strong class="user"><em>scott at boothcreek dot com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#20267"> &para;</a><div class="date" title="2002-03-28 01:28"><strong>21 years ago</strong></div>
  <div class="text" id="Hcom20267">
<div class="phpcode"><code><span class="html">If you are using ECB mode to encrypt it does not seem to use the iv (initialization vector) for much of anything, given the same key it will always decrypt it no matter what the iv is.  If you use CBC mode you must decrypt with the same iv that you encrypted with. <br /><br /> If you use a different iv before decrypting, your decrypt will not work.  IMHO it seems better to use CBC mode than ECB as ECB will always encrypt to the same cipher text given the same plain text  (leaving you open to know plaintext attacks).  CBC uses the random iv which means text encrypts to different things.  You probably could get the same effect from using random keys in ECB mode.<br /><br />Read that in the Schneier book - Applied Cryptography (ISBN 0-471-11709-9)  This book is a must for anyone seriously using any type of encryption.</span></code></div>
  </div>
 </div>
  <div class="note" id="80808">  <div class="votes">
    <div id="Vu80808">
    <a href="https://www.php.net/manual/vote-note.php?id=80808&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd80808">
    <a href="https://www.php.net/manual/vote-note.php?id=80808&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V80808" title="44% like this...">
    -1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#80808" class="name">
  <strong class="user"><em>phpknights at pookmail dot com</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#80808"> &para;</a><div class="date" title="2008-02-01 01:18"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom80808">
<div class="phpcode"><code><span class="html">The Pear class Crypt/Blowfish.php will use the mcrypt module if available but the mcrypt module is not required.<br /><br />Some very easy Pear and example pseudocode to protect your data by encrypting your databases with a one-way hash and blowfish symmetric encryption.<br /><a href="http://en.wikibooks.org/wiki/Cryptography/Database_protection" rel="nofollow" target="_blank">http://en.wikibooks.org/wiki/Cryptography/Database_protection</a><br /><br />Using a one-way hash and blowfish symmetric encryption.<br />1. Insert a record of John Doe in an encrypted database.<br />2. Get the encrypted record of user John Doe and decrypt the data.<br /><br />1. Insert a record of John Doe in an encrypted database.<br /><span class="default">&lt;?php<br /><br />        </span><span class="keyword">require_once(</span><span class="string">"Crypt/Blowfish.php"</span><span class="keyword">); </span><span class="comment">// a Pear class<br /><br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">]       =       </span><span class="string">"johndoe@anisp.localhost"</span><span class="keyword">; </span><span class="comment">// The Primary key<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]        =       </span><span class="string">"John Doe"</span><span class="keyword">;<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">]    =       </span><span class="string">"0192733652342" </span><span class="keyword">;<br /><br />        </span><span class="comment">// crypt - one-way encryption<br />        </span><span class="default">$cipher_key </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">] , </span><span class="string">"AN_SECRET_COMPANY_SALT"</span><span class="keyword">);<br /><br />        </span><span class="default">$bf </span><span class="keyword">= new </span><span class="default">Crypt_Blowfish</span><span class="keyword">(</span><span class="string">'ecb'</span><span class="keyword">);<br />        </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">setKey</span><span class="keyword">( </span><span class="default">$cipher_key </span><span class="keyword">);<br /><br />        </span><span class="comment">// crypt_blowfish symmetric encryption to encrypt the data<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">]       = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">] );<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]        = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] );<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">]    = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">] );<br /><br />        </span><span class="default">$result </span><span class="keyword">= </span><span class="default">sqlInsert</span><span class="keyword">( </span><span class="default">$aRecord </span><span class="keyword">) ;<br /></span><span class="default">?&gt;<br /></span><br />2. Get the encrypted record of user John Doe and decrypt the data.<br /><span class="default">&lt;?php<br /><br />        </span><span class="keyword">require_once(</span><span class="string">"Crypt/Blowfish.php"</span><span class="keyword">);  </span><span class="comment">// a Pear class<br /><br />        </span><span class="default">$primary_key </span><span class="keyword">= </span><span class="string">"johndoe@anisp.localhost"</span><span class="keyword">;<br /><br />        </span><span class="comment">// crypt - one-way encryption<br />        </span><span class="default">$cipher_key </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">(  </span><span class="default">$primary_key </span><span class="keyword">, </span><span class="string">"AN_SECRET_COMPANY_SALT"</span><span class="keyword">);<br /><br />        </span><span class="default">$bf </span><span class="keyword">= new </span><span class="default">Crypt_Blowfish</span><span class="keyword">(</span><span class="string">'ecb'</span><span class="keyword">);<br />        </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">setKey</span><span class="keyword">( </span><span class="default">$cipher_key </span><span class="keyword">);<br /><br />        </span><span class="comment">// crypt_blowfish symmetric encryption to ecrypt the primary key for a sql select<br />        </span><span class="default">$select_key </span><span class="keyword">= </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">(  </span><span class="default">$primary_key </span><span class="keyword">) ;<br /><br />        </span><span class="default">$aRecord </span><span class="keyword">= </span><span class="default">sqlSelectWithPKEY</span><span class="keyword">( </span><span class="default">$select_key </span><span class="keyword">);<br /><br />        </span><span class="comment">// crypt_blowfish symmetric encryption to decrypt the data<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">]       = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">] );<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]        = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] );<br />        </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">]    = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">] );<br /></span><span class="default">?&gt;<br /></span><br />Thanks for reading this.</span></code></div>
  </div>
 </div>
  <div class="note" id="83519">  <div class="votes">
    <div id="Vu83519">
    <a href="https://www.php.net/manual/vote-note.php?id=83519&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83519">
    <a href="https://www.php.net/manual/vote-note.php?id=83519&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83519" title="42% like this...">
    -1
    </div>
  </div>
  <a href="ref.mcrypt.php.html#83519" class="name">
  <strong class="user"><em>artem at it-nt dot ru</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#83519"> &para;</a><div class="date" title="2008-05-29 12:25"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom83519">
<div class="phpcode"><code><span class="html">And some code for LM hash:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">function </span><span class="default">LMhash</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br />{<br />    </span><span class="default">$string </span><span class="keyword">= </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">14</span><span class="keyword">));<br /><br />    </span><span class="default">$p1 </span><span class="keyword">= </span><span class="default">LMhash_DESencrypt</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">));<br />    </span><span class="default">$p2 </span><span class="keyword">= </span><span class="default">LMhash_DESencrypt</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">));<br /><br />    return </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$p1</span><span class="keyword">.</span><span class="default">$p2</span><span class="keyword">);<br />}<br /><br />function </span><span class="default">LMhash_DESencrypt</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br />{<br />    </span><span class="default">$key </span><span class="keyword">= array();<br />    </span><span class="default">$tmp </span><span class="keyword">= array();<br />    </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br /><br />    for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">7</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">)<br />        </span><span class="default">$tmp</span><span class="keyword">[] = </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len </span><span class="keyword">? </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) : </span><span class="default">0</span><span class="keyword">;<br /><br />    </span><span class="default">$key</span><span class="keyword">[] = </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] &amp; </span><span class="default">254</span><span class="keyword">;<br />    </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] &lt;&lt; </span><span class="default">7</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] &gt;&gt; </span><span class="default">1</span><span class="keyword">);<br />    </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] &lt;&lt; </span><span class="default">6</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] &gt;&gt; </span><span class="default">2</span><span class="keyword">);<br />    </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] &lt;&lt; </span><span class="default">5</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] &gt;&gt; </span><span class="default">3</span><span class="keyword">);<br />    </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] &lt;&lt; </span><span class="default">4</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] &gt;&gt; </span><span class="default">4</span><span class="keyword">);<br />    </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] &lt;&lt; </span><span class="default">3</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] &gt;&gt; </span><span class="default">5</span><span class="keyword">);<br />    </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] &lt;&lt; </span><span class="default">2</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] &gt;&gt; </span><span class="default">6</span><span class="keyword">);<br />    </span><span class="default">$key</span><span class="keyword">[] = </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] &lt;&lt; </span><span class="default">1</span><span class="keyword">;<br />    <br />    </span><span class="default">$is </span><span class="keyword">= </span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">MCRYPT_DES</span><span class="keyword">, </span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">);<br />    </span><span class="default">$iv </span><span class="keyword">= </span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">$is</span><span class="keyword">, </span><span class="default">MCRYPT_RAND</span><span class="keyword">);<br />    </span><span class="default">$key0 </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />    <br />    foreach (</span><span class="default">$key </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">)<br />        </span><span class="default">$key0 </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">);<br />    </span><span class="default">$crypt </span><span class="keyword">= </span><span class="default">mcrypt_encrypt</span><span class="keyword">(</span><span class="default">MCRYPT_DES</span><span class="keyword">, </span><span class="default">$key0</span><span class="keyword">, </span><span class="string">"KGS!@#$%"</span><span class="keyword">, </span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);<br /><br />    return </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">$crypt</span><span class="keyword">);<br />}<br /></span><span class="default">?&gt;<br /></span><br />Some optimization?</span></code></div>
  </div>
 </div>
  <div class="note" id="36161">  <div class="votes">
    <div id="Vu36161">
    <a href="https://www.php.net/manual/vote-note.php?id=36161&amp;page=ref.mcrypt&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd36161">
    <a href="https://www.php.net/manual/vote-note.php?id=36161&amp;page=ref.mcrypt&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V36161" title="33% like this...">
    -2
    </div>
  </div>
  <a href="ref.mcrypt.php.html#36161" class="name">
  <strong class="user"><em>steve@itemfront dot ltd dot uk</em></strong></a><a class="genanchor" href="ref.mcrypt.php.html#36161"> &para;</a><div class="date" title="2003-09-29 05:17"><strong>20 years ago</strong></div>
  <div class="text" id="Hcom36161">
<div class="phpcode"><code><span class="html">Just spent a while getting mcrypt support working with php. Used libmcrypt version 2.5.7 with php 4.3.3. Out of the box it just won't work. Configure as follows:<br /><br />libmcrypt:<br /><br />  ./configure --disable-posix-threads --enable-dynamic-loading<br /><br />php: ( as you can see, it's built for a SunONE server, but that's the easy bit to configure! )<br /><br />./configure  --with-nsapi=/usr/iplanet/servers --enable-sigchld --with-ldap --with-zlib-dir=/usr/lib --with-mcrypt=&lt;srcdir&gt;/libmcrypt-2.5.7<br /><br />hth, steve</span></code></div>
  </div>
 </div></div>
<div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=ref.mcrypt&amp;redirect=https://www.php.net/manual/ru/ref.mcrypt.php">＋<small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="book.mcrypt.php.html">Mcrypt</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="intro.mcrypt.php.html" title="Введение">Введение</a>
                        </li>
                                                <li class="">
                            <a href="mcrypt.setup.php.html" title="Установка и настройка">Установка и настройка</a>
                        </li>
                                                <li class="">
                            <a href="mcrypt.constants.php.html" title="Предопределённые константы">Предопределённые константы</a>
                        </li>
                                                <li class="">
                            <a href="mcrypt.ciphers.php.html" title="Шифры Mcrypt">Шифры Mcrypt</a>
                        </li>
                                                <li class="current">
                            <a href="ref.mcrypt.php.html" title="Mcrypt">Mcrypt</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2024 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fhogan-3.0.2.min.js"></script>
<script src="../../cached.php%3Ft=1421837618&amp;f=%252Fjs%252Fext%252Ftypeahead.min.js"></script>
<script src="../../cached.php%3Ft=1657876202&amp;f=%252Fjs%252Fext%252Fmousetrap.min.js"></script>
<script src="../../cached.php%3Ft=1657730402&amp;f=%252Fjs%252Fext%252Fjquery.scrollTo.min.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fsearch.js"></script>
<script src="../../cached.php%3Ft=1701958202&amp;f=%252Fjs%252Fcommon.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top@2x.png"></a>

</body>
</html>
